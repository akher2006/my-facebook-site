;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="10c668de-79b3-ca2b-c227-c424516ae121")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,614447,e=>{"use strict";var t,i,n,r,s,a,o,l,c,u,h,d,f,v=e.i(439725),_=e.i(394212),g=e.i(297083),y=e.i(399119),p=e.i(904851),m=e.i(90659),x=e.i(721281),w=e.i(663355),C=e.i(862470),b=e.i(445789),L=e.i(167626),k=e.i(530658),M=e.i(346715),S=e.i(119468),A=e.i(463348),R=e.i(817556),T=e.i(903673),E=new(function(){function e(){(0,p._)(this,e),this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(function(){throw e.stack?F.isErrorNoTelemetry(e)?new F(e.message+"\n\n"+e.stack):Error(e.message+"\n\n"+e.stack):e},0)}}return(0,m._)(e,[{key:"addListener",value:function(e){var t=this;return this.listeners.push(e),function(){t._removeListener(e)}}},{key:"emit",value:function(e){this.listeners.forEach(function(t){t(e)})}},{key:"_removeListener",value:function(e){this.listeners.splice(this.listeners.indexOf(e),1)}},{key:"setUnexpectedErrorHandler",value:function(e){this.unexpectedErrorHandler=e}},{key:"getUnexpectedErrorHandler",value:function(){return this.unexpectedErrorHandler}},{key:"onUnexpectedError",value:function(e){this.unexpectedErrorHandler(e),this.emit(e)}},{key:"onUnexpectedExternalError",value:function(e){this.unexpectedErrorHandler(e)}}]),e}());function B(e){var t;t=e,(0,L._)(t,P)||(0,L._)(t,Error)&&t.name===D&&t.message===D||E.onUnexpectedError(e)}var D="Canceled",P=function(e){function t(){var e;return(0,p._)(this,t),(e=(0,y._)(this,t,[D])).name=e.message,e}return(0,b._)(t,e),t}((0,A._)(Error)),F=function(e){function t(e){var i;return(0,p._)(this,t),(i=(0,y._)(this,t,[e])).name="CodeExpectedError",i}return(0,b._)(t,e),(0,m._)(t,null,[{key:"fromError",value:function(e){if((0,L._)(e,t))return e;var i=new t;return i.message=e.message,i.stack=e.stack,i}},{key:"isErrorNoTelemetry",value:function(e){return"CodeExpectedError"===e.name}}]),t}((0,A._)(Error));(function(){function e(t){(0,p._)(this,e),this._array=t,this._findLastMonotonousLastIdx=0}return(0,m._)(e,[{key:"findLastMonotonous",value:function(t){if(e.assertInvariants){if(this._prevFindLastPredicate){var i=!0,n=!1,r=void 0;try{for(var s,a=this._array[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var o=s.value;if(this._prevFindLastPredicate(o)&&!t(o))throw Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}}catch(e){n=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(n)throw r}}}this._prevFindLastPredicate=t}var l=function(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,r=i,s=n;r<s;){var a=Math.floor((r+s)/2);t(e[a])?r=a+1:s=a}return r-1}(this._array,t,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=l+1,-1===l?void 0:this._array[l]}}]),e})().assertInvariants=!1,($=en||(en={})).isLessThan=function(e){return e<0},$.isLessThanOrEqual=function(e){return e<=0},$.isGreaterThan=function(e){return e>0},$.isNeitherLessOrGreaterThan=function(e){return 0===e},$.greaterThan=1,$.lessThan=-1,$.neitherLessOrGreaterThan=0;var I=function(e,t){return e-t},W=function(){function e(t){(0,p._)(this,e),this.iterate=t}return(0,m._)(e,[{key:"forEach",value:function(e){this.iterate(function(t){return e(t),!0})}},{key:"toArray",value:function(){var e=[];return this.iterate(function(t){return e.push(t),!0}),e}},{key:"filter",value:function(t){var i=this;return new e(function(e){return i.iterate(function(i){return!t(i)||e(i)})})}},{key:"map",value:function(t){var i=this;return new e(function(e){return i.iterate(function(i){return e(t(i))})})}},{key:"some",value:function(e){var t=!1;return this.iterate(function(i){return!(t=e(i))}),t}},{key:"findFirst",value:function(e){var t;return this.iterate(function(i){return!e(i)||(t=i,!1)}),t}},{key:"findLast",value:function(e){var t;return this.iterate(function(i){return e(i)&&(t=i),!0}),t}},{key:"findLastMaxBy",value:function(e){var t,i=!0;return this.iterate(function(n){return(i||en.isGreaterThan(e(n,t)))&&(i=!1,t=n),!0}),t}}]),e}();W.empty=new W(function(e){});var z=function(){function e(){(0,p._)(this,e),this.map=new Map}return(0,m._)(e,[{key:"add",value:function(e,t){var i=this.map.get(e);i||(i=new Set,this.map.set(e,i)),i.add(t)}},{key:"delete",value:function(e,t){var i=this.map.get(e);i&&(i.delete(t),0===i.size&&this.map.delete(e))}},{key:"forEach",value:function(e,t){var i=this.map.get(e);i&&i.forEach(t)}},{key:"get",value:function(e){return this.map.get(e)||new Set}}]),e}();function O(e){}function U(e,t){}function N(e){if(el.is(e)){var t=[],i=!0,n=!1,r=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var o=s.value;if(o)try{o.dispose()}catch(e){t.push(e)}}}catch(e){n=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(n)throw r}}if(1===t.length)throw t[0];if(t.length>1)throw AggregateError(t,"Encountered errors while disposing of store");return Array.isArray(e)?[]:e}if(e)return e.dispose(),e}function q(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=G(function(){return N(t)});return n}function G(e){var t={dispose:function(e,t){var i,n=this,r=!1;return function(){if(r)return i;if(r=!0,t)try{i=e.apply(n,arguments)}finally{t()}else i=e.apply(n,arguments);return i}}(function(){O(t),e()})};return t}er=el||(el={}),es=function(e){return e&&(void 0===e?"undefined":(0,S._)(e))=="object"&&"function"==typeof e[Symbol.iterator]},ea=function(e){return(0,R._)(this,function(t){switch(t.label){case 0:return[4,e];case 1:return t.sent(),[2]}})},er.is=es,eo=Object.freeze([]),er.empty=function(){return eo},er.single=ea,er.wrap=function(e){return es(e)?e:ea(e)},er.from=function(e){return e||eo},er.reverse=function(e){var t;return(0,R._)(this,function(i){switch(i.label){case 0:t=e.length-1,i.label=1;case 1:if(!(t>=0))return[3,4];return[4,e[t]];case 2:i.sent(),i.label=3;case 3:return t--,[3,1];case 4:return[2]}})},er.isEmpty=function(e){return!e||!0===e[Symbol.iterator]().next().done},er.first=function(e){return e[Symbol.iterator]().next().value},er.some=function(e,t){var i=0,n=!0,r=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var l=a.value;if(t(l,i++))return!0}}catch(e){r=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw s}}return!1},er.find=function(e,t){var i=!0,n=!1,r=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var o=s.value;if(t(o))return o}}catch(e){n=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(n)throw r}}},er.filter=function(e,t){var i,n,r,s,a,o,l;return(0,R._)(this,function(c){switch(c.label){case 0:i=!0,n=!1,r=void 0,c.label=1;case 1:c.trys.push([1,7,8,9]),s=e[Symbol.iterator](),c.label=2;case 2:if(i=(a=s.next()).done)return[3,6];if(!t(o=a.value))return[3,4];return[4,o];case 3:c.sent(),c.label=4;case 4:c.label=5;case 5:return i=!0,[3,2];case 6:return[3,9];case 7:return l=c.sent(),n=!0,r=l,[3,9];case 8:try{i||null==s.return||s.return()}finally{if(n)throw r}return[7];case 9:return[2]}})},er.map=function(e,t){var i,n,r,s,a,o,l;return(0,R._)(this,function(c){switch(c.label){case 0:i=0,n=!0,r=!1,s=void 0,c.label=1;case 1:c.trys.push([1,6,7,8]),a=e[Symbol.iterator](),c.label=2;case 2:if(n=(o=a.next()).done)return[3,5];return[4,t(o.value,i++)];case 3:c.sent(),c.label=4;case 4:return n=!0,[3,2];case 5:return[3,8];case 6:return l=c.sent(),r=!0,s=l,[3,8];case 7:try{n||null==a.return||a.return()}finally{if(r)throw s}return[7];case 8:return[2]}})},er.flatMap=function(e,t){var i,n,r,s,a,o,l,c;return(0,R._)(this,function(u){switch(u.label){case 0:i=0,n=!0,r=!1,s=void 0,u.label=1;case 1:u.trys.push([1,6,7,8]),a=e[Symbol.iterator](),u.label=2;case 2:if(n=(o=a.next()).done)return[3,5];return l=o.value,[5,(0,T._)(t(l,i++))];case 3:u.sent(),u.label=4;case 4:return n=!0,[3,2];case 5:return[3,8];case 6:return c=u.sent(),r=!0,s=c,[3,8];case 7:try{n||null==a.return||a.return()}finally{if(r)throw s}return[7];case 8:return[2]}})},er.concat=function(){var e,t,i,n,r,s,a,o,l,c,u=arguments;return(0,R._)(this,function(h){switch(h.label){case 0:for(t=Array(e=u.length),i=0;i<e;i++)t[i]=u[i];n=!0,r=!1,s=void 0,h.label=1;case 1:h.trys.push([1,6,7,8]),a=t[Symbol.iterator](),h.label=2;case 2:if(n=(o=a.next()).done)return[3,5];return l=o.value,[5,(0,T._)(l)];case 3:h.sent(),h.label=4;case 4:return n=!0,[3,2];case 5:return[3,8];case 6:return c=h.sent(),r=!0,s=c,[3,8];case 7:try{n||null==a.return||a.return()}finally{if(r)throw s}return[7];case 8:return[2]}})},er.reduce=function(e,t,i){var n=i,r=!0,s=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var c=o.value;n=t(n,c)}}catch(e){s=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(s)throw a}}return n},er.slice=function(e,t){var i,n=arguments;return(0,R._)(this,function(r){switch(r.label){case 0:i=n.length>2&&void 0!==n[2]?n[2]:e.length,t<0&&(t+=e.length),i<0?i+=e.length:i>e.length&&(i=e.length),r.label=1;case 1:if(!(t<i))return[3,4];return[4,e[t]];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}})},er.consume=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,i=[];if(0===t)return[i,e];for(var n=e[Symbol.iterator](),r=0;r<t;r++){var s=n.next();if(s.done)return[i,er.empty()];i.push(s.value)}return[i,(0,x._)({},Symbol.iterator,function(){return n})]},er.asyncToArray=function(e){return(0,g._)(function(){var t,i,n,r,s,a,o,l;return(0,R._)(this,function(c){switch(c.label){case 0:t=[],i=!1,n=!1,c.label=1;case 1:c.trys.push([1,6,7,12]),s=(0,_._)(e),c.label=2;case 2:return[4,s.next()];case 3:if(!(i=!(a=c.sent()).done))return[3,5];o=a.value,t.push(o),c.label=4;case 4:return i=!1,[3,2];case 5:return[3,12];case 6:return l=c.sent(),n=!0,r=l,[3,12];case 7:if(c.trys.push([7,,10,11]),!(i&&null!=s.return))return[3,9];return[4,s.return()];case 8:c.sent(),c.label=9;case 9:return[3,11];case 10:if(n)throw r;return[7];case 11:return[7];case 12:return[2,Promise.resolve(t)]}})})()},function(){function e(){(0,p._)(this,e),this.livingDisposables=new Map}return(0,m._)(e,[{key:"getDisposableData",value:function(t){var i=this.livingDisposables.get(t);return i||(i={parent:null,source:null,isSingleton:!1,value:t,idx:e.idx++},this.livingDisposables.set(t,i)),i}},{key:"trackDisposable",value:function(e){var t=this.getDisposableData(e);t.source||(t.source=Error().stack)}},{key:"setParent",value:function(e,t){this.getDisposableData(e).parent=t}},{key:"markAsDisposed",value:function(e){this.livingDisposables.delete(e)}},{key:"markAsSingleton",value:function(e){this.getDisposableData(e).isSingleton=!0}},{key:"getRootParent",value:function(e,t){var i=t.get(e);if(i)return i;var n=e.parent?this.getRootParent(this.getDisposableData(e.parent),t):e;return t.set(e,n),n}},{key:"getTrackedDisposables",value:function(){var e=this,t=new Map;return(0,M._)(this.livingDisposables.entries()).filter(function(i){var n=(0,k._)(i,2)[1];return null!==n.source&&!e.getRootParent(n,t).isSingleton}).flatMap(function(e){return(0,k._)(e,1)[0]})}},{key:"computeLeakingDisposables",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=arguments.length>1?arguments[1]:void 0;if(i)u=i;else{var n=new Map,r=(0,M._)(this.livingDisposables.values()).filter(function(t){return null!==t.source&&!e.getRootParent(t,n).isSingleton});if(0===r.length)return;var s=new Set(r.map(function(e){return e.value}));if(0===(u=r.filter(function(e){return!(e.parent&&s.has(e.parent))})).length)throw Error("There are cyclic diposable chains!")}if(u){var a=new z,o=!0,l=!1,c=void 0;try{for(var u,h,d=u[Symbol.iterator]();!(o=(h=d.next()).done);o=!0)for(var f=h.value,v=E(f),_=0;_<=v.length;_++)a.add(v.slice(0,_).join("\n"),f)}catch(e){l=!0,c=e}finally{try{o||null==d.return||d.return()}finally{if(l)throw c}}u.sort((w=function(e){return e.idx},function(e,t){return I(w(e),w(t))}));var g="",y=0,p=!0,m=!1,x=void 0;try{for(var w,C,b=u.slice(0,t)[Symbol.iterator]();!(p=(C=b.next()).done);p=!0){var L=function(e){var t=A[e];t="(shared with ".concat(a.get(A.slice(0,e+1).join("\n")).size,"/").concat(u.length," leaks) at ").concat(t);var i=a.get(A.slice(0,e).join("\n")),n=function(e,t){var i=Object.create(null),n=!0,r=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var l=a.value,c=t(l),u=i[c];u||(u=i[c]=[]),u.push(l)}}catch(e){r=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw s}}return i}((0,M._)(i).map(function(t){return E(t)[e]}),function(e){return e});delete n[A[e]];var r=!0,s=!1,o=void 0;try{for(var l,c=Object.entries(n)[Symbol.iterator]();!(r=(l=c.next()).done);r=!0){var h=(0,k._)(l.value,2),d=h[0],f=h[1];R.unshift("    - stacktraces of ".concat(f.length," other leaks continue with ").concat(d))}}catch(e){s=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(s)throw o}}R.unshift(t)},S=C.value;y++;for(var A=E(S),R=[],T=0;T<A.length;T++)L(T);g+="\n\n\n==================== Leaking disposable ".concat(y,"/").concat(u.length,": ").concat(S.value.constructor.name," ====================\n").concat(R.join("\n"),"\n============================================================\n\n")}}catch(e){m=!0,x=e}finally{try{p||null==b.return||b.return()}finally{if(m)throw x}}return u.length>t&&(g+="\n\n\n... and ".concat(u.length-t," more leaking disposables\n\n")),{leaks:u,details:g}}function E(e){var t=e.source.split("\n").map(function(e){return e.trim().replace("at ","")}).filter(function(e){return""!==e});return function(e,t){for(;e.length>0&&t.some(function(t){return"string"==typeof t?t===e[0]:e[0].match(t)});)e.shift()}(t,["Error",/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]),t.reverse()}}}]),e}().idx=0;var H=function(){function e(){(0,p._)(this,e),this._toDispose=new Set,this._isDisposed=!1}return(0,m._)(e,[{key:"dispose",value:function(){this._isDisposed||(O(this),this._isDisposed=!0,this.clear())}},{key:"isDisposed",get:function(){return this._isDisposed}},{key:"clear",value:function(){if(0!==this._toDispose.size)try{N(this._toDispose)}finally{this._toDispose.clear()}}},{key:"add",value:function(t){if(!t)return t;if(t===this)throw Error("Cannot register a disposable on itself!");return U(t,this),this._isDisposed?e.DISABLE_DISPOSED_WARNING||console.warn(Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(t),t}},{key:"delete",value:function(e){if(e){if(e===this)throw Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}},{key:"deleteAndLeak",value:function(e){e&&this._toDispose.has(e)&&(this._toDispose.delete(e),U(e,null))}}]),e}();H.DISABLE_DISPOSED_WARNING=!1;var V=function(){function e(){(0,p._)(this,e),this._store=new H,U(this._store,this)}return(0,m._)(e,[{key:"dispose",value:function(){O(this),this._store.dispose()}},{key:"_register",value:function(e){if(e===this)throw Error("Cannot register a disposable on itself!");return this._store.add(e)}}]),e}();V.None=Object.freeze({dispose:function(){}});var j=function(){function e(){(0,p._)(this,e),this._isDisposed=!1}return(0,m._)(e,[{key:"value",get:function(){return this._isDisposed?void 0:this._value},set:function(e){var t;this._isDisposed||e===this._value||(null==(t=this._value)||t.dispose(),e&&U(e,this),this._value=e)}},{key:"clear",value:function(){this.value=void 0}},{key:"dispose",value:function(){var e;this._isDisposed=!0,O(this),null==(e=this._value)||e.dispose(),this._value=void 0}},{key:"clearAndLeak",value:function(){var e=this._value;return this._value=void 0,e&&U(e,null),e}}]),e}(),Y=(void 0===v.default?"undefined":(0,S._)(v.default))<"u"&&"title"in v.default,X=Y?"node":navigator.userAgent,Z=Y?"node":navigator.platform,Q=X.includes("Firefox"),K=X.includes("Edge"),J=/^((?!chrome|android).)*safari/i.test(X);["Macintosh","MacIntel","MacPPC","Mac68K"].includes(Z),["Windows","Win16","Win32","WinCE"].includes(Z),Z.indexOf("Linux"),/\bCrOS\b/.test(X);var $,ee,et,ei,en,er,es,ea,eo,el,ec,eu=0,eh=0,ed=0,ef=0,ev={css:"#00000000",rgba:0};function e_(e){var t=e.toString(16);return t.length<2?"0"+t:t}function eg(e,t){return e<t?(t+.05)/(e+.05):(e+.05)/(t+.05)}function ey(e){if(!e)throw Error("value must not be falsy");return e}function ep(e){return 57508<=e&&e<=57558}function em(e){return ep(e)||9472<=e&&e<=9631}function ex(){return{width:0,height:0}}(ew=ec||(ec={})).toCss=function(e,t,i,n){return void 0!==n?"#".concat(e_(e)).concat(e_(t)).concat(e_(i)).concat(e_(n)):"#".concat(e_(e)).concat(e_(t)).concat(e_(i))},ew.toRgba=function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255;return(e<<24|t<<16|i<<8|n)>>>0},ew.toColor=function(e,t,i,n){return{css:ew.toCss(e,t,i,n),rgba:ew.toRgba(e,t,i,n)}},eC=eR||(eR={}),eb=function(e,t){var i;return ef=Math.round(255*t),eu=(i=(0,k._)(eB.toChannels(e.rgba),3))[0],eh=i[1],ed=i[2],{css:ec.toCss(eu,eh,ed,ef),rgba:ec.toRgba(eu,eh,ed,ef)}},eC.blend=function(e,t){if(1==(ef=(255&t.rgba)/255))return{css:t.css,rgba:t.rgba};var i=t.rgba>>24&255,n=t.rgba>>16&255,r=t.rgba>>8&255,s=e.rgba>>24&255,a=e.rgba>>16&255,o=e.rgba>>8&255;return eu=s+Math.round((i-s)*ef),eh=a+Math.round((n-a)*ef),ed=o+Math.round((r-o)*ef),{css:ec.toCss(eu,eh,ed),rgba:ec.toRgba(eu,eh,ed)}},eC.isOpaque=function(e){return(255&e.rgba)==255},eC.ensureContrastRatio=function(e,t,i){var n=eB.ensureContrastRatio(e.rgba,t.rgba,i);if(n)return ec.toColor(n>>24&255,n>>16&255,n>>8&255)},eC.opaque=function(e){var t,i=(255|e.rgba)>>>0;return eu=(t=(0,k._)(eB.toChannels(i),3))[0],eh=t[1],ed=t[2],{css:ec.toCss(eu,eh,ed),rgba:i}},eC.opacity=eb,eC.multiplyOpacity=function(e,t){return ef=255&e.rgba,eb(e,ef*t/255)},eC.toColorRGB=function(e){return[e.rgba>>24&255,e.rgba>>16&255,e.rgba>>8&255]},function(e){var t,i;try{var n=document.createElement("canvas");n.width=1,n.height=1;var r=n.getContext("2d",{willReadFrequently:!0});r&&((t=r).globalCompositeOperation="copy",i=t.createLinearGradient(0,0,1,1))}catch(e){}e.toColor=function(e){if(e.match(/#[\da-f]{3,8}/i))switch(e.length){case 4:return eu=parseInt(e.slice(1,2).repeat(2),16),eh=parseInt(e.slice(2,3).repeat(2),16),ed=parseInt(e.slice(3,4).repeat(2),16),ec.toColor(eu,eh,ed);case 5:return eu=parseInt(e.slice(1,2).repeat(2),16),eh=parseInt(e.slice(2,3).repeat(2),16),ed=parseInt(e.slice(3,4).repeat(2),16),ef=parseInt(e.slice(4,5).repeat(2),16),ec.toColor(eu,eh,ed,ef);case 7:return{css:e,rgba:(parseInt(e.slice(1),16)<<8|255)>>>0};case 9:return{css:e,rgba:parseInt(e.slice(1),16)>>>0}}var n,r=e.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(r)return eu=parseInt(r[1]),eh=parseInt(r[2]),ed=parseInt(r[3]),ef=Math.round((void 0===r[5]?1:parseFloat(r[5]))*255),ec.toColor(eu,eh,ed,ef);if(!t||!i||(t.fillStyle=i,t.fillStyle=e,"string"!=typeof t.fillStyle)||(t.fillRect(0,0,1,1),eu=(n=(0,k._)(t.getImageData(0,0,1,1).data,4))[0],eh=n[1],ed=n[2],255!==(ef=n[3])))throw Error("css.toColor: Unsupported css format");return{rgba:ec.toRgba(eu,eh,ed,ef),css:e}}}(eT||(eT={})),eL=eE||(eE={}),ek=function(e,t,i){var n=e/255,r=t/255,s=i/255;return .2126*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.7152*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.0722*(s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4))},eL.relativeLuminance=function(e){return ek(e>>16&255,e>>8&255,255&e)},eL.relativeLuminance2=ek,eM=eB||(eB={}),eS=function(e,t,i){for(var n=e>>24&255,r=e>>16&255,s=e>>8&255,a=t>>24&255,o=t>>16&255,l=t>>8&255,c=eg(eE.relativeLuminance2(a,o,l),eE.relativeLuminance2(n,r,s));c<i&&(a>0||o>0||l>0);)a-=Math.max(0,Math.ceil(.1*a)),o-=Math.max(0,Math.ceil(.1*o)),l-=Math.max(0,Math.ceil(.1*l)),c=eg(eE.relativeLuminance2(a,o,l),eE.relativeLuminance2(n,r,s));return(a<<24|o<<16|l<<8|255)>>>0},eA=function(e,t,i){for(var n=e>>24&255,r=e>>16&255,s=e>>8&255,a=t>>24&255,o=t>>16&255,l=t>>8&255,c=eg(eE.relativeLuminance2(a,o,l),eE.relativeLuminance2(n,r,s));c<i&&(a<255||o<255||l<255);)a=Math.min(255,a+Math.ceil((255-a)*.1)),o=Math.min(255,o+Math.ceil((255-o)*.1)),l=Math.min(255,l+Math.ceil((255-l)*.1)),c=eg(eE.relativeLuminance2(a,o,l),eE.relativeLuminance2(n,r,s));return(a<<24|o<<16|l<<8|255)>>>0},eM.blend=function(e,t){if(1==(ef=(255&t)/255))return t;var i=e>>24&255,n=e>>16&255,r=e>>8&255;return eu=i+Math.round(((t>>24&255)-i)*ef),eh=n+Math.round(((t>>16&255)-n)*ef),ed=r+Math.round(((t>>8&255)-r)*ef),ec.toRgba(eu,eh,ed)},eM.ensureContrastRatio=function(e,t,i){var n=eE.relativeLuminance(e>>8),r=eE.relativeLuminance(t>>8);if(eg(n,r)<i){if(r<n){var s=eS(e,t,i),a=eg(n,eE.relativeLuminance(s>>8));if(a<i){var o=eA(e,t,i);return a>eg(n,eE.relativeLuminance(o>>8))?s:o}return s}var l=eA(e,t,i),c=eg(n,eE.relativeLuminance(l>>8));if(c<i){var u=eS(e,t,i);return c>eg(n,eE.relativeLuminance(u>>8))?l:u}return l}},eM.reduceLuminance=eS,eM.increaseLuminance=eA,eM.toChannels=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]};var ew,eC,eb,eL,ek,eM,eS,eA,eR,eT,eE,eB,eD,eP=0,eF=0,eI=!1,eW=!1,ez=!1,eO=0,eU=function(){function e(t,i,n,r,s,a){(0,p._)(this,e),this._terminal=t,this._optionService=i,this._selectionRenderModel=n,this._decorationService=r,this._coreBrowserService=s,this._themeService=a,this.result={fg:0,bg:0,ext:0}}return(0,m._)(e,[{key:"resolve",value:function(e,t,i,n){if(this.result.bg=e.bg,this.result.fg=e.fg,this.result.ext=0x10000000&e.bg?e.extended.ext:0,eF=0,eP=0,eW=!1,eI=!1,ez=!1,eD=this._themeService.colors,eO=0,0!==e.getCode()&&4===e.extended.underlineStyle&&(eO=t*n%(2*Math.round(Math.max(1,Math.floor(this._optionService.rawOptions.fontSize*this._coreBrowserService.dpr/15))))),this._decorationService.forEachDecorationAtCell(t,i,"bottom",function(e){e.backgroundColorRGB&&(eF=e.backgroundColorRGB.rgba>>8&0xffffff,eW=!0),e.foregroundColorRGB&&(eP=e.foregroundColorRGB.rgba>>8&0xffffff,eI=!0)}),ez=this._selectionRenderModel.isCellSelected(this._terminal,t,i)){if(0x4000000&this.result.fg||(0x3000000&this.result.bg)!=0){if(0x4000000&this.result.fg)switch(0x3000000&this.result.fg){case 0x1000000:case 0x2000000:eF=this._themeService.colors.ansi[255&this.result.fg].rgba;break;case 0x3000000:eF=(0xffffff&this.result.fg)<<8|255;break;default:eF=this._themeService.colors.foreground.rgba}else switch(0x3000000&this.result.bg){case 0x1000000:case 0x2000000:eF=this._themeService.colors.ansi[255&this.result.bg].rgba;break;case 0x3000000:eF=(0xffffff&this.result.bg)<<8|255}eF=eB.blend(eF,0xffffff00&(this._coreBrowserService.isFocused?eD.selectionBackgroundOpaque:eD.selectionInactiveBackgroundOpaque).rgba|128)>>8&0xffffff}else eF=(this._coreBrowserService.isFocused?eD.selectionBackgroundOpaque:eD.selectionInactiveBackgroundOpaque).rgba>>8&0xffffff;if(eW=!0,eD.selectionForeground&&(eP=eD.selectionForeground.rgba>>8&0xffffff,eI=!0),em(e.getCode())){if(0x4000000&this.result.fg&&(0x3000000&this.result.bg)==0)eP=(this._coreBrowserService.isFocused?eD.selectionBackgroundOpaque:eD.selectionInactiveBackgroundOpaque).rgba>>8&0xffffff;else{if(0x4000000&this.result.fg)switch(0x3000000&this.result.bg){case 0x1000000:case 0x2000000:eP=this._themeService.colors.ansi[255&this.result.bg].rgba;break;case 0x3000000:eP=(0xffffff&this.result.bg)<<8|255}else switch(0x3000000&this.result.fg){case 0x1000000:case 0x2000000:eP=this._themeService.colors.ansi[255&this.result.fg].rgba;break;case 0x3000000:eP=(0xffffff&this.result.fg)<<8|255;break;default:eP=this._themeService.colors.foreground.rgba}eP=eB.blend(eP,0xffffff00&(this._coreBrowserService.isFocused?eD.selectionBackgroundOpaque:eD.selectionInactiveBackgroundOpaque).rgba|128)>>8&0xffffff}eI=!0}}this._decorationService.forEachDecorationAtCell(t,i,"top",function(e){e.backgroundColorRGB&&(eF=e.backgroundColorRGB.rgba>>8&0xffffff,eW=!0),e.foregroundColorRGB&&(eP=e.foregroundColorRGB.rgba>>8&0xffffff,eI=!0)}),eW&&(eF=ez?-0x1000000&e.bg&-0x8000001|eF|0x3000000:-0x1000000&e.bg|eF|0x3000000),eI&&(eP=-0x1000000&e.fg&-0x4000001|eP|0x3000000),0x4000000&this.result.fg&&(eW&&!eI&&(eP=(0x3000000&this.result.bg)==0?-0x8000000&this.result.fg|eD.background.rgba>>8&0xffffff|0x3000000:-0x8000000&this.result.fg|0x3ffffff&this.result.bg,eI=!0),!eW&&eI&&(eF=(0x3000000&this.result.fg)==0?-0x4000000&this.result.bg|eD.foreground.rgba>>8&0xffffff|0x3000000:-0x4000000&this.result.bg|0x3ffffff&this.result.fg,eW=!0)),eD=void 0,this.result.bg=eW?eF:this.result.bg,this.result.fg=eI?eP:this.result.fg,this.result.ext&=0x1fffffff,this.result.ext|=eO<<29&0xe0000000}}]),e}(),eN=Q||K?"bottom":"ideographic",eq={"â–€":[{x:0,y:0,w:8,h:4}],"â–":[{x:0,y:7,w:8,h:1}],"â–‚":[{x:0,y:6,w:8,h:2}],"â–ƒ":[{x:0,y:5,w:8,h:3}],"â–„":[{x:0,y:4,w:8,h:4}],"â–…":[{x:0,y:3,w:8,h:5}],"â–†":[{x:0,y:2,w:8,h:6}],"â–‡":[{x:0,y:1,w:8,h:7}],"â–ˆ":[{x:0,y:0,w:8,h:8}],"â–‰":[{x:0,y:0,w:7,h:8}],"â–Š":[{x:0,y:0,w:6,h:8}],"â–‹":[{x:0,y:0,w:5,h:8}],"â–Œ":[{x:0,y:0,w:4,h:8}],"â–":[{x:0,y:0,w:3,h:8}],"â–Ž":[{x:0,y:0,w:2,h:8}],"â–":[{x:0,y:0,w:1,h:8}],"â–":[{x:4,y:0,w:4,h:8}],"â–”":[{x:0,y:0,w:8,h:1}],"â–•":[{x:7,y:0,w:1,h:8}],"â––":[{x:0,y:4,w:4,h:4}],"â–—":[{x:4,y:4,w:4,h:4}],"â–˜":[{x:0,y:0,w:4,h:4}],"â–™":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"â–š":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"â–›":[{x:0,y:0,w:4,h:8},{x:4,y:0,w:4,h:4}],"â–œ":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"â–":[{x:4,y:0,w:4,h:4}],"â–ž":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"â–Ÿ":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"ðŸ­°":[{x:1,y:0,w:1,h:8}],"ðŸ­±":[{x:2,y:0,w:1,h:8}],"ðŸ­²":[{x:3,y:0,w:1,h:8}],"ðŸ­³":[{x:4,y:0,w:1,h:8}],"ðŸ­´":[{x:5,y:0,w:1,h:8}],"ðŸ­µ":[{x:6,y:0,w:1,h:8}],"ðŸ­¶":[{x:0,y:1,w:8,h:1}],"ðŸ­·":[{x:0,y:2,w:8,h:1}],"ðŸ­¸":[{x:0,y:3,w:8,h:1}],"ðŸ­¹":[{x:0,y:4,w:8,h:1}],"ðŸ­º":[{x:0,y:5,w:8,h:1}],"ðŸ­»":[{x:0,y:6,w:8,h:1}],"ðŸ­¼":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"ðŸ­½":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"ðŸ­¾":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"ðŸ­¿":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"ðŸ®€":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"ðŸ®":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"ðŸ®‚":[{x:0,y:0,w:8,h:2}],"ðŸ®ƒ":[{x:0,y:0,w:8,h:3}],"ðŸ®„":[{x:0,y:0,w:8,h:5}],"ðŸ®…":[{x:0,y:0,w:8,h:6}],"ðŸ®†":[{x:0,y:0,w:8,h:7}],"ðŸ®‡":[{x:6,y:0,w:2,h:8}],"ðŸ®ˆ":[{x:5,y:0,w:3,h:8}],"ðŸ®‰":[{x:3,y:0,w:5,h:8}],"ðŸ®Š":[{x:2,y:0,w:6,h:8}],"ðŸ®‹":[{x:1,y:0,w:7,h:8}],"ðŸ®•":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"ðŸ®–":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"ðŸ®—":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]},eG={"â–‘":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"â–’":[[1,0],[0,0],[0,1],[0,0]],"â–“":[[0,1],[1,1],[1,0],[1,1]]},eH={"â”€":{1:"M0,.5 L1,.5"},"â”":{3:"M0,.5 L1,.5"},"â”‚":{1:"M.5,0 L.5,1"},"â”ƒ":{3:"M.5,0 L.5,1"},"â”Œ":{1:"M0.5,1 L.5,.5 L1,.5"},"â”":{3:"M0.5,1 L.5,.5 L1,.5"},"â”":{1:"M0,.5 L.5,.5 L.5,1"},"â”“":{3:"M0,.5 L.5,.5 L.5,1"},"â””":{1:"M.5,0 L.5,.5 L1,.5"},"â”—":{3:"M.5,0 L.5,.5 L1,.5"},"â”˜":{1:"M.5,0 L.5,.5 L0,.5"},"â”›":{3:"M.5,0 L.5,.5 L0,.5"},"â”œ":{1:"M.5,0 L.5,1 M.5,.5 L1,.5"},"â”£":{3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"â”¤":{1:"M.5,0 L.5,1 M.5,.5 L0,.5"},"â”«":{3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"â”¬":{1:"M0,.5 L1,.5 M.5,.5 L.5,1"},"â”³":{3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"â”´":{1:"M0,.5 L1,.5 M.5,.5 L.5,0"},"â”»":{3:"M0,.5 L1,.5 M.5,.5 L.5,0"},"â”¼":{1:"M0,.5 L1,.5 M.5,0 L.5,1"},"â•‹":{3:"M0,.5 L1,.5 M.5,0 L.5,1"},"â•´":{1:"M.5,.5 L0,.5"},"â•¸":{3:"M.5,.5 L0,.5"},"â•µ":{1:"M.5,.5 L.5,0"},"â•¹":{3:"M.5,.5 L.5,0"},"â•¶":{1:"M.5,.5 L1,.5"},"â•º":{3:"M.5,.5 L1,.5"},"â•·":{1:"M.5,.5 L.5,1"},"â•»":{3:"M.5,.5 L.5,1"},"â•":{1:function(e,t){return"M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t)}},"â•‘":{1:function(e,t){return"M".concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1")}},"â•’":{1:function(e,t){return"M.5,1 L.5,".concat(.5-t," L1,").concat(.5-t," M.5,").concat(.5+t," L1,").concat(.5+t)}},"â•“":{1:function(e,t){return"M".concat(.5-e,",1 L").concat(.5-e,",.5 L1,.5 M").concat(.5+e,",.5 L").concat(.5+e,",1")}},"â•”":{1:function(e,t){return"M1,".concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1")}},"â••":{1:function(e,t){return"M0,".concat(.5-t," L.5,").concat(.5-t," L.5,1 M0,").concat(.5+t," L.5,").concat(.5+t)}},"â•–":{1:function(e,t){return"M".concat(.5+e,",1 L").concat(.5+e,",.5 L0,.5 M").concat(.5-e,",.5 L").concat(.5-e,",1")}},"â•—":{1:function(e,t){return"M0,".concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M0,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",1")}},"â•˜":{1:function(e,t){return"M.5,0 L.5,".concat(.5+t," L1,").concat(.5+t," M.5,").concat(.5-t," L1,").concat(.5-t)}},"â•™":{1:function(e,t){return"M1,.5 L".concat(.5-e,",.5 L").concat(.5-e,",0 M").concat(.5+e,",.5 L").concat(.5+e,",0")}},"â•š":{1:function(e,t){return"M1,".concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0 M1,").concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",0")}},"â•›":{1:function(e,t){return"M0,".concat(.5+t," L.5,").concat(.5+t," L.5,0 M0,").concat(.5-t," L.5,").concat(.5-t)}},"â•œ":{1:function(e,t){return"M0,.5 L".concat(.5+e,",.5 L").concat(.5+e,",0 M").concat(.5-e,",.5 L").concat(.5-e,",0")}},"â•":{1:function(e,t){return"M0,".concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0 M0,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",0")}},"â•ž":{1:function(e,t){return"M.5,0 L.5,1 M.5,".concat(.5-t," L1,").concat(.5-t," M.5,").concat(.5+t," L1,").concat(.5+t)}},"â•Ÿ":{1:function(e,t){return"M".concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1 M").concat(.5+e,",.5 L1,.5")}},"â• ":{1:function(e,t){return"M".concat(.5-e,",0 L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1 M1,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0")}},"â•¡":{1:function(e,t){return"M.5,0 L.5,1 M0,".concat(.5-t," L.5,").concat(.5-t," M0,").concat(.5+t," L.5,").concat(.5+t)}},"â•¢":{1:function(e,t){return"M0,.5 L".concat(.5-e,",.5 M").concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1")}},"â•£":{1:function(e,t){return"M".concat(.5+e,",0 L").concat(.5+e,",1 M0,").concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M0,").concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0")}},"â•¤":{1:function(e,t){return"M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t," M.5,").concat(.5+t," L.5,1")}},"â•¥":{1:function(e,t){return"M0,.5 L1,.5 M".concat(.5-e,",.5 L").concat(.5-e,",1 M").concat(.5+e,",.5 L").concat(.5+e,",1")}},"â•¦":{1:function(e,t){return"M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1")}},"â•§":{1:function(e,t){return"M.5,0 L.5,".concat(.5-t," M0,").concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t)}},"â•¨":{1:function(e,t){return"M0,.5 L1,.5 M".concat(.5-e,",.5 L").concat(.5-e,",0 M").concat(.5+e,",.5 L").concat(.5+e,",0")}},"â•©":{1:function(e,t){return"M0,".concat(.5+t," L1,").concat(.5+t," M0,").concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0 M1,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0")}},"â•ª":{1:function(e,t){return"M.5,0 L.5,1 M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t)}},"â•«":{1:function(e,t){return"M0,.5 L1,.5 M".concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1")}},"â•¬":{1:function(e,t){return"M0,".concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1 M0,").concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0 M1,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0")}},"â•±":{1:"M1,0 L0,1"},"â•²":{1:"M0,0 L1,1"},"â•³":{1:"M1,0 L0,1 M0,0 L1,1"},"â•¼":{1:"M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"â•½":{1:"M.5,.5 L.5,0",3:"M.5,.5 L.5,1"},"â•¾":{1:"M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"â•¿":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"â”":{1:"M.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"â”Ž":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"â”‘":{1:"M.5,.5 L.5,1",3:"M.5,.5 L0,.5"},"â”’":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"â”•":{1:"M.5,.5 L.5,0",3:"M.5,.5 L1,.5"},"â”–":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"â”™":{1:"M.5,.5 L.5,0",3:"M.5,.5 L0,.5"},"â”š":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,0"},"â”":{1:"M.5,0 L.5,1",3:"M.5,.5 L1,.5"},"â”ž":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"â”Ÿ":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"â” ":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1"},"â”¡":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"â”¢":{1:"M.5,.5 L.5,0",3:"M0.5,1 L.5,.5 L1,.5"},"â”¥":{1:"M.5,0 L.5,1",3:"M.5,.5 L0,.5"},"â”¦":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"â”§":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"â”¨":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1"},"â”©":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L0,.5"},"â”ª":{1:"M.5,.5 L.5,0",3:"M0,.5 L.5,.5 L.5,1"},"â”­":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"â”®":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"â”¯":{1:"M.5,.5 L.5,1",3:"M0,.5 L1,.5"},"â”°":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"â”±":{1:"M.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"â”²":{1:"M.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"â”µ":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"â”¶":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"â”·":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5"},"â”¸":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,0"},"â”¹":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"â”º":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,.5 L1,.5"},"â”½":{1:"M.5,0 L.5,1 M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"â”¾":{1:"M.5,0 L.5,1 M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"â”¿":{1:"M.5,0 L.5,1",3:"M0,.5 L1,.5"},"â•€":{1:"M0,.5 L1,.5 M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"â•":{1:"M.5,.5 L.5,0 M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"â•‚":{1:"M0,.5 L1,.5",3:"M.5,0 L.5,1"},"â•ƒ":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"â•„":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"â•…":{1:"M.5,0 L.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"â•†":{1:"M.5,0 L.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"â•‡":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0 M0,.5 L1,.5"},"â•ˆ":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"â•‰":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"â•Š":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"â•Œ":{1:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"â•":{3:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"â”„":{1:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"â”…":{3:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"â”ˆ":{1:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"â”‰":{3:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"â•Ž":{1:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"â•":{3:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"â”†":{1:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"â”‡":{3:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"â”Š":{1:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"â”‹":{3:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"â•­":{1:function(e,t){return"M.5,1 L.5,".concat(.5+t/.15*.5," C.5,").concat(.5+t/.15*.5,",.5,.5,1,.5")}},"â•®":{1:function(e,t){return"M.5,1 L.5,".concat(.5+t/.15*.5," C.5,").concat(.5+t/.15*.5,",.5,.5,0,.5")}},"â•¯":{1:function(e,t){return"M.5,0 L.5,".concat(.5-t/.15*.5," C.5,").concat(.5-t/.15*.5,",.5,.5,0,.5")}},"â•°":{1:function(e,t){return"M.5,0 L.5,".concat(.5-t/.15*.5," C.5,").concat(.5-t/.15*.5,",.5,.5,1,.5")}}},eV={"î‚ ":{d:"M.3,1 L.03,1 L.03,.88 C.03,.82,.06,.78,.11,.73 C.15,.7,.2,.68,.28,.65 L.43,.6 C.49,.58,.53,.56,.56,.53 C.59,.5,.6,.47,.6,.43 L.6,.27 L.4,.27 L.69,.1 L.98,.27 L.78,.27 L.78,.46 C.78,.52,.76,.56,.72,.61 C.68,.66,.63,.67,.56,.7 L.48,.72 C.42,.74,.38,.76,.35,.78 C.32,.8,.31,.84,.31,.88 L.31,1 M.3,.5 L.03,.59 L.03,.09 L.3,.09 L.3,.655",type:0},"î‚¡":{d:"M.7,.4 L.7,.47 L.2,.47 L.2,.03 L.355,.03 L.355,.4 L.705,.4 M.7,.5 L.86,.5 L.86,.95 L.69,.95 L.44,.66 L.46,.86 L.46,.95 L.3,.95 L.3,.49 L.46,.49 L.71,.78 L.69,.565 L.69,.5",type:0},"î‚¢":{d:"M.25,.94 C.16,.94,.11,.92,.11,.87 L.11,.53 C.11,.48,.15,.455,.23,.45 L.23,.3 C.23,.25,.26,.22,.31,.19 C.36,.16,.43,.15,.51,.15 C.59,.15,.66,.16,.71,.19 C.77,.22,.79,.26,.79,.3 L.79,.45 C.87,.45,.91,.48,.91,.53 L.91,.87 C.91,.92,.86,.94,.77,.94 L.24,.94 M.53,.2 C.49,.2,.45,.21,.42,.23 C.39,.25,.38,.27,.38,.3 L.38,.45 L.68,.45 L.68,.3 C.68,.27,.67,.25,.64,.23 C.61,.21,.58,.2,.53,.2 M.58,.82 L.58,.66 C.63,.65,.65,.63,.65,.6 C.65,.58,.64,.57,.61,.56 C.58,.55,.56,.54,.52,.54 C.48,.54,.46,.55,.43,.56 C.4,.57,.39,.59,.39,.6 C.39,.63,.41,.64,.46,.66 L.46,.82 L.57,.82",type:0},"î‚°":{d:"M0,0 L1,.5 L0,1",type:0,rightPadding:2},"î‚±":{d:"M-1,-.5 L1,.5 L-1,1.5",type:1,leftPadding:1,rightPadding:1},"î‚²":{d:"M1,0 L0,.5 L1,1",type:0,leftPadding:2},"î‚³":{d:"M2,-.5 L0,.5 L2,1.5",type:1,leftPadding:1,rightPadding:1},"î‚´":{d:"M0,0 L0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:0,rightPadding:1},"î‚µ":{d:"M.2,1 C.422,1,.8,.826,.78,.5 C.8,.174,0.422,0,.2,0",type:1,rightPadding:1},"î‚¶":{d:"M1,0 L1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:0,leftPadding:1},"î‚·":{d:"M.8,1 C0.578,1,0.2,.826,.22,.5 C0.2,0.174,0.578,0,0.8,0",type:1,leftPadding:1},"î‚¸":{d:"M-.5,-.5 L1.5,1.5 L-.5,1.5",type:0},"î‚¹":{d:"M-.5,-.5 L1.5,1.5",type:1,leftPadding:1,rightPadding:1},"î‚º":{d:"M1.5,-.5 L-.5,1.5 L1.5,1.5",type:0},"î‚¼":{d:"M1.5,-.5 L-.5,1.5 L-.5,-.5",type:0},"î‚½":{d:"M1.5,-.5 L-.5,1.5",type:1,leftPadding:1,rightPadding:1},"î‚¾":{d:"M-.5,-.5 L1.5,1.5 L1.5,-.5",type:0}};eV["î‚»"]=eV["î‚½"],eV["î‚¿"]=eV["î‚¹"];var ej=new Map;function eY(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.max(Math.min(e,t),i)}var eX={C:function(e,t){return e.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5])},L:function(e,t){return e.lineTo(t[0],t[1])},M:function(e,t){return e.moveTo(t[0],t[1])}};function eZ(e,t,i,n,r,s,a){var o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=e.map(function(e){return parseFloat(e)||parseInt(e)});if(c.length<2)throw Error("Too few arguments for instruction");for(var u=0;u<c.length;u+=2)c[u]*=t-o*a-l*a,s&&0!==c[u]&&(c[u]=eY(Math.round(c[u]+.5)-.5,t,0)),c[u]+=n+o*a;for(var h=1;h<c.length;h+=2)c[h]*=i,s&&0!==c[h]&&(c[h]=eY(Math.round(c[h]+.5)-.5,i,0)),c[h]+=r;return c}var eQ=function(){function e(){(0,p._)(this,e),this._data={}}return(0,m._)(e,[{key:"set",value:function(e,t,i){this._data[e]||(this._data[e]={}),this._data[e][t]=i}},{key:"get",value:function(e,t){return this._data[e]?this._data[e][t]:void 0}},{key:"clear",value:function(){this._data={}}}]),e}(),eK=function(){function e(){(0,p._)(this,e),this._data=new eQ}return(0,m._)(e,[{key:"set",value:function(e,t,i,n,r){this._data.get(e,t)||this._data.set(e,t,new eQ),this._data.get(e,t).set(i,n,r)}},{key:"get",value:function(e,t,i,n){var r;return null==(r=this._data.get(e,t))?void 0:r.get(i,n)}},{key:"clear",value:function(){this._data.clear()}}]),e}(),eJ=function(){function e(){(0,p._)(this,e),this._tasks=[],this._i=0}return(0,m._)(e,[{key:"enqueue",value:function(e){this._tasks.push(e),this._start()}},{key:"flush",value:function(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}},{key:"clear",value:function(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}},{key:"_start",value:function(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}},{key:"_process",value:function(e){this._idleCallback=void 0;for(var t=0,i=0,n=e.timeRemaining(),r=0;this._i<this._tasks.length;){if(t=performance.now(),this._tasks[this._i]()||this._i++,1.5*(i=Math.max(t=Math.max(1,performance.now()-t),i))>(r=e.timeRemaining())){n-t<-20&&console.warn("task queue exceeded allotted deadline by ".concat(Math.abs(Math.round(n-t)),"ms")),this._start();return}n=r}this.clear()}}]),e}(),e$=function(e){function t(){return(0,p._)(this,t),(0,y._)(this,t,arguments)}return(0,b._)(t,e),(0,m._)(t,[{key:"_requestCallback",value:function(e){var t=this;return setTimeout(function(){return e(t._createDeadline(16))})}},{key:"_cancelCallback",value:function(e){clearTimeout(e)}},{key:"_createDeadline",value:function(e){var t=performance.now()+e;return{timeRemaining:function(){return Math.max(0,t-performance.now())}}}}]),t}(eJ),e0=function(e){function t(){return(0,p._)(this,t),(0,y._)(this,t,arguments)}return(0,b._)(t,e),(0,m._)(t,[{key:"_requestCallback",value:function(e){return requestIdleCallback(e)}},{key:"_cancelCallback",value:function(e){cancelIdleCallback(e)}}]),t}(eJ),e5=!Y&&"requestIdleCallback"in window?e0:e$,e1=function(){function e(){(0,p._)(this,e),this.fg=0,this.bg=0,this.extended=new e2}return(0,m._)(e,[{key:"clone",value:function(){var t=new e;return t.fg=this.fg,t.bg=this.bg,t.extended=this.extended.clone(),t}},{key:"isInverse",value:function(){return 0x4000000&this.fg}},{key:"isBold",value:function(){return 0x8000000&this.fg}},{key:"isUnderline",value:function(){return this.hasExtendedAttrs()&&0!==this.extended.underlineStyle?1:0x10000000&this.fg}},{key:"isBlink",value:function(){return 0x20000000&this.fg}},{key:"isInvisible",value:function(){return 0x40000000&this.fg}},{key:"isItalic",value:function(){return 0x4000000&this.bg}},{key:"isDim",value:function(){return 0x8000000&this.bg}},{key:"isStrikethrough",value:function(){return 0x80000000&this.fg}},{key:"isProtected",value:function(){return 0x20000000&this.bg}},{key:"isOverline",value:function(){return 0x40000000&this.bg}},{key:"getFgColorMode",value:function(){return 0x3000000&this.fg}},{key:"getBgColorMode",value:function(){return 0x3000000&this.bg}},{key:"isFgRGB",value:function(){return(0x3000000&this.fg)==0x3000000}},{key:"isBgRGB",value:function(){return(0x3000000&this.bg)==0x3000000}},{key:"isFgPalette",value:function(){return(0x3000000&this.fg)==0x1000000||(0x3000000&this.fg)==0x2000000}},{key:"isBgPalette",value:function(){return(0x3000000&this.bg)==0x1000000||(0x3000000&this.bg)==0x2000000}},{key:"isFgDefault",value:function(){return(0x3000000&this.fg)==0}},{key:"isBgDefault",value:function(){return(0x3000000&this.bg)==0}},{key:"isAttributeDefault",value:function(){return 0===this.fg&&0===this.bg}},{key:"getFgColor",value:function(){switch(0x3000000&this.fg){case 0x1000000:case 0x2000000:return 255&this.fg;case 0x3000000:return 0xffffff&this.fg;default:return -1}}},{key:"getBgColor",value:function(){switch(0x3000000&this.bg){case 0x1000000:case 0x2000000:return 255&this.bg;case 0x3000000:return 0xffffff&this.bg;default:return -1}}},{key:"hasExtendedAttrs",value:function(){return 0x10000000&this.bg}},{key:"updateExtended",value:function(){this.extended.isEmpty()?this.bg&=-0x10000001:this.bg|=0x10000000}},{key:"getUnderlineColor",value:function(){if(0x10000000&this.bg&&~this.extended.underlineColor)switch(0x3000000&this.extended.underlineColor){case 0x1000000:case 0x2000000:return 255&this.extended.underlineColor;case 0x3000000:return 0xffffff&this.extended.underlineColor}return this.getFgColor()}},{key:"getUnderlineColorMode",value:function(){return 0x10000000&this.bg&&~this.extended.underlineColor?0x3000000&this.extended.underlineColor:this.getFgColorMode()}},{key:"isUnderlineColorRGB",value:function(){return 0x10000000&this.bg&&~this.extended.underlineColor?(0x3000000&this.extended.underlineColor)==0x3000000:this.isFgRGB()}},{key:"isUnderlineColorPalette",value:function(){return 0x10000000&this.bg&&~this.extended.underlineColor?(0x3000000&this.extended.underlineColor)==0x1000000||(0x3000000&this.extended.underlineColor)==0x2000000:this.isFgPalette()}},{key:"isUnderlineColorDefault",value:function(){return 0x10000000&this.bg&&~this.extended.underlineColor?(0x3000000&this.extended.underlineColor)==0:this.isFgDefault()}},{key:"getUnderlineStyle",value:function(){return 0x10000000&this.fg?0x10000000&this.bg?this.extended.underlineStyle:1:0}},{key:"getUnderlineVariantOffset",value:function(){return this.extended.underlineVariantOffset}}],[{key:"toColorRGB",value:function(e){return[e>>>16&255,e>>>8&255,255&e]}},{key:"fromColorRGB",value:function(e){return(255&e[0])<<16|(255&e[1])<<8|255&e[2]}}]),e}(),e2=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,p._)(this,e),this._ext=0,this._urlId=0,this._ext=t,this._urlId=i}return(0,m._)(e,[{key:"ext",get:function(){return this._urlId?-0x1c000001&this._ext|this.underlineStyle<<26:this._ext},set:function(e){this._ext=e}},{key:"underlineStyle",get:function(){return this._urlId?5:(0x1c000000&this._ext)>>26},set:function(e){this._ext&=-0x1c000001,this._ext|=e<<26&0x1c000000}},{key:"underlineColor",get:function(){return 0x3ffffff&this._ext},set:function(e){this._ext&=-0x4000000,this._ext|=0x3ffffff&e}},{key:"urlId",get:function(){return this._urlId},set:function(e){this._urlId=e}},{key:"underlineVariantOffset",get:function(){var e=(0xe0000000&this._ext)>>29;return e<0?0xfffffff8^e:e},set:function(e){this._ext&=0x1fffffff,this._ext|=e<<29&0xe0000000}},{key:"clone",value:function(){return new e(this._ext,this._urlId)}},{key:"isEmpty",value:function(){return 0===this.underlineStyle&&0===this._urlId}}]),e}(),e3=function e(t){(0,p._)(this,e),this.element=t,this.next=e.Undefined,this.prev=e.Undefined};e3.Undefined=new e3(void 0);var e4=globalThis.performance&&"function"==typeof globalThis.performance.now,e8=function(){function e(t){(0,p._)(this,e),this._now=e4&&!1===t?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}return(0,m._)(e,[{key:"stop",value:function(){this._stopTime=this._now()}},{key:"reset",value:function(){this._startTime=this._now(),this._stopTime=-1}},{key:"elapsed",value:function(){return -1!==this._stopTime?this._stopTime-this._startTime:this._now()-this._startTime}}],[{key:"create",value:function(t){return new e(t)}}]),e}();te=e9||(e9={}),tt=function(e){},ti=function(e){return function(t){var i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2?arguments[2]:void 0,s=!1;return i=e(function(e){if(!s)return i?i.dispose():s=!0,t.call(n,e)},null,r),s&&i.dispose(),i}},tn=function(e,t,i){return ts(function(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2?arguments[2]:void 0;return e(function(e){return i.call(n,t(e))},null,r)},i)},tr=function(e,t,i){return ts(function(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2?arguments[2]:void 0;return e(function(e){return t(e)&&i.call(n,e)},null,r)},i)},ts=function(e,t){var i,n={onWillAddFirstListener:function(){i=e(r.fire,r)},onDidRemoveLastListener:function(){null==i||i.dispose()}};t||tt(n);var r=new ty(n);return null==t||t.add(r),r.event},ta=function(e,t){var i,n,r,s,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=arguments.length>5?arguments[5]:void 0,u=arguments.length>6?arguments[6]:void 0,h=0,d={leakWarningThreshold:c,onWillAddFirstListener:function(){i=e(function(e){h++,n=t(n,e),o&&!r&&(f.fire(n),n=void 0),s=function(){var e=n;n=void 0,r=void 0,(!o||h>1)&&f.fire(e),h=0},"number"==typeof a?(clearTimeout(r),r=setTimeout(s,a)):void 0===r&&(r=0,queueMicrotask(s))})},onWillRemoveListener:function(){l&&h>0&&(null==s||s())},onDidRemoveLastListener:function(){s=void 0,i.dispose()}};u||tt(d);var f=new ty(d);return null==u||u.add(f),f.event},te.None=function(){return V.None},te.defer=function(e,t){return ta(e,function(){},0,void 0,!0,void 0,t)},te.once=ti,te.map=tn,te.forEach=function(e,t,i){return ts(function(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2?arguments[2]:void 0;return e(function(e){t(e),i.call(n,e)},null,r)},i)},te.filter=tr,te.signal=function(e){return e},te.any=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;return function(e,t){return(0,L._)(t,Array)?t.push(e):t&&t.add(e),e}(q.apply(void 0,(0,M._)(t.map(function(t){return t(function(t){return e.call(i,t)})}))),n)}},te.reduce=function(e,t,i,n){var r=i;return tn(e,function(e){return r=t(r,e)},n)},te.debounce=ta,te.accumulate=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;return te.debounce(e,function(e,t){return e?(e.push(t),e):[t]},t,void 0,!0,void 0,i)},te.latch=function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){return e===t},n=arguments.length>2?arguments[2]:void 0,r=!0;return tr(e,function(e){var n=r||!i(e,t);return r=!1,t=e,n},n)},te.split=function(e,t,i){return[te.filter(e,t,i),te.filter(e,function(e){return!t(e)},i)]},te.buffer=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3?arguments[3]:void 0,r=i.slice(),s=e(function(e){r?r.push(e):o.fire(e)});n&&n.add(s);var a=function(){null==r||r.forEach(function(e){return o.fire(e)}),r=null},o=new ty({onWillAddFirstListener:function(){s||(s=e(function(e){return o.fire(e)}),n&&n.add(s))},onDidAddFirstListener:function(){r&&(t?setTimeout(a):a())},onDidRemoveLastListener:function(){s&&s.dispose(),s=null}});return n&&n.add(o),o.event},te.chain=function(e,t){return function(i,n,r){var s=t(new tl);return e(function(e){var t=s.evaluate(e);t!==to&&i.call(n,t)},void 0,r)}},to=Symbol("HaltChainable"),tl=function(){function e(){(0,p._)(this,e),this.steps=[]}return(0,m._)(e,[{key:"map",value:function(e){return this.steps.push(e),this}},{key:"forEach",value:function(e){return this.steps.push(function(t){return e(t),t}),this}},{key:"filter",value:function(e){return this.steps.push(function(t){return e(t)?t:to}),this}},{key:"reduce",value:function(e,t){var i=t;return this.steps.push(function(t){return i=e(i,t)}),this}},{key:"latch",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e,t){return e===t},i=!0;return this.steps.push(function(n){var r=i||!t(n,e);return i=!1,e=n,r?n:to}),this}},{key:"evaluate",value:function(e){var t=!0,i=!1,n=void 0;try{for(var r,s=this.steps[Symbol.iterator]();!(t=(r=s.next()).done)&&(e=(0,r.value)(e))!==to;t=!0);}catch(e){i=!0,n=e}finally{try{t||null==s.return||s.return()}finally{if(i)throw n}}return e}}]),e}(),te.fromNodeEventEmitter=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e},n=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.fire(i.apply(void 0,(0,M._)(t)))},r=new ty({onWillAddFirstListener:function(){return e.on(t,n)},onDidRemoveLastListener:function(){return e.removeListener(t,n)}});return r.event},te.fromDOMEventEmitter=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e},n=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.fire(i.apply(void 0,(0,M._)(t)))},r=new ty({onWillAddFirstListener:function(){return e.addEventListener(t,n)},onDidRemoveLastListener:function(){return e.removeEventListener(t,n)}});return r.event},te.toPromise=function(e){return new Promise(function(t){return ti(e)(t)})},te.fromPromise=function(e){var t=new ty;return e.then(function(e){t.fire(e)},function(){t.fire(void 0)}).finally(function(){t.dispose()}),t.event},te.forward=function(e,t){return e(function(e){return t.fire(e)})},te.runAndSubscribe=function(e,t,i){return t(i),e(function(e){return t(e)})},tc=function(){function e(t,i){var n=this;(0,p._)(this,e),this._observable=t,this._counter=0,this._hasChanged=!1;var r={onWillAddFirstListener:function(){t.addObserver(n)},onDidRemoveLastListener:function(){t.removeObserver(n)}};i||tt(r),this.emitter=new ty(r),i&&i.add(this.emitter)}return(0,m._)(e,[{key:"beginUpdate",value:function(e){this._counter++}},{key:"handlePossibleChange",value:function(e){}},{key:"handleChange",value:function(e,t){this._hasChanged=!0}},{key:"endUpdate",value:function(e){this._counter--,0===this._counter&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}]),e}(),te.fromObservable=function(e,t){return new tc(e,t).emitter.event},te.fromObservableLight=function(e){return function(t,i,n){var r=0,s=!1,a={beginUpdate:function(){r++},endUpdate:function(){0==--r&&(e.reportChanges(),s&&(s=!1,t.call(i)))},handlePossibleChange:function(){},handleChange:function(){s=!0}};e.addObserver(a),e.reportChanges();var o={dispose:function(){e.removeObserver(a)}};return(0,L._)(n,H)?n.add(o):Array.isArray(n)&&n.push(o),o}};var e6=function(){function e(t){(0,p._)(this,e),this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name="".concat(t,"_").concat(e._idPool++),e.all.add(this)}return(0,m._)(e,[{key:"start",value:function(e){this._stopWatch=new e8,this.listenerCount=e}},{key:"stop",value:function(){if(this._stopWatch){var e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}}]),e}();e6.all=new Set,e6._idPool=0;var e7=function(){function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e._idPool++).toString(16).padStart(3,"0");(0,p._)(this,e),this._errorHandler=t,this.threshold=i,this.name=n,this._warnCountdown=0}return(0,m._)(e,[{key:"dispose",value:function(){var e;null==(e=this._stacks)||e.clear()}},{key:"check",value:function(e,t){var i=this,n=this.threshold;if(!(n<=0)&&!(t<n)){this._stacks||(this._stacks=new Map);var r=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,r+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=.5*n;var s=(0,k._)(this.getMostFrequentStack(),2),a=s[0],o=s[1],l="[".concat(this.name,"] potential listener LEAK detected, having ").concat(t," listeners already. MOST frequent listener (").concat(o,"):");console.warn(l),console.warn(a);var c=new tf(l,a);this._errorHandler(c)}return function(){var t=i._stacks.get(e.value)||0;i._stacks.set(e.value,t-1)}}}},{key:"getMostFrequentStack",value:function(){if(this._stacks){var e,t=0,i=!0,n=!1,r=void 0;try{for(var s,a=this._stacks[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var o=(0,k._)(s.value,2),l=o[0],c=o[1];(!e||t<c)&&(e=[l,c],t=c)}}catch(e){n=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(n)throw r}}return e}}}]),e}();e7._idPool=1;var e9,te,tt,ti,tn,tr,ts,ta,to,tl,tc,tu,th,td=function(){function e(t){(0,p._)(this,e),this.value=t}return(0,m._)(e,[{key:"print",value:function(){console.warn(this.value.split("\n").slice(2).join("\n"))}}],[{key:"create",value:function(){var t;return new e(null!=(t=Error().stack)?t:"")}}]),e}(),tf=function(e){function t(e,i){var n;return(0,p._)(this,t),(n=(0,y._)(this,t,[e])).name="ListenerLeakError",n.stack=i,n}return(0,b._)(t,e),t}((0,A._)(Error)),tv=function(e){function t(e,i){var n;return(0,p._)(this,t),(n=(0,y._)(this,t,[e])).name="ListenerRefusalError",n.stack=i,n}return(0,b._)(t,e),t}((0,A._)(Error)),t_=0,tg=function e(t){(0,p._)(this,e),this.value=t,this.id=t_++},ty=function(){function e(t){var i,n,r,s,a,o;(0,p._)(this,e),this._size=0,this._options=t,this._leakageMon=(null==(i=this._options)?void 0:i.leakWarningThreshold)?new e7(null!=(a=null==t?void 0:t.onListenerError)?a:B,null!=(o=null==(n=this._options)?void 0:n.leakWarningThreshold)?o:-1):void 0,this._perfMon=(null==(r=this._options)?void 0:r._profName)?new e6(this._options._profName):void 0,this._deliveryQueue=null==(s=this._options)?void 0:s.deliveryQueue}return(0,m._)(e,[{key:"dispose",value:function(){if(!this._disposed){var e,t,i,n;this._disposed=!0,(null==(e=this._deliveryQueue)?void 0:e.current)===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),null==(i=this._options)||null==(t=i.onDidRemoveLastListener)||t.call(i),null==(n=this._leakageMon)||n.dispose()}}},{key:"event",get:function(){var e=this;return null!=this._event||(this._event=function(t,i,n){if(e._leakageMon&&e._size>Math.pow(e._leakageMon.threshold,2)){var r,s,a,o,l,c,u="[".concat(e._leakageMon.name,"] REFUSES to accept new listeners because it exceeded its threshold by far (").concat(e._size," vs ").concat(e._leakageMon.threshold,")");console.warn(u);var h=null!=(c=e._leakageMon.getMostFrequentStack())?c:["UNKNOWN stack",-1],d=new tv("".concat(u,". HINT: Stack shows most frequent listener (").concat(h[1],"-times)"),h[0]);return((null==(l=e._options)?void 0:l.onListenerError)||B)(d),V.None}if(e._disposed)return V.None;i&&(t=t.bind(i));var f,v=new tg(t);e._leakageMon&&e._size>=Math.ceil(.2*e._leakageMon.threshold)&&(v.stack=td.create(),f=e._leakageMon.check(v.stack,e._size+1)),e._listeners?(0,L._)(e._listeners,tg)?(null!=e._deliveryQueue||(e._deliveryQueue=new tp),e._listeners=[e._listeners,v]):e._listeners.push(v):(null==(s=e._options)||null==(r=s.onWillAddFirstListener)||r.call(s,e),e._listeners=v,null==(o=e._options)||null==(a=o.onDidAddFirstListener)||a.call(o,e)),e._size++;var _=G(function(){null==tu||tu.unregister(_),null==f||f(),e._removeListener(v)});if((0,L._)(n,H)?n.add(_):Array.isArray(n)&&n.push(_),tu){var g,y=Error().stack.split("\n").slice(2,3).join("\n").trim(),p=/(file:|vscode-file:\/\/vscode-app)?(\/[^:]*:\d+:\d+)/.exec(y);tu.register(_,null!=(g=null==p?void 0:p[2])?g:y,_)}return _}),this._event}},{key:"_removeListener",value:function(e){if(null==(i=this._options)||null==(t=i.onWillRemoveListener)||t.call(i,this),this._listeners){if(1===this._size){this._listeners=void 0,null==(r=this._options)||null==(n=r.onDidRemoveLastListener)||n.call(r,this),this._size=0;return}var t,i,n,r,s=this._listeners,a=s.indexOf(e);if(-1===a)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),Error("Attempted to dispose unknown listener");this._size--,s[a]=void 0;var o=this._deliveryQueue.current===this;if(2*this._size<=s.length){for(var l=0,c=0;c<s.length;c++)s[c]?s[l++]=s[c]:o&&(this._deliveryQueue.end--,l<this._deliveryQueue.i&&this._deliveryQueue.i--);s.length=l}}}},{key:"_deliver",value:function(e,t){if(e){var i,n=(null==(i=this._options)?void 0:i.onListenerError)||B;try{e.value(t)}catch(e){n(e)}}}},{key:"_deliverQueue",value:function(e){for(var t=e.current._listeners;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}},{key:"fire",value:function(e){var t,i,n,r;if((null==(t=this._deliveryQueue)?void 0:t.current)&&(this._deliverQueue(this._deliveryQueue),null==(i=this._perfMon)||i.stop()),null==(n=this._perfMon)||n.start(this._size),this._listeners)if((0,L._)(this._listeners,tg))this._deliver(this._listeners,e);else{var s=this._deliveryQueue;s.enqueue(this,e,this._listeners.length),this._deliverQueue(s)}null==(r=this._perfMon)||r.stop()}},{key:"hasListeners",value:function(){return this._size>0}}]),e}(),tp=function(){function e(){(0,p._)(this,e),this.i=-1,this.end=0}return(0,m._)(e,[{key:"enqueue",value:function(e,t,i){this.i=0,this.end=i,this.current=e,this.value=t}},{key:"reset",value:function(){this.i=this.end,this.current=void 0,this.value=void 0}}]),e}(),tm={texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},offset:{x:0,y:0},size:{x:0,y:0},sizeClipSpace:{x:0,y:0}},tx=function(){function e(t,i,n){(0,p._)(this,e),this._document=t,this._config=i,this._unicodeService=n,this._didWarmUp=!1,this._cacheMap=new eK,this._cacheMapCombined=new eK,this._pages=[],this._activePages=[],this._workBoundingBox={top:0,left:0,bottom:0,right:0},this._workAttributeData=new e1,this._textureSize=512,this._onAddTextureAtlasCanvas=new ty,this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=new ty,this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._requestClearModel=!1,this._createNewPage(),this._tmpCanvas=tb(t,4*this._config.deviceCellWidth+4,this._config.deviceCellHeight+4),this._tmpCtx=ey(this._tmpCanvas.getContext("2d",{alpha:this._config.allowTransparency,willReadFrequently:!0}))}return(0,m._)(e,[{key:"pages",get:function(){return this._pages}},{key:"dispose",value:function(){this._tmpCanvas.remove();var e=!0,t=!1,i=void 0;try{for(var n,r=this.pages[Symbol.iterator]();!(e=(n=r.next()).done);e=!0)n.value.canvas.remove()}catch(e){t=!0,i=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw i}}this._onAddTextureAtlasCanvas.dispose()}},{key:"warmUp",value:function(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)}},{key:"_doWarmUp",value:function(){for(var e=function(e){i.enqueue(function(){if(!t._cacheMap.get(e,0,0,0)){var i=t._drawToCache(e,0,0,0,!1,void 0);t._cacheMap.set(e,0,0,0,i)}})},t=this,i=new e5,n=33;n<126;n++)e(n)}},{key:"beginFrame",value:function(){return this._requestClearModel}},{key:"clearTexture",value:function(){if(0!==this._pages[0].currentRow.x||0!==this._pages[0].currentRow.y){var e=!0,t=!1,i=void 0;try{for(var n,r=this._pages[Symbol.iterator]();!(e=(n=r.next()).done);e=!0)n.value.clear()}catch(e){t=!0,i=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw i}}this._cacheMap.clear(),this._cacheMapCombined.clear(),this._didWarmUp=!1}}},{key:"_createNewPage",value:function(){if(e.maxAtlasPages&&this._pages.length>=Math.max(4,e.maxAtlasPages)){for(var t=this._pages.filter(function(t){return 2*t.canvas.width<=(e.maxTextureSize||4096)}).sort(function(e,t){return t.canvas.width!==e.canvas.width?t.canvas.width-e.canvas.width:t.percentageUsed-e.percentageUsed}),i=-1,n=0,r=0;r<t.length;r++)if(t[r].canvas.width!==n)i=r,n=t[r].canvas.width;else if(r-i==3)break;var s=t.slice(i,i+4),a=s.map(function(e){return e.glyphs[0].texturePage}).sort(function(e,t){return e>t?1:-1}),o=this.pages.length-s.length,l=this._mergePages(s,o);l.version++;for(var c=a.length-1;c>=0;c--)this._deletePage(a[c]);this.pages.push(l),this._requestClearModel=!0,this._onAddTextureAtlasCanvas.fire(l.canvas)}var u=new tw(this._document,this._textureSize);return this._pages.push(u),this._activePages.push(u),this._onAddTextureAtlasCanvas.fire(u.canvas),u}},{key:"_mergePages",value:function(e,t){var i=2*e[0].canvas.width,n=new tw(this._document,i,e),r=!0,s=!1,a=void 0;try{for(var o,l=e.entries()[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var c=(0,k._)(o.value,2),u=c[0],h=c[1],d=u*h.canvas.width%i,f=Math.floor(u/2)*h.canvas.height;n.ctx.drawImage(h.canvas,d,f);var v=!0,_=!1,g=void 0;try{for(var y,p=h.glyphs[Symbol.iterator]();!(v=(y=p.next()).done);v=!0){var m=y.value;m.texturePage=t,m.sizeClipSpace.x=m.size.x/i,m.sizeClipSpace.y=m.size.y/i,m.texturePosition.x+=d,m.texturePosition.y+=f,m.texturePositionClipSpace.x=m.texturePosition.x/i,m.texturePositionClipSpace.y=m.texturePosition.y/i}}catch(e){_=!0,g=e}finally{try{v||null==p.return||p.return()}finally{if(_)throw g}}this._onRemoveTextureAtlasCanvas.fire(h.canvas);var x=this._activePages.indexOf(h);-1!==x&&this._activePages.splice(x,1)}}catch(e){s=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(s)throw a}}return n}},{key:"_deletePage",value:function(e){this._pages.splice(e,1);for(var t=e;t<this._pages.length;t++){var i=this._pages[t],n=!0,r=!1,s=void 0;try{for(var a,o=i.glyphs[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var l=a.value;l.texturePage--}}catch(e){r=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw s}}i.version++}}},{key:"getRasterizedGlyphCombinedChar",value:function(e,t,i,n,r,s){return this._getFromCacheMap(this._cacheMapCombined,e,t,i,n,r,s)}},{key:"getRasterizedGlyph",value:function(e,t,i,n,r,s){return this._getFromCacheMap(this._cacheMap,e,t,i,n,r,s)}},{key:"_getFromCacheMap",value:function(e,t,i,n,r,s,a){return(th=e.get(t,i,n,r))||(th=this._drawToCache(t,i,n,r,s,a),e.set(t,i,n,r,th)),th}},{key:"_getColorFromAnsiIndex",value:function(e){if(e>=this._config.colors.ansi.length)throw Error("No color found for idx "+e);return this._config.colors.ansi[e]}},{key:"_getBackgroundColor",value:function(e,t,i,n){if(this._config.allowTransparency)return ev;switch(e){case 0x1000000:case 0x2000000:r=this._getColorFromAnsiIndex(t);break;case 0x3000000:var r,s=e1.toColorRGB(t);r=ec.toColor(s[0],s[1],s[2]);break;default:r=i?eR.opaque(this._config.colors.foreground):this._config.colors.background}return this._config.allowTransparency||(r=eR.opaque(r)),r}},{key:"_getForegroundColor",value:function(e,t,i,n,r,s,a,o,l,c){var u,h=this._getMinimumContrastColor(e,t,i,n,r,s,a,l,o,c);if(h)return h;switch(r){case 0x1000000:case 0x2000000:this._config.drawBoldTextInBrightColors&&l&&s<8&&(s+=8),u=this._getColorFromAnsiIndex(s);break;case 0x3000000:var d=e1.toColorRGB(s);u=ec.toColor(d[0],d[1],d[2]);break;default:u=a?this._config.colors.background:this._config.colors.foreground}return this._config.allowTransparency&&(u=eR.opaque(u)),o&&(u=eR.multiplyOpacity(u,.5)),u}},{key:"_resolveBackgroundRgba",value:function(e,t,i){switch(e){case 0x1000000:case 0x2000000:return this._getColorFromAnsiIndex(t).rgba;case 0x3000000:return t<<8;default:return i?this._config.colors.foreground.rgba:this._config.colors.background.rgba}}},{key:"_resolveForegroundRgba",value:function(e,t,i,n){switch(e){case 0x1000000:case 0x2000000:return this._config.drawBoldTextInBrightColors&&n&&t<8&&(t+=8),this._getColorFromAnsiIndex(t).rgba;case 0x3000000:return t<<8;default:return i?this._config.colors.background.rgba:this._config.colors.foreground.rgba}}},{key:"_getMinimumContrastColor",value:function(e,t,i,n,r,s,a,o,l,c){if(1!==this._config.minimumContrastRatio&&!c){var u=this._getContrastCache(l),h=u.getColor(e,n);if(void 0!==h)return h||void 0;var d=this._resolveBackgroundRgba(t,i,a),f=this._resolveForegroundRgba(r,s,a,o),v=eB.ensureContrastRatio(d,f,this._config.minimumContrastRatio/(l?2:1));if(!v)return void u.setColor(e,n,null);var _=ec.toColor(v>>24&255,v>>16&255,v>>8&255);return u.setColor(e,n,_),_}}},{key:"_getContrastCache",value:function(e){return e?this._config.colors.halfContrastCache:this._config.colors.contrastCache}},{key:"_drawToCache",value:function(t,i,n,r,s,a){var o="number"==typeof t?String.fromCharCode(t):t;a&&this._tmpCanvas.parentElement!==a&&(this._tmpCanvas.style.display="none",a.append(this._tmpCanvas));var l=Math.min(this._config.deviceCellWidth*Math.max(o.length,2)+4,this._config.deviceMaxTextureSize);this._tmpCanvas.width<l&&(this._tmpCanvas.width=l);var c=Math.min(this._config.deviceCellHeight+8,this._textureSize);if(this._tmpCanvas.height<c&&(this._tmpCanvas.height=c),this._tmpCtx.save(),this._workAttributeData.fg=n,this._workAttributeData.bg=i,this._workAttributeData.extended.ext=r,this._workAttributeData.isInvisible())return tm;var u=!!this._workAttributeData.isBold(),h=!!this._workAttributeData.isInverse(),d=!!this._workAttributeData.isDim(),f=!!this._workAttributeData.isItalic(),v=!!this._workAttributeData.isUnderline(),_=!!this._workAttributeData.isStrikethrough(),g=!!this._workAttributeData.isOverline(),y=this._workAttributeData.getFgColor(),p=this._workAttributeData.getFgColorMode(),m=this._workAttributeData.getBgColor(),x=this._workAttributeData.getBgColorMode();if(h){var w=y;y=m,m=w;var C=p;p=x,x=C}var b=this._getBackgroundColor(x,m,h,d);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=b.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.globalCompositeOperation="source-over";var L=u?this._config.fontWeightBold:this._config.fontWeight;this._tmpCtx.font="".concat(f?"italic":""," ").concat(L," ").concat(this._config.fontSize*this._config.devicePixelRatio,"px ").concat(this._config.fontFamily),this._tmpCtx.textBaseline=eN;var M=1===o.length&&ep(o.charCodeAt(0)),S=1===o.length&&57520<=(E=o.charCodeAt(0))&&E<=57527,A=this._getForegroundColor(i,x,m,n,p,y,h,d,u,em(o.charCodeAt(0)));this._tmpCtx.fillStyle=A.css;var R=4*!S,T=!1;!1!==this._config.customGlyphs&&(T=function(e,t,i,n,r,s,a,o){var l=eq[t];if(l)return function(e,t,i,n,r,s){for(var a=0;a<t.length;a++){var o=t[a],l=r/8,c=s/8;e.fillRect(i+o.x*l,n+o.y*c,o.w*l,o.h*c)}}(e,l,i,n,r,s),!0;var c=eG[t];if(c)return function(e,t,i,n,r,s){var a=ej.get(t);a||(a=new Map,ej.set(t,a));var o=e.fillStyle;if("string"!=typeof o)throw Error('Unexpected fillStyle type "'.concat(o,'"'));var l=a.get(o);if(!l){var c,u=t[0].length,h=t.length,d=e.canvas.ownerDocument.createElement("canvas");d.width=u,d.height=h;var f,v,_,g,y=ey(d.getContext("2d")),p=new ImageData(u,h);if(o.startsWith("#"))f=parseInt(o.slice(1,3),16),v=parseInt(o.slice(3,5),16),_=parseInt(o.slice(5,7),16),g=o.length>7&&parseInt(o.slice(7,9),16)||1;else if(o.startsWith("rgba"))f=(c=(0,k._)(o.substring(5,o.length-1).split(",").map(function(e){return parseFloat(e)}),4))[0],v=c[1],_=c[2],g=c[3];else throw Error('Unexpected fillStyle color format "'.concat(o,'" when drawing pattern glyph'));for(var m=0;m<h;m++)for(var x=0;x<u;x++)p.data[(m*u+x)*4]=f,p.data[(m*u+x)*4+1]=v,p.data[(m*u+x)*4+2]=_,p.data[(m*u+x)*4+3]=t[m][x]*(255*g);y.putImageData(p,0,0),l=ey(e.createPattern(d,null)),a.set(o,l)}e.fillStyle=l,e.fillRect(i,n,r,s)}(e,c,i,n,r,s),!0;var u=eH[t];if(u)return function(e,t,i,n,r,s,a){e.strokeStyle=e.fillStyle;var o=!0,l=!1,c=void 0;try{for(var u,h=Object.entries(t)[Symbol.iterator]();!(o=(u=h.next()).done);o=!0){var d=(0,k._)(u.value,2),f=d[0],v=d[1];e.beginPath(),e.lineWidth=a*Number.parseInt(f);var _=void 0;if("function"==typeof v){var g=.15/s*r;_=v(.15,g)}else _=v;var y=!0,p=!1,m=void 0;try{for(var x,w=_.split(" ")[Symbol.iterator]();!(y=(x=w.next()).done);y=!0){var C=x.value,b=C[0],L=eX[b];if(!L){console.error('Could not find drawing instructions for "'.concat(b,'"'));continue}var M=C.substring(1).split(",");M[0]&&M[1]&&L(e,eZ(M,r,s,i,n,!0,a))}}catch(e){p=!0,m=e}finally{try{y||null==w.return||w.return()}finally{if(p)throw m}}e.stroke(),e.closePath()}}catch(e){l=!0,c=e}finally{try{o||null==h.return||h.return()}finally{if(l)throw c}}}(e,u,i,n,r,s,o),!0;var h=eV[t];return!!h&&(function(e,t,i,n,r,s,a,o){var l=new Path2D;l.rect(i,n,r,s),e.clip(l),e.beginPath();var c=a/12;e.lineWidth=o*c;var u=!0,h=!1,d=void 0;try{for(var f,v=t.d.split(" ")[Symbol.iterator]();!(u=(f=v.next()).done);u=!0){var _,g,y=f.value,p=y[0],m=eX[p];if(!m){console.error('Could not find drawing instructions for "'.concat(p,'"'));continue}var x=y.substring(1).split(",");x[0]&&x[1]&&m(e,eZ(x,r,s,i,n,!1,o,(null!=(_=t.leftPadding)?_:0)*(c/2),(null!=(g=t.rightPadding)?g:0)*(c/2)))}}catch(e){h=!0,d=e}finally{try{u||null==v.return||v.return()}finally{if(h)throw d}}1===t.type?(e.strokeStyle=e.fillStyle,e.stroke()):e.fill(),e.closePath()}(e,h,i,n,r,s,a,o),!0)}(this._tmpCtx,o,R,R,this._config.deviceCellWidth,this._config.deviceCellHeight,this._config.fontSize,this._config.devicePixelRatio));var E,B,D=!M;if(B="number"==typeof t?this._unicodeService.wcwidth(t):this._unicodeService.getStringCellWidth(t),v){this._tmpCtx.save();var P=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),F=.5*(P%2==1);if(this._tmpCtx.lineWidth=P,this._workAttributeData.isUnderlineColorDefault())this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle;else if(this._workAttributeData.isUnderlineColorRGB())D=!1,this._tmpCtx.strokeStyle="rgb(".concat(e1.toColorRGB(this._workAttributeData.getUnderlineColor()).join(","),")");else{D=!1;var I=this._workAttributeData.getUnderlineColor();this._config.drawBoldTextInBrightColors&&this._workAttributeData.isBold()&&I<8&&(I+=8),this._tmpCtx.strokeStyle=this._getColorFromAnsiIndex(I).css}this._tmpCtx.beginPath();for(var W=Math.ceil(R+this._config.deviceCharHeight)-F-(s?2*P:0),z=W+P,O=W+2*P,U=this._workAttributeData.getUnderlineVariantOffset(),N=0;N<B;N++){this._tmpCtx.save();var q=R+N*this._config.deviceCellWidth,G=R+(N+1)*this._config.deviceCellWidth,H=q+this._config.deviceCellWidth/2;switch(this._workAttributeData.extended.underlineStyle){case 2:this._tmpCtx.moveTo(q,W),this._tmpCtx.lineTo(G,W),this._tmpCtx.moveTo(q,O),this._tmpCtx.lineTo(G,O);break;case 3:var V=P<=1?O:Math.ceil(R+this._config.deviceCharHeight-P/2)-F,j=P<=1?W:Math.ceil(R+this._config.deviceCharHeight+P/2)-F,Y=new Path2D;Y.rect(q,W,this._config.deviceCellWidth,O-W),this._tmpCtx.clip(Y),this._tmpCtx.moveTo(q-this._config.deviceCellWidth/2,z),this._tmpCtx.bezierCurveTo(q-this._config.deviceCellWidth/2,j,q,j,q,z),this._tmpCtx.bezierCurveTo(q,V,H,V,H,z),this._tmpCtx.bezierCurveTo(H,j,G,j,G,z),this._tmpCtx.bezierCurveTo(G,V,G+this._config.deviceCellWidth/2,V,G+this._config.deviceCellWidth/2,z);break;case 4:var X=0===U?0:U>=P?2*P-U:P-U;!(U>=P)==!1||0===X?(this._tmpCtx.setLineDash([Math.round(P),Math.round(P)]),this._tmpCtx.moveTo(q+X,W)):(this._tmpCtx.setLineDash([Math.round(P),Math.round(P)]),this._tmpCtx.moveTo(q,W),this._tmpCtx.lineTo(q+X,W),this._tmpCtx.moveTo(q+X+P,W)),this._tmpCtx.lineTo(G,W),U=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(e-(2*Math.round(t)-i))%(2*Math.round(t))}(G-q,P,U);break;case 5:var Z=G-q,Q=Math.floor(.6*Z),K=Math.floor(.3*Z),J=Z-Q-K;this._tmpCtx.setLineDash([Q,K,J]),this._tmpCtx.moveTo(q,W),this._tmpCtx.lineTo(G,W);break;default:this._tmpCtx.moveTo(q,W),this._tmpCtx.lineTo(G,W)}this._tmpCtx.stroke(),this._tmpCtx.restore()}if(this._tmpCtx.restore(),!T&&this._config.fontSize>=12&&!this._config.allowTransparency&&" "!==o){this._tmpCtx.save(),this._tmpCtx.textBaseline="alphabetic";var $=this._tmpCtx.measureText(o);if(this._tmpCtx.restore(),"actualBoundingBoxDescent"in $&&$.actualBoundingBoxDescent>0){this._tmpCtx.save();var ee=new Path2D;ee.rect(R,W-Math.ceil(P/2),this._config.deviceCellWidth*B,O-W+Math.ceil(P/2)),this._tmpCtx.clip(ee),this._tmpCtx.lineWidth=3*this._config.devicePixelRatio,this._tmpCtx.strokeStyle=b.css,this._tmpCtx.strokeText(o,R,R+this._config.deviceCharHeight),this._tmpCtx.restore()}}}if(g){var et=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),ei=.5*(et%2==1);this._tmpCtx.lineWidth=et,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(R,R+ei),this._tmpCtx.lineTo(R+this._config.deviceCharWidth*B,R+ei),this._tmpCtx.stroke()}if(T||this._tmpCtx.fillText(o,R,R+this._config.deviceCharHeight),"_"===o&&!this._config.allowTransparency){var en=tC(this._tmpCtx.getImageData(R,R,this._config.deviceCellWidth,this._config.deviceCellHeight),b,A,D);if(en)for(var er=1;er<=5&&(this._tmpCtx.save(),this._tmpCtx.fillStyle=b.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.restore(),this._tmpCtx.fillText(o,R,R+this._config.deviceCharHeight-er),en=tC(this._tmpCtx.getImageData(R,R,this._config.deviceCellWidth,this._config.deviceCellHeight),b,A,D));er++);}if(_){var es=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/10)),ea=.5*(this._tmpCtx.lineWidth%2==1);this._tmpCtx.lineWidth=es,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(R,R+Math.floor(this._config.deviceCharHeight/2)-ea),this._tmpCtx.lineTo(R+this._config.deviceCharWidth*B,R+Math.floor(this._config.deviceCharHeight/2)-ea),this._tmpCtx.stroke()}this._tmpCtx.restore();var eo=this._tmpCtx.getImageData(0,0,this._tmpCanvas.width,this._tmpCanvas.height);if(this._config.allowTransparency?function(e){for(var t=0;t<e.data.length;t+=4)if(e.data[t+3]>0)return!1;return!0}(eo):tC(eo,b,A,D))return tm;for(var el,ec,eu=this._findGlyphBoundingBox(eo,this._workBoundingBox,l,S,T,R);;){if(0===this._activePages.length){var eh=this._createNewPage();el=eh,(ec=eh.currentRow).height=eu.size.y;break}ec=(el=this._activePages[this._activePages.length-1]).currentRow;var ed=!0,ef=!1,ev=void 0;try{for(var e_,eg=this._activePages[Symbol.iterator]();!(ed=(e_=eg.next()).done);ed=!0){var ex=e_.value;eu.size.y<=ex.currentRow.height&&(el=ex,ec=ex.currentRow)}}catch(e){ef=!0,ev=e}finally{try{ed||null==eg.return||eg.return()}finally{if(ef)throw ev}}for(var ew=!0,eC=!1,eb=void 0,eL=this._activePages.length-1;eL>=0;eL--)try{for(var ek,eM=this._activePages[eL].fixedRows[Symbol.iterator]();!(ew=(ek=eM.next()).done);ew=!0){var eS=ek.value;eS.height<=ec.height&&eu.size.y<=eS.height&&(el=this._activePages[eL],ec=eS)}}catch(e){eC=!0,eb=e}finally{try{ew||null==eM.return||eM.return()}finally{if(eC)throw eb}}if(eu.size.x>this._textureSize){this._overflowSizePage||(this._overflowSizePage=new tw(this._document,this._config.deviceMaxTextureSize),this.pages.push(this._overflowSizePage),this._requestClearModel=!0,this._onAddTextureAtlasCanvas.fire(this._overflowSizePage.canvas)),el=this._overflowSizePage,(ec=this._overflowSizePage.currentRow).x+eu.size.x>=el.canvas.width&&(ec.x=0,ec.y+=ec.height,ec.height=0);break}if(ec.y+eu.size.y>=el.canvas.height||ec.height>eu.size.y+2){var eA=!1;if(el.currentRow.y+el.currentRow.height+eu.size.y>=el.canvas.height){var eR=void 0,eT=!0,eE=!1,eB=void 0;try{for(var eD,eP=this._activePages[Symbol.iterator]();!(eT=(eD=eP.next()).done);eT=!0){var eF=eD.value;if(eF.currentRow.y+eF.currentRow.height+eu.size.y<eF.canvas.height){eR=eF;break}}}catch(e){eE=!0,eB=e}finally{try{eT||null==eP.return||eP.return()}finally{if(eE)throw eB}}if(eR)el=eR;else if(e.maxAtlasPages&&this._pages.length>=e.maxAtlasPages&&ec.y+eu.size.y<=el.canvas.height&&ec.height>=eu.size.y&&ec.x+eu.size.x<=el.canvas.width)eA=!0;else{var eI=this._createNewPage();el=eI,(ec=eI.currentRow).height=eu.size.y,eA=!0}}eA||(el.currentRow.height>0&&el.fixedRows.push(el.currentRow),ec={x:0,y:el.currentRow.y+el.currentRow.height,height:eu.size.y},el.fixedRows.push(ec),el.currentRow={x:0,y:ec.y+ec.height,height:0})}if(ec.x+eu.size.x<=el.canvas.width)break;ec===el.currentRow?(ec.x=0,ec.y+=ec.height,ec.height=0):el.fixedRows.splice(el.fixedRows.indexOf(ec),1)}return eu.texturePage=this._pages.indexOf(el),eu.texturePosition.x=ec.x,eu.texturePosition.y=ec.y,eu.texturePositionClipSpace.x=ec.x/el.canvas.width,eu.texturePositionClipSpace.y=ec.y/el.canvas.height,eu.sizeClipSpace.x/=el.canvas.width,eu.sizeClipSpace.y/=el.canvas.height,ec.height=Math.max(ec.height,eu.size.y),ec.x+=eu.size.x,el.ctx.putImageData(eo,eu.texturePosition.x-this._workBoundingBox.left,eu.texturePosition.y-this._workBoundingBox.top,this._workBoundingBox.left,this._workBoundingBox.top,eu.size.x,eu.size.y),el.addGlyph(eu),el.version++,eu}},{key:"_findGlyphBoundingBox",value:function(e,t,i,n,r,s){t.top=0;for(var a=n?this._config.deviceCellHeight:this._tmpCanvas.height,o=n?this._config.deviceCellWidth:i,l=!1,c=0;c<a;c++){for(var u=0;u<o;u++){var h=c*this._tmpCanvas.width*4+4*u+3;if(0!==e.data[h]){t.top=c,l=!0;break}}if(l)break}t.left=0,l=!1;for(var d=0;d<s+o;d++){for(var f=0;f<a;f++){var v=f*this._tmpCanvas.width*4+4*d+3;if(0!==e.data[v]){t.left=d,l=!0;break}}if(l)break}t.right=o,l=!1;for(var _=s+o-1;_>=s;_--){for(var g=0;g<a;g++){var y=g*this._tmpCanvas.width*4+4*_+3;if(0!==e.data[y]){t.right=_,l=!0;break}}if(l)break}t.bottom=a,l=!1;for(var p=a-1;p>=0;p--){for(var m=0;m<o;m++){var x=p*this._tmpCanvas.width*4+4*m+3;if(0!==e.data[x]){t.bottom=p,l=!0;break}}if(l)break}return{texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:t.right-t.left+1,y:t.bottom-t.top+1},sizeClipSpace:{x:t.right-t.left+1,y:t.bottom-t.top+1},offset:{x:-t.left+s+(n||r?Math.floor((this._config.deviceCellWidth-this._config.deviceCharWidth)/2):0),y:-t.top+s+(n||r?1===this._config.lineHeight?0:Math.round((this._config.deviceCellHeight-this._config.deviceCharHeight)/2):0)}}}}]),e}(),tw=function(){function e(t,i,n){(0,p._)(this,e),this._usedPixels=0,this._glyphs=[],this.version=0,this.currentRow={x:0,y:0,height:0},this.fixedRows=[];var r=!0,s=!1,a=void 0;if(n)try{for(var o,l,c=n[Symbol.iterator]();!(r=(l=c.next()).done);r=!0){var u=l.value;(o=this._glyphs).push.apply(o,(0,M._)(u.glyphs)),this._usedPixels+=u._usedPixels}}catch(e){s=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(s)throw a}}this.canvas=tb(t,i,i),this.ctx=ey(this.canvas.getContext("2d",{alpha:!0}))}return(0,m._)(e,[{key:"percentageUsed",get:function(){return this._usedPixels/(this.canvas.width*this.canvas.height)}},{key:"glyphs",get:function(){return this._glyphs}},{key:"addGlyph",value:function(e){this._glyphs.push(e),this._usedPixels+=e.size.x*e.size.y}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentRow.x=0,this.currentRow.y=0,this.currentRow.height=0,this.fixedRows.length=0,this.version++}}]),e}();function tC(e,t,i,n){for(var r=t.rgba>>>24,s=t.rgba>>>16&255,a=t.rgba>>>8&255,o=Math.floor((Math.abs(r-(i.rgba>>>24))+Math.abs(s-(i.rgba>>>16&255))+Math.abs(a-(i.rgba>>>8&255)))/12),l=!0,c=0;c<e.data.length;c+=4)e.data[c]===r&&e.data[c+1]===s&&e.data[c+2]===a||n&&Math.abs(e.data[c]-r)+Math.abs(e.data[c+1]-s)+Math.abs(e.data[c+2]-a)<o?e.data[c+3]=0:l=!1;return l}function tb(e,t,i){var n=e.createElement("canvas");return n.width=t,n.height=i,n}function tL(e,t){for(var i=0;i<e.colors.ansi.length;i++)if(e.colors.ansi[i].rgba!==t.colors.ansi[i].rgba)return!1;return e.devicePixelRatio===t.devicePixelRatio&&e.customGlyphs===t.customGlyphs&&e.lineHeight===t.lineHeight&&e.letterSpacing===t.letterSpacing&&e.fontFamily===t.fontFamily&&e.fontSize===t.fontSize&&e.fontWeight===t.fontWeight&&e.fontWeightBold===t.fontWeightBold&&e.allowTransparency===t.allowTransparency&&e.deviceCharWidth===t.deviceCharWidth&&e.deviceCharHeight===t.deviceCharHeight&&e.drawBoldTextInBrightColors===t.drawBoldTextInBrightColors&&e.minimumContrastRatio===t.minimumContrastRatio&&e.colors.foreground.rgba===t.colors.foreground.rgba&&e.colors.background.rgba===t.colors.background.rgba}var tk=[];function tM(e,t,i,n,r,s,a,o,l){for(var c,u=(c={foreground:i.foreground,background:i.background,cursor:ev,cursorAccent:ev,selectionForeground:ev,selectionBackgroundTransparent:ev,selectionBackgroundOpaque:ev,selectionInactiveBackgroundTransparent:ev,selectionInactiveBackgroundOpaque:ev,overviewRulerBorder:ev,scrollbarSliderBackground:ev,scrollbarSliderHoverBackground:ev,scrollbarSliderActiveBackground:ev,ansi:i.ansi.slice(),contrastCache:i.contrastCache,halfContrastCache:i.halfContrastCache},{customGlyphs:t.customGlyphs,devicePixelRatio:o,deviceMaxTextureSize:l,letterSpacing:t.letterSpacing,lineHeight:t.lineHeight,deviceCellWidth:n,deviceCellHeight:r,deviceCharWidth:s,deviceCharHeight:a,fontFamily:t.fontFamily,fontSize:t.fontSize,fontWeight:t.fontWeight,fontWeightBold:t.fontWeightBold,allowTransparency:t.allowTransparency,drawBoldTextInBrightColors:t.drawBoldTextInBrightColors,minimumContrastRatio:t.minimumContrastRatio,colors:c}),h=0;h<tk.length;h++){var d=tk[h],f=d.ownedBy.indexOf(e);if(f>=0){if(tL(d.config,u))return d.atlas;1===d.ownedBy.length?(d.atlas.dispose(),tk.splice(h,1)):d.ownedBy.splice(f,1);break}}for(var v=0;v<tk.length;v++){var _=tk[v];if(tL(_.config,u))return _.ownedBy.push(e),_.atlas}var g={atlas:new tx(document,u,e._core.unicodeService),config:u,ownedBy:[e]};return tk.push(g),g.atlas}function tS(e){for(var t=0;t<tk.length;t++){var i=tk[t].ownedBy.indexOf(e);if(-1!==i){1===tk[t].ownedBy.length?(tk[t].atlas.dispose(),tk.splice(t,1)):tk[t].ownedBy.splice(i,1);break}}}var tA=function(){function e(t,i){(0,p._)(this,e),this._renderCallback=t,this._coreBrowserService=i,this.isCursorVisible=!0,this._coreBrowserService.isFocused&&this._restartInterval()}return(0,m._)(e,[{key:"isPaused",get:function(){return!(this._blinkStartTimeout||this._blinkInterval)}},{key:"dispose",value:function(){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}},{key:"restartBlinkAnimation",value:function(){var e=this;this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(function(){e._renderCallback(),e._animationFrame=void 0})))}},{key:"_restartInterval",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:600;this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=this._coreBrowserService.window.setTimeout(function(){if(e._animationTimeRestarted){var t=600-(Date.now()-e._animationTimeRestarted);if(e._animationTimeRestarted=void 0,t>0)return void e._restartInterval(t)}e.isCursorVisible=!1,e._animationFrame=e._coreBrowserService.window.requestAnimationFrame(function(){e._renderCallback(),e._animationFrame=void 0}),e._blinkInterval=e._coreBrowserService.window.setInterval(function(){if(e._animationTimeRestarted){var t=600-(Date.now()-e._animationTimeRestarted);e._animationTimeRestarted=void 0,e._restartInterval(t);return}e.isCursorVisible=!e.isCursorVisible,e._animationFrame=e._coreBrowserService.window.requestAnimationFrame(function(){e._renderCallback(),e._animationFrame=void 0})},600)},t)}},{key:"pause",value:function(){this.isCursorVisible=!0,this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}},{key:"resume",value:function(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()}}]),e}();function tR(e,t,i){var n=new t.ResizeObserver(function(t){var r=t.find(function(t){return t.target===e});if(r){if(!("devicePixelContentBoxSize"in r)){null==n||n.disconnect(),n=void 0;return}var s=r.devicePixelContentBoxSize[0].inlineSize,a=r.devicePixelContentBoxSize[0].blockSize;s>0&&a>0&&i(s,a)}});try{n.observe(e,{box:["device-pixel-content-box"]})}catch(e){n.disconnect(),n=void 0}return G(function(){return null==n?void 0:n.disconnect()})}var tT=function(e){function t(){var e;return(0,p._)(this,t),e=(0,y._)(this,t,arguments),e.content=0,e.fg=0,e.bg=0,e.extended=new e2,e.combinedData="",e}return(0,b._)(t,e),(0,m._)(t,[{key:"isCombined",value:function(){return 2097152&this.content}},{key:"getWidth",value:function(){return this.content>>22}},{key:"getChars",value:function(){var e;return 2097152&this.content?this.combinedData:2097151&this.content?(e=2097151&this.content)>65535?String.fromCharCode(((e-=65536)>>10)+55296)+String.fromCharCode(e%1024+56320):String.fromCharCode(e):""}},{key:"getCode",value:function(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}},{key:"setFromCharData",value:function(e){this.fg=e[0],this.bg=0;var t=!1;if(e[1].length>2)t=!0;else if(2===e[1].length){var i=e[1].charCodeAt(0);if(55296<=i&&i<=56319){var n=e[1].charCodeAt(1);56320<=n&&n<=57343?this.content=(i-55296)*1024+n-56320+65536|e[2]<<22:t=!0}else t=!0}else this.content=e[1].charCodeAt(0)|e[2]<<22;t&&(this.combinedData=e[1],this.content=2097152|e[2]<<22)}},{key:"getAsCharData",value:function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}],[{key:"fromCharData",value:function(e){var i=new t;return i.setFromCharData(e),i}}]),t}(e1),tE=new Float32Array([2,0,0,0,0,-2,0,0,0,0,1,0,-1,1,0,1]);function tB(e,t,i){var n=ey(e.createProgram());if(e.attachShader(n,ey(tD(e,e.VERTEX_SHADER,t))),e.attachShader(n,ey(tD(e,e.FRAGMENT_SHADER,i))),e.linkProgram(n),e.getProgramParameter(n,e.LINK_STATUS))return n;console.error(e.getProgramInfoLog(n)),e.deleteProgram(n)}function tD(e,t,i){var n=ey(e.createShader(t));if(e.shaderSource(n,i),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))return n;console.error(e.getShaderInfoLog(n)),e.deleteShader(n)}var tP,tF=function e(t){(0,p._)(this,e),this.texture=t,this.version=-1},tI=11*Float32Array.BYTES_PER_ELEMENT,tW=0,tz=0,tO=0,tU=function(e){function t(e,i,n,r){(0,p._)(this,t),(s=(0,y._)(this,t))._terminal=e,s._gl=i,s._dimensions=n,s._optionsService=r,s._activeBuffer=0,s._vertices={count:0,attributes:new Float32Array(0),attributesBuffers:[new Float32Array(0),new Float32Array(0)]};var s,a=s._gl;void 0===tx.maxAtlasPages&&(tx.maxAtlasPages=Math.min(32,ey(a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS))),tx.maxTextureSize=ey(a.getParameter(a.MAX_TEXTURE_SIZE))),s._program=ey(tB(a,"#version 300 es\nlayout (location = 0) in vec2 a_unitquad;\nlayout (location = 1) in vec2 a_cellpos;\nlayout (location = 2) in vec2 a_offset;\nlayout (location = 3) in vec2 a_size;\nlayout (location = 4) in float a_texpage;\nlayout (location = 5) in vec2 a_texcoord;\nlayout (location = 6) in vec2 a_texsize;\n\nuniform mat4 u_projection;\nuniform vec2 u_resolution;\n\nout vec2 v_texcoord;\nflat out int v_texpage;\n\nvoid main() {\n  vec2 zeroToOne = (a_offset / u_resolution) + a_cellpos + (a_unitquad * a_size);\n  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);\n  v_texpage = int(a_texpage);\n  v_texcoord = a_texcoord + a_unitquad * a_texsize;\n}",function(e){for(var t="",i=1;i<e;i++)t+=" else if (v_texpage == ".concat(i,") { outColor = texture(u_texture[").concat(i,"], v_texcoord); }");return"#version 300 es\nprecision lowp float;\n\nin vec2 v_texcoord;\nflat in int v_texpage;\n\nuniform sampler2D u_texture[".concat(e,"];\n\nout vec4 outColor;\n\nvoid main() {\n  if (v_texpage == 0) {\n    outColor = texture(u_texture[0], v_texcoord);\n  } ").concat(t,"\n}")}(tx.maxAtlasPages))),s._register(G(function(){return a.deleteProgram(s._program)})),s._projectionLocation=ey(a.getUniformLocation(s._program,"u_projection")),s._resolutionLocation=ey(a.getUniformLocation(s._program,"u_resolution")),s._textureLocation=ey(a.getUniformLocation(s._program,"u_texture")),s._vertexArrayObject=a.createVertexArray(),a.bindVertexArray(s._vertexArrayObject);var o=new Float32Array([0,0,1,0,0,1,1,1]),l=a.createBuffer();s._register(G(function(){return a.deleteBuffer(l)})),a.bindBuffer(a.ARRAY_BUFFER,l),a.bufferData(a.ARRAY_BUFFER,o,a.STATIC_DRAW),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,s._gl.FLOAT,!1,0,0);var c=new Uint8Array([0,1,2,3]),u=a.createBuffer();s._register(G(function(){return a.deleteBuffer(u)})),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,u),a.bufferData(a.ELEMENT_ARRAY_BUFFER,c,a.STATIC_DRAW),s._attributesBuffer=ey(a.createBuffer()),s._register(G(function(){return a.deleteBuffer(s._attributesBuffer)})),a.bindBuffer(a.ARRAY_BUFFER,s._attributesBuffer),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,tI,0),a.vertexAttribDivisor(2,1),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,2,a.FLOAT,!1,tI,2*Float32Array.BYTES_PER_ELEMENT),a.vertexAttribDivisor(3,1),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.FLOAT,!1,tI,4*Float32Array.BYTES_PER_ELEMENT),a.vertexAttribDivisor(4,1),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,2,a.FLOAT,!1,tI,5*Float32Array.BYTES_PER_ELEMENT),a.vertexAttribDivisor(5,1),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,tI,7*Float32Array.BYTES_PER_ELEMENT),a.vertexAttribDivisor(6,1),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,tI,9*Float32Array.BYTES_PER_ELEMENT),a.vertexAttribDivisor(1,1),a.useProgram(s._program);for(var h=new Int32Array(tx.maxAtlasPages),d=0;d<tx.maxAtlasPages;d++)h[d]=d;a.uniform1iv(s._textureLocation,h),a.uniformMatrix4fv(s._projectionLocation,!1,tE),s._atlasTextures=[];for(var f=0;f<tx.maxAtlasPages;f++)!function(e){var t=new tF(ey(a.createTexture()));s._register(G(function(){return a.deleteTexture(t.texture)})),a.activeTexture(a.TEXTURE0+e),a.bindTexture(a.TEXTURE_2D,t.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,1,1,0,a.RGBA,a.UNSIGNED_BYTE,new Uint8Array([255,0,0,255])),s._atlasTextures[e]=t}(f);return a.enable(a.BLEND),a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA),s.handleResize(),s}return(0,b._)(t,e),(0,m._)(t,[{key:"beginFrame",value:function(){return!this._atlas||this._atlas.beginFrame()}},{key:"updateCell",value:function(e,t,i,n,r,s,a,o,l){this._updateCell(this._vertices.attributes,e,t,i,n,r,s,a,o,l)}},{key:"_updateCell",value:function(e,t,i,n,r,s,a,o,l,c){var u,h;(tW=(i*this._terminal.cols+t)*11,0===n||void 0===n)?e.fill(0,tW,tW+11-1-2):this._atlas&&(tP=o&&o.length>1?this._atlas.getRasterizedGlyphCombinedChar(o,r,s,a,!1,this._terminal.element):this._atlas.getRasterizedGlyph(n,r,s,a,!1,this._terminal.element),tz=Math.floor((this._dimensions.device.cell.width-this._dimensions.device.char.width)/2),r!==c&&tP.offset.x>tz?(tO=tP.offset.x-tz,e[tW]=-(tP.offset.x-tO)+this._dimensions.device.char.left,e[tW+1]=-tP.offset.y+this._dimensions.device.char.top,e[tW+2]=(tP.size.x-tO)/this._dimensions.device.canvas.width,e[tW+3]=tP.size.y/this._dimensions.device.canvas.height,e[tW+4]=tP.texturePage,e[tW+5]=tP.texturePositionClipSpace.x+tO/this._atlas.pages[tP.texturePage].canvas.width,e[tW+6]=tP.texturePositionClipSpace.y,e[tW+7]=tP.sizeClipSpace.x-tO/this._atlas.pages[tP.texturePage].canvas.width):(e[tW]=-tP.offset.x+this._dimensions.device.char.left,e[tW+1]=-tP.offset.y+this._dimensions.device.char.top,e[tW+2]=tP.size.x/this._dimensions.device.canvas.width,e[tW+3]=tP.size.y/this._dimensions.device.canvas.height,e[tW+4]=tP.texturePage,e[tW+5]=tP.texturePositionClipSpace.x,e[tW+6]=tP.texturePositionClipSpace.y,e[tW+7]=tP.sizeClipSpace.x),e[tW+8]=tP.sizeClipSpace.y,this._optionsService.rawOptions.rescaleOverlappingGlyphs&&(u=tP.size.x,h=this._dimensions.device.cell.width,1===l&&u>Math.ceil(1.5*h)&&void 0!==n&&n>255&&!(n>=128512&&n<=128591||n>=127744&&n<=128511||n>=128640&&n<=128767||n>=9728&&n<=9983||n>=9984&&n<=10175||n>=65024&&n<=65039||n>=129280&&n<=129535||n>=127462&&n<=127487)&&!ep(n)&&!(57344<=n&&n<=63743))&&(e[tW+2]=(this._dimensions.device.cell.width-1)/this._dimensions.device.canvas.width))}},{key:"clear",value:function(){var e=this._terminal,t=e.cols*e.rows*11;this._vertices.count!==t?this._vertices.attributes=new Float32Array(t):this._vertices.attributes.fill(0);for(var i=0;i<this._vertices.attributesBuffers.length;i++)this._vertices.count!==t?this._vertices.attributesBuffers[i]=new Float32Array(t):this._vertices.attributesBuffers[i].fill(0);this._vertices.count=t,i=0;for(var n=0;n<e.rows;n++)for(var r=0;r<e.cols;r++)this._vertices.attributes[i+9]=r/e.cols,this._vertices.attributes[i+10]=n/e.rows,i+=11}},{key:"handleResize",value:function(){var e=this._gl;e.useProgram(this._program),e.viewport(0,0,e.canvas.width,e.canvas.height),e.uniform2f(this._resolutionLocation,e.canvas.width,e.canvas.height),this.clear()}},{key:"render",value:function(e){if(this._atlas){var t=this._gl;t.useProgram(this._program),t.bindVertexArray(this._vertexArrayObject),this._activeBuffer=(this._activeBuffer+1)%2;for(var i=this._vertices.attributesBuffers[this._activeBuffer],n=0,r=0;r<e.lineLengths.length;r++){var s=r*this._terminal.cols*11,a=this._vertices.attributes.subarray(s,s+11*e.lineLengths[r]);i.set(a,n),n+=a.length}t.bindBuffer(t.ARRAY_BUFFER,this._attributesBuffer),t.bufferData(t.ARRAY_BUFFER,i.subarray(0,n),t.STREAM_DRAW);for(var o=0;o<this._atlas.pages.length;o++)this._atlas.pages[o].version!==this._atlasTextures[o].version&&this._bindAtlasPageTexture(t,this._atlas,o);t.drawElementsInstanced(t.TRIANGLE_STRIP,4,t.UNSIGNED_BYTE,0,n/11)}}},{key:"setAtlas",value:function(e){this._atlas=e;var t=!0,i=!1,n=void 0;try{for(var r,s=this._atlasTextures[Symbol.iterator]();!(t=(r=s.next()).done);t=!0)r.value.version=-1}catch(e){i=!0,n=e}finally{try{t||null==s.return||s.return()}finally{if(i)throw n}}}},{key:"_bindAtlasPageTexture",value:function(e,t,i){e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_2D,this._atlasTextures[i].texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.pages[i].canvas),e.generateMipmap(e.TEXTURE_2D),this._atlasTextures[i].version=t.pages[i].version}},{key:"setDimensions",value:function(e){this._dimensions=e}}]),t}(V),tN=function(){function e(){(0,p._)(this,e),this.clear()}return(0,m._)(e,[{key:"clear",value:function(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}},{key:"update",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.selectionStart=t,this.selectionEnd=i,!t||!i||t[0]===i[0]&&t[1]===i[1])return void this.clear();var r=e.buffers.active.ydisp,s=t[1]-r,a=i[1]-r,o=Math.max(s,0),l=Math.min(a,e.rows-1);o>=e.rows||l<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=n,this.viewportStartRow=s,this.viewportEndRow=a,this.viewportCappedStartRow=o,this.viewportCappedEndRow=l,this.startCol=t[0],this.endCol=i[0])}},{key:"isCellSelected",value:function(e,t,i){return!!this.hasSelection&&(i-=e.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?t>=this.startCol&&i>=this.viewportCappedStartRow&&t<this.endCol&&i<=this.viewportCappedEndRow:t<this.startCol&&i>=this.viewportCappedStartRow&&t>=this.endCol&&i<=this.viewportCappedEndRow:i>this.viewportStartRow&&i<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&i===this.viewportStartRow&&t>=this.startCol&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&i===this.viewportEndRow&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&i===this.viewportStartRow&&t>=this.startCol)}}]),e}(),tq=function(){function e(){(0,p._)(this,e),this.cells=new Uint32Array(0),this.lineLengths=new Uint32Array(0),this.selection=new tN}return(0,m._)(e,[{key:"resize",value:function(e,t){var i=e*t*4;i!==this.cells.length&&(this.cells=new Uint32Array(i),this.lineLengths=new Uint32Array(t))}},{key:"clear",value:function(){this.cells.fill(0,0),this.lineLengths.fill(0,0)}}]),e}(),tG=8*Float32Array.BYTES_PER_ELEMENT,tH=function e(){(0,p._)(this,e),this.attributes=new Float32Array(160),this.count=0},tV=0,tj=0,tY=0,tX=0,tZ=0,tQ=0,tK=0,tJ=function(e){function t(e,i,n,r){(0,p._)(this,t),(s=(0,y._)(this,t))._terminal=e,s._gl=i,s._dimensions=n,s._themeService=r,s._vertices=new tH,s._verticesCursor=new tH;var s,a=s._gl;s._program=ey(tB(a,"#version 300 es\nlayout (location = 0) in vec2 a_position;\nlayout (location = 1) in vec2 a_size;\nlayout (location = 2) in vec4 a_color;\nlayout (location = 3) in vec2 a_unitquad;\n\nuniform mat4 u_projection;\n\nout vec4 v_color;\n\nvoid main() {\n  vec2 zeroToOne = a_position + (a_unitquad * a_size);\n  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);\n  v_color = a_color;\n}","#version 300 es\nprecision lowp float;\n\nin vec4 v_color;\n\nout vec4 outColor;\n\nvoid main() {\n  outColor = v_color;\n}")),s._register(G(function(){return a.deleteProgram(s._program)})),s._projectionLocation=ey(a.getUniformLocation(s._program,"u_projection")),s._vertexArrayObject=a.createVertexArray(),a.bindVertexArray(s._vertexArrayObject);var o=new Float32Array([0,0,1,0,0,1,1,1]),l=a.createBuffer();s._register(G(function(){return a.deleteBuffer(l)})),a.bindBuffer(a.ARRAY_BUFFER,l),a.bufferData(a.ARRAY_BUFFER,o,a.STATIC_DRAW),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,2,s._gl.FLOAT,!1,0,0);var c=new Uint8Array([0,1,2,3]),u=a.createBuffer();return s._register(G(function(){return a.deleteBuffer(u)})),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,u),a.bufferData(a.ELEMENT_ARRAY_BUFFER,c,a.STATIC_DRAW),s._attributesBuffer=ey(a.createBuffer()),s._register(G(function(){return a.deleteBuffer(s._attributesBuffer)})),a.bindBuffer(a.ARRAY_BUFFER,s._attributesBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.FLOAT,!1,tG,0),a.vertexAttribDivisor(0,1),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,tG,2*Float32Array.BYTES_PER_ELEMENT),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,4,a.FLOAT,!1,tG,4*Float32Array.BYTES_PER_ELEMENT),a.vertexAttribDivisor(2,1),s._updateCachedColors(r.colors),s._register(s._themeService.onChangeColors(function(e){s._updateCachedColors(e),s._updateViewportRectangle()})),s}return(0,b._)(t,e),(0,m._)(t,[{key:"renderBackgrounds",value:function(){this._renderVertices(this._vertices)}},{key:"renderCursor",value:function(){this._renderVertices(this._verticesCursor)}},{key:"_renderVertices",value:function(e){var t=this._gl;t.useProgram(this._program),t.bindVertexArray(this._vertexArrayObject),t.uniformMatrix4fv(this._projectionLocation,!1,tE),t.bindBuffer(t.ARRAY_BUFFER,this._attributesBuffer),t.bufferData(t.ARRAY_BUFFER,e.attributes,t.DYNAMIC_DRAW),t.drawElementsInstanced(this._gl.TRIANGLE_STRIP,4,t.UNSIGNED_BYTE,0,e.count)}},{key:"handleResize",value:function(){this._updateViewportRectangle()}},{key:"setDimensions",value:function(e){this._dimensions=e}},{key:"_updateCachedColors",value:function(e){this._bgFloat=this._colorToFloat32Array(e.background),this._cursorFloat=this._colorToFloat32Array(e.cursor)}},{key:"_updateViewportRectangle",value:function(){this._addRectangleFloat(this._vertices.attributes,0,0,0,this._terminal.cols*this._dimensions.device.cell.width,this._terminal.rows*this._dimensions.device.cell.height,this._bgFloat)}},{key:"updateBackgrounds",value:function(e){var t,i,n,r,s,a,o,l,c,u,h,d=this._terminal,f=this._vertices,v=1;for(t=0;t<d.rows;t++){for(n=-1,r=0,s=0,a=!1,i=0;i<d.cols;i++)o=(t*d.cols+i)*4,l=e.cells[o+1],u=!!(0x4000000&(c=e.cells[o+2])),(l!==r||c!==s&&(a||u))&&((0!==r||a&&0!==s)&&(h=8*v++,this._updateRectangle(f,h,s,r,n,i,t)),n=i,r=l,s=c,a=u);(0!==r||a&&0!==s)&&(h=8*v++,this._updateRectangle(f,h,s,r,n,d.cols,t))}f.count=v}},{key:"updateCursor",value:function(e){var t=this._verticesCursor,i=e.cursor;if(!i||"block"===i.style){t.count=0;return}var n,r=0;("bar"===i.style||"outline"===i.style)&&(n=8*r++,this._addRectangleFloat(t.attributes,n,i.x*this._dimensions.device.cell.width,i.y*this._dimensions.device.cell.height,"bar"===i.style?i.dpr*i.cursorWidth:i.dpr,this._dimensions.device.cell.height,this._cursorFloat)),("underline"===i.style||"outline"===i.style)&&(n=8*r++,this._addRectangleFloat(t.attributes,n,i.x*this._dimensions.device.cell.width,(i.y+1)*this._dimensions.device.cell.height-i.dpr,i.width*this._dimensions.device.cell.width,i.dpr,this._cursorFloat)),"outline"===i.style&&(n=8*r++,this._addRectangleFloat(t.attributes,n,i.x*this._dimensions.device.cell.width,i.y*this._dimensions.device.cell.height,i.width*this._dimensions.device.cell.width,i.dpr,this._cursorFloat),n=8*r++,this._addRectangleFloat(t.attributes,n,(i.x+i.width)*this._dimensions.device.cell.width-i.dpr,i.y*this._dimensions.device.cell.height,i.dpr,this._dimensions.device.cell.height,this._cursorFloat)),t.count=r}},{key:"_updateRectangle",value:function(e,t,i,n,r,s,a){if(0x4000000&i)switch(0x3000000&i){case 0x1000000:case 0x2000000:tV=this._themeService.colors.ansi[255&i].rgba;break;case 0x3000000:tV=(0xffffff&i)<<8;break;default:tV=this._themeService.colors.foreground.rgba}else switch(0x3000000&n){case 0x1000000:case 0x2000000:tV=this._themeService.colors.ansi[255&n].rgba;break;case 0x3000000:tV=(0xffffff&n)<<8;break;default:tV=this._themeService.colors.background.rgba}e.attributes.length<t+4&&(e.attributes=function(e,t){for(var i=new Float32Array(Math.min(2*e.length,t)),n=0;n<e.length;n++)i[n]=e[n];return i}(e.attributes,this._terminal.rows*this._terminal.cols*8)),tj=r*this._dimensions.device.cell.width,tY=a*this._dimensions.device.cell.height,tX=(tV>>24&255)/255,tZ=(tV>>16&255)/255,tQ=(tV>>8&255)/255,tK=1,this._addRectangle(e.attributes,t,tj,tY,(s-r)*this._dimensions.device.cell.width,this._dimensions.device.cell.height,tX,tZ,tQ,tK)}},{key:"_addRectangle",value:function(e,t,i,n,r,s,a,o,l,c){e[t]=i/this._dimensions.device.canvas.width,e[t+1]=n/this._dimensions.device.canvas.height,e[t+2]=r/this._dimensions.device.canvas.width,e[t+3]=s/this._dimensions.device.canvas.height,e[t+4]=a,e[t+5]=o,e[t+6]=l,e[t+7]=c}},{key:"_addRectangleFloat",value:function(e,t,i,n,r,s,a){e[t]=i/this._dimensions.device.canvas.width,e[t+1]=n/this._dimensions.device.canvas.height,e[t+2]=r/this._dimensions.device.canvas.width,e[t+3]=s/this._dimensions.device.canvas.height,e[t+4]=a[0],e[t+5]=a[1],e[t+6]=a[2],e[t+7]=a[3]}},{key:"_colorToFloat32Array",value:function(e){return new Float32Array([(e.rgba>>24&255)/255,(e.rgba>>16&255)/255,(e.rgba>>8&255)/255,(255&e.rgba)/255])}}]),t}(V),t$=function(e){function t(e,i,n,r,s,a,o){var l;return(0,p._)(this,t),(l=(0,y._)(this,t,[n,e,"link",i,!0,s,a,o]))._register(r.onShowLinkUnderline(function(e){return l._handleShowLinkUnderline(e)})),l._register(r.onHideLinkUnderline(function(e){return l._handleHideLinkUnderline(e)})),l}return(0,b._)(t,e),(0,m._)(t,[{key:"resize",value:function(e,i){(0,w._)((0,C._)(t.prototype),"resize",this).call(this,e,i),this._state=void 0}},{key:"reset",value:function(e){this._clearCurrentLink()}},{key:"_clearCurrentLink",value:function(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);var e=this._state.y2-this._state.y1-1;e>0&&this._clearCells(0,this._state.y1+1,this._state.cols,e),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}}},{key:"_handleShowLinkUnderline",value:function(e){var t;if(257===e.fg?this._ctx.fillStyle=this._themeService.colors.background.css:void 0!==e.fg&&((0x3000000&(t=e.fg))==0x1000000||(0x3000000&t)==0x2000000)?this._ctx.fillStyle=this._themeService.colors.ansi[e.fg].css:this._ctx.fillStyle=this._themeService.colors.foreground.css,e.y1===e.y2)this._fillBottomLineAtCells(e.x1,e.y1,e.x2-e.x1);else{this._fillBottomLineAtCells(e.x1,e.y1,e.cols-e.x1);for(var i=e.y1+1;i<e.y2;i++)this._fillBottomLineAtCells(0,i,e.cols);this._fillBottomLineAtCells(0,e.y2,e.x2)}this._state=e}},{key:"_handleHideLinkUnderline",value:function(e){this._clearCurrentLink()}}]),t}(function(e){function t(e,i,n,r,s,a,o,l){var c;return(0,p._)(this,t),(c=(0,y._)(this,t))._container=i,c._alpha=s,c._coreBrowserService=a,c._optionsService=o,c._themeService=l,c._deviceCharWidth=0,c._deviceCharHeight=0,c._deviceCellWidth=0,c._deviceCellHeight=0,c._deviceCharLeft=0,c._deviceCharTop=0,c._canvas=c._coreBrowserService.mainDocument.createElement("canvas"),c._canvas.classList.add("xterm-".concat(n,"-layer")),c._canvas.style.zIndex=r.toString(),c._initCanvas(),c._container.appendChild(c._canvas),c._register(c._themeService.onChangeColors(function(t){c._refreshCharAtlas(e,t),c.reset(e)})),c._register(G(function(){c._canvas.remove()})),c}return(0,b._)(t,e),(0,m._)(t,[{key:"_initCanvas",value:function(){this._ctx=ey(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()}},{key:"handleBlur",value:function(e){}},{key:"handleFocus",value:function(e){}},{key:"handleCursorMove",value:function(e){}},{key:"handleGridChanged",value:function(e,t,i){}},{key:"handleSelectionChanged",value:function(e,t,i){arguments.length>3&&void 0!==arguments[3]&&arguments[3]}},{key:"_setTransparency",value:function(e,t){if(t!==this._alpha){var i=this._canvas;this._alpha=t,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,i),this._refreshCharAtlas(e,this._themeService.colors),this.handleGridChanged(e,0,e.rows-1)}}},{key:"_refreshCharAtlas",value:function(e,t){this._deviceCharWidth<=0&&this._deviceCharHeight<=0||(this._charAtlas=tM(e,this._optionsService.rawOptions,t,this._deviceCellWidth,this._deviceCellHeight,this._deviceCharWidth,this._deviceCharHeight,this._coreBrowserService.dpr,2048),this._charAtlas.warmUp())}},{key:"resize",value:function(e,t){this._deviceCellWidth=t.device.cell.width,this._deviceCellHeight=t.device.cell.height,this._deviceCharWidth=t.device.char.width,this._deviceCharHeight=t.device.char.height,this._deviceCharLeft=t.device.char.left,this._deviceCharTop=t.device.char.top,this._canvas.width=t.device.canvas.width,this._canvas.height=t.device.canvas.height,this._canvas.style.width="".concat(t.css.canvas.width,"px"),this._canvas.style.height="".concat(t.css.canvas.height,"px"),this._alpha||this._clearAll(),this._refreshCharAtlas(e,this._themeService.colors)}},{key:"_fillBottomLineAtCells",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this._ctx.fillRect(e*this._deviceCellWidth,(t+1)*this._deviceCellHeight-this._coreBrowserService.dpr-1,i*this._deviceCellWidth,this._coreBrowserService.dpr)}},{key:"_clearAll",value:function(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))}},{key:"_clearCells",value:function(e,t,i,n){this._alpha?this._ctx.clearRect(e*this._deviceCellWidth,t*this._deviceCellHeight,i*this._deviceCellWidth,n*this._deviceCellHeight):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(e*this._deviceCellWidth,t*this._deviceCellHeight,i*this._deviceCellWidth,n*this._deviceCellHeight))}},{key:"_fillCharTrueColor",value:function(e,t,i,n){this._ctx.font=this._getFont(e,!1,!1),this._ctx.textBaseline=eN,this._clipCell(i,n,t.getWidth()),this._ctx.fillText(t.getChars(),i*this._deviceCellWidth+this._deviceCharLeft,n*this._deviceCellHeight+this._deviceCharTop+this._deviceCharHeight)}},{key:"_clipCell",value:function(e,t,i){this._ctx.beginPath(),this._ctx.rect(e*this._deviceCellWidth,t*this._deviceCellHeight,i*this._deviceCellWidth,this._deviceCellHeight),this._ctx.clip()}},{key:"_getFont",value:function(e,t,i){var n=t?e.options.fontWeightBold:e.options.fontWeight;return"".concat(i?"italic":""," ").concat(n," ").concat(e.options.fontSize*this._coreBrowserService.dpr,"px ").concat(e.options.fontFamily)}}]),t}(V)),t0=("undefined"==typeof window?"undefined":(0,S._)(window))=="object"?window:globalThis,t5=function(){function e(){(0,p._)(this,e),this.mapWindowIdToZoomLevel=new Map,this._onDidChangeZoomLevel=new ty,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event,this.mapWindowIdToZoomFactor=new Map,this._onDidChangeFullscreen=new ty,this.onDidChangeFullscreen=this._onDidChangeFullscreen.event,this.mapWindowIdToFullScreen=new Map}return(0,m._)(e,[{key:"getZoomLevel",value:function(e){var t;return null!=(t=this.mapWindowIdToZoomLevel.get(this.getWindowId(e)))?t:0}},{key:"setZoomLevel",value:function(e,t){if(this.getZoomLevel(t)!==e){var i=this.getWindowId(t);this.mapWindowIdToZoomLevel.set(i,e),this._onDidChangeZoomLevel.fire(i)}}},{key:"getZoomFactor",value:function(e){var t;return null!=(t=this.mapWindowIdToZoomFactor.get(this.getWindowId(e)))?t:1}},{key:"setZoomFactor",value:function(e,t){this.mapWindowIdToZoomFactor.set(this.getWindowId(t),e)}},{key:"setFullscreen",value:function(e,t){if(this.isFullscreen(t)!==e){var i=this.getWindowId(t);this.mapWindowIdToFullScreen.set(i,e),this._onDidChangeFullscreen.fire(i)}}},{key:"isFullscreen",value:function(e){return!!this.mapWindowIdToFullScreen.get(this.getWindowId(e))}},{key:"getWindowId",value:function(e){return e.vscodeWindowId}}]),e}();t5.INSTANCE=new t5,t5.INSTANCE.onDidChangeZoomLevel,t5.INSTANCE.onDidChangeFullscreen;var t1=("undefined"==typeof navigator?"undefined":(0,S._)(navigator))=="object"?navigator.userAgent:"";t1.indexOf("Firefox"),t1.indexOf("AppleWebKit"),t1.indexOf("Chrome")>=0||t1.indexOf("Safari"),t1.indexOf("Electron/"),t1.indexOf("Android");var t2=!1;if("function"==typeof t0.matchMedia){var t3,t4=t0.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),t8=t0.matchMedia("(display-mode: fullscreen)");t2=t4.matches,t3=t4,"string"==typeof t3&&(t3=t0.matchMedia(t3)),t3.addEventListener("change",function(e){var t=e.matches;t2&&t8.matches||(t2=t)})}var t6,t7,t9=!1,ie=!1,it="en",ii=globalThis;"u">(0,S._)(ii.vscode)&&"u">(0,S._)(ii.vscode.process)?t7=ii.vscode.process:(void 0===v.default?"undefined":(0,S._)(v.default))<"u"&&"string"==typeof(null==(et=v.default)||null==(ee=et.versions)?void 0:ee.node)&&(t7=v.default);var ir="string"==typeof(null==t7||null==(ei=t7.versions)?void 0:ei.electron)&&(null==t7?void 0:t7.type)==="renderer";if((void 0===t7?"undefined":(0,S._)(t7))=="object"){t7.platform,t7.platform,"linux"===t7.platform&&t7.env.SNAP&&t7.env.SNAP_REVISION,t7.env.CI||t7.env.BUILD_ARTIFACTSTAGINGDIRECTORY,it="en";var is=t7.env.VSCODE_NLS_CONFIG;if(is)try{var ia,io=JSON.parse(is);io.userLocale,io.osLocale,it=io.resolvedLanguage||"en",null==(ia=io.languagePack)||ia.translationsConfigFile}catch(e){}t9=!0}else("undefined"==typeof navigator?"undefined":(0,S._)(navigator))!="object"||ir?console.error("Unable to resolve platform."):((t6=navigator.userAgent).indexOf("Windows"),t6.indexOf("Macintosh"),(t6.indexOf("Macintosh")>=0||t6.indexOf("iPad")>=0||t6.indexOf("iPhone")>=0)&&navigator.maxTouchPoints&&navigator.maxTouchPoints,t6.indexOf("Linux"),null==t6||t6.indexOf("Mobi"),ie=!0,it=globalThis._VSCODE_NLS_LANGUAGE||"en",navigator.language.toLowerCase());var il=t9;ie&&"function"==typeof ii.importScripts&&ii.origin;var ic,iu=t6,ih=it;(iw=ic||(ic={})).value=function(){return ih},iw.isDefaultVariant=function(){return 2===ih.length?"en"===ih:ih.length>=3&&"e"===ih[0]&&"n"===ih[1]&&"-"===ih[2]},iw.isDefault=function(){return"en"===ih};var id="function"==typeof ii.postMessage&&!ii.importScripts,iv=function(){if(id){var e=[];ii.addEventListener("message",function(t){if(t.data&&t.data.vscodeScheduleAsyncWork)for(var i=0,n=e.length;i<n;i++){var r=e[i];if(r.id===t.data.vscodeScheduleAsyncWork){e.splice(i,1),r.callback();return}}});var t=0;return function(i){var n=++t;e.push({id:n,callback:i}),ii.postMessage({vscodeScheduleAsyncWork:n},"*")}}return function(e){return setTimeout(e)}}(),i_=!!(iu&&iu.indexOf("Chrome")>=0);iu&&iu.indexOf("Firefox"),!i_&&iu&&iu.indexOf("Safari"),iu&&iu.indexOf("Edg/"),iu&&iu.indexOf("Android");var ig=("undefined"==typeof navigator?"undefined":(0,S._)(navigator))=="object"?navigator:{};il||document.queryCommandSupported&&document.queryCommandSupported("copy")||ig&&ig.clipboard&&ig.clipboard.writeText,il||ig&&ig.clipboard&&ig.clipboard.readText,il||t2||ig.keyboard,"ontouchstart"in t0||ig.maxTouchPoints,t0.PointerEvent&&("ontouchstart"in t0||navigator.maxTouchPoints);var iy=function(){function e(){(0,p._)(this,e),this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}return(0,m._)(e,[{key:"define",value:function(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}},{key:"keyCodeToStr",value:function(e){return this._keyCodeToStr[e]}},{key:"strToKeyCode",value:function(e){return this._strToKeyCode[e.toLowerCase()]||0}}]),e}(),ip=new iy,im=new iy,ix=new iy;(iC=ib||(ib={})).toString=function(e){return ip.keyCodeToStr(e)},iC.fromString=function(e){return ip.strToKeyCode(e)},iC.toUserSettingsUS=function(e){return im.keyCodeToStr(e)},iC.toUserSettingsGeneral=function(e){return ix.keyCodeToStr(e)},iC.fromUserSettings=function(e){return im.strToKeyCode(e)||ix.strToKeyCode(e)},iC.toElectronAccelerator=function(e){if(e>=98&&e<=113)return null;switch(e){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return ip.keyCodeToStr(e)};var iw,iC,ib,iL,ik=Object.freeze(function(e,t){var i=setTimeout(e.bind(t),0);return{dispose:function(){clearTimeout(i)}}});(t=iL||(iL={})).isCancellationToken=function(e){return!!(e===t.None||e===t.Cancelled||(0,L._)(e,iM))||!!e&&(void 0===e?"undefined":(0,S._)(e))=="object"&&"boolean"==typeof e.isCancellationRequested&&"function"==typeof e.onCancellationRequested},t.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:e9.None}),t.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:ik});var iM=function(){function e(){(0,p._)(this,e),this._isCancelled=!1,this._emitter=null}return(0,m._)(e,[{key:"cancel",value:function(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}},{key:"isCancellationRequested",get:function(){return this._isCancelled}},{key:"onCancellationRequested",get:function(){return this._isCancelled?ik:(this._emitter||(this._emitter=new ty),this._emitter.event)}},{key:"dispose",value:function(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}]),e}();Symbol("MicrotaskDelay"),(i=f||(f={})).settled=function(e){return(0,g._)(function(){var t,i;return(0,R._)(this,function(n){switch(n.label){case 0:return[4,Promise.all(e.map(function(e){return e.then(function(e){return e},function(e){t||(t=e)})}))];case 1:if(i=n.sent(),(void 0===t?"undefined":(0,S._)(t))<"u")throw t;return[2,i]}})})()},i.withAsyncBody=function(e){return new Promise(function(t,i){return(0,g._)(function(){return(0,R._)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e(t,i)];case 1:return n.sent(),[3,3];case 2:return i(n.sent()),[3,3];case 3:return[2]}})})()})};var iS=function(){function e(t,i){var n=this;(0,p._)(this,e),this._state=0,this._results=[],this._error=null,this._onReturn=i,this._onStateChanged=new ty,queueMicrotask(function(){return(0,g._)(function(){var e,i,n;return(0,R._)(this,function(r){switch(r.label){case 0:e=this,i={emitOne:function(t){return e.emitOne(t)},emitMany:function(t){return e.emitMany(t)},reject:function(t){return e.reject(t)}},r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,Promise.resolve(t(i))];case 2:return r.sent(),this.resolve(),[3,5];case 3:return n=r.sent(),this.reject(n),[3,5];case 4:return i.emitOne=void 0,i.emitMany=void 0,i.reject=void 0,[7];case 5:return[2]}})}).call(n)})}return(0,m._)(e,[{key:Symbol.asyncIterator,value:function(){var e=this,t=0;return{next:function(){return(0,g._)(function(){return(0,R._)(this,function(e){switch(e.label){case 0:if(2===this._state)throw this._error;if(t<this._results.length)return[2,{done:!1,value:this._results[t++]}];if(1===this._state)return[2,{done:!0,value:void 0}];return[4,e9.toPromise(this._onStateChanged.event)];case 1:e.sent(),e.label=2;case 2:return[3,0];case 3:return[2]}})}).call(e)},return:function(){return(0,g._)(function(){var e,t;return(0,R._)(this,function(i){return[2,(null==(e=(t=this)._onReturn)||e.call(t),{done:!0,value:void 0})]})}).call(e)}}}},{key:"map",value:function(t){return e.map(this,t)}},{key:"filter",value:function(t){return e.filter(this,t)}},{key:"coalesce",value:function(){return e.coalesce(this)}},{key:"toPromise",value:function(){return e.toPromise(this)}},{key:"emitOne",value:function(e){0===this._state&&(this._results.push(e),this._onStateChanged.fire())}},{key:"emitMany",value:function(e){0===this._state&&(this._results=this._results.concat(e),this._onStateChanged.fire())}},{key:"resolve",value:function(){0===this._state&&(this._state=1,this._onStateChanged.fire())}},{key:"reject",value:function(e){0===this._state&&(this._state=2,this._error=e,this._onStateChanged.fire())}}],[{key:"fromArray",value:function(t){return new e(function(e){e.emitMany(t)})}},{key:"fromPromise",value:function(t){return new e(function(e){return(0,g._)(function(){var i;return(0,R._)(this,function(n){switch(n.label){case 0:return i=e.emitMany,[4,t];case 1:return i.apply(e,[n.sent()]),[2]}})})()})}},{key:"fromPromises",value:function(t){return new e(function(e){return(0,g._)(function(){return(0,R._)(this,function(i){switch(i.label){case 0:return[4,Promise.all(t.map(function(t){return(0,g._)(function(){var i;return(0,R._)(this,function(n){switch(n.label){case 0:return i=e.emitOne,[4,t];case 1:return[2,i.apply(e,[n.sent()])]}})})()}))];case 1:return i.sent(),[2]}})})()})}},{key:"merge",value:function(t){return new e(function(e){return(0,g._)(function(){return(0,R._)(this,function(i){switch(i.label){case 0:return[4,Promise.all(t.map(function(t){return(0,g._)(function(){var i,n,r,s,a,o,l;return(0,R._)(this,function(c){switch(c.label){case 0:i=!1,n=!1,c.label=1;case 1:c.trys.push([1,6,7,12]),s=(0,_._)(t),c.label=2;case 2:return[4,s.next()];case 3:if(!(i=!(a=c.sent()).done))return[3,5];o=a.value,e.emitOne(o),c.label=4;case 4:return i=!1,[3,2];case 5:return[3,12];case 6:return l=c.sent(),n=!0,r=l,[3,12];case 7:if(c.trys.push([7,,10,11]),!(i&&null!=s.return))return[3,9];return[4,s.return()];case 8:c.sent(),c.label=9;case 9:return[3,11];case 10:if(n)throw r;return[7];case 11:return[7];case 12:return[2]}})})()}))];case 1:return i.sent(),[2]}})})()})}},{key:"map",value:function(t,i){return new e(function(e){return(0,g._)(function(){var n,r,s,a,o,l,c;return(0,R._)(this,function(u){switch(u.label){case 0:n=!1,r=!1,u.label=1;case 1:u.trys.push([1,6,7,12]),a=(0,_._)(t),u.label=2;case 2:return[4,a.next()];case 3:if(!(n=!(o=u.sent()).done))return[3,5];l=o.value,e.emitOne(i(l)),u.label=4;case 4:return n=!1,[3,2];case 5:return[3,12];case 6:return c=u.sent(),r=!0,s=c,[3,12];case 7:if(u.trys.push([7,,10,11]),!(n&&null!=a.return))return[3,9];return[4,a.return()];case 8:u.sent(),u.label=9;case 9:return[3,11];case 10:if(r)throw s;return[7];case 11:return[7];case 12:return[2]}})})()})}},{key:"filter",value:function(t,i){return new e(function(e){return(0,g._)(function(){var n,r,s,a,o,l,c;return(0,R._)(this,function(u){switch(u.label){case 0:n=!1,r=!1,u.label=1;case 1:u.trys.push([1,6,7,12]),a=(0,_._)(t),u.label=2;case 2:return[4,a.next()];case 3:if(!(n=!(o=u.sent()).done))return[3,5];i(l=o.value)&&e.emitOne(l),u.label=4;case 4:return n=!1,[3,2];case 5:return[3,12];case 6:return c=u.sent(),r=!0,s=c,[3,12];case 7:if(u.trys.push([7,,10,11]),!(n&&null!=a.return))return[3,9];return[4,a.return()];case 8:u.sent(),u.label=9;case 9:return[3,11];case 10:if(r)throw s;return[7];case 11:return[7];case 12:return[2]}})})()})}},{key:"coalesce",value:function(t){return e.filter(t,function(e){return!!e})}},{key:"toPromise",value:function(e){return(0,g._)(function(){var t,i,n,r,s,a,o,l;return(0,R._)(this,function(c){switch(c.label){case 0:t=[],i=!1,n=!1,c.label=1;case 1:c.trys.push([1,6,7,12]),s=(0,_._)(e),c.label=2;case 2:return[4,s.next()];case 3:if(!(i=!(a=c.sent()).done))return[3,5];o=a.value,t.push(o),c.label=4;case 4:return i=!1,[3,2];case 5:return[3,12];case 6:return l=c.sent(),n=!0,r=l,[3,12];case 7:if(c.trys.push([7,,10,11]),!(i&&null!=s.return))return[3,9];return[4,s.return()];case 8:c.sent(),c.label=9;case 9:return[3,11];case 10:if(n)throw r;return[7];case 11:return[7];case 12:return[2,t]}})})()}}]),e}();function iA(e){return 56320<=e&&e<=57343}iS.EMPTY=iS.fromArray([]);function iR(e,t){return(t<<5)-t+e|0}function iT(e,t){t=iR(149417,t);for(var i=0,n=e.length;i<n;i++)t=iR(e.charCodeAt(i),t);return t}function iE(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,n=i-t;return(e<<t|(~((1<<n)-1)&e)>>>n)>>>0}function iB(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.byteLength,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=0;r<i;r++)e[t+r]=n}function iD(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32;return(0,L._)(e,ArrayBuffer)?Array.from(new Uint8Array(e)).map(function(e){return e.toString(16).padStart(2,"0")}).join(""):function(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";e.length<t;)e=i+e;return e}((e>>>0).toString(16),t/4)}(function(){function e(){(0,p._)(this,e),this._h0=0x67452301,this._h1=0xefcdab89,this._h2=0x98badcfe,this._h3=0x10325476,this._h4=0xc3d2e1f0,this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}return(0,m._)(e,[{key:"update",value:function(e){var t=e.length;if(0!==t){var i,n,r=this._buff,s=this._buffLen,a=this._leftoverHighSurrogate;for(0!==a?(i=a,n=-1,a=0):(i=e.charCodeAt(0),n=0);;){var o,l=i;if(55296<=(o=i)&&o<=56319)if(n+1<t){var c=e.charCodeAt(n+1);iA(c)?(n++,l=(i-55296<<10)+(c-56320)+65536):l=65533}else{a=i;break}else iA(i)&&(l=65533);if(s=this._push(r,s,l),++n<t)i=e.charCodeAt(n);else break}this._buffLen=s,this._leftoverHighSurrogate=a}}},{key:"_push",value:function(e,t,i){return i<128?e[t++]=i:(i<2048?e[t++]=192|(1984&i)>>>6:(i<65536?e[t++]=224|(61440&i)>>>12:(e[t++]=240|(1835008&i)>>>18,e[t++]=128|(258048&i)>>>12),e[t++]=128|(4032&i)>>>6),e[t++]=128|(63&i)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),t}},{key:"digest",value:function(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),iD(this._h0)+iD(this._h1)+iD(this._h2)+iD(this._h3)+iD(this._h4)}},{key:"_wrapUp",value:function(){this._buff[this._buffLen++]=128,iB(this._buff,this._buffLen),this._buffLen>56&&(this._step(),iB(this._buff));var e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/0x100000000),!1),this._buffDV.setUint32(60,e%0x100000000,!1),this._step()}},{key:"_step",value:function(){for(var t=e._bigBlock32,i=this._buffDV,n=0;n<64;n+=4)t.setUint32(n,i.getUint32(n,!1),!1);for(var r=64;r<320;r+=4)t.setUint32(r,iE(t.getUint32(r-12,!1)^t.getUint32(r-32,!1)^t.getUint32(r-56,!1)^t.getUint32(r-64,!1),1),!1);for(var s,a,o,l=this._h0,c=this._h1,u=this._h2,h=this._h3,d=this._h4,f=0;f<80;f++)f<20?(s=c&u|~c&h,a=0x5a827999):f<40?(s=c^u^h,a=0x6ed9eba1):f<60?(s=c&u|c&h|u&h,a=0x8f1bbcdc):(s=c^u^h,a=0xca62c1d6),o=iE(l,5)+s+d+a+t.getUint32(4*f,!1)|0,d=h,h=u,u=iE(c,30),c=l,l=o;this._h0=this._h0+l|0,this._h1=this._h1+c|0,this._h2=this._h2+u|0,this._h3=this._h3+h|0,this._h4=this._h4+d|0}}]),e})()._bigBlock32=new DataView(new ArrayBuffer(320));var iP=(n=new Map,r={window:t0,disposables:new H},n.set(t0.vscodeWindowId,r),s=new ty,a=new ty,o=new ty,{onDidRegisterWindow:s.event,onWillUnregisterWindow:o.event,onDidUnregisterWindow:a.event,registerWindow:function(e){if(n.has(e.vscodeWindowId))return V.None;var t,i,r=new H,l={window:e,disposables:r.add(new H)};return n.set(e.vscodeWindowId,l),r.add(G(function(){n.delete(e.vscodeWindowId),a.fire(e)})),r.add((t=e,i=iU.BEFORE_UNLOAD,new iW(t,i,function(){o.fire(e)},void 0))),s.fire(l),r},getWindows:function(){return n.values()},getWindowsCount:function(){return n.size},getWindowId:function(e){return e.vscodeWindowId},hasWindow:function(e){return n.has(e)},getWindowById:function(e,t){var i;return null!=(i="number"==typeof e?n.get(e):void 0)?i:t?r:void 0},getWindow:function(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)?e.ownerDocument.defaultView.window:(null==e?void 0:e.view)?e.view.window:t0},getDocument:function(e){return iF(e).document}}),iF=(iP.registerWindow,iP.getWindow),iI=(iP.getDocument,iP.getWindows,iP.getWindowsCount,iP.getWindowId);iP.getWindowById,iP.hasWindow,iP.onDidRegisterWindow,iP.onWillUnregisterWindow,iP.onDidUnregisterWindow;var iW=function(){function e(t,i,n,r){(0,p._)(this,e),this._node=t,this._type=i,this._handler=n,this._options=r||!1,this._node.addEventListener(this._type,this._handler,this._options)}return(0,m._)(e,[{key:"dispose",value:function(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}]),e}(),iz=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,p._)(this,e),this._runner=t,this.priority=i,this._canceled=!1}return(0,m._)(e,[{key:"dispose",value:function(){this._canceled=!0}},{key:"execute",value:function(){if(!this._canceled)try{this._runner()}catch(e){B(e)}}}],[{key:"sort",value:function(e,t){return t.priority-e.priority}}]),e}();l=new Map,c=new Map,u=new Map,h=new Map,d=function(e){u.set(e,!1);var t,i=null!=(t=l.get(e))?t:[];for(c.set(e,i),l.set(e,[]),h.set(e,!0);i.length>0;)i.sort(iz.sort),i.shift().execute();h.set(e,!1)};var iO=function(){function e(t,i){(0,p._)(this,e),this.width=t,this.height=i}return(0,m._)(e,[{key:"with",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.width,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.height;return t!==this.width||i!==this.height?new e(t,i):this}}],[{key:"is",value:function(e){return(void 0===e?"undefined":(0,S._)(e))=="object"&&"number"==typeof e.height&&"number"==typeof e.width}},{key:"lift",value:function(t){return(0,L._)(t,e)?t:new e(t.width,t.height)}},{key:"equals",value:function(e,t){return e===t||!!e&&!!t&&e.width===t.width&&e.height===t.height}}]),e}();iO.None=new iO(0,0),new(function(){function e(){(0,p._)(this,e),this.mutationObservers=new Map}return(0,m._)(e,[{key:"observe",value:function(e,t,i){var n=this,r=this.mutationObservers.get(e);r||(r=new Map,this.mutationObservers.set(e,r));var s=function e(t,i){switch(void 0===t?"undefined":(0,S._)(t)){case"object":var n,r,s,a;return null===t?iR(349,i):Array.isArray(t)?(n=t,r=iR(104579,r=i),n.reduce(function(t,i){return e(i,t)},r)):(s=t,a=iR(181387,a=i),Object.keys(s).sort().reduce(function(t,i){return t=iT(i,t),e(s[i],t)},a));case"string":return iT(t,i);case"boolean":return iR(t?433:863,i);case"number":return iR(t,i);case"undefined":return iR(937,i);default:return iR(617,i)}}(i,0),a=r.get(s);if(a)a.users+=1;else{var o=new ty,l=new MutationObserver(function(e){return o.fire(e)});l.observe(e,i);var c=a={users:1,observer:l,onDidMutate:o.event};t.add(G(function(){c.users-=1,0===c.users&&(o.dispose(),l.disconnect(),null==r||r.delete(s),(null==r?void 0:r.size)===0&&n.mutationObservers.delete(e))})),r.set(s,a)}return a.onDidMutate}}]),e}());var iU={BEFORE_UNLOAD:"beforeunload"},iN=function(e){function t(e,i,n,r,s,a,o,l,c){var u,h;if((0,p._)(this,t),(u=(0,y._)(this,t))._terminal=e,u._characterJoinerService=i,u._charSizeService=n,u._coreBrowserService=r,u._coreService=s,u._decorationService=a,u._optionsService=o,u._themeService=l,u._cursorBlinkStateManager=new j,u._charAtlasDisposable=u._register(new j),u._observerDisposable=u._register(new j),u._model=new tq,u._workCell=new tT,u._workCell2=new tT,u._rectangleRenderer=u._register(new j),u._glyphRenderer=u._register(new j),u._onChangeTextureAtlas=u._register(new ty),u.onChangeTextureAtlas=u._onChangeTextureAtlas.event,u._onAddTextureAtlasCanvas=u._register(new ty),u.onAddTextureAtlasCanvas=u._onAddTextureAtlasCanvas.event,u._onRemoveTextureAtlasCanvas=u._register(new ty),u.onRemoveTextureAtlasCanvas=u._onRemoveTextureAtlasCanvas.event,u._onRequestRedraw=u._register(new ty),u.onRequestRedraw=u._onRequestRedraw.event,u._onContextLoss=u._register(new ty),u.onContextLoss=u._onContextLoss.event,u._canvas=u._coreBrowserService.mainDocument.createElement("canvas"),u._gl=u._canvas.getContext("webgl2",{antialias:!1,depth:!1,preserveDrawingBuffer:c}),!u._gl)throw Error("WebGL2 not supported "+u._gl);return u._register(u._themeService.onChangeColors(function(){return u._handleColorChange()})),u._cellColorResolver=new eU(u._terminal,u._optionsService,u._model.selection,u._decorationService,u._coreBrowserService,u._themeService),u._core=u._terminal._core,u._renderLayers=[new t$(u._core.screenElement,2,u._terminal,u._core.linkifier,u._coreBrowserService,o,u._themeService)],u.dimensions={css:{canvas:ex(),cell:ex()},device:{canvas:ex(),cell:ex(),char:{width:0,height:0,left:0,top:0}}},u._devicePixelRatio=u._coreBrowserService.dpr,u._updateDimensions(),u._updateCursorBlink(),u._register(o.onOptionChange(function(){return u._handleOptionsChanged()})),u._deviceMaxTextureSize=u._gl.getParameter(u._gl.MAX_TEXTURE_SIZE),u._register(new iW(u._canvas,"webglcontextlost",function(e){console.log("webglcontextlost event received"),e.preventDefault(),u._contextRestorationTimeout=setTimeout(function(){u._contextRestorationTimeout=void 0,console.warn("webgl context not restored; firing onContextLoss"),u._onContextLoss.fire(e)},3e3)},void 0)),u._register(new iW(u._canvas,"webglcontextrestored",function(e){console.warn("webglcontextrestored event received"),clearTimeout(u._contextRestorationTimeout),u._contextRestorationTimeout=void 0,tS(u._terminal),u._initializeWebGLState(),u._requestRedrawViewport()},void 0)),u._observerDisposable.value=tR(u._canvas,u._coreBrowserService.window,function(e,t){return u._setCanvasDevicePixelDimensions(e,t)}),u._register(u._coreBrowserService.onWindowChange(function(e){u._observerDisposable.value=tR(u._canvas,e,function(e,t){return u._setCanvasDevicePixelDimensions(e,t)})})),u._core.screenElement.appendChild(u._canvas),h=(0,k._)(u._initializeWebGLState(),2),u._rectangleRenderer.value=h[0],u._glyphRenderer.value=h[1],u._isAttached=u._core.screenElement.isConnected,u._register(G(function(){var e=!0,t=!1,i=void 0;try{for(var n,r,s=u._renderLayers[Symbol.iterator]();!(e=(r=s.next()).done);e=!0)r.value.dispose()}catch(e){t=!0,i=e}finally{try{e||null==s.return||s.return()}finally{if(t)throw i}}null==(n=u._canvas.parentElement)||n.removeChild(u._canvas),tS(u._terminal)})),u}return(0,b._)(t,e),(0,m._)(t,[{key:"textureAtlas",get:function(){var e;return null==(e=this._charAtlas)?void 0:e.pages[0].canvas}},{key:"_handleColorChange",value:function(){this._refreshCharAtlas(),this._clearModel(!0)}},{key:"handleDevicePixelRatioChange",value:function(){this._devicePixelRatio!==this._coreBrowserService.dpr&&(this._devicePixelRatio=this._coreBrowserService.dpr,this.handleResize(this._terminal.cols,this._terminal.rows))}},{key:"handleResize",value:function(e,t){this._updateDimensions(),this._model.resize(this._terminal.cols,this._terminal.rows);var i=!0,n=!1,r=void 0;try{for(var s,a,o,l,c,u=this._renderLayers[Symbol.iterator]();!(i=(c=u.next()).done);i=!0)c.value.resize(this._terminal,this.dimensions)}catch(e){n=!0,r=e}finally{try{i||null==u.return||u.return()}finally{if(n)throw r}}this._canvas.width=this.dimensions.device.canvas.width,this._canvas.height=this.dimensions.device.canvas.height,this._canvas.style.width="".concat(this.dimensions.css.canvas.width,"px"),this._canvas.style.height="".concat(this.dimensions.css.canvas.height,"px"),this._core.screenElement.style.width="".concat(this.dimensions.css.canvas.width,"px"),this._core.screenElement.style.height="".concat(this.dimensions.css.canvas.height,"px"),null==(s=this._rectangleRenderer.value)||s.setDimensions(this.dimensions),null==(a=this._rectangleRenderer.value)||a.handleResize(),null==(o=this._glyphRenderer.value)||o.setDimensions(this.dimensions),null==(l=this._glyphRenderer.value)||l.handleResize(),this._refreshCharAtlas(),this._clearModel(!1)}},{key:"handleCharSizeChanged",value:function(){this.handleResize(this._terminal.cols,this._terminal.rows)}},{key:"handleBlur",value:function(){var e=!0,t=!1,i=void 0;try{for(var n,r,s=this._renderLayers[Symbol.iterator]();!(e=(r=s.next()).done);e=!0)r.value.handleBlur(this._terminal)}catch(e){t=!0,i=e}finally{try{e||null==s.return||s.return()}finally{if(t)throw i}}null==(n=this._cursorBlinkStateManager.value)||n.pause(),this._requestRedrawViewport()}},{key:"handleFocus",value:function(){var e=!0,t=!1,i=void 0;try{for(var n,r,s=this._renderLayers[Symbol.iterator]();!(e=(r=s.next()).done);e=!0)r.value.handleFocus(this._terminal)}catch(e){t=!0,i=e}finally{try{e||null==s.return||s.return()}finally{if(t)throw i}}null==(n=this._cursorBlinkStateManager.value)||n.resume(),this._requestRedrawViewport()}},{key:"handleSelectionChanged",value:function(e,t,i){var n=!0,r=!1,s=void 0;try{for(var a,o=this._renderLayers[Symbol.iterator]();!(n=(a=o.next()).done);n=!0)a.value.handleSelectionChanged(this._terminal,e,t,i)}catch(e){r=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw s}}this._model.selection.update(this._core,e,t,i),this._requestRedrawViewport()}},{key:"handleCursorMove",value:function(){var e=!0,t=!1,i=void 0;try{for(var n,r,s=this._renderLayers[Symbol.iterator]();!(e=(r=s.next()).done);e=!0)r.value.handleCursorMove(this._terminal)}catch(e){t=!0,i=e}finally{try{e||null==s.return||s.return()}finally{if(t)throw i}}null==(n=this._cursorBlinkStateManager.value)||n.restartBlinkAnimation()}},{key:"_handleOptionsChanged",value:function(){this._updateDimensions(),this._refreshCharAtlas(),this._updateCursorBlink()}},{key:"_initializeWebGLState",value:function(){return this._rectangleRenderer.value=new tJ(this._terminal,this._gl,this.dimensions,this._themeService),this._glyphRenderer.value=new tU(this._terminal,this._gl,this.dimensions,this._optionsService),this.handleCharSizeChanged(),[this._rectangleRenderer.value,this._glyphRenderer.value]}},{key:"_refreshCharAtlas",value:function(){if(this.dimensions.device.char.width<=0&&this.dimensions.device.char.height<=0){this._isAttached=!1;return}var e,t=tM(this._terminal,this._optionsService.rawOptions,this._themeService.colors,this.dimensions.device.cell.width,this.dimensions.device.cell.height,this.dimensions.device.char.width,this.dimensions.device.char.height,this._coreBrowserService.dpr,this._deviceMaxTextureSize);this._charAtlas!==t&&(this._onChangeTextureAtlas.fire(t.pages[0].canvas),this._charAtlasDisposable.value=q(e9.forward(t.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas),e9.forward(t.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas))),this._charAtlas=t,this._charAtlas.warmUp(),null==(e=this._glyphRenderer.value)||e.setAtlas(this._charAtlas)}},{key:"_clearModel",value:function(e){var t;this._model.clear(),e&&(null==(t=this._glyphRenderer.value)||t.clear())}},{key:"clearTextureAtlas",value:function(){var e;null==(e=this._charAtlas)||e.clearTexture(),this._clearModel(!0),this._requestRedrawViewport()}},{key:"clear",value:function(){this._clearModel(!0);var e=!0,t=!1,i=void 0;try{for(var n,r,s=this._renderLayers[Symbol.iterator]();!(e=(r=s.next()).done);e=!0)r.value.reset(this._terminal)}catch(e){t=!0,i=e}finally{try{e||null==s.return||s.return()}finally{if(t)throw i}}null==(n=this._cursorBlinkStateManager.value)||n.restartBlinkAnimation(),this._updateCursorBlink()}},{key:"renderRows",value:function(e,t){if(!this._isAttached)if(null==(s=this._core.screenElement)||!s.isConnected||!this._charSizeService.width||!this._charSizeService.height)return;else this._updateDimensions(),this._refreshCharAtlas(),this._isAttached=!0;var i=!0,n=!1,r=void 0;try{for(var s,a,o=this._renderLayers[Symbol.iterator]();!(i=(a=o.next()).done);i=!0)a.value.handleGridChanged(this._terminal,e,t)}catch(e){n=!0,r=e}finally{try{i||null==o.return||o.return()}finally{if(n)throw r}}this._glyphRenderer.value&&this._rectangleRenderer.value&&(this._glyphRenderer.value.beginFrame()?(this._clearModel(!0),this._updateModel(0,this._terminal.rows-1)):this._updateModel(e,t),this._rectangleRenderer.value.renderBackgrounds(),this._glyphRenderer.value.render(this._model),(!this._cursorBlinkStateManager.value||this._cursorBlinkStateManager.value.isCursorVisible)&&this._rectangleRenderer.value.renderCursor())}},{key:"_updateCursorBlink",value:function(){var e,t=this;(null!=(e=this._coreService.decPrivateModes.cursorBlink)?e:this._terminal.options.cursorBlink)?this._cursorBlinkStateManager.value=new tA(function(){t._requestRedrawCursor()},this._coreBrowserService):this._cursorBlinkStateManager.clear(),this._requestRedrawCursor()}},{key:"_updateModel",value:function(e,t){var i,n,r,s,a,o,l,c,u,h,d,f,v,_,g,y,p,m=this._core,x=this._workCell,w=0,C=!0;e=iG(e,m.rows-1,0),t=iG(t,m.rows-1,0);var b=null!=(n=null!=(i=this._coreService.decPrivateModes.cursorStyle)?i:m.options.cursorStyle)?n:"block",L=this._terminal.buffer.active.baseY+this._terminal.buffer.active.cursorY,k=L-m.buffer.ydisp,M=Math.min(this._terminal.buffer.active.cursorX,m.cols-1),S=-1,A=this._coreService.isCursorInitialized&&!this._coreService.isCursorHidden&&(!this._cursorBlinkStateManager.value||this._cursorBlinkStateManager.value.isCursorVisible);this._model.cursor=void 0;var R=!1;for(s=e;s<=t;s++)for(a=s+m.buffer.ydisp,o=m.buffer.lines.get(a),this._model.lineLengths[s]=0,d=L===a,w=0,l=this._characterJoinerService.getJoinedCharacters(a),y=0;y<m.cols;y++){if(r=this._cellColorResolver.result.bg,o.loadCell(y,x),0===y&&(r=this._cellColorResolver.result.bg),c=!1,C=y>=w,u=y,l.length>0&&y===l[0][0]&&C){h=l.shift();var T=this._model.selection.isCellSelected(this._terminal,h[0],a);for(g=h[0]+1;g<h[1];g++)C&&(C=T===this._model.selection.isCellSelected(this._terminal,g,a));C&&(C=!d||M<h[0]||M>=h[1]),C?(c=!0,x=new iq(x,o.translateToString(!0,h[0],h[1]),h[1]-h[0]),u=h[1]-1):w=h[1]}if(f=x.getChars(),v=x.getCode(),g=(s*m.cols+y)*4,this._cellColorResolver.resolve(x,y,a,this.dimensions.device.cell.width),A&&a===L&&(y===M&&(this._model.cursor={x:M,y:k,width:x.getWidth(),style:this._coreBrowserService.isFocused?b:m.options.cursorInactiveStyle,cursorWidth:m.options.cursorWidth,dpr:this._devicePixelRatio},S=M+x.getWidth()-1),y>=M&&y<=S&&(this._coreBrowserService.isFocused&&"block"===b||!1===this._coreBrowserService.isFocused&&"block"===m.options.cursorInactiveStyle)&&(this._cellColorResolver.result.fg=0x3000000|this._themeService.colors.cursorAccent.rgba>>8&0xffffff,this._cellColorResolver.result.bg=0x3000000|this._themeService.colors.cursor.rgba>>8&0xffffff)),0!==v&&(this._model.lineLengths[s]=y+1),(this._model.cells[g]!==v||this._model.cells[g+1]!==this._cellColorResolver.result.bg||this._model.cells[g+2]!==this._cellColorResolver.result.fg||this._model.cells[g+3]!==this._cellColorResolver.result.ext)&&(R=!0,f.length>1&&(v|=0x80000000),this._model.cells[g]=v,this._model.cells[g+1]=this._cellColorResolver.result.bg,this._model.cells[g+2]=this._cellColorResolver.result.fg,this._model.cells[g+3]=this._cellColorResolver.result.ext,_=x.getWidth(),this._glyphRenderer.value.updateCell(y,s,v,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext,f,_,r),c)){for(x=this._workCell,y++;y<=u;y++)p=(s*m.cols+y)*4,this._glyphRenderer.value.updateCell(y,s,0,0,0,0,"",0,0),this._model.cells[p]=0,this._model.cells[p+1]=this._cellColorResolver.result.bg,this._model.cells[p+2]=this._cellColorResolver.result.fg,this._model.cells[p+3]=this._cellColorResolver.result.ext;y--}}R&&this._rectangleRenderer.value.updateBackgrounds(this._model),this._rectangleRenderer.value.updateCursor(this._model)}},{key:"_updateDimensions",value:function(){this._charSizeService.width&&this._charSizeService.height&&(this.dimensions.device.char.width=Math.floor(this._charSizeService.width*this._devicePixelRatio),this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*this._devicePixelRatio),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.top=1===this._optionsService.rawOptions.lineHeight?0:Math.round((this.dimensions.device.cell.height-this.dimensions.device.char.height)/2),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.char.left=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.device.canvas.height=this._terminal.rows*this.dimensions.device.cell.height,this.dimensions.device.canvas.width=this._terminal.cols*this.dimensions.device.cell.width,this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/this._devicePixelRatio),this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/this._devicePixelRatio),this.dimensions.css.cell.height=this.dimensions.device.cell.height/this._devicePixelRatio,this.dimensions.css.cell.width=this.dimensions.device.cell.width/this._devicePixelRatio)}},{key:"_setCanvasDevicePixelDimensions",value:function(e,t){this._canvas.width===e&&this._canvas.height===t||(this._canvas.width=e,this._canvas.height=t,this._requestRedrawViewport())}},{key:"_requestRedrawViewport",value:function(){this._onRequestRedraw.fire({start:0,end:this._terminal.rows-1})}},{key:"_requestRedrawCursor",value:function(){var e=this._terminal.buffer.active.cursorY;this._onRequestRedraw.fire({start:e,end:e})}}]),t}(V),iq=function(e){function t(e,i,n){var r;return(0,p._)(this,t),(r=(0,y._)(this,t)).content=0,r.combinedData="",r.fg=e.fg,r.bg=e.bg,r.combinedData=i,r._width=n,r}return(0,b._)(t,e),(0,m._)(t,[{key:"isCombined",value:function(){return 2097152}},{key:"getWidth",value:function(){return this._width}},{key:"getChars",value:function(){return this.combinedData}},{key:"getCode",value:function(){return 2097151}},{key:"setFromCharData",value:function(e){throw Error("not implemented")}},{key:"getAsCharData",value:function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}]),t}(e1);function iG(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.max(Math.min(e,t),i)}var iH="di$target",iV="di$dependencies",ij=new Map;function iY(e){if(ij.has(e))return ij.get(e);var t=function(e,i,n){var r,s,a;if(3!=arguments.length)throw Error("@IServiceName-decorator can only be used to decorate a parameter");r=t,s=e,a=n,s[iH]===s?s[iV].push({id:r,index:a}):(s[iV]=[{id:r,index:a}],s[iH]=s)};return t._id=e,ij.set(e,t),t}iY("BufferService"),iY("CoreMouseService"),iY("CoreService"),iY("CharsetService"),iY("InstantiationService"),iY("LogService");var iX=iY("OptionsService");iY("OscLinkService"),iY("UnicodeService"),iY("DecorationService");var iZ={trace:0,debug:1,info:2,warn:3,error:4,off:5},iQ=function(e){function t(e){var i;return(0,p._)(this,t),(i=(0,y._)(this,t))._optionsService=e,i._logLevel=5,i._updateLogLevel(),i._register(i._optionsService.onSpecificOptionChange("logLevel",function(){return i._updateLogLevel()})),i}return(0,b._)(t,e),(0,m._)(t,[{key:"logLevel",get:function(){return this._logLevel}},{key:"_updateLogLevel",value:function(){this._logLevel=iZ[this._optionsService.rawOptions.logLevel]}},{key:"_evalLazyOptionalParams",value:function(e){for(var t=0;t<e.length;t++)"function"==typeof e[t]&&(e[t]=e[t]())}},{key:"_log",value:function(e,t,i){this._evalLazyOptionalParams(i),e.call.apply(e,[console,(this._optionsService.options.logger?"":"xterm.js: ")+t].concat((0,M._)(i)))}},{key:"trace",value:function(e){for(var t,i,n=arguments.length,r=Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];this._logLevel<=0&&this._log(null!=(i=null==(t=this._optionsService.options.logger)?void 0:t.trace.bind(this._optionsService.options.logger))?i:console.log,e,r)}},{key:"debug",value:function(e){for(var t,i,n=arguments.length,r=Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];this._logLevel<=1&&this._log(null!=(i=null==(t=this._optionsService.options.logger)?void 0:t.debug.bind(this._optionsService.options.logger))?i:console.log,e,r)}},{key:"info",value:function(e){for(var t,i,n=arguments.length,r=Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];this._logLevel<=2&&this._log(null!=(i=null==(t=this._optionsService.options.logger)?void 0:t.info.bind(this._optionsService.options.logger))?i:console.info,e,r)}},{key:"warn",value:function(e){for(var t,i,n=arguments.length,r=Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];this._logLevel<=3&&this._log(null!=(i=null==(t=this._optionsService.options.logger)?void 0:t.warn.bind(this._optionsService.options.logger))?i:console.warn,e,r)}},{key:"error",value:function(e){for(var t,i,n=arguments.length,r=Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];this._logLevel<=4&&this._log(null!=(i=null==(t=this._optionsService.options.logger)?void 0:t.error.bind(this._optionsService.options.logger))?i:console.error,e,r)}}]),t}(V);iQ=function(e,t,i,n){for(var r,s=t,a=e.length-1;a>=0;a--)(r=e[a])&&(s=r(s)||s);return s}([function(e,t){return iX(e,t,0)}],iQ);var iK=function(e){function t(e){if((0,p._)(this,t),J&&16>function(){if(!J)return 0;var e=X.match(/Version\/(\d+)/);return null===e||e.length<2?0:parseInt(e[1])}()){var i;if(!document.createElement("canvas").getContext("webgl2",{antialias:!1,depth:!1,preserveDrawingBuffer:!0}))throw Error("Webgl2 is only supported on Safari 16 and above")}return(i=(0,y._)(this,t))._preserveDrawingBuffer=e,i._onChangeTextureAtlas=i._register(new ty),i.onChangeTextureAtlas=i._onChangeTextureAtlas.event,i._onAddTextureAtlasCanvas=i._register(new ty),i.onAddTextureAtlasCanvas=i._onAddTextureAtlasCanvas.event,i._onRemoveTextureAtlasCanvas=i._register(new ty),i.onRemoveTextureAtlasCanvas=i._onRemoveTextureAtlasCanvas.event,i._onContextLoss=i._register(new ty),i.onContextLoss=i._onContextLoss.event,i}return(0,b._)(t,e),(0,m._)(t,[{key:"activate",value:function(e){var t=this,i=e._core;if(!e.element)return void this._register(i.onWillOpen(function(){return t.activate(e)}));this._terminal=e;var n=i.coreService,r=i.optionsService,s=i._renderService,a=i._characterJoinerService,o=i._charSizeService,l=i._coreBrowserService,c=i._decorationService,u=(i._logService,i._themeService);this._renderer=this._register(new iN(e,a,o,l,n,c,r,u,this._preserveDrawingBuffer)),this._register(e9.forward(this._renderer.onContextLoss,this._onContextLoss)),this._register(e9.forward(this._renderer.onChangeTextureAtlas,this._onChangeTextureAtlas)),this._register(e9.forward(this._renderer.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas)),this._register(e9.forward(this._renderer.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)),s.setRenderer(this._renderer),this._register(G(function(){if(!t._terminal._core._store._isDisposed){var i=t._terminal._core._renderService;i.setRenderer(t._terminal._core._createRenderer()),i.handleResize(e.cols,e.rows)}}))}},{key:"textureAtlas",get:function(){var e;return null==(e=this._renderer)?void 0:e.textureAtlas}},{key:"clearTextureAtlas",value:function(){var e;null==(e=this._renderer)||e.clearTextureAtlas()}}]),t}(V);e.s(["WebglAddon",()=>iK])}]);

//# debugId=10c668de-79b3-ca2b-c227-c424516ae121
//# sourceMappingURL=a73f66488d6b1ca7.js.map