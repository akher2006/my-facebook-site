;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="f6881024-6a6c-f77e-431b-942940cecc45")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,74032,e=>{e.v({"fade-in":"LoadingState-module___WZova__fade-in",header:"LoadingState-module___WZova__header",loadingAnimation:"LoadingState-module___WZova__loadingAnimation",root:"LoadingState-module___WZova__root"})},695337,e=>{e.v({surface:"KeyboardShortcutsModal-module__Tz_71q__surface"})},918218,e=>{e.v({right:"ExpandAgentButton-module__Sr5bZG__right",root:"ExpandAgentButton-module__Sr5bZG__root",show:"ExpandAgentButton-module__Sr5bZG__show"})},576779,e=>{e.v({animationWrapper:"FigmaImport-module__p8csWa__animationWrapper",overlay:"FigmaImport-module__p8csWa__overlay",progressBarContainer:"FigmaImport-module__p8csWa__progressBarContainer",progressBarFill:"FigmaImport-module__p8csWa__progressBarFill",progressBarTrack:"FigmaImport-module__p8csWa__progressBarTrack"})},111724,e=>{e.v({measureBar:"FreemiumUsagePopover-module___B9tOa__measureBar",usageCard:"FreemiumUsagePopover-module___B9tOa__usageCard"})},680189,e=>{e.v({flippedIcon:"workspaceTour-module__-kv3kW__flippedIcon",iconSurface:"workspaceTour-module__-kv3kW__iconSurface"})},980713,e=>{e.v({baseButton:"Deploy-module__8ZcrnG__baseButton",baseButtonLoading:"Deploy-module__8ZcrnG__baseButtonLoading",deployIconDot:"Deploy-module__8ZcrnG__deployIconDot",deployIconDotWrapper:"Deploy-module__8ZcrnG__deployIconDotWrapper",deployIconWithStatus:"Deploy-module__8ZcrnG__deployIconWithStatus",openPaneButton:"Deploy-module__8ZcrnG__openPaneButton",pulse:"Deploy-module__8ZcrnG__pulse",roundedButton:"Deploy-module__8ZcrnG__roundedButton",roundedButtonLoading:"Deploy-module__8ZcrnG__roundedButtonLoading"})},60166,e=>{e.v({root:"RunStatusButton-module__27k_5G__root"})},700283,e=>{e.v({flipped:"FiletreeButton-module__3d0q-a__flipped"})},317941,e=>{e.v({avatar:"index-module__PnN-4a__avatar",inviteDialog:"index-module__PnN-4a__inviteDialog",remainingCountButton:"index-module__PnN-4a__remainingCountButton",stacked:"index-module__PnN-4a__stacked"})},384132,e=>{e.v({emptySpacer:"NavMenu-module__rNmZaG__emptySpacer",menu:"NavMenu-module__rNmZaG__menu",repl:"NavMenu-module__rNmZaG__repl",usage:"NavMenu-module__rNmZaG__usage"})},342571,e=>{e.v({desktopAppWindowsOs:"index-module__IZzwWa__desktopAppWindowsOs",desktopDragRegion:"index-module__IZzwWa__desktopDragRegion",left:"index-module__IZzwWa__left",planningHeader:"index-module__IZzwWa__planningHeader",planningHeaderLeft:"index-module__IZzwWa__planningHeaderLeft",planningTimeline:"index-module__IZzwWa__planningTimeline",right:"index-module__IZzwWa__right"})},375032,e=>{e.v({"fade-out":"Border-module__AS8LXG__fade-out",pulse:"Border-module__AS8LXG__pulse",root:"Border-module__AS8LXG__root"})},231927,e=>{e.v({container:"index-module__4PIZ9q__container",interactionBlanket:"index-module__4PIZ9q__interactionBlanket",root:"index-module__4PIZ9q__root"})},33171,e=>{e.v({closeButton:"Tab-module__U4WksG__closeButton",tab:"Tab-module__U4WksG__tab",tabButton:"Tab-module__U4WksG__tabButton",title:"Tab-module__U4WksG__title"})},13891,e=>{e.v({desktopAppWindowsOs:"index-module__QGsN1W__desktopAppWindowsOs",dragArea:"index-module__QGsN1W__dragArea",dropPreview:"index-module__QGsN1W__dropPreview",newTab:"index-module__QGsN1W__newTab",newTabIconButton:"index-module__QGsN1W__newTabIconButton",newTabTextButton:"index-module__QGsN1W__newTabTextButton",tabBar:"index-module__QGsN1W__tabBar",tabs:"index-module__QGsN1W__tabs"})},248611,e=>{e.v({surface:"index-module__3SVBeW__surface"})},357210,e=>{e.v({grip:"ResizeHandle-module__D5nG1G__grip",root:"ResizeHandle-module__D5nG1G__root",stacked:"ResizeHandle-module__D5nG1G__stacked"})},224373,e=>{e.v({grip:"ResizeHandle-module__nCKbhG__grip",left:"ResizeHandle-module__nCKbhG__left",right:"ResizeHandle-module__nCKbhG__right",root:"ResizeHandle-module__nCKbhG__root"})},861781,e=>{e.v({root:"index-module__mWTpga__root"})},491694,e=>{e.v({root:"Search-module__fSv4Tq__root"})},943124,e=>{e.v({root:"index-module__0C7YZG__root"})},755181,e=>{e.v({contentContainer:"Workspace-module__bV5fda__contentContainer",desktopApp:"Workspace-module__bV5fda__desktopApp"})},838720,e=>{e.v({emailVerificationWrapper:"replEnvironmentDesktop-module__rxGmJG__emailVerificationWrapper",surface:"replEnvironmentDesktop-module__rxGmJG__surface"})},453926,e=>{"use strict";var n,t,r,i,o,a,s,l,u,c,d,p,f,g=e.i(276385),h=e.i(931849),m=e.i(878420),v=e.i(569384),x=e.i(973245),y=e.i(304277),b=e.i(566901),w=e.i(552207);function j(){var e=(0,v._)(["\n  query ReplEnvironmentDesktop(\n    $replId: String!\n    $environment: KeybindingsEnvironmentEnum!\n    $platform: KeybindingsPlatformEnum!\n  ) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        ...ReplEnvironmentDesktopRepl\n      }\n      ... on ReplOrgPermissionDeniedError {\n        replId\n        orgId\n        ownerUsername\n        ownerImage\n      }\n      ... on Error {\n        message\n      }\n    }\n    currentUser {\n      id\n      isVerified\n      ...ReplEnvironmentDesktopCurrentUser\n      keybindings(environment: $environment, platform: $platform) {\n        keybindings\n      }\n    }\n  }\n  ","\n  ","\n"]);return j=function(){return e},e}var _={},S=(0,x.gql)(j(),w.ReplEnvironmentDesktopReplFragmentDoc,w.ReplEnvironmentDesktopCurrentUserFragmentDoc),C=e.i(82464),k=e.i(911185),I=e.i(721281),T=e.i(872734),R=e.i(480028),P=e.i(660614),E=e.i(929872),A=e.i(625484),D=e.i(219577),V=e.i(751299),O=e.i(74032),F=(0,R.cvarsFrom)("LoadingState.module.css",["--header-height"]);function M(e){return(0,g.jsxs)(E.Surface,{style:(0,I._)({},F.headerHeight,D.APP_HEADER_HEIGHT+"px"),clsx:O.default.root,children:[(0,g.jsx)(E.Surface,{row:!0,clsx:O.default.header,justify:"space-between",px:6,children:(0,g.jsxs)(A.View,{row:!0,align:"center",children:[(0,g.jsx)(T.default,{}),(0,g.jsx)(V.NavMenu,{children:(0,g.jsx)(g.Fragment,{})})]})}),(0,g.jsx)(A.View,{grow:!0,shrink:!0,align:"center",justify:"center",clsx:O.default.loadingAnimation,children:e.animation?(0,g.jsx)(P.default,{height:100}):null})]})}var L=e.i(952914),U=e.i(530658),B=e.i(389959),N=e.i(133320),G=e.i(877212),W=e.i(204203),z=e.i(545525),H=e.i(787182),q=e.i(921521),K=e.i(993796),$=e.i(125674),Q=e.i(441329),Y=e.i(956111),J=e.i(400081),X=e.i(42783),Z=e.i(346715),ee=e.i(297083),en=e.i(817556),et=e.i(541793),er=e.i(161322),ei=e.i(858248),eo=e.i(709485),ea=e.i(821472),es=e.i(979931),el=e.i(106020),eu=e.i(292849);e.i(282890);var ec=e.i(66718),ed=e.i(827456),ep=e.i(259493),ef=e.i(965863);function eg(e){var n=e.currentPaneId,t=e.type,r=(0,ed.usePaneUIContext)(),i=(0,es.useReplacePane)(),o=(0,es.useSelectTab)(),a=(0,ef.useGetPanes)(),s=(0,ep.useGetPaneBindings)(),l=n?"Move existing tab here":"Jump to existing tab";return(0,B.useCallback)(function(e){var u=e.searchQuery;return(0,ee._)(function(){var e,c,d,p,f,h,m,v,x,y,b,w,j,_,S,C,k,I,T,R,P,E,A,D,V;return(0,en._)(this,function(O){switch(O.label){case 0:if(e=a(),!(c=n?e.filter(function(e){return(0,U._)(e,1)[0]!==n}):e).length||!u&&"files"===t)return[2,[]];d=new Map,p=[],f=!0,h=!1,m=void 0;try{for(v=c[Symbol.iterator]();!(f=(x=v.next()).done);f=!0)(y=(0,U._)(x.value,2))[0],b=y[1],(0,ec.isFilePane)(b)&&b.data.path&&p.push(b.data.path)}catch(e){h=!0,m=e}finally{try{f||null==v.return||v.return()}finally{if(h)throw m}}return[4,(0,eu.filterFiles)(u,p)];case 1:w=O.sent(),j=!0,_=!1,S=void 0;try{for(C=w[Symbol.iterator]();!(j=(k=C.next()).done);j=!0)I=k.value,d.set(I.path,{score:I.score,ranges:I.ranges})}catch(e){_=!0,S=e}finally{try{j||null==C.return||C.return()}finally{if(_)throw S}}T=[],R=!0,P=!1,E=void 0;try{for(A=function(){var e=(0,U._)(V.value,2),a=e[0],u=e[1],c=(0,ec.isToolPane)(u);if("tools"===t&&!c||"tools"===t&&"commands"===u.type||"files"===t&&c)return"continue";var p=(0,ec.isFilePane)(u)?u.data.path:null,f=p?d.get(p):null;if("deployments"===u.type){var h=s(a);if((null==h?void 0:h.type)==="deployments"){var m=h.getTabs();if(m)return T.push({match:el.fzfMatchLabel,data:{type:"context",label:r.getTitle(u),icon:(0,g.jsx)(r.Icon,{pane:u})},commands:function(){return m.map(function(e){return{match:el.fzfMatchLabel,data:{key:a+e.id,type:"action",label:e.label,icon:(0,g.jsx)(e.Icon,{size:16}),run:function(){o(a),h.setTab(e.id)}}}})}}),"continue"}}var v=p&&f?function(){return{score:f.score,render:(0,eu.createFileMatchRender)({path:p,ranges:f.ranges,description:l})}}:el.fzfMatchLabel,x=r.getTitle(u),y=r.Icon({pane:u});T.push({match:v,data:{key:a,type:"action",label:x,icon:y,run:function(){return n?i({a:n,b:a}):o(a)},description:l}})},D=c[Symbol.iterator]();!(R=(V=D.next()).done);R=!0)A()}catch(e){P=!0,E=e}finally{try{R||null==D.return||D.return()}finally{if(P)throw E}}return[2,T]}})})()},[n,a,r,o,i,s,l,t])}var eh=e.i(333980),em=e.i(927989),ev=e.i(794633),ex=e.i(967286),ey=e.i(32109),eb=e.i(384401),ew=e.i(888330),ej=e.i(615778),e_=e.i(44239),eS="Searchâ€¦";function eC(){var e=(0,er.useSetAtom)(ea.toggleCommandBarAtom);return(0,B.useCallback)(function(n){e(n)},[e])}var ek=e.i(262206),eI=e.i(446530),eT=e.i(613355),eR=e.i(739521),eP=e.i(980338),eE={id:"toggleGlobalCommandBarCommand",name:"Toggle Commandbar",description:"Opens or closes the command bar",default:(0,ek.defaultKeyCombo)({cmdOrCtrl:!0,key:"k"})};function eA(e){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{enabled:!0}).enabled,t=(0,er.useSetAtom)(ea.commandsAtom);(0,B.useEffect)(function(){if(n&&null!==e)return t(function(n){return(0,Z._)(n).concat([e])}),function(){t(function(n){return n.filter(function(n){return n!==e})})}},[t,e,n])}var eD=(0,eI.cssRecord)({surface:[eT.rcss.maxHeight("70vh"),eT.rcss.borderRadius(8)]});let eV=(0,B.memo)(function(){var e,n,t,r,i,o,a,s,l,u,c,d,p=(0,er.useAtomValue)(ea.commandBarIsOpenAtom),f=eC(),h=(e=(0,es.useOpenTool)(),n=(0,B.useCallback)(function(n){(0,ei.track)(eo.events.TOOL_OPENED,{source:"Command Bar",tool:n.pane.type}),e(n)},[e]),t=(0,ed.usePaneUIContext)(),r=(0,ev.useToolPanes)(),i=(0,ef.useGetPanes)(),o=(0,B.useCallback)(function(){var e=i().map(function(e){var n=(0,U._)(e,2);return(n[0],n[1]).type}),o=[],a=!0,s=!1,l=void 0;try{for(var u,c=r[Symbol.iterator]();!(a=(u=c.next()).done);a=!0)!function(){var r=u.value;if(!((0,ec.isSingleton)(r.type)&&e.includes(r.type))){var i=t.getTitle(r),a=t.Icon({pane:r});o.push({match:(0,eh.matchToolPane)({pane:r,aliases:em.paneAliases.get(r.type)}),data:{key:"extension"===r.type?"extension-".concat(r.data.installationId,"-").concat(r.data.path):void 0,type:"action",label:i,description:t.getDescription(r,{short:!0}),icon:a,run:function(){n({pane:r})}}})}}()}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}return o},[r,n,i,t]),a=eg({type:"tools"}),s=(0,eb.useKeyCombo)("toggleGlobalCommandBarCommand"),l=(0,$.default)(function(){return{type:"context",icon:(0,g.jsx)(ej.default,{}),label:"",description:eS,keyboardShortcut:s}},[s]),u=(0,ex.useAssistantDeprecationCommand)(),c=(0,$.default)(function(){return(0,et.atom)(function(e){var n=e(ea.commandsAtom),t={data:{type:"context",label:ew.toolsCommandLabel,icon:(0,g.jsx)(e_.default,{})},commands:function(e){var n=e.searchQuery;return(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:return[4,a({searchQuery:n})];case 1:return[2,Z._.apply(void 0,[e.sent()]).concat((0,Z._)(o()))]}})})()}};return{data:l,commands:function(){return[u].concat((0,Z._)(n),[t])}}})},[o,l,a,u]),d=(0,$.default)(function(){return(0,et.atom)(function(e){var n=e(c),t=e(ea.initialSubCommandAtom);return t?[n,t]:n})},[c]),(0,er.useAtomValue)(d)),m=(0,eb.useKeyCombo)(eE.id);return(0,g.jsx)(eR.Modal,{hideCloseButton:!0,isOpen:p,onRequestClose:f,noPadding:!0,skipTransition:!0,topPadding:8,children:(0,g.jsx)(E.Surface,{css:eD.surface,children:(0,g.jsx)(eP.CommandBar,{keyboardShortcut:m,onAction:function(){return f()},command:h,autoFocus:!0})})})});var eO=e.i(692043);function eF(){var e=(0,v._)(["\n  query ExtensionStore($replId: String!, $userId: Int) {\n    extensionList(includeNonBlessed: true, userId: $userId) {\n      ...TopLevelExtension\n      installation(replId: $replId) {\n        ...TopLevelExtensionInstallation\n      }\n    }\n  }\n  ","\n  ","\n"]);return eF=function(){return e},e}var eM=(0,x.gql)(eF(),eO.TopLevelExtensionFragmentDoc,eO.TopLevelExtensionInstallationFragmentDoc),eL=e.i(761201),eU=e.i(253344),eB=e.i(47503),eN=e.i(207237),eG=e.i(173738),eW=e.i(140487),ez=e.i(960178),eH=(0,eI.cssRecord)({container:eT.rcss.colWithGap(24)});function eq(e){var n=e.fileExtension,t=e.onCancel,r=e.onConfirm;return(0,g.jsxs)(A.View,{css:eH.container,children:[(0,g.jsx)(ez.Header,{level:1,variant:"headerDefault",children:"Make this extension default?"}),(0,g.jsxs)(ez.Text,{children:["Do you want to use this extension to open ",n," files by default? You can always use another file opener by right clicking on the file and opening it with something else"]}),(0,g.jsxs)(A.View,{row:!0,gap:12,justify:"end",children:[(0,g.jsx)(eW.Button,{onClick:function(){return t()},text:"Cancel"}),(0,g.jsx)(eW.Button,{colorway:"positive",onClick:function(){return r()},text:"Yes, use this extension by default"})]})]})}var eK=e.i(98816),e$=e.i(222342),eQ=e.i(992785);e.i(290625);var eY=e.i(949874);function eJ(){var e=(0,ef.useGetActivePaneId)(),n=(0,es.useGetVisiblePanes)(),t=(0,es.useGetHiddenPanes)(),r=(0,es.useGetLayoutState)(),i=(0,es.useInsertPane)(),o=(0,es.useRevealPane)(),a=(0,es.useUpdatePane)(),s=(0,es.useGetUncommittedFilePaneId)(),l=(0,es.useGetUncommittedToolPaneId)(),u=(0,es.useGetIsMaximized)();return(0,B.useCallback)(function(c){var d=c.pane,p=c.activate,f=c.updateOnReveal,g=e(),h=(0,ec.isFilePane)(d)?s():l();h||(h=function(e){var n,t,r=e.panes,i=e.pane;if((0,ec.isFilePane)(i)){var o,a,s=i.data.path;return null!=(a=null==(o=r.find(function(e){var n=(0,U._)(e,2)[1];return(0,ec.isFilePane)(n)&&n.data.path===s}))?void 0:o[0])?a:null}if((0,ec.isExtensionPane)(i))return null!=(u=null==(l=r.find(function(e){var n=(0,U._)(e,2)[1];return!!(0,ec.isExtensionPane)(n)&&n.data.installationId===i.data.installationId&&n.data.path===i.data.path&&n.data.filePath===i.data.filePath}))?void 0:l[0])?u:null;if("diff"===i.type){var l,u,c,d=r.find(function(e){var n=(0,U._)(e,2),t=(n[0],n[1]);return"diff"===t.type&&(0,eQ.default)(t.data,i.data)});return null!=(c=null==d?void 0:d[0])?c:null}return(0,ec.isSingleton)(i.type)&&null!=(t=null==(n=r.find(function(e){return(0,U._)(e,2)[1].type===i.type}))?void 0:n[0])?t:null}({panes:(0,Z._)(n()).concat((0,Z._)(t())),pane:d}));var m=u();if(h&&g){var v,x,y=r().layout,b=null==(v=(0,eY.findPaneById)(y,g))?void 0:v.paneGroup,w=null==(x=(0,eY.findPaneById)(y,h))?void 0:x.paneGroup;if(!m||(null==b?void 0:b.id)===(null==w?void 0:w.id))return(void 0===f||f)&&a({paneId:h,pane:d}),o({paneId:h,activate:p}),h}var j=c.placement;return m&&null!=g?j={type:"after",paneId:g}:(null==j?void 0:j.type)!=="secondary"||j.relativeTo||(j={type:"secondary",relativeTo:g}),i({pane:d,activate:p,placement:j})},[e,s,l,i,n,t,r,u,o,a])}var eX=e.i(778203);function eZ(){var e,n=(0,es.useOpenFile)(),t=(0,ef.useActivatePane)(),r=(e=(0,ef.useObservableActiveFile)(),(0,$.default)(function(){return function(n){return e.subscribe(n)}},[e])),i=(0,ef.useGetActiveFile)(),o=(0,e$.default)(),a=eJ(),s=(0,ef.useGetActivePaneId)(),l=(0,es.useGetLayoutState)(),u=(0,es.useSetLayoutState)(),c=(0,eX.default)(),d=(0,eK.default)(c),p=(0,B.useCallback)(function(e){a({pane:{type:"extension",data:{extensionId:e.extensionId,installationId:e.installationId,baseUrl:e.baseUrl,path:e.path,name:e.name}},activate:!0,placement:{type:"secondary",relativeTo:s()}})},[a,s]);return(0,$.default)(function(){return{openFile:n,watchActiveFile:r,getActiveFile:i,activatePane:t,toasts:o,revealOrInsertTool:p,getLayoutState:l,setLayoutState:u,getSshConfig:function(){return d.current}}},[n,r,i,t,o,p,l,u,d])}var e0=e.i(142903),e1=e.i(475032),e2=e.i(529810);e.i(244719);var e4=e.i(667279),e8=e.i(196380),e3=e.i(100811),e6=e.i(9293),e9=e.i(64386),e5=e.i(62820),e7=e.i(409792),ne=e.i(343252),nn=e.i(873379),nt=e.i(557964),nr=e.i(167626),ni=e.i(119468),no=((n={}).RAW="RAW",n.PROXY="PROXY",n.THROW="THROW",n.HANDLER="HANDLER",n),na=((t={}).GET="GET",t.SET="SET",t.APPLY="APPLY",t.CONSTRUCT="CONSTRUCT",t.ENDPOINT="ENDPOINT",t.RELEASE="RELEASE",t),ns=Symbol("Comlink.proxy"),nl=Symbol("Comlink.endpoint"),nu=Symbol("Comlink.releaseProxy"),nc=Symbol("Comlink.thrown"),nd=function(e){return(void 0===e?"undefined":(0,ni._)(e))==="object"&&null!==e||"function"==typeof e},np=new Map([["proxy",{canHandle:function(e){return nd(e)&&e[ns]},serialize:function(e){var n=new MessageChannel,t=n.port1,r=n.port2;return nf(e,t),[r,[r]]},deserialize:function(e){var n;return e.start(),function e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=!1,o=new Proxy(r,{get:function(r,a){if(nh(i),a===nu)return function(){return nw(n,{type:na.RELEASE,path:t.map(function(e){return e.toString()})}).then(function(){ng(n),i=!0})};if("then"===a){if(0===t.length)return{then:function(){return o}};var s=nw(n,{type:na.GET,path:t.map(function(e){return e.toString()})}).then(nb);return s.then.bind(s)}return e(n,(0,Z._)(t).concat([a]))},set:function(e,r,o){nh(i);var a=(0,U._)(ny(o),2),s=a[0],l=a[1];return nw(n,{type:na.SET,path:(0,Z._)(t).concat([r]).map(function(e){return e.toString()}),value:s},l).then(nb)},apply:function(r,o,a){nh(i);var s=t[t.length-1];if(s===nl)return nw(n,{type:na.ENDPOINT}).then(nb);if("bind"===s)return e(n,t.slice(0,-1));var l=(0,U._)(nm(a),2),u=l[0],c=l[1];return nw(n,{type:na.APPLY,path:t.map(function(e){return e.toString()}),argumentList:u},c).then(nb)},construct:function(e,r){nh(i);var o=(0,U._)(nm(r),2),a=o[0],s=o[1];return nw(n,{type:na.CONSTRUCT,path:t.map(function(e){return e.toString()}),argumentList:a},s).then(nb)}});return o}(e,[],n)}}],["throw",{canHandle:function(e){return nd(e)&&nc in e},serialize:function(e){var n=e.value;return[(0,nr._)(n,Error)?{isError:!0,value:{message:n.message,name:n.name,stack:n.stack}}:{isError:!1,value:n},[]]},deserialize:function(e){if(e.isError)throw Object.assign(Error(e.value.message),e.value);throw e.value}}]]);function nf(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:self,t=arguments.length>2?arguments[2]:void 0;function r(i){if(i&&i.data&&(!t||i.origin===t.origin&&i.source===t.source)){var o,a=(0,m._)({path:[]},i.data),s=a.id,l=a.type,u=a.path,c=(i.data.argumentList||[]).map(nb);try{var d=u.slice(0,-1).reduce(function(e,n){return e[n]},e),p=u.reduce(function(e,n){return e[n]},e);switch(l){case na.GET:o=p;break;case na.SET:d[u.slice(-1)[0]]=nb(i.data.value),o=!0;break;case na.APPLY:o=p.apply(d,c);break;case na.CONSTRUCT:var f=(0,nt._)(p,(0,Z._)(c));o=nx(f);break;case na.ENDPOINT:var g,h,v=new MessageChannel,x=v.port1,y=v.port2;nf(e,y),g=x,h=[x],nv.set(g,h),o=g;break;case na.RELEASE:o=void 0;break;default:return}}catch(e){o=(0,I._)({value:e},nc,0)}Promise.resolve(o).catch(function(e){return(0,I._)({value:e},nc,0)}).then(function(e){var t=(0,U._)(ny(e),2),i=t[0],o=t[1];n.postMessage((0,e9._)((0,m._)({},i),{id:s}),o),l===na.RELEASE&&(n.removeEventListener("message",r),ng(n))})}}return n.addEventListener("message",r),n.start&&n.start(),function(){n.removeEventListener("message",r),ng(n)}}function ng(e){"MessagePort"===e.constructor.name&&e.close()}function nh(e){if(e)throw Error("Proxy has been released and is not useable")}function nm(e){var n,t=e.map(ny);return[t.map(function(e){return e[0]}),(n=t.map(function(e){return e[1]}),Array.prototype.concat.apply([],n))]}var nv=new WeakMap;function nx(e){return Object.assign(e,(0,I._)({},ns,!0))}function ny(e){var n=!0,t=!1,r=void 0;try{for(var i,o=np[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var a=(0,U._)(i.value,2),s=a[0],l=a[1];if(l.canHandle(e)){var u=(0,U._)(l.serialize(e),2),c=u[0],d=u[1];return[{type:no.HANDLER,name:s,value:c},d]}}}catch(e){t=!0,r=e}finally{try{n||null==o.return||o.return()}finally{if(t)throw r}}return[{type:no.RAW,value:e},nv.get(e)||[]]}function nb(e){switch(e.type){case no.HANDLER:return np.get(e.name).deserialize(e.value);case no.RAW:return e.value}}function nw(e,n,t){return new Promise(function(r){var i=[,,,,].fill(0).map(function(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)}).join("-");e.addEventListener("message",function n(t){t.data&&t.data.id&&t.data.id===i&&(e.removeEventListener("message",n),r(t.data))}),e.start&&e.start(),e.postMessage((0,m._)({id:i},n),t)})}var nj=e.i(623059),n_=Symbol("timeout"),nS=e.i(881476);function nC(){var e=(0,v._)(["\n  fragment InitialCurrentUserData on CurrentUser {\n    id\n    username\n    image\n    bio\n  }\n"]);return nC=function(){return e},e}function nk(){var e=(0,v._)(["\n  fragment SocialCurrentUserData on CurrentUser {\n    url\n    socials {\n      id\n      url\n      type\n    }\n    firstName\n    lastName\n    displayName\n    fullName\n    followCount\n    followerCount\n  }\n"]);return nk=function(){return e},e}function nI(){var e=(0,v._)(["\n  fragment RolesCurrentUserData on CurrentUser {\n    roles {\n      id\n      name\n      key\n      tagline\n    }\n  }\n"]);return nI=function(){return e},e}function nT(){var e=(0,v._)(["\n  fragment PlanCurrentUserData on CurrentUser {\n    isUserHacker: subscriptionIsType(subscriptionType: HACKER)\n    ...CoreSubscriptionPlanStatus\n  }\n  ","\n"]);return nT=function(){return e},e}function nR(){var e=(0,v._)(["\n  fragment SocialUserData on User {\n    url\n    socials {\n      id\n      url\n      type\n    }\n    firstName\n    lastName\n    displayName\n    fullName\n    followCount\n    followerCount\n  }\n"]);return nR=function(){return e},e}function nP(){var e=(0,v._)(["\n  fragment RolesUserData on User {\n    roles {\n      id\n      name\n      key\n      tagline\n    }\n  }\n"]);return nP=function(){return e},e}function nE(){var e=(0,v._)(["\n  fragment PlanUserData on User {\n    isUserHacker: subscriptionIsType(subscriptionType: HACKER)\n    isUserPro: subscriptionIsType(subscriptionType: HACKER_PRO)\n  }\n"]);return nE=function(){return e},e}function nA(){var e=(0,v._)(["\n  fragment InitialReplData on Repl {\n    id\n    url\n    title\n    description\n    timeCreated\n    slug\n    isPrivate\n  }\n"]);return nA=function(){return e},e}function nD(){var e=(0,v._)(["\n  fragment SocialReplData on Repl {\n    likeCount\n    publicForkCount\n    iconUrl\n    imageUrl\n  }\n"]);return nD=function(){return e},e}function nV(){var e=(0,v._)(["\n  fragment InitialUserData on User {\n    id\n    username\n    image\n    bio\n  }\n"]);return nV=function(){return e},e}function nO(){var e=(0,v._)(["\n  fragment OwnerData on Repl {\n    owner {\n      __typename\n      ... on User {\n        ...InitialUserData\n      }\n      ... on Team {\n        id\n        username\n        image\n        description\n      }\n    }\n  }\n  ","\n"]);return nO=function(){return e},e}function nF(){var e=(0,v._)(["\n  fragment MultiplayersData on Repl {\n    multiplayers {\n      ...InitialUserData\n    }\n  }\n  ","\n"]);return nF=function(){return e},e}function nM(){var e=(0,v._)(["\n  query extensionPortCurrentUser(\n    $includeSocialData: Boolean! = false\n    $includeRoles: Boolean! = false\n    $includePlan: Boolean! = false\n  ) {\n    user: currentUser {\n      ...InitialCurrentUserData\n      ...SocialCurrentUserData @include(if: $includeSocialData)\n      ...RolesCurrentUserData @include(if: $includeRoles)\n      ...PlanCurrentUserData @include(if: $includePlan)\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return nM=function(){return e},e}function nL(){var e=(0,v._)(["\n  query extensionPortUserByUsername(\n    $username: String!\n    $includeSocialData: Boolean! = false\n    $includeRoles: Boolean! = false\n    $includePlan: Boolean! = false\n  ) {\n    userByUsername(username: $username) {\n      ...InitialUserData\n      ...SocialUserData @include(if: $includeSocialData)\n      ...RolesUserData @include(if: $includeRoles)\n      ...PlanUserData @include(if: $includePlan)\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return nL=function(){return e},e}function nU(){var e=(0,v._)(["\n  query extensionPortUserById(\n    $id: Int!\n    $includeSocialData: Boolean! = false\n    $includeRoles: Boolean! = false\n    $includePlan: Boolean! = false\n  ) {\n    user(id: $id) {\n      ...InitialUserData\n      ...SocialUserData @include(if: $includeSocialData)\n      ...RolesUserData @include(if: $includeRoles)\n      ...PlanUserData @include(if: $includePlan)\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return nU=function(){return e},e}function nB(){var e=(0,v._)(["\n  query currentUserEditorPreferences {\n    currentUser {\n      id\n      workspacePreferences\n    }\n  }\n"]);return nB=function(){return e},e}function nN(){var e=(0,v._)(["\n  query extensionPortReplById(\n    $id: String!\n    $includeSocialData: Boolean! = false\n    $includeOwner: Boolean! = false\n    $includeMultiplayers: Boolean! = false\n  ) {\n    getRepl(id: $id) {\n      __typename\n      ... on Repl {\n        ...InitialReplData\n        ...SocialReplData @include(if: $includeSocialData)\n        ...OwnerData @include(if: $includeOwner)\n        ...MultiplayersData @include(if: $includeMultiplayers)\n      }\n      ... on ReplRedirect {\n        replUrl\n      }\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return nN=function(){return e},e}function nG(){var e=(0,v._)(["\n  query extensionPortReplByUrl(\n    $url: String!\n    $includeSocialData: Boolean! = false\n    $includeOwner: Boolean! = false\n    $includeMultiplayers: Boolean! = false\n  ) {\n    getRepl(url: $url) {\n      __typename\n      ... on Repl {\n        ...InitialReplData\n        ...SocialReplData @include(if: $includeSocialData)\n        ...OwnerData @include(if: $includeOwner)\n        ...MultiplayersData @include(if: $includeMultiplayers)\n      }\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return nG=function(){return e},e}var nW=(0,x.gql)(nC()),nz=(0,x.gql)(nk()),nH=(0,x.gql)(nI()),nq=(0,x.gql)(nT(),nS.CoreSubscriptionPlanStatusFragmentDoc),nK=(0,x.gql)(nR()),n$=(0,x.gql)(nP()),nQ=(0,x.gql)(nE()),nY=(0,x.gql)(nA()),nJ=(0,x.gql)(nD()),nX=(0,x.gql)(nV()),nZ=(0,x.gql)(nO(),nX),n0=(0,x.gql)(nF(),nX),n1=(0,x.gql)(nM(),nW,nz,nH,nq),n2=(0,x.gql)(nL(),nX,nK,n$,nQ),n4=(0,x.gql)(nU(),nX,nK,n$,nQ),n8=(0,x.gql)(nB()),n3=(0,x.gql)(nN(),nY,nJ,nZ,n0),n6=(0,x.gql)(nG(),nY,nJ,nZ,n0);function n9(e){return function(n){return(0,ee._)(function(){var t,r;return(0,en._)(this,function(i){switch(i.label){case 0:return[4,null===eG.apolloClient||void 0===eG.apolloClient?void 0:eG.apolloClient.query({query:e,variables:n||void 0})];case 1:if(null==(t=i.sent())?void 0:t.data)return[2,t.data];throw Error(null==t||null==(r=t.error)?void 0:r.message)}})})()}}var n5=e.i(960933),n7=e.i(862927);function te(e,n){var t={};for(var r in n)"function"==typeof n[r]&&(t[r]=function(e,n){return function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];var o=!0,a=!1,s=void 0;try{for(var l,u=e[Symbol.iterator]();!(o=(l=u.next()).done);o=!0)(0,l.value)()}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}return n.apply(void 0,(0,Z._)(r))}}(e,n[r]));return t}function tn(e,n){return function(){var t=e.store.get(e.extensionStateAtom),r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;if(!t.scopes.has(l)){var u="Scope not declared in extension.json: ".concat(l);e.logger.warn("".concat(u,". In the future this will throw an error"))}}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}}var tt=n5.Type.Record(n5.Type.String(),n5.Type.String({minLength:1})),tr=e.i(336106);function ti(){var e=(0,v._)(["\n  query ExtensionApiAuthToken($installationId: String!) {\n    extensionInstallationById(id: $installationId) {\n      ... on ExtensionInstallation {\n        id\n        token\n      }\n    }\n  }\n"]);return ti=function(){return e},e}e.i(439725);var to=(0,x.gql)(ti());function ta(e){return{registerCommand:function(n,t){return(0,ee._)(function(){var r,i,o;return(0,en._)(this,function(a){switch(a.label){case 0:if(t)return[3,2];return e.logger.warn("registerCommand: calling registerCommand with a single argument is deprecated. Pass a {commandId, contributions} object as the first command."),r=n,[4,(0,e3.parseCommandProxyToExtensionCommand)(r,e)];case 1:if(!(o=a.sent()).data.id)throw Error("Command: expected id to be defined");if(!("contributions"in o.data))throw Error("Command: In ".concat(o.data.id,", contributions should be an array"));return 0===o.data.contributions.length&&e.logger.warn("Command: ".concat(o.data.id," has no contributions")),(i={commandId:o.data.id,contributions:o.data.contributions}).contributions||(e.logger.warn("Command: '".concat(o.data.id,"' has no contributions")),i.contributions=[]),[3,4];case 2:return i=n,r=t,[4,(0,e3.parseCommandProxyToExtensionCommand)(r,e)];case 3:o=a.sent(),a.label=4;case 4:return e.store.set(e4.registerExtensionCreateCommandAtom,{extensionStateAtom:e.extensionStateAtom,createCommand:{id:(0,eU.asExtensionCommandId)(i.commandId),contributions:i.contributions,create:function(){return(0,ee._)(function(){return(0,en._)(this,function(e){return[2,o]})})()}}}),[2]}})})()},registerCreateCommand:function(n,t){return(0,ee._)(function(){var r,i;return(0,en._)(this,function(o){if(!n.commandId||""===n.commandId)throw Error("Attempted to register command without id");if(!n.contributions||!Array.isArray(n.contributions))throw Error("Command: In ".concat(n.commandId,", contributions should be an array"));return 0===n.contributions.length&&e.logger.warn("Command: ".concat(n.commandId," has no contributions")),(r=n.contributions.filter(function(e){return!(e in nj.ContributionType)})).length>0&&e.logger.warn("Command: ".concat(n.commandId," has unrecognized contributions: ").concat(r.join(", "),". Valid contributions are ").concat(Object.values(nj.ContributionType))),i={id:(0,eU.asExtensionCommandId)(n.commandId),contributions:n.contributions,create:function(n){var r=n.path;return(0,ee._)(function(){var n;return(0,en._)(this,function(i){switch(i.label){case 0:return[4,Promise.race([t({path:r}),new Promise(function(e){return setTimeout(function(){return e(null)},50)})])];case 1:if(null===(n=i.sent()))return[2,null];return[2,(0,e3.parseCommandProxyToExtensionCommand)(n,e)]}})})()}},e.store.set(e4.registerExtensionCreateCommandAtom,{extensionStateAtom:e.extensionStateAtom,createCommand:i}),[2]})})()}}}function ts(e){return function(){if(!e.store.get(e.extensionStateAtom).enableExperimentalApi)throw Error("Experimental APIs are not enabled. (If you are the developer, please add the `experimental-api` scope to your extension.json)")}}var tl=e.i(995683),tu=e.i(205104),tc=e.i(703631),td=e.i(903381);function tp(e){return e.error?{error:e.error,success:!1}:{success:!0,error:null}}var tf=e.i(968323),tg=e.i(12291),th=e.i(664152),tm=function(e,n){var t=e.extension,r=n.showMessage,i=n.hideMessage,o=n.hideAllMessages,a=function(e){return function(n){var i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4e3,a=arguments.length>2?arguments[2]:void 0,u=Date.now();u-l>=6e4&&(l=u,s=0);var c=null!=(i=t.manifest.name.trim())?i:"Unknown Extension";s<10?(r({content:(0,g.jsxs)(g.Fragment,{children:[n,(0,g.jsx)("div",{children:(0,g.jsx)(ez.Text,{variant:"small",children:c})})]}),type:e,time:o>1e4?1e4:o,style:a}),s++):th.logger.error("Extension reached showMessage throttle limit",{extensionId:t.extensionId,extensionName:t.manifest.name,content:n})}},s=0,l=Date.now();return{showConfirm:a("confirm"),showError:a("error"),showNotice:a("notice"),showWarning:a("warning"),hideMessage:i,hideAllMessages:o}},tv=e.i(412284),tx=e.i(703774);function ty(e){var n=e.extension,t=e.sandboxUrl,r=e.sandboxTitle,i=e.paneId,o=e.environmentAPIs,a=e.filePath,s=(0,B.useRef)(null),l=(0,eN.default)(),u=(0,eB.useCurrentUserId)(),c=(0,e2.default)(),d=(0,B.useRef)(),p=(0,tv.useExtensionsStore)(),f=(0,e4.useExtensionStateAtom)(null==n?void 0:n.installationId),g=(0,tx.useTheme)(),h=(0,B.useRef)(g),v=(0,B.useRef)([]);h.current=g;var x=(0,$.default)(function(){return{}},[]),y=(0,nn.default)(c.container),b=(0,U._)((0,B.useState)(!1),2),w=b[0],j=b[1];(0,B.useEffect)(function(){y===e5.ConnectionState.CONNECTED&&j(!0)},[y]),(0,B.useEffect)(function(){v.current.forEach(function(e){return e(g.theme)})},[g.theme]),(0,B.useEffect)(function(){return function(){d.current&&d.current()}},[]);var _=(0,B.useCallback)(function(){try{var e=new URL(t);if("https:"===e.protocol)return!0;return!1}catch(e){return!1}},[t]),S=(0,B.useCallback)(function(){!s.current||!_()||n&&f&&u&&(d.current&&d.current(),d.current=function(e){var n=e.extensionIframe,t=new URL(n.src).origin,r=function(e){var n,t,r,i,o,a,s,l,u,c,d,p=e.filePath,f=e.replId,g=e.environmentAPIs,h=e.logger.createLogger({api:"debug"});return(0,e9._)((0,m._)({filePath:p},(n=e.services.fs,t=e.logger.createLogger({api:"fs"}),te([tn(e,["read"])],(0,m._)({readFile:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";return(0,ee._)(function(){var r,i;return(0,en._)(this,function(o){switch(o.label){case 0:return r=(0,tc.normalizePath)(e),[4,n.readFile(r)];case 1:var a;if((i=o.sent()).error)return[2,{error:i.error,content:null}];return[2,{error:null,content:(a=i.content,"utf8"===t?a.toString():"binary"===t?a.toBuffer():a)}]}})})()},readDir:function(e){return(0,ee._)(function(){var t,r;return(0,en._)(this,function(i){switch(i.label){case 0:return t=(0,tc.normalizePath)(e),[4,n.readDir(t)];case 1:if((r=i.sent()).error)return[2,{error:r.error,children:null}];return[2,{error:null,children:r.children}]}})})()},watchFile:function(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"binary",o=(0,tc.normalizePath)(e);(0,tu.isOTFile)(o)&&t.warn("Extension used watchFile on a text file. This works, but watchTextFile is preferred.");var a=n.watchFile(o,{onChange:function(e){"utf8"===i?r.onChange(e.toString("utf8")):r.onChange(e.asBuffer)},onError:function(e){r.onError(e.message)},onMoveOrDelete:function(e){r.onMoveOrDelete({eventType:e.eventType,node:e.node})}});return nx(function(){a()})},watchDir:function(e,t){var r=(0,tc.normalizePath)(e),i=n.watchDir(r,{onChange:function(n){t.onChange(n.map(function(n){return{path:(0,tc.asDir)(e)+n.filename,type:n.type}}))},onError:function(e){t.onError(e)},onMoveOrDelete:function(e){t.onMoveOrDelete(e)}});return nx(function(){i()})}},te([tn(e,["write-exec"])],{createDir:function(e){return(0,ee._)(function(){var t;return(0,en._)(this,function(r){switch(r.label){case 0:return t=(0,tc.normalizePath)(e),[4,n.createDir(t)];case 1:return[2,tp(r.sent())]}})})()},deleteDir:function(e){return(0,ee._)(function(){var t;return(0,en._)(this,function(r){switch(r.label){case 0:return t=(0,tc.normalizePath)(e),[4,n.deleteDir(t)];case 1:return[2,tp(r.sent())]}})})()},writeFile:function(e,t){return(0,ee._)(function(){var r,i,o;return(0,en._)(this,function(a){switch(a.label){case 0:if(r=(0,tc.normalizePath)(e),"string"!=typeof t)return[3,1];return i=t,[3,4];case 1:if(!(0,nr._)(t,Blob))return[3,3];return o=tl.default.from,[4,t.arrayBuffer()];case 2:return i=o.apply(tl.default,[a.sent()]),[3,4];case 3:i=tl.default.from(t),a.label=4;case 4:return[4,n.writeFile(r,i)];case 5:return[2,tp(a.sent())]}})})()},deleteFile:function(e){return(0,ee._)(function(){var t;return(0,en._)(this,function(r){switch(r.label){case 0:return t=(0,tc.normalizePath)(e),[4,n.deleteFile(t)];case 1:return[2,tp(r.sent())]}})})()},copyFile:function(e,t){return(0,ee._)(function(){var r;return(0,en._)(this,function(i){switch(i.label){case 0:return r=(0,tc.normalizePath)(e),[4,n.copyFile(r,t)];case 1:return[2,tp(i.sent())]}})})()},move:function(e,t){return(0,ee._)(function(){var r,i,o;return(0,en._)(this,function(a){switch(a.label){case 0:return r=(0,tc.normalizePath)(e),[4,n.stat(r)];case 1:if(!(i=a.sent()).exists)return[2,{error:"File or directory does not exist",success:!1}];if(i.type!==td.FileType.File)return[3,3];return[4,n.moveFile(r,t)];case 2:return o=a.sent(),[3,5];case 3:return[4,n.moveDir(r,t)];case 4:o=a.sent(),a.label=5;case 5:return[2,tp(o)]}})})()},watchTextFile:function(e,r){(0,tu.isOTFile)(e)||t.warn("It appears that you are trying to use watchTextFile on a non-OT file. Please use fs.watchFile instead");var i=n.watchTextFile(e,{onReady:function(e){var n=e.fetchChanges,t=e.initialContent,i=e.transformSelection,o=e.updateSelections,a=e.version,s=e.writeChange;r.onReady(nx({writeChange:s,fetchChanges:n,initialContent:t,version:a,transformSelection:i,updateSelections:o}))},onChange:function(e){var n=e.latestContent,t=e.changeSource,i=e.changes,o=e.version;return(0,ee._)(function(){return(0,en._)(this,function(e){return r.onChange({latestContent:n.toString(),version:o,changeSource:t,changes:i.toJSON()}),[2]})})()},onError:function(e){r.onError(e.message)},onMoveOrDelete:function(e){r.onMoveOrDelete({eventType:e.eventType,node:e.node})}});return nx(function(){i()})}})))),function(e){var n=e.services.container,t=null;function r(){return(0,ee._)(function(){var e;return(0,en._)(this,function(r){switch(r.label){case 0:if(t)return[2];return[4,n.exec("bash","-c","echo $REPLIT_DB_URL")];case 1:if((e=r.sent()).error||!e.output)throw Error("unable to find REPLIT_DB_URL");return t=e.output.trim(),[2]}})})()}return te([tn(e,["repldb:read"])],(0,m._)({getReplDbValue:function(e){return(0,ee._)(function(){return(0,en._)(this,function(i){switch(i.label){case 0:return[4,r()];case 1:return i.sent(),[4,n.exec("curl","-s","".concat(t,"/").concat(e))];case 2:return[2,i.sent().output]}})})()},listReplDbKeys:function(e){return(0,ee._)(function(){var i;return(0,en._)(this,function(o){switch(o.label){case 0:return[4,r()];case 1:return o.sent(),[4,n.exec("curl","-s","".concat(t,"?prefix=").concat(e))];case 2:if((i=o.sent()).error||!i.output)return[2,{error:i.error}];return[2,{keys:i.output.split("\n")}]}})})()}},te([tn(e,["repldb:write"])],{setReplDbValue:function(e,i){return(0,ee._)(function(){return(0,en._)(this,function(o){switch(o.label){case 0:return[4,r()];case 1:return o.sent(),[4,n.exec("curl",t,"-s","-d","".concat(e,"=").concat(i))];case 2:return o.sent(),[2]}})})()},deleteReplDbKey:function(e){return(0,ee._)(function(){var i;return(0,en._)(this,function(o){switch(o.label){case 0:return[4,r()];case 1:return o.sent(),[4,n.exec("curl","-s","-XDELETE","".concat(t,"/").concat(e))];case 2:if((i=o.sent()).error||!i.output)return[2,{error:i.error}];return[2,{keys:i.output.split("\n")}]}})})()}})))}(e),{watchActiveFile:function(e){return nx(r.environmentAPIs.watchActiveFile(e))},openFile:(r=e).environmentAPIs.openFile,getActiveFile:function(){return r.environmentAPIs.getActiveFile()}},(i=e.getThemeContext,o=e.onThemeChange,{getCurrentTheme:function(){return i().theme},getCurrentThemeValues:function(){return i().theme.values.global},onThemeChange:function(e){var n=o(e);return nx(function(){n()})},onThemeChangeValues:function(e){var n=o(function(n){return e(n.values.global)});return nx(function(){n()})}}),tm(e,g.toasts),{currentUser:n9(n1),userById:n9(n4),userByUsername:n9(n2),currentRepl:function(e){return n9(n3)((0,m._)({id:f},e))},replById:n9(n3),replByUrl:n9(n6)},(a=e.services.container.client(),s=e.logger.createLogger({api:"exec"}),(0,m._)({},te([tn(e,["write-exec"])],{exec:function(e){return(0,ee._)(function(){var n,t,r,i;return(0,en._)(this,function(o){switch(o.label){case 0:return[4,e.args];case 1:return n=o.sent(),[4,e.env];case 2:if(t=o.sent(),s.info("exec: [".concat(n.join(", "),"]"),{environmentVariables:t}),!n7.Value.Check(tt,t))throw Error("Invalid environment variables");return[4,e.splitStderr];case 3:return r=o.sent(),i=function(){},[2,nx({dispose:function(){i()},promise:new Promise(function(o){i=a.openChannel({service:"exec"},function(a){var l=a.channel;l.onCommand(function(n){r?n.output?e.onOutput(n.output):n.stderr&&e.onStdErr(n.stderr):n.output&&e.onOutput(n.output)}),l.request({exec:{args:n,env:t,splitStderr:!!r}}).then(function(n){if(n.ok)return void o({exitCode:0,error:null});if(n.channelClosed){var t="Channel closed before command's execution finished";e.onError(t),o({exitCode:null,error:t});return}if("open"===l.status&&i(),n.error){var r,a,s=Number(null==(a=n.error)||null==(r=a.match(/-?[0-9]+/g))?void 0:r[0]);o({exitCode:"number"==typeof s?s:null,error:n.error});return}throw Error("Unknown error")}).catch(function(n){s.error("exec: threw crosis error:\n".concat(String(n||"")));var t="exec() failed due to internal error. See console for details.";e.onError(t),o({error:t,exitCode:null})})})})})]}})})()}}))),(l=e.extension,u=e.paneId,c=e.environmentAPIs,d=!1,{activatePane:function(){u&&(c.activatePane(u),d||(d=!0,(0,ei.track)(eo.events.EXTENSION_USED,{action:"used",extensionId:l.extensionId,extensionName:l.manifest.name})))}})),{commands:{registerCommand:function(n,t){return(0,ee._)(function(){var r;return(0,en._)(this,function(i){switch(i.label){case 0:if(!n.commandId||""===n.commandId)throw Error("Attempted to register command without id");if(!n.contributions||!Array.isArray(n.contributions))throw Error("Command: In ".concat(n.commandId,", contributions should be an array"));return 0===n.contributions.length&&e.logger.warn("Command: ".concat(n.commandId," has no contributions")),[4,(0,e3.parseCommandProxyToExtensionCommand)(t,e)];case 1:return r=i.sent(),e.store.set(e4.registerExtensionCreateCommandAtom,{extensionStateAtom:e.extensionStateAtom,createCommand:{id:n.commandId,contributions:n.contributions,create:function(){return(0,ee._)(function(){return(0,en._)(this,function(e){return[2,r]})})()}}}),[2]}})})()},registerCreateCommand:function(n,t){return(0,ee._)(function(){var r,i;return(0,en._)(this,function(o){if(!n.commandId||""===n.commandId)throw Error("Attempted to register command without id");if(!n.contributions||!Array.isArray(n.contributions))throw Error("Command: In ".concat(n.commandId,", contributions should be an array"));return 0===n.contributions.length&&e.logger.warn("Command: ".concat(n.commandId," has no contributions")),(r=n.contributions.filter(function(e){return!(e in nj.ContributionType)})).length>0&&e.logger.warn("Command: ".concat(n.commandId," has unrecognized contributions: ").concat(r.join(", "),". Valid contributions are ").concat(Object.values(nj.ContributionType))),i={id:n.commandId,contributions:n.contributions,create:function(n){var r=n.path;return(0,ee._)(function(){var n;return(0,en._)(this,function(i){switch(i.label){case 0:return[4,Promise.race([t({path:r}),new Promise(function(e){return setTimeout(function(){return e(n_)},50)})])];case 1:if(null===(n=i.sent()))return[2,null];if(n===n_)return e.logger.warn("Command took too long to create. When using registerCreateCommand, you must return a command within ".concat(50,"ms")),[2,null];return[2,(0,e3.parseCommandProxyToExtensionCommand)(n,e)]}})})()}},e.store.set(e4.registerExtensionCreateCommandAtom,{extensionStateAtom:e.extensionStateAtom,createCommand:i}),[2]})})()}},experimental:(0,e9._)((0,m._)({},te([ts(e)],{hasExperimentalApi:function(){return!0}})),{editor:te([ts(e)],(0,m._)({},{getPreferences:function(){return(0,ee._)(function(){var e,n,t,r;return(0,en._)(this,function(i){switch(i.label){case 0:return[4,null===eG.apolloClient||void 0===eG.apolloClient?void 0:eG.apolloClient.query({query:n8})];case 1:if(null==(t=i.sent())||null==(n=t.data)||null==(e=n.currentUser)?void 0:e.workspacePreferences)return[2,(0,tr.getUserPreferences)(t.data.currentUser.workspacePreferences)];throw Error(null==t||null==(r=t.error)?void 0:r.message)}})})()}})),commands:te([ts(e)],(0,m._)({},ta(e))),auth:te([ts(e)],(0,m._)({},{getAuthToken:function(){return(0,ee._)(function(){var n,t;return(0,en._)(this,function(r){switch(r.label){case 0:if(e.extension.isLocal)return[2,[btoa(JSON.stringify({alg:"none",typ:"JWT",local:!0,key:"there-is-no-key-for-local-extensions"})),btoa(JSON.stringify({installationId:e.extension.installationId,extensionId:e.extension.extensionId,userId:e.userId,origin:"https://staging.replit.com"})),"this-is-a-locally-generated-jwt-that-will-fail-verification-to-avoid-being-used-accidentally-in-prod-so-please-check-the-header-for-whether-this-is-a-local-extension"].join(".")];return[4,null===eG.apolloClient||void 0===eG.apolloClient?void 0:eG.apolloClient.query({query:to,variables:{installationId:e.extension.installationId}})];case 1:if(!(null==(n=r.sent())?void 0:n.data))throw Error("Failed to authenticate: something went wrong");if("NotFoundError"===(t=n.data.extensionInstallationById).__typename)throw Error("Failed to authenticate: invalid installation ID");if("ExtensionInstallation"!==t.__typename||!t.token)throw Error("Failed to authenticate: something went wrong");return[2,t.token]}})})()}})),internal:te([ts(e)],(0,m._)({},ta(e)))}),internal:function(e){var n,t,r;return e.store.get(e.extensionStateAtom).enableInternalApi?{hasInternalApi:function(){return!0},ghostwriter:{},container:(n=e.services.container,{getConnectionState:function(){return n.getConnectionState()},onConnectionStateChanged:function(e){var t=n.onConnectionStateChanged(e);return nx(function(){t()})}}),layout:{revealOrInsertTool:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=e.logger.createLogger({api:"revealOrInsertTool"});if(!e.extension.manifest.tools)return void t.warn("No tools defined in extension manifest");if(e.extension.manifest.tools.length<n+1)return void t.warn("Tool index out of bounds");var r=e.extension.manifest.tools[n],i=r.name||e.extension.manifest.name,o=r.handler;e.environmentAPIs.revealOrInsertTool({extensionId:e.extension.extensionId,installationId:e.extension.installationId,baseUrl:e.extension.baseUrl,path:o,name:i})},getLayoutState:function(){return e.environmentAPIs.getLayoutState()},setLayoutState:function(n){return e.environmentAPIs.setLayoutState(n)}},secrets:(t=e.services.secrets,{setSecret:function(e){return(0,ee._)(function(e){var n,r;return(0,en._)(this,function(i){switch(i.label){case 0:return n=e.key,r=e.value,[4,t.addEntries([{key:n,value:r}])];case 1:return i.sent(),[2,(0,tf.Ok)(!0)]}})}).apply(this,arguments)},getSecret:function(e){return(0,ee._)(function(){var n;return(0,en._)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t.read()];case 1:return[2,tf.Ok.apply(void 0,[r.sent().get(e.key)])];case 2:return n=r.sent(),[2,(0,tf.Err)(n)];case 3:return[2]}})})()},getReferenceCode:function(e){return(0,ee._)(function(){return(0,en._)(this,function(n){return[2,(0,tg.getEnvCodeForLanguage)(e.filePath,e.key)]})})()}}),dotReplit:{getConfig:(r=e.services.dotReplit).getConfig,update:r.updateDotReplit},ssh:{getSshConfig:function(){return(0,ee._)(function(){return(0,en._)(this,function(n){return[2,e.environmentAPIs.getSshConfig()]})})()}},commands:ta(e)}:null}(e),debug:{info:function(e,n){return h.info(e,n)},warn:function(e,n){return h.warn(e,n)},error:function(e,n){return h.error(e,n)}},handshake:function(n){return(0,ee._)(function(){var t,r,i,o;return(0,en._)(this,function(a){switch(a.label){case 0:return[4,null==n?void 0:n.clientName];case 1:return r=null!=(t=a.sent())?t:"(unset)",[4,null==n?void 0:n.clientVersion];case 2:return o=null!=(i=a.sent())?i:"(unset)",(0,ei.track)(eo.events.EXTENSION_USED,{action:"sandbox_initialized",clientName:r,clientVersion:o,extensionId:e.extension.extensionId,extensionName:e.extension.manifest.name,installationId:e.extension.installationId}),(0,ee._)(function(){var n,t,i;return(0,en._)(this,function(a){switch(a.label){case 0:if(!e.extension.isLocal||"@replit/extensions"!==r)return[2];return[4,e.services.container.exec("sh","-c","npm view @replit/extensions --json version 2>/dev/null")];case 1:if((t=a.sent()).error)throw t.error;if(!t.output)throw Error("No output from npm");if((i=JSON.parse(null==(n=t.output)?void 0:n.trim()))===o)return[2];return e.logger.warn("There is a new version of @replit/extensions available. You are using ".concat(o,", but the latest version is ").concat(i),{clientVersion:o,latestVersion:i}),[2]}})})(),[2,{success:!0}]}})})()}})}(e);if(!n.contentWindow)throw Error("No contentWindow");var i=nf(r,function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:self,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";return{postMessage:function(n,r){e.postMessage(n,t,r)},addEventListener:n.addEventListener.bind(n),removeEventListener:n.removeEventListener.bind(n)}}(n.contentWindow,self,t),{origin:t,source:n.contentWindow}),o=function(r){if(r.origin===t&&n.contentWindow===r.source){var i=r.data;i.payload&&e.logger.warn("Extension sent deprecated postMessage",i)}};return window.addEventListener("message",o),function(){i(),window.removeEventListener("message",o)}}({extension:n,extensionIframe:s.current,services:c,paneId:i,replId:l,getThemeContext:function(){return h.current},onThemeChange:function(e){return v.current.push(e),function(){v.current.splice(v.current.indexOf(e),1)}},store:p,extensionStateAtom:f,environmentAPIs:o,filePath:a,logger:n.logger.createLogger({sandboxUrl:t,sandboxTitle:r}),userId:u,ghostwriter:x}))},[u,h,c,_,i,p,f,o,l,a,n,t,r,x]);return{isValidExtensionPaneUrl:_,didConnectOnce:w,getIframeProps:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,e9._)((0,m._)({title:r,src:t},e7.default,e),{ref:(0,ne.mergeRefs)([s,e.ref],{breadcrumb:"client/workspace/extensions/sandbox/useExtensionSandbox.tsx:191"}),onLoad:function(n){S(),e.onLoad&&e.onLoad(n)}})},reloadSandbox:(0,B.useCallback)(function(){if(s.current){var e=s.current.src;s.current.src=e}},[])}}function tb(e){var n=e.extension,t=e.environmentAPIs;if(!n.manifest.background)throw Error("ExtensionBackground loaded without a background script defined in manifest");var r=(0,e4.useExtensionStateAtom)(n.installationId),i=ty({extension:n,sandboxUrl:(0,e6.getAssetUrl)(n.baseUrl,n.manifest.background.page),sandboxTitle:"Extension Background: "+n.manifest.name,environmentAPIs:t,paneId:null,filePath:null}),o=i.didConnectOnce,a=i.isValidExtensionPaneUrl,s=i.getIframeProps;return a()&&o&&r?(0,g.jsx)("iframe",(0,m._)({},s({css:{width:"0px",height:"0px",border:"none"}}))):null}var tw=e.i(838124),tj=e.i(557154),t_=e.i(934565),tS=e.i(952030),tC=e.i(373764);function tk(){var e=(0,eN.default)(),n=(0,eB.useCurrentUserId)(),t=(0,e2.default)().container,r=(0,e1.default)(t).url,i=(0,tw.useIsExtensionRepl)(),o=(0,e8.useInstallExtension)(),a=(0,es.useOpenTool)(),s=(0,e8.useInstallExtensionLocallyByURL)(),l=(0,e8.useLoadExtension)(),u=(0,e8.useInitializeExtensionSystem)();(0,tw.useSyncReplConfigIsExtension)();var c=(0,e4.useExtensions)(),d=eZ(),p=(0,U._)((0,B.useState)(!1),2),f=p[0],h=p[1];(0,B.useEffect)(function(){e&&n&&u({replId:e,userId:n})},[e,n,u]);var m=(0,e4.useFileHandlers)(),v=(0,es.useSetExtensionFileHandlers)();(0,B.useEffect)(function(){v(m)},[m,v]);var x=(0,es.useAssociateFiletype)();(0,e0.useInitializeFiletypeAssociations)();var y=(0,es.useFiletypeAssociationRequest)(),b=(0,es.useSetFiletypeAssociationRequest)(),w=function(t){var r=t.filterUser;return function(t){var i=t.active;return(0,ee._)(function(){var t,a;return(0,en._)(this,function(s){switch(s.label){case 0:if(!i)return[2,[]];return[4,null===eG.apolloClient||void 0===eG.apolloClient?void 0:eG.apolloClient.query({query:eM,variables:{replId:e,userId:r?n:void 0}})];case 1:if(!(t=s.sent())||t.error||!(a=t.data.extensionList))return[2,[]];return[2,a.map(function(n){var t;return{match:el.matchLabel,data:{type:"action",label:n.name,icon:(0,g.jsx)(tC.default,{}),description:null!=(t=n.description)?t:"",run:function(){n.url&&(n.installation?l({installationId:(0,eU.asInstallationId)(n.installation.id)}):o({replId:e,extensionId:(0,eU.asExtensionId)(n.id)}))}}}})]}})})()}},j=(0,e4.useExtensionCommands)(nj.ContributionType.CommandBar);return eA({data:{type:"group",key:"Extensions",description:"Commands from Extensions"},commands:function(){return(0,ee._)(function(){var e;return(0,en._)(this,function(n){switch(n.label){case 0:return e=[{data:{}}],[4,Promise.all(j.map(function(n){return(0,ee._)(function(){var t;return(0,en._)(this,function(r){switch(r.label){case 0:return[4,n.create({path:e})];case 1:if(!(t=r.sent()))return[2,null];return[2,(0,e3.wrapExtensionCommand)(t,{path:e})]}})})()}))];case 1:return[2,n.sent().filter(Boolean)]}})})()}},{enabled:!0}),eA({match:el.matchLabel,commands:function(e){return e.active||""!==e.searchQuery?[{match:el.matchLabel,data:{type:"action",label:"Extension Devtools",icon:(0,g.jsx)(tS.default,{}),description:"Manage and deploy this Repl as an extension",run:function(){a({pane:{type:"extensionDevtools"}})}}},{match:el.matchLabel,data:{type:"action",label:"URL",icon:(0,g.jsx)(tS.default,{}),description:"Add an extension by URL",run:function(){h(!0)}}},{match:el.matchLabel,data:{type:"action",label:"From this Repl",icon:(0,g.jsx)(tS.default,{}),description:"Load this Repl as an extension",run:function(){r&&s(r)}}},{match:el.matchLabel,data:{type:"context",label:"My Extensions",icon:(0,g.jsx)(tC.default,{}),description:"Browse extensions you have created"},commands:w({filterUser:!0})},{match:el.matchLabel,data:{type:"action",label:"Docs",icon:(0,g.jsx)(t_.default,{}),description:"Read the Extensions docs",run:function(){window.open(eL.LINKS_DOCS.EXTENSIONS,"_blank","noopener")}}}]:[]},data:{type:"context",label:"Extensions",icon:(0,g.jsx)(tC.default,{}),description:"Manage extensions"}},{enabled:i}),(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(eR.Modal,{isOpen:f,onRequestClose:function(){return h(!1)},children:(0,g.jsx)(tj.default,{prompt:"Add an extension by URL",desc:"Insert extension url",placeholder:"https://example-extension.replit.app",type:"text",onCancel:function(){return h(!1)},onConfirm:function(e){s(e)}})}),(0,g.jsx)(eR.Modal,{isOpen:!!y,onRequestClose:function(){return b(null)},children:y?(0,g.jsx)(eq,{fileExtension:y.fileExtension,extensionId:y.extensionId,fileHandlerId:y.fileHandlerId,onCancel:function(){return b(null)},onConfirm:function(){return(0,ee._)(function(){var e;return(0,en._)(this,function(n){switch(n.label){case 0:return e=y.fileExtension,[4,x({fileExtension:e,newAssociation:{extensionId:y.extensionId,fileHandlerId:y.fileHandlerId}})];case 1:return n.sent(),b(null),[2]}})})()}}):null}),c.map(function(e){return e.manifest.background?(0,g.jsx)(tb,{environmentAPIs:d,extension:e},e.installationId):null})]})}var tI=e.i(127227),tT=e.i(292297),tR=e.i(761922);function tP(){var e=(0,e2.default)().fs,n=(0,U._)((0,B.useState)(!1),2),t=n[0],r=n[1],i=(0,U._)((0,B.useState)(!1),2),o=i[0],a=i[1],s=(0,B.useId)();(0,B.useEffect)(function(){if(!o)return e.onDiskQuotaExceeded(function(){r(!0)})},[e,o]);var l=(0,B.useCallback)(function(){r(!1)},[r]);return(0,g.jsx)(eR.Modal,{isOpen:t,onRequestClose:l,children:(0,g.jsx)(A.View,{gap:24,children:(0,g.jsxs)(A.View,{gap:24,children:[(0,g.jsxs)(ez.Header,{level:3,variant:"headerDefault",children:["Oops! This Repl's disk is full"," ",(0,g.jsx)(tT.default,{color:R.tokens.accentNegativeDefault,size:20})]}),(0,g.jsxs)(ez.Text,{variant:"subheadDefault",children:["Please free up space by deleting some files. You can open the file tree by clicking the ",(0,g.jsx)(tR.default,{})," icon on the left."]}),(0,g.jsx)(ez.Text,{children:"You can check how much space you are using from the Repl Resources section under the file tree."}),(0,g.jsxs)(A.View,{row:!0,gap:8,tag:"label",children:[(0,g.jsx)(tI.Checkbox,{id:s,checked:o,onChange:a}),(0,g.jsx)(ez.Text,{variant:"small",children:"Do not show this message again for this session."})]}),(0,g.jsx)(eW.Button,{onClick:l,text:"Close"})]})})})}var tE=e.i(816639),tA=e.i(989740),tD=e.i(679668),tV=e.i(515791);function tO(){var e=(0,es.useMoveOrDeleteFile)(),n=(0,tA.default)({moveOrDeleteFile:e}),t=n.isConverging,r=n.didContentsDiverge,i=n.showMoreDetail,o=n.failedFiles,a=n.failedFilesOptions,s=n.selectedFile,l=n.setSelectedFile,u=n.reviewingPrompt,c=n.onChoice,d=n.local,p=n.remote,f=[eT.rcss.minHeight("7em"),eT.rcss.maxHeight("50vh"),eT.rcss.overflowY("auto"),{"> div":{display:"flex",alignItems:"stretch",width:"100%",height:"100%"},"> div > .cm-editor":{flex:"1 1 auto",width:"100%"}}];return(0,g.jsx)(eR.Modal,{css:[{maxHeight:"90%"}],preventClose:!0,maxWidth:"90%",isOpen:r,onRequestClose:function(){},children:(0,g.jsxs)(A.View,{gap:24,children:[(0,g.jsx)(ez.Header,{level:3,variant:"headerDefault",children:"Replit is out of sync!"}),(0,g.jsxs)(ez.Text,{children:["Sometimes Replit has trouble making sure everyone's code is the same. Let us know which version of"," ",o.length>1?"these files":"this file"," you'd like to keep."," ",o.length>1?(0,g.jsxs)("strong",{children:["There are ",o.length," files impacted by this."]}):""]}),t?(0,g.jsx)(tV.default,{}):(0,g.jsxs)(g.Fragment,{children:[a.length?(0,g.jsx)(tD.Select,{"aria-label":"Select file with diverged contents",initialSelectedItem:a[0],selectedItem:a.find(function(e){return e.path===s}),items:a,onChange:function(e){l(e.path)}}):null,i?(0,g.jsxs)(A.View,{css:[eT.rcss.backgroundColor.redDimmest,eT.rcss.font.code],pt:16,p:8,row:!0,gap:16,justify:"start",align:"center",children:[(0,g.jsx)(ez.Text,{variant:"subheadDefault",multiline:!1,children:"Debug View"}),(0,g.jsxs)(ez.Text,{multiline:!1,children:["Divergence type: ",null==u?void 0:u.case]})]}):null,(0,g.jsxs)(A.View,{row:!0,gap:8,children:[(0,g.jsxs)(A.View,{css:[{flexBasis:0}],grow:!0,shrink:!0,children:[(0,g.jsx)(ez.Text,{variant:"subheadDefault",multiline:!1,children:"My changes"}),(0,g.jsx)(E.Surface,{elevated:!0,grow:!0,shrink:!0,py:8,children:(0,g.jsx)(A.View,{css:f,children:(0,g.jsx)(tE.DiffComponent,{diffViewer:d})})}),(0,g.jsxs)(A.View,{pt:16,children:[(0,g.jsx)(ez.Text,{css:[eT.rcss.textAlign.center],children:"This might disrupt other people's work or create unexpected bugs."}),(0,g.jsx)(eW.Button,{onClick:function(){c("local")},text:"Reset to Mine"})]})]}),(0,g.jsxs)(A.View,{css:[{flexBasis:0}],grow:!0,shrink:!0,children:[(0,g.jsx)(ez.Text,{variant:"subheadDefault",multiline:!1,children:"Shared changes"}),(0,g.jsx)(E.Surface,{elevated:!0,grow:!0,shrink:!0,py:8,children:(0,g.jsx)(A.View,{css:f,children:(0,g.jsx)(tE.DiffComponent,{diffViewer:p})})}),(0,g.jsxs)(A.View,{pt:16,justify:"end",children:[(0,g.jsx)(ez.Text,{css:[eT.rcss.textAlign.center],children:"This is the safest option and won't disrupt other's work."}),(0,g.jsx)(eW.Button,{onClick:function(){c("remote")},text:"Sync to Shared",colorway:"primary"})]})]})]})]})]})})}var tF=e.i(260924),tM=e.i(317919),tL=e.i(399344),tU=e.i(282453),tB=e.i(703916),tN=e.i(316699),tG=e.i(142685),tW=e.i(610357);e.i(653863);var tz=e.i(973519),tH=e.i(744895),tq=e.i(702522),tK=e.i(41e4),t$=e.i(927158),tQ=e.i(90376),tY=e.i(759097),tJ=["ðŸ”„","â³","ðŸ”ƒ","âš¡","ðŸš€","âœ¨"];function tX(e){return new Promise(function(n){return setTimeout(n,e)})}var tZ=e.i(989481),t0=e.i(793579),t1=e.i(366492),t2=e.i(279042);function t4(){var e=(0,v._)(["\n  fragment ReplEnvironmentDesktopMyReplsSearchRepl on Repl {\n    id\n    title\n    timeUpdated\n    url\n    iconUrl\n    ...ReplLinkRepl\n    owner {\n      ... on User {\n        id\n        username\n        image\n      }\n      ... on Team {\n        id\n        username\n        image\n      }\n    }\n  }\n  ","\n"]);return t4=function(){return e},e}function t8(){var e=(0,v._)(["\n  query ReplEnvironmentDesktopMyReplsSearch($query: String, $count: Int) {\n    currentUser {\n      id\n      search {\n        repls(query: $query, count: $count) {\n          id\n          ...ReplEnvironmentDesktopMyReplsSearchRepl\n        }\n      }\n    }\n  }\n  ","\n"]);return t8=function(){return e},e}var t3=(0,x.gql)(t4(),t2.ReplLinkReplFragmentDoc),t6=(0,x.gql)(t8(),t3),t9=e.i(314531),t5=e.i(46654),t7=e.i(228108),re=e.i(290446),rn=e.i(243074),rt=(0,eI.cssRecord)({root:[eT.rcss.viewStyle,eT.rcss.rowWithGap(8),eT.rcss.align.center,eT.rcss.px(8),{textDecoration:"none"}],meta:{fontSize:10}});function rr(e){var n=e.repl,t=e.height,r=e.isActive,i=e.searchQuery,o=n.title,a=(0,B.useMemo)(function(){return i?t9.default.match(i,o):null},[i,o]);return(0,g.jsxs)(t1.default,{href:n.url,passHref:!0,style:{height:t},css:rt.root,children:[(0,g.jsx)(t7.default,{alt:n.title,size:32,iconUrl:n.iconUrl}),(0,g.jsxs)(A.View,{grow:!0,shrink:!0,gap:2,children:[(0,g.jsx)(re.HighlightMatches,{text:n.title,highlight:null==a?void 0:a.ranges,dimmed:!r}),(0,g.jsxs)(ez.Text,{css:rt.meta,color:"dimmest",multiline:!1,children:[n.owner.username," â€¢ edited ",(0,t5.ago)(n.timeUpdated)]})]})]})}function ri(){var e=(0,es.useOpenFile)(),n=(0,es.useOpenTool)();return(0,B.useCallback)(function(t){return(0,ec.isFilePane)(t)&&t.data.path?e((0,e9._)((0,m._)({},t.data),{path:t.data.path})):n({pane:t})},[n,e])}var ro=e.i(926118),ra=e.i(971131),rs=(0,et.atom)(!1),rl=(0,et.atom)(null,function(e,n){e(rs)?(0,ra.flushSync)(function(){n(rs,!1)}):n(rs,!0)});function ru(){return(0,er.useSetAtom)(rl)}var rc=e.i(62534),rd=e.i(695337),rp={id:"toggleKeyboardShortcuts",name:"Keyboard shortcuts Help",description:"Opens the keyboard shortcuts modal",default:"Shift-/"};let rf=function(){var e=(0,er.useAtomValue)(rs),n=ru();return(0,g.jsx)(eR.Modal,{isOpen:e,onRequestClose:n,maxWidth:1200,centered:!0,children:(0,g.jsx)(A.View,{gap:12,children:(0,g.jsx)(rh,{})})})};var rg=["toggleGlobalCommandBarCommand","agent.switchMode","agent.toggle","webviewpane.reload","toggleKeyboardShortcuts","sidebar.toggle","paneMenu.toggle","files.searchContents","files.searchFiles","repl.showShell"];function rh(){var e=(0,eb.useKeyBindings)(),n=ri(),t=ru(),r=(0,Z._)(e.values()).filter(function(e){return e.shortcut}).filter(function(e){return void 0===e.scope}).sort(function(e,n){var t=rg.indexOf(e.id),r=rg.indexOf(n.id);return -1!==t&&-1!==r?t-r:e.description&&!n.description?-1:!e.description&&n.description?1:e.name.localeCompare(n.name)}),i=(0,B.useCallback)(function(){n({type:"preferences",data:{tab:1}}),t()},[n,t]);return(0,g.jsxs)(A.View,{p:0,gap:12,children:[(0,g.jsx)(ez.Header,{level:2,variant:"subheadBig",children:"Keyboard shortcuts"}),r.length>0?(0,g.jsx)(E.Surface,{className:rd.default.surface,children:r.map(function(e){return(0,g.jsxs)(A.View,{row:!0,align:"start",justify:"space-between",gap:8,"data-testid":e.id,children:[(0,g.jsxs)(A.View,{grow:0,shrink:!0,gap:2,children:[(0,g.jsx)(ez.Text,{multiline:!1,children:e.name}),e.description?(0,g.jsx)(ez.Text,{color:"dimmest",multiline:!1,children:e.description}):null]}),e.shortcut?(0,g.jsx)(ro.KeyComboBlocks,{small:!0,keyCombo:e.shortcut}):null]},e.id)})}):(0,g.jsx)(A.View,{children:(0,g.jsx)(ez.Text,{color:"dimmest",children:"No keyboard shortcuts found."})}),(0,g.jsx)(A.View,{align:"start",children:(0,g.jsx)(eW.Button,{variant:"outlined",onClick:i,iconLeft:(0,g.jsx)(rc.default,{}),text:"Customize keyboard shortcuts"})})]})}var rm=e.i(556088),rv=e.i(61524),rx=e.i(171362),ry=e.i(369948),rb=e.i(360877),rw=e.i(357399),rj=["fontSize","wrapping","minimapDisplay","indentDetection","indentFormatPastes","indentIsSpaces","keyboardHandler","showFileTreeGitStatus","codeIntelligence","shellBellAudio","accessibleTerminal","webviewAutoOpenOnPortOpened","forwardPortsAutomatically","multiselectModifierKey","codeSuggestion","chatEngine","ghostwriterModelSelection"],r_=e.i(982829),rS=e.i(211733),rC=e.i(133783),rk=e.i(959407),rI=e.i(6560),rT=e.i(578166),rR=e.i(77164),rP=e.i(718610);function rE(e){return(0,B.useMemo)(function(){var n=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[];return Object.entries(t).forEach(function(t){var o,a=(0,U._)(t,2),s=a[0],l=a[1],u=(0,Z._)(r).concat([s]);if(l.children){var c,d=n(l.children,u);i.push({match:el.matchLabel,data:{type:"context",label:l.label,icon:null!=(c=l.icon)?c:(0,g.jsx)(g.Fragment,{})},commands:function(){return d}})}else l.component&&i.push({match:el.matchLabel,data:{type:"action",label:l.label,icon:null!=(o=l.icon)?o:(0,g.jsx)(g.Fragment,{}),run:function(){return e(u)}}})}),i},t=n(rR.developerTabs);return{data:{type:"context",label:"Developer",icon:(0,g.jsx)(rP.default,{})},commands:function(e){return e.active||""!==e.searchQuery?t:[]}}},[e])}var rA=e.i(1736),rD=e.i(729122),rV=e.i(589721);e.i(925218);var rO=e.i(267103);function rF(){var e=(0,v._)(["\n  query ConfiguredTools($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        hasAuthUsers\n        defaultBucket {\n          ... on Bucket {\n            id\n          }\n        }\n      }\n    }\n  }\n"]);return rF=function(){return e},e}var rM={},rL=(0,x.gql)(rF()),rU=e.i(424746),rB=e.i(630818),rN=e.i(882027);function rG(e){var n,t,r,i,o,a,s,l,u,c,d,p,f,h,v,x,b,w,j,_=e.openPane,S=e.currentPaneId,C=(0,e2.default)().fs,k=(0,ed.usePaneUIContext)(),I=(0,B.useCallback)(function(e){var n=e.path,t=(0,ec.getPaneTypeForFile)({path:n});(0,ei.track)(eo.events.TOOL_OPENED,{source:"New Tab",tool:t}),_({pane:{type:t,data:{path:n}}})},[_]),T=(0,es.useMoveAndReplacePane)(),R=(0,es.useGetPanes)(),P=(0,B.useCallback)(function(e){if((0,ei.track)(eo.events.TOOL_OPENED,{source:"New Tab",tool:e.type}),S&&(0,ec.isSingleton)(e.type)){var n=R().find(function(n){var t=(0,U._)(n,2);return t[0],t[1].type===e.type});if(n)return T({from:n[0],to:S})}_({pane:e})},[_,R,S,T]),E=rE((0,B.useCallback)(function(e){P({type:"developer",data:{tab:e}})},[P])),A=(0,rA.useShouldHideFileInWorkspace)(),D=(0,ef.useGetRecentFiles)(),V=rH(S),O=(0,ex.useAssistantDeprecationCommand)({currentPaneId:S}),F=(x=(n=(0,eN.default)(),o=(i=(null==(r=(null==(t=(0,rV.useNewPanePrimaryOutputQuery)({variables:{replId:n}}).data)?void 0:t.getRepl.__typename)==="Repl"?t.getRepl:null)?void 0:r.config)||{}).isServer,a=i.isAgentStack,s=i.isExpertMode,(0,B.useMemo)(function(){return a?[{type:"automations"}]:s?(0,Z._)(o?[{type:"webview"}]:[]).concat([{type:"runnerOutput"}]):[{type:"webview"}]},[o,a,s])),b=(p=(null==(d=(u={variables:{replId:(0,eN.default)()}},c=(0,m._)({},rM,u),y.useQuery(rL,c)).data)?void 0:d.getRepl.__typename)==="Repl"?d.getRepl:null,f=void 0!==(0,rU.useNeonDevelopmentDatabase)().database,h=!!(null==p?void 0:p.hasAuthUsers),v=(null==p||null==(l=p.defaultBucket)?void 0:l.__typename)==="Bucket",(0,B.useMemo)(function(){var e=[];return h&&e.push({type:"replitAuth"}),f&&e.push({type:"neon"}),v&&e.push({type:"objectStorage"}),e},[f,h,v])),w=(0,ev.useToolPanes)(),j=(0,es.usePanes)(),(0,B.useMemo)(function(){var e=new Map,n=new Set,t=[],r=function(r,i){if((0,ec.isExtensionPane)(i))return void t.push(i);if(!n.has(i.type)){n.add(i.type);var o=e.get(r);o?o.push(i):e.set(r,[i])}},i=!0,o=!1,a=void 0;try{for(var s,l=x[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;r("output",u)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}var c=!0,d=!1,p=void 0;try{for(var f,g=b[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var h=f.value;r("configured",h)}}catch(e){d=!0,p=e}finally{try{c||null==g.return||g.return()}finally{if(d)throw p}}var m=!0,v=!1,y=void 0;try{for(var _,S=rW[Symbol.iterator]();!(m=(_=S.next()).done);m=!0){var C=_.value;r("suggested",C)}}catch(e){v=!0,y=e}finally{try{m||null==S.return||S.return()}finally{if(v)throw y}}var k=!0,I=!1,T=void 0;try{for(var R,P=w[Symbol.iterator]();!(k=(R=P.next()).done);k=!0){var E=R.value;r("rest",E)}}catch(e){I=!0,T=e}finally{try{k||null==P.return||P.return()}finally{if(I)throw T}}var A=[],D=!0,V=!1,O=void 0;try{for(var F,M=e.values()[Symbol.iterator]();!(D=(F=M.next()).done);D=!0){var L=F.value,B=!0,N=!1,G=void 0;try{for(var W,z=L[Symbol.iterator]();!(B=(W=z.next()).done);B=!0)!function(){var e=W.value,n=!(0,ec.isSingleton)(e.type)&&!(0,ec.isFilePane)(e)&&j.find(function(n){var t=(0,U._)(n,2);return(t[0],t[1]).type===e.type});n&&A.push(n)}()}catch(e){N=!0,G=e}finally{try{B||null==z.return||z.return()}finally{if(N)throw G}}}}catch(e){V=!0,O=e}finally{try{D||null==M.return||M.return()}finally{if(V)throw O}}return{groupedPanes:e,existingNonSingletonTools:A,extensions:t}},[x,b,w,j])),M=F.groupedPanes,L=F.existingNonSingletonTools,N=F.extensions;return(0,B.useMemo)(function(){var e,n,t,r=(0,rI.createFindOrCreateFileCommand)({openFile:I,fs:C,shouldHideFile:A,getRecentFiles:D}),i=(n=(e={fs:C,openFile:I}).openFile,t=e.fs,{match:el.fzfMatchLabel,data:{type:"context",label:"New file",description:"Create a new file",icon:(0,g.jsx)(tS.default,{})},commands:function(e){var r=e.searchQuery,i=e.active;return r&&i?[{match:el.matchLabel,data:{type:"action",description:"Create a new file",label:r,icon:(0,g.jsx)(rB.default,{path:r}),run:function(){return(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:return[4,t.stat(r)];case 1:if(e.sent().exists)return[2,{type:"error",message:'"'.concat(r,'" already exists')}];return[4,t.writeFile(r,tl.default.from(""))];case 2:if(e.sent().error)return[2,{type:"error",message:'Could not create "'+r+'"'}];return n({path:r}),[2]}})})()}}}]:[]}}),o=[O];V&&o.push(V);var a=function(e,n){if(n.panes&&0!==n.panes.length){var t=[],r=!0,i=!1,a=void 0;try{for(var s,l=n.panes[Symbol.iterator]();!(r=(s=l.next()).done);r=!0)!function(){var e=s.value;L.some(function(n){var t=(0,U._)(n,2);return(t[0],t[1]).type===e.type})||t.push(rz(e,P,k,n.large))}()}catch(e){i=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw a}}o.push({data:"context"===e.type?(0,e9._)((0,m._)({},e),{icon:(0,g.jsx)(g.Fragment,{})}):e,commands:function(){return t}})}};return a({type:"context",label:"Your App"},{panes:M.get("output"),large:!0}),a({type:"group",key:"configured"},{panes:M.get("configured")}),L.length>0&&S&&o.push({data:{label:"Jump to existing tab",type:"context",icon:(0,g.jsx)(g.Fragment,{})},commands:function(){return L.map(function(e){var n=(0,U._)(e,2),t=n[0];return rz(n[1],function(){T({from:t,to:S})},k)})}}),a({type:"context",label:"Suggested"},{panes:M.get("suggested")}),a({type:"group",key:"Other tools"},{panes:M.get("rest")}),o.push({data:{type:"context",label:"Extensions",icon:(0,g.jsx)(g.Fragment,{})},commands:function(){return N.map(function(e){return rz(e,P,k)})}}),L.length>0&&o.push({data:{key:"existing-non-singleton-tools",type:"group"},commands:function(){return L.map(function(e){var n=(0,U._)(e,2);return rz((n[0],n[1]),P,k)})}}),o.push(E),o.push({data:{type:"context",label:"Files",icon:(0,g.jsx)(g.Fragment,{})},commands:function(){return[r,i]}}),{data:{type:"group",key:"root",description:"Search for tools & filesâ€¦"},commands:function(){return o}}},[C,D,A,I,E,M,N,L,S,T,P,k,V,O])}var rW=[{type:"deployments"},{type:"integrations"},{type:"neon"},{type:"objectStorage"},{type:"replitAuth"},{type:"securityScan"},{type:"envEditor"}];function rz(e,n,t){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=r?24:void 0,o=t.getTitle(e),a=t.Icon({pane:e,size:i});return{match:(0,eh.matchToolPane)({pane:e,aliases:em.paneAliases.get(e.type),iconSize:i}),data:{key:"extension"===e.type?"extension-".concat(e.data.installationId,"-").concat(e.data.path):void 0,type:"action",label:o,icon:a,run:function(){return n(e)}}}}function rH(e){var n=(0,es.useRemovePane)(),t=(0,es.useAgentLayout)(),r=(0,rO.useObservable)(t.isCollapsed),i=t.toggle;return(0,B.useMemo)(function(){return r?{match:el.matchLabel,data:{type:"action",label:"Open Agent",icon:(0,g.jsx)(rN.default,{}),run:function(){e&&n(e),i(!0)}}}:null},[r,i,n,e])}var rq=e.i(368964),rK={nextTab:{id:"tabs.next",name:"Switch to next tab",default:(0,I._)({},rq.KeybindingsEnvironmentEnum.DesktopApp,(0,ek.defaultKeyCombo)({cmdOrCtrl:!0,shift:!0,key:"]"}))},previousTab:{id:"tabs.previous",name:"Switch to previous tab",default:(0,I._)({},rq.KeybindingsEnvironmentEnum.DesktopApp,(0,ek.defaultKeyCombo)({cmdOrCtrl:!0,shift:!0,key:"["}))},newTab:{id:"tabs.new",name:"New tab",description:"Opens a tab in the current active group",default:(0,I._)({},rq.KeybindingsEnvironmentEnum.DesktopApp,(0,ek.defaultKeyCombo)({cmdOrCtrl:!0,key:"t"}))},closeTab:{id:"tabs.close",name:"Close tab",description:"Close the current active tab",default:(0,I._)({},rq.KeybindingsEnvironmentEnum.DesktopApp,(0,ek.defaultKeyCombo)({cmdOrCtrl:!0,key:"w"}))},reopenClosedTab:{id:"tabs.reopenClosed",name:"Reopen closed tab",default:(0,I._)({},rq.KeybindingsEnvironmentEnum.DesktopApp,(0,ek.defaultKeyCombo)({cmdOrCtrl:!0,shift:!0,key:"t"}))},findFile:{id:"files.find",name:"Find file",default:(0,ek.defaultKeyCombo)({cmdOrCtrl:!0,key:"p"})},searchFileContents:{id:"files.searchContents",name:"Search file contents",default:rT.keyboardShortcut},run:{id:"repl.run",name:"Run Repl",default:(0,ek.defaultKeyCombo)({cmdOrCtrl:!0,key:"Enter"})},toggleInviteDialog:{id:"repl.multiplayers",name:"See multiplayers",default:(0,ek.defaultKeyCombo)({cmdOrCtrl:!0,key:"m"})},showShell:{id:"repl.showShell",name:"Show shell",default:(0,ek.defaultKeyCombo)({ctrl:!0,key:"`"}),description:"Opens or reveals a Shell in a tab"},showConsole:{id:"repl.showConsole",name:"Show console",description:"Opens or reveals the Console in a tab",default:void 0},showReplitAi:{id:"repl.showGhostwriter",name:"Show Replit AI",description:"Opens or reveals Replit AI in a tab",default:void 0},showSettings:{id:"repl.showSettings",name:"Show settings",description:"Opens or reveals the Settings tab",default:(0,I._)({},rq.KeybindingsEnvironmentEnum.DesktopApp,(0,ek.defaultKeyCombo)({cmdOrCtrl:!0,key:","}))},saveAllFiles:{id:"repl.saveAllFiles",name:"Save all files",description:"Forces all changes to be flushed to disk",default:void 0},showGit:{id:"repl.showGit",name:"Show git",description:"Opens or reveals the Git tool in a tab",default:void 0},toggleFloatPaneGroup:{id:"paneGroup.toggleFloat",name:"Toggle float group",description:"Floats or un-floats the current active group",default:void 0},toggleMaximizePaneGroup:{id:"paneGroup.toggleMaximize",name:"Toggle maximize group",description:"Maximizes or restores the current active group",default:void 0},removePaneGroup:{id:"paneGroup.close",name:"Close group",description:"Closes all tabs in the current active group",default:void 0},removeOthersInPaneGroup:{id:"paneGroup.closeOthers",name:"Close other tabs in group",description:"Closes all tabs except the visible one in the current active group",default:void 0},insertPaneGroupUp:{id:"paneGroup.insertUp",name:"Insert group above",description:"Adds a new group above the current active group",default:void 0},insertPaneGroupRight:{id:"paneGroup.insertRight",name:"Insert group right",description:"Adds a new group to the right of the current active group",default:void 0},insertPaneGroupLeft:{id:"paneGroup.insertLeft",name:"Insert group left",description:"Adds a new group to the left of the current active group",default:void 0},insertPaneGroupDown:{id:"paneGroup.insertDown",name:"Insert group below",description:"Adds a new group below the current active group",default:void 0},moveTabUpGroup:{id:"tabs.move.groupUp",name:"Move tab into group above",description:"Moves the current active tab into the group above",default:void 0},moveTabRightGroup:{id:"tabs.move.groupRight",name:"Move tab into group right",description:"Moves the current active tab into the group to the right",default:void 0},moveTabLeftGroup:{id:"tabs.move.groupLeft",name:"Move tab into group left",description:"Moves the current active tab into the group to the left",default:void 0},moveTabDownGroup:{id:"tabs.move.groupDown",name:"Move tab into group below",description:"Moves the current active tab into the group below",default:void 0},moveFocusUp:{id:"paneGroup.focusUp",name:"Move focus to group above",description:"Move focus to the group above the current active group",default:void 0},moveFocusRight:{id:"paneGroup.focusRight",name:"Move focus to group right",description:"Move focus to the group to the right of the current active group",default:void 0},moveFocusLeft:{id:"paneGroup.focusLeft",name:"Move focus to group left",description:"Move focus to the group to the left of the current active group",default:void 0},moveFocusDown:{id:"paneGroup.focusDown",name:"Move focus to group below",description:"Move focus to the group below the current active group",default:void 0},webviewRefresh:{id:"webviewpane.reload",name:"Refresh preview",description:"Reload the preview pane",default:(0,ek.defaultKeyCombo)({alt:!0,key:"r"})},keepTab:{id:"tab.keep",name:"Keep tab",description:"Converts a preview tab to a persisted tab",default:void 0}},r$=e.i(464092),rQ=e.i(51606),rY=e.i(243914),rJ=e.i(115357),rX=e.i(428070),rZ=e.i(559073),r0=e.i(121817),r1=e.i(592877),r2=e.i(566818),r4=e.i(170314),r8=Object.values(rK);let r3=(0,B.memo)(function(e){var n,t,r,i,o,a,s,l,u,c,d,p,f,h,m,v,x,y,b,w=e.isAdmin,j=e.isSubscribed,_=eC(),S=(0,ef.useGetRecentFiles)(),C=(0,e2.default)(),k=C.fs,T=C.container,R=(0,r$.useForkContext)(),P=R.fork,E=R.isForking,A=(0,rD.useRunInfo)(),D=A.isOffline,V=A.isWorkflowsLoading,O=A.isRunning,F=(0,rD.useOnToggleRun)(),M=(0,rA.useShouldHideFileInWorkspace)(),L=(0,es.useOpenFile)(),N=(0,es.useNewTab)(),G=(0,es.useCloseTab)(),W=(0,es.useRelativeMoveTab)(),z=(0,es.useReopenClosedTab)(),H=(0,es.useMoveFocus)(),K=(0,es.useSwitchTab)(),J=(0,es.useCommitPane)(),X=(0,es.useActivePaneId)(),et=(0,es.useActivePaneGroupId)(),er=(0,es.useToggleFloating)(),ea=(0,es.useMaximizedPane)().toggleMaximizePane,eu=(0,es.useRemovePaneGroup)(),eh=(0,es.useRemoveOtherPanesInGroup)(),em=(0,es.useCancelQuickJump)(),ev=(0,es.useSplitPane)(),ex=(0,ep.usePaneBindings)(X),ey=(0,Y.useQueryParam)("replUrl","string"),ew=(0,eN.default)(),ej=(0,q.default)(),e_=(0,es.usePanesCount)(),eS=(0,es.useOpenTool)(),ek=(0,eX.default)(),eI=(0,rC.default)(),eT=(0,e1.default)(T).url,eP=(0,e$.default)().showNotice,eD=w||!1,eV=(0,Y.useQueryParam)("debug","boolean"),eO=(0,rk.default)("vscode"),eF=eO.openEditor,eM=eO.onConfirmConfig,eL=eO.isConfigModalOpen,eU=eO.closeConfigModal,eB=(0,tN.default)(function(e){return(0,ei.track)(eo.events.PROJECT_RAN,{replId:ew,placement:e})},500);(0,eb.useCommandBinding)(function(){return[rK.saveAllFiles.id,function(){k.flush(void 0,td.FlushSource.MANUAL_SAVE)}]},[k]),(0,eb.useCommandBinding)(function(){return[rK.newTab.id,function(){return N()}]},[N]),(0,eb.useCommandBinding)(function(){return[rK.nextTab.id,function(){return K("next")}]},[K]),(0,eb.useCommandBinding)(function(){return[rK.previousTab.id,function(){return K("previous")}]},[K]),(0,eb.useCommandBinding)(function(){return[rK.closeTab.id,function(){var e=G();return e||e_()>0}]},[G,e_]),(0,eb.useCommandBinding)(function(){return[rK.reopenClosedTab.id,function(){return z()}]},[z]),(0,eb.useCommandBinding)(function(){return[rK.moveTabUpGroup.id,function(){return W("above")}]},[W]),(0,eb.useCommandBinding)(function(){return[rK.moveTabRightGroup.id,function(){return W("rightOf")}]},[W]),(0,eb.useCommandBinding)(function(){return[rK.moveTabLeftGroup.id,function(){return W("leftOf")}]},[W]),(0,eb.useCommandBinding)(function(){return[rK.moveTabDownGroup.id,function(){return W("below")}]},[W]),(0,eb.useCommandBinding)(function(){return X?[rK.keepTab.id,function(){return J(X)}]:void 0},[X,J]),(0,eb.useCommandBinding)(function(){return X?[rK.insertPaneGroupUp.id,function(){return ev({paneId:X,placement:"above",autoFocus:!0})}]:void 0},[X]),(0,eb.useCommandBinding)(function(){return X?[rK.insertPaneGroupRight.id,function(){return ev({paneId:X,placement:"rightOf",autoFocus:!0})}]:void 0},[X]),(0,eb.useCommandBinding)(function(){return X?[rK.insertPaneGroupLeft.id,function(){return ev({paneId:X,placement:"leftOf",autoFocus:!0})}]:void 0},[X]),(0,eb.useCommandBinding)(function(){return X?[rK.insertPaneGroupDown.id,function(){return ev({paneId:X,placement:"below",autoFocus:!0})}]:void 0},[X]),(0,eb.useCommandBinding)(function(){return[eE.id,function(){return _()}]},[_]);var eW=ru(),ez=(0,Q.useIsInMobileWorkspace)();(0,eb.useCommandBinding)(function(){return[rp.id,function(){if(function(){var e=document.activeElement;if(!e)return!1;var n=e.tagName.toLowerCase();return"textarea"===n||("input"===n?["text","password","email","search","tel","url","number","date","datetime-local","month","time","week"].includes(e.type.toLowerCase()):!!e.isContentEditable||"true"===e.getAttribute("contenteditable"))}()||ez)return!1;eW()}]},[eW]);var eH=(0,eb.useKeyCombo)(rK.findFile.id);(0,eb.useCommandBinding)(function(){return[rK.findFile.id,function(){return _(rI.createFindOrCreateFileCommand({openFile:L,fs:k,shouldHideFile:M,getRecentFiles:S,keyboardShortcut:eH}))}]},[_]);var eq=eg({type:"files"});eA(rI.createFindOrCreateFileCommand({openFile:L,fs:k,shouldHideFile:M,getRecentFiles:S,getCurrentlyOpenFilePanesCommands:eq,keyboardShortcut:eH}));var eQ=(0,eb.useKeyCombo)(rK.searchFileContents.id),eY=(0,es.useOpenTool)(),eJ=(0,B.useCallback)(function(e){(0,ec.isFilePane)(e.pane)||(0,ei.track)(eo.events.TOOL_OPENED,{source:"Command Bar",tool:e.pane.type}),eY(e)},[eY]);(0,eb.useCommandBinding)(function(){return[rK.searchFileContents.id,function(){if((null==ex?void 0:ex.type)==="searchReplace"){null==(e=ex.focusSearchInput)||e.call(ex);return}(0,ei.track)(eo.events.SEARCH_PANE_USED,{action:"opened_via_shortcut"});var e,n,t=void 0;(null==ex?void 0:ex.type)==="codeEditor"&&(t=null==(n=ex.getCurrentSelectionText)?void 0:n.call(ex)),eJ({pane:{type:"searchReplace",data:{initialQuery:t}}})}]},[ex,eJ]),(0,eb.useCommandBinding)(function(){return X?[rK.toggleFloatPaneGroup.id,function(){return er(X)}]:void 0},[X]),(0,eb.useCommandBinding)(function(){return X?[rK.toggleMaximizePaneGroup.id,function(){return ea(X)}]:void 0},[X]),(0,eb.useCommandBinding)(function(){return et?[rK.removePaneGroup.id,function(){eu({paneGroupId:et}),em()}]:void 0},[et]),(0,eb.useCommandBinding)(function(){return X?[rK.removeOthersInPaneGroup.id,function(){eh(X)}]:void 0},[X]),(0,eb.useCommandBinding)(function(){return[rK.moveFocusUp.id,function(){return H("above")}]},[]),(0,eb.useCommandBinding)(function(){return[rK.moveFocusDown.id,function(){return H("below")}]},[]),(0,eb.useCommandBinding)(function(){return[rK.moveFocusRight.id,function(){return H("rightOf")}]},[]),(0,eb.useCommandBinding)(function(){return[rK.moveFocusLeft.id,function(){return H("leftOf")}]},[]),eA((n=(0,ed.usePaneUIContext)(),(0,$.default)(function(){return{data:{type:"context",label:"Open with Code Search",icon:(0,g.jsx)(t0.default,{}),key:"codeSearch"},commands:function(e){var t=e.searchQuery;if(!t)return[];var r={type:"searchReplace",data:{initialQuery:t}};return[{match:(0,el.createFzfMatchLabel)({defaultScore:tZ.commandDefaultScores.codeSearch,matchScoreMultiplier:tZ.commandMatchScoreMultipliers.codeSearch,filterLowMatchScores:!1}),data:{type:"action",label:n.getTitle(r),icon:n.Icon({pane:r}),run:function(){eS({pane:r})}}}]}}},[n,eS]))),eA(rH()),eA(rT.createSearchFileContentsCommand({container:T,activeOnly:!0,keyboardShortcut:eQ,openFile:L})),(0,eb.useCommandBinding)(function(){if(!D&&!V)return[rK.run.id,function(){F(r_.RunReason.KEYBOARD_SHORTCUT),eB("shortcut_cmd_enter")}]},[F]);var eZ=(0,eb.useKeyCombo)(rK.run.id);eA({match:el.fzfMatchLabel,data:{type:"action",icon:(0,g.jsx)(rX.default,{}),label:"New window",keyboardShortcut:"Cmd-Shift-n",description:"Open a new window",run:function(){tG.desktopAppApi.openNewWindow()}}},{enabled:ej}),eA({match:el.fzfMatchLabel,data:{type:"action",icon:(0,g.jsx)(rZ.default,{}),label:"Run",description:"Run Repl",run:function(){F(r_.RunReason.KEYBOARD_SHORTCUT)},keyboardShortcut:eZ}},{enabled:!O}),eA({match:el.fzfMatchLabel,data:{type:"action",icon:(0,g.jsx)(r2.default,{}),label:"Stop",description:"Stop Repl",run:function(){F(r_.RunReason.KEYBOARD_SHORTCUT)}}},{enabled:O}),eA({match:el.fzfMatchLabel,data:{type:"action",icon:(0,g.jsx)(r0.default,{}),label:"Kill 1",description:"Kill the Repl pid1 process if it's in a bad state (admin only)",run:function(){T.exec("kill","1")}}},{enabled:eD}),eA({match:el.fzfMatchLabel,data:{type:"action",icon:(0,g.jsx)(rY.default,{}),label:"Open development URL",run:function(){if(!eT)throw Error("Expected dotdevUrl");window.open(eT,"_blank","noopener")}}}),eA({match:el.fzfMatchLabel,data:{type:"action",icon:(0,g.jsx)(rJ.default,{}),label:"Open in desktop app",description:"Open this Repl in the desktop app",run:function(){if(!ey)throw Error("Expected Repl URL query param");var e="".concat(window.location.origin,"/desktopApp/open?replUrl=").concat(ey);window.open(e,"_blank")}}},{enabled:!ej}),eA({match:el.fzfMatchLabel,data:{type:"action",icon:(0,g.jsx)(r4.default,{}),label:"Open in VS Code",description:"Connect to this Repl in VS Code via SSH",run:function(){(0,ei.track)(eo.events.WORKSPACE,{action:"open_in_vscode_clicked",source:"command_bar",editor:"vscode"}),eF()}}},{enabled:!!ek&&j}),eA({match:el.fzfMatchLabel,data:{type:"action",icon:(0,g.jsx)(rQ.default,{}),label:"Copy SSH Command",description:"Copy a shell command to connect to this Repl via SSH",run:function(){if(!ek)throw Error("Expected sshConfig");var e=ek.sshPort,n=ek.sshUser,t=ek.sshHostname,r="ssh -i ".concat(eI,"/.ssh/replit -p ").concat(e," ").concat(n,"@").concat(t);(0,ei.track)(eo.events.WORKSPACE,{action:"ssh_key_copied",source:"command_bar"}),(0,tW.default)(r),eP("Copied SSH command")}}},{enabled:!!ek&&j}),eA((r=(t={description:"Jump to another Repl",onRun:function(e){window.location.href=e.url}}).description,i=t.onRun,o=(0,eK.default)(i),(0,$.default)(function(){return{match:(0,el.createFzfMatchLabel)({defaultScore:tZ.commandDefaultScores.myRepls}),data:{type:"context",label:"My Apps",icon:(0,g.jsx)(rn.default,{}),description:r},commands:function(e){return(0,ee._)(function(e){var n;return(0,en._)(this,function(t){switch(t.label){case 0:var r;if(n=e.searchQuery,!e.active)return[2,[]];return[4,(r={query:n,count:50},(0,ee._)(function(){var e;return(0,en._)(this,function(n){switch(n.label){case 0:if(!eG.apolloClient)throw Error("Expected apolloClient");return[4,eG.apolloClient.query({query:t6,variables:r})];case 1:return[2,(null==(e=n.sent().data.currentUser)?void 0:e.search.repls.filter(function(e){return!!e.owner}))||[]]}})})())];case 1:return[2,t.sent().map(function(e){var t,r,i,a;return r=(t={repl:e,searchQuery:n,run:function(){return o.current(e)}}).repl,i=t.searchQuery,a=t.run,{match:function(){return{score:1,render:{height:44,content:(0,g.jsx)(rr,{repl:r,height:44,searchQuery:i})}}},data:{type:"action",label:r.title,icon:(0,g.jsx)(t7.default,{alt:r.title,size:16,iconUrl:r.iconUrl}),run:function(){return a(r)}}}})]}})}).apply(this,arguments)}}},[r,o]))),eA({match:(0,el.createFzfMatchLabel)({defaultScore:tZ.commandDefaultScores.fork}),data:{type:"action",label:"Remix",icon:(0,g.jsx)(r1.default,{}),description:"Remix App",run:function(){E||P()}}}),s=(a=rv.usePreferences.apply(void 0,(0,Z._)(rj))).preferences,l=a.update,u=function(e){Object.keys(e).forEach(function(n){var t=e[n];(0,ei.track)(eo.events.SETTINGS_TOGGLED,{settingChanged:n,updatedValue:t,isCommandBar:!0})}),l(e)},d=(c=(0,tx.useTheme)()).setActiveTheme,p=c.theme,eA({match:(0,el.createFzfMatchLabel)({defaultScore:tZ.commandDefaultScores.settings,matchScoreMultiplier:tZ.commandMatchScoreMultipliers.settings}),data:{type:"context",label:"Settings",description:"Change Replit Settings",icon:(0,g.jsx)(rw.default,{})},commands:function(e){var n=e.active,t=e.searchQuery;if(!n&&!t)return[];var r={match:(0,el.createFzfMatchLabel)({defaultScore:tZ.commandDefaultScores.settings,matchScoreMultiplier:tZ.commandMatchScoreMultipliers.settings}),data:{type:"context",label:"Theme",icon:(0,g.jsx)(rb.default,{}),description:"Change Replit Theme"},commands:function(){return rx.officialThemes.map(function(e){return{match:(0,el.createFzfMatchLabel)({defaultScore:tZ.commandDefaultScores.settings,matchScoreMultiplier:tZ.commandMatchScoreMultipliers.settings}),data:{type:"action",label:e.title,icon:p.id===e.id?(0,g.jsx)(ry.default,{}):(0,g.jsx)(rw.default,{opacity:0}),description:"Use "+e.title+" theme "+(p.id===e.id?" (current)":""),run:function(){d(e.id)}}}})}},i=Object.values(rm.userPreferences).filter(function(e){return -1!==rj.indexOf(e.editorPreferencesKey)}).map(function(e){return{match:(0,el.createFzfMatchLabel)({defaultScore:tZ.commandDefaultScores.settings,matchScoreMultiplier:tZ.commandMatchScoreMultipliers.settings}),data:{type:"context",label:e.name,icon:(0,g.jsx)(rw.default,{}),description:e.description},commands:function(){return e.options.map(function(n){var t=s[e.editorPreferencesKey],r=!!e.editorPreferencesKey&&n.editorPreferencesValue===t;return{match:(0,el.createFzfMatchLabel)({defaultScore:tZ.commandDefaultScores.settings,matchScoreMultiplier:tZ.commandMatchScoreMultipliers.settings}),data:{type:"action",label:n.title,icon:r?(0,g.jsx)(ry.default,{}):(0,g.jsx)(rw.default,{opacity:0}),description:n.description,run:function(){return(0,ee._)(function(){return(0,en._)(this,function(t){switch(t.label){case 0:if(!e.editorPreferencesKey)throw Error("editorPreferencesKey is not defined");return[4,u((0,I._)({},e.editorPreferencesKey,n.editorPreferencesValue))];case 1:return t.sent(),[2]}})})()}}}})}}});return(0,Z._)(i).concat([r])}},{enabled:!0}),eA(rE((0,B.useCallback)(function(e){eJ({pane:{type:"developer",data:{tab:e}}})},[eJ])));var e0=(f=(0,eN.default)(),h=(0,tz.useGlobalModal)().show,(0,B.useMemo)(function(){var e=[];return e.push({match:el.matchLabel,data:{type:"action",label:"[Admin] Show Slack Agent Stack Connector Modal [DEPRECATED]",icon:(0,g.jsx)(tq.default,{}),run:function(){h("SlackConnectorSetupModalDeprecated",{replId:f})}}}),{match:el.matchLabel,data:{icon:(0,g.jsx)(tH.default,{}),label:"Admin",type:"context",description:"Manage internal only settings"},commands:function(){return e},numCommands:e.length}},[h,f]));eA(e0,{enabled:eD&&e0.numCommands>0});var e4=(m=(0,tK.useUploadPid2)(),v=(0,U._)((0,tK.usePid2UploadState)(),1)[0],x=(0,e$.default)().showNotice,y=(0,t$.usePid2Callback)(function(e){return function(){return(0,ee._)(function(){var n;return(0,en._)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e.healthCheck.ping.rpc({})];case 1:if((n=t.sent()).ok)return[2,{ok:!0,payload:n.payload}];return[2,{ok:!1}];case 2:return t.sent(),[2,{ok:!1}];case 3:return[2]}})})()}}),b=(0,t$.usePid2Callback)(function(e){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return(0,ee._)(function(){var r,i,o;return(0,en._)(this,function(a){switch(a.label){case 0:r=0,a.label=1;case 1:if(!(r<n))return[3,8];i=tJ[r%tJ.length],x("".concat(i," Pinging PID2... (attempt ").concat(r+1,"/").concat(n,")")),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,e.healthCheck.ping.rpc({})];case 3:if((o=a.sent()).ok)return x("âœ… PID2 is ready! ".concat(JSON.stringify(o.payload))),[2,!0];return[3,5];case 4:return a.sent(),[3,5];case 5:if(!(r<n-1))return[3,7];return[4,tX(t)];case 6:a.sent(),a.label=7;case 7:return r++,[3,1];case 8:return x("âŒ PID2 not responding after ".concat(n," attempts")),[2,!1]}})})()}}),(0,B.useMemo)(function(){var e=[];return e.push({match:el.matchLabel,data:{type:"action",icon:(0,g.jsx)(tQ.default,{}),label:"Ping PID2",description:"Check if PID2 is healthy and responding",run:function(){return(0,ee._)(function(){var e;return(0,en._)(this,function(n){switch(n.label){case 0:if(!y)return x("PID2 client not available"),[2];return[4,y()];case 1:return(null==(e=n.sent())?void 0:e.ok)?x("âœ… PID2 is healthy: ".concat(JSON.stringify(e.payload))):x("âŒ PID2 ping failed"),[2]}})})()}}}),e.push({match:el.matchLabel,data:{type:"action",icon:(0,g.jsx)(tY.default,{}),label:v===tK.Pid2UploadState.IDLE?"Upload PID2 bundle":"Upload PID2 bundle (".concat(v.toLowerCase(),")"),description:v===tK.Pid2UploadState.IDLE?"Upload and install the latest PID2 bundle to the container":"Current status: ".concat(v.toLowerCase()),run:function(){return(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:if(v!==tK.Pid2UploadState.IDLE&&v!==tK.Pid2UploadState.ERROR)return[3,5];return[4,m()];case 1:return e.sent(),[4,tX(2e3)];case 2:if(e.sent(),!b)return[3,4];return[4,b(5,1e3)];case 3:e.sent(),e.label=4;case 4:return[3,6];case 5:x("PID2 upload already in progress: ".concat(v)),e.label=6;case 6:return[2]}})})()}}}),{match:el.matchLabel,data:{icon:(0,g.jsx)(tH.default,{}),label:"PID2",type:"context",description:"PID2 debug commands"},commands:function(){return e},numCommands:e.length}},[m,v,x,y,b]));return eA(e4,{enabled:(eD||eV)&&e4.numCommands>0}),(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(eR.Modal,{isOpen:eL,onRequestClose:eU,centered:!0,children:(0,g.jsx)(rS.default,{onConfirm:eM})})})});var r6=e.i(921211),r9=e.i(672963),r5=e.i(670413),r7=e.i(337761),ie=e.i(323049),it=e.i(967629),ir=e.i(496019),ii=e.i(352767),io=e.i(608263),ia=(0,it.keyframes)({"0%":{transform:"translate(0, 0)"},"8.33%, 25%":{transform:"translate(-50%, 0)"},"33.33%, 50%":{transform:"translate(-50%, -50%)"},"58.33%, 75%":{transform:"translate(0, -50%)"},"83.33%, 100%":{transform:"translate(0, 0)"}}),is=(0,eI.cssRecord)({root:[eT.rcss.color.foregroundDimmest,eT.rcss.position.relative,eT.rcss.width("100%"),eT.rcss.height("100%"),{overflow:"hidden"}],arrows:[eT.rcss.position.absolute,eT.rcss.top(0),eT.rcss.left(0),eT.rcss.flex.row,eT.rcss.flex.wrap,eT.rcss.width("200%"),eT.rcss.height("200%"),{animationName:ia,animationDirection:"normal",animationTimingFunction:"ease-out",animationIterationCount:"infinite"}],arrow:[eT.rcss.width("50%"),eT.rcss.height("50%"),eT.rcss.center]});function il(e){var n=e.delay,t=e.duration;return(0,g.jsx)(A.View,{css:is.root,children:(0,g.jsxs)(A.View,{css:is.arrows,style:{animationDelay:n?n+"ms":void 0,animationDuration:t?t+"ms":"8000ms"},children:[(0,g.jsx)(A.View,{css:is.arrow,children:(0,g.jsx)(ir.default,{size:12})}),(0,g.jsx)(A.View,{css:is.arrow,children:(0,g.jsx)(ii.default,{size:12})}),(0,g.jsx)(A.View,{css:is.arrow,children:(0,g.jsx)(ry.default,{size:12})}),(0,g.jsx)(A.View,{css:is.arrow,children:(0,g.jsx)(io.default,{size:12})})]})})}var iu=e.i(886513),ic=e.i(283110),id=(0,eI.cssRecord)({root:[eT.rcss.position.relative],circle:[eT.rcss.top(-6),eT.rcss.right(-6),eT.rcss.minWidth(12),eT.rcss.borderRadius(8),eT.rcss.position.absolute,eT.rcss.backgroundColor.backgroundHighest,eT.rcss.shadow(3),{textAlign:"center",fontSize:10,border:"1px solid",borderColor:R.tokens.outlineDefault}],count:[{textAlign:"center",fontSize:10}]});function ip(e){var n=e.count,t=(0,iu._)(e,["count"]);return(0,g.jsxs)(A.View,{css:id.root,children:[(0,g.jsx)(ic.default,(0,m._)({},t)),(0,g.jsx)(A.View,{css:[id.circle,id.count],children:n})]})}function ig(){return(0,g.jsxs)(A.View,{css:id.root,children:[(0,g.jsx)(ic.default,{}),(0,g.jsx)(A.View,{css:id.circle,children:(0,g.jsx)(ry.default,{size:6})})]})}function ih(e){var n=e.paneId,t=e.paneGroupId,r=(0,ed.usePaneUIContext)(),i=(0,es.usePane)(n),o=(0,es.useRemovePane)(),a=(0,es.useRemovePanesToRightInGroup)(),s=(0,es.useRemoveOtherPanesInGroup)(),l=(0,es.usePaneGroupIndex)({paneId:n}),u=(0,es.usePaneGroupCount)({paneGroupId:t});return(0,$.default)(function(){var e=r.getTitle(i),t=[{match:el.matchLabel,data:{type:"action",label:"Close "+e,icon:(0,g.jsx)(ic.default,{}),run:function(){o(n)}}}];return u&&u>1&&(null!==l&&l<u-1&&t.push({match:el.matchLabel,data:{type:"action",label:"Close to the right",icon:(0,g.jsx)(ig,{}),run:function(){a(n)}}}),t.push({match:el.matchLabel,data:{type:"action",label:"Close all other tabs",icon:(0,g.jsx)(ip,{count:u-1}),run:function(){s(n)}}})),t},[r,i,u,l,o,n,a,s])}function im(){var e=(0,es.useGetPane)(),n=(0,es.useCommitPane)();return(0,B.useCallback)(function(t){var r=e(t),i=r.isCommitted,o=r.pane;return!i&&(0,ec.isFilePane)(o)?{match:el.matchLabel,data:{type:"action",label:"Keep open",icon:(0,g.jsx)(tR.default,{}),run:function(){return n(t)}}}:null},[e,n])}var iv=e.i(15053),ix=e.i(761732),iy=e.i(659666),ib=new Map([["left",{label:"Move Left",icon:(0,g.jsx)(ii.default,{})}],["right",{label:"Move Right",icon:(0,g.jsx)(ry.default,{})}],["up",{label:"Move Up",icon:(0,g.jsx)(io.default,{})}],["down",{label:"Move Down",icon:(0,g.jsx)(ir.default,{})}]]),iw=e.i(491404),ij=new Map([["leftOf",{label:"Move Left",icon:(0,g.jsx)(ii.default,{})}],["rightOf",{label:"Move Right",icon:(0,g.jsx)(ry.default,{})}],["above",{label:"Move Up",icon:(0,g.jsx)(io.default,{})}],["below",{label:"Move Down",icon:(0,g.jsx)(ir.default,{})}]]),i_=e.i(769767),iS=e.i(221121),iC=e.i(224996),ik=e.i(918208),iI=e.i(149028),iT=new Map([["leftOf",{commandId:rK.insertPaneGroupUp.id,label:"Insert Left",icon:(0,g.jsx)(iC.default,{})}],["rightOf",{commandId:rK.insertPaneGroupRight.id,label:"Insert Right",icon:(0,g.jsx)(ik.default,{})}],["above",{commandId:rK.insertPaneGroupLeft.id,label:"Insert Up",icon:(0,g.jsx)(iI.default,{})}],["below",{commandId:rK.insertPaneGroupDown.id,label:"Insert Down",icon:(0,g.jsx)(iS.default,{})}]]),iR=e.i(417095),iP=e.i(792774),iE=e.i(308212),iA=e.i(998583);function iD(e){var n,t,r,i,o,a,s,l,u,c,d,p,f,h,v,x,y,b,w,j,_,S,C,k,T,R,P,E,A,D,V,O,F,M,L,B,N=e.paneGroupId,G=e.paneId,W=function(e){var n,t,r=e.paneId,i=e.paneGroupId,o=(0,es.useHeaderView)(i),a=(0,ix.default)(o.isMaximized),s=(0,ix.default)(o.isFloating),l=!a&&!s,u=(n=(0,eb.useKeyBindings)(),t=(0,es.useSplitPane)(),(0,$.default)(function(){return(0,Z._)(iT.entries()).map(function(e){var i,o,a=(0,U._)(e,2),s=a[0],l=a[1],u=l.commandId,c=l.label,d=l.icon;return{match:el.matchLabel,data:{label:c,icon:d,type:"action",keyboardShortcut:null!=(o=null==(i=n.get(u))?void 0:i.shortcut)?o:void 0,run:function(){t({placement:s,paneId:r,autoFocus:!0}),(0,ei.track)(eo.events.WORKSPACE,{action:"split_used",placement:s})}}}})},[n,t,r]));return(0,$.default)(function(){return l?[{match:el.matchLabel,data:{type:"context",label:"Add pane",icon:(0,g.jsx)(i_.default,{})},commands:function(e){var n=e.active,t=e.searchQuery;return n||t?u:[]}}]:[]},[l,u])}({paneId:G,paneGroupId:N}),z=(n=(0,es.usePaneView)(G),t=(0,es.useIsMaximized)(),r=(0,ix.default)(n.isFloating),i=!t&&!r,o=(0,es.useRelativeMoveTab)(),(0,$.default)(function(){var e=(0,Z._)(ij.entries()).map(function(e){var n=(0,U._)(e,2),t=n[0],r=n[1],i=r.label,a=r.icon;return{match:el.matchLabel,data:{label:i,icon:a,type:"action",run:function(){o(t)}}}});return i?[{match:el.matchLabel,data:{type:"context",label:"Move tab",icon:(0,g.jsx)(iw.default,{})},commands:function(n){var t=n.active,r=n.searchQuery;return t||r?e:[]}}]:[]},[i,o])),H=(a=(0,es.useHeaderView)(N),s=(0,ix.default)(a.isMaximized),l=(0,ix.default)(a.isFloating),u=!s&&!l,c=(0,es.useMovePaneGroup)(),(0,$.default)(function(){var e=(0,Z._)(ib.entries()).map(function(e){var n=(0,U._)(e,2),t=n[0],r=n[1],i=r.label,o=r.icon;return{match:el.matchLabel,data:{label:i,icon:o,type:"action",run:function(){c({direction:t})}}}});return u?[{match:el.matchLabel,data:{type:"context",label:"Move group",icon:(0,g.jsx)(iy.default,{})},commands:function(n){var t=n.active,r=n.searchQuery;return t||r?e:[]}}]:[]},[u,c])),q=(p=(d=(0,es.useMaximizedPane)()).maximizePaneGroup,f=d.restoreMaximizedPaneGroup,h=(0,es.useHeaderView)(N),v=(0,ix.default)(h.isMaximized),x=(0,es.useIsInPopup)(),y=(0,eb.useKeyCombo)(rK.toggleMaximizePaneGroup.id),(0,$.default)(function(){return v?x?[]:[{match:el.matchLabel,data:{type:"action",label:"Restore",icon:(0,g.jsx)(iP.default,{}),run:function(){return f()},keyboardShortcut:y}}]:[{match:el.matchLabel,data:{type:"action",label:"Maximize",icon:(0,g.jsx)(iR.default,{}),run:function(){return p({paneGroupId:N})},keyboardShortcut:y}}]},[v,y,x,f,p,N])),K=(b=(0,es.useRemovePaneGroup)(),w=(0,es.useCancelQuickJump)(),j=(0,es.useIsInPopup)(),_=(0,eb.useKeyCombo)(rK.removePaneGroup.id),(0,$.default)(function(){return j?[]:[{match:el.matchLabel,data:{type:"action",label:"Close",icon:(0,g.jsx)(ic.default,{}),run:function(){w(),b({paneGroupId:N})},keyboardShortcut:_}}]},[w,b,j,_,N])),Q=(C=(S={paneId:G,paneGroupId:N}).paneId,k=S.paneGroupId,T=(0,es.useToggleFloating)(),R=(0,es.useHeaderView)(k),P=(0,ix.default)(R.isMaximized),E=(0,ix.default)(R.isFloating),A=(0,eb.useKeyCombo)(rK.toggleFloatPaneGroup.id),(0,$.default)(function(){return P?[]:[{match:el.matchLabel,data:{type:"action",label:E?"Unfloat":"Float",icon:E?(0,g.jsx)(iA.default,{}):(0,g.jsx)(rX.default,{}),keyboardShortcut:A,run:function(){T(C)}}}]},[C,T,A,E,P])),Y=(D={paneId:G,paneGroupId:N},V=(0,es.useHeaderView)(D.paneGroupId),O=(0,es.usePaneView)(D.paneId),F=(0,es.usePaneGroup)(D.paneGroupId),M=(0,es.useGetPanes)(),L=(0,es.useStorePopupLayoutState)(),B=(0,ix.default)(V.isMaximized),(0,$.default)(function(){return B?[]:[{match:el.matchLabel,data:{type:"action",label:"New window",icon:(0,g.jsx)(iE.default,{}),run:function(){var e=(0,iv.v4)(),n=M().filter(function(e){var n=(0,U._)(e,1)[0];return F.panes.current.includes(n)});L({popupId:e,state:{type:"saved",layout:{floating:[],tiling:{id:(0,iv.v4)(),type:"paneGroup",percent:100,activeIndex:F.activeIndex.current,panes:F.panes.current}},data:n.reduce(function(e,n){var t=(0,U._)(n,2),r=t[0],i=t[1];return(0,e9._)((0,m._)({},e),(0,I._)({},r,i))},{})}}),window.open("".concat(window.location.origin+window.location.pathname,"?popupId=").concat(e),"_blank","popup=1,height=".concat(O.size.current.height,"px,width=").concat(O.size.current.width,"px")),(0,ei.track)(eo.events.WORKSPACE,{action:"workspace_popout_opened",ai:n.some(function(e){var n=(0,U._)(e,2);return"ghostwriterChat"===(n[0],n[1]).type}),console:n.some(function(e){var n=(0,U._)(e,2);return"runnerOutput"===(n[0],n[1]).type}),editor:n.some(function(e){var n=(0,U._)(e,2);return"codeEditor"===(n[0],n[1]).type}),shell:n.some(function(e){var n=(0,U._)(e,2);return"shell"===(n[0],n[1]).type}),paneData:n})}}}]},[B,F.activeIndex,F.panes,M,L,O.size]));return(0,$.default)(function(){return[{data:{type:"group",key:"pane-group"},commands:function(){return(0,Z._)(W).concat((0,Z._)(z),(0,Z._)(H),(0,Z._)(q),(0,Z._)(Q),(0,Z._)(Y),(0,Z._)(K))}}]},[W,z,H,q,Q,Y,K])}var iV=e.i(546284),iO=e.i(993134),iF=e.i(707468);function iM(e){var n,t,r,i,o,a,s,l,u=e.paneId,c=(n=(0,ed.usePaneUIContext)(),t=(0,ev.useGetToolPanes)(),r=(0,es.useChangePane)(),(0,B.useCallback)(function(){return{data:{type:"context",label:ew.toolsCommandLabel,icon:(0,g.jsx)(e_.default,{})},commands:function(){return t().map(function(e){return{match:el.matchLabel,data:{type:"action",label:n.getTitle(e),icon:n.Icon({pane:e}),run:function(){(0,ei.track)(eo.events.TOOL_OPENED,{source:"Tab Menu",tool:e.type}),r({paneId:u,pane:e})}}}})}}},[t,n,r,u])),d=(i=(0,ef.useGetRecentFiles)(),o=(0,ef.useGetOpenFiles)(),a=(0,es.useChangePane)(),(0,B.useCallback)(function(){var e=o(),n=i().filter(function(n){return!e.includes(n)});return{data:{type:"context",label:"Recent",icon:(0,g.jsx)(iO.default,{})},commands:function(e){var t=e.searchQuery;return(0,rI.createFileCommands)({paths:n,searchQuery:t,run:function(e){a({paneId:u,pane:{type:(0,ec.getPaneTypeForFile)({path:e}),data:{path:e}}})}})}}},[i,a,u,o])),p=(s=(0,e2.default)().fs,l=(0,es.useChangePane)(),(0,$.default)(function(){return{match:el.matchLabel,data:{type:"context",label:"Files",icon:(0,g.jsx)(tR.default,{})},commands:function(e){return(0,ee._)(function(e){var n,t,r;return(0,en._)(this,function(i){switch(i.label){case 0:if(n=e.searchQuery,t=e.active,!n&&!t)return[2,[]];return[4,s.listFiles()];case 1:if((r=i.sent()).error)return[2,[]];if(!r.files)throw Error("Expected files");return[2,(0,rI.createFileCommands)({paths:r.files,searchQuery:n,run:function(e){l({paneId:u,pane:{type:(0,ec.getPaneTypeForFile)({path:e}),data:{path:e}}})}})]}})}).apply(this,arguments)}}},[s,l,u]));return(0,$.default)(function(){return{match:el.matchLabel,data:{type:"context",label:"Change tab",icon:(0,g.jsx)(iF.default,{})},commands:function(e){var n=e.searchQuery,t=e.active;return n||t?[d(),p,c()]:[]}}},[d,c,p])}var iL=(0,it.css)(eT.rcss.center,{fontSize:R.tokens.fontSizeSmall,border:"1px solid",borderColor:R.tokens.outlineDefault,width:20,height:20,marginTop:-2,marginLeft:-2},eT.rcss.borderRadius(8));function iU(e){return(0,g.jsx)(A.View,{css:iL,children:(0,g.jsx)(A.View,{css:{lineHeight:1},children:e.count})})}var iB=(0,et.atom)([]);function iN(e,n){var t=n.run,r=n.enabled,i=void 0===r||r,o=(0,er.useSetAtom)(iB);(0,B.useEffect)(function(){if(i){var n=(Array.isArray(e)?e:[e]).map(function(e){return{shortcut:e,run:t}});return o(function(e){return(0,Z._)(e).concat((0,Z._)(n))}),function(){o(function(e){return e.filter(function(e){return!n.includes(e)})})}}},[e,t,o,i])}function iG(){var e=(0,er.useAtomValue)(iB);return(0,B.useEffect)(function(){var n=function(n){var t=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var s,l=o.value,u=l.shortcut,c=l.run;!!u.cmdOrCtrlKey==!!(0,r5.getCmdOrCtrl)(n)&&!!u.altKey==!!n.altKey&&!!u.shiftKey==!!n.shiftKey&&(null==(s=u.key)?void 0:s.toLowerCase())===n.key.toLowerCase()&&(n.preventDefault(),c(u))}}catch(e){r=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw i}}};return document.addEventListener("keydown",n),function(){document.removeEventListener("keydown",n)}},[e]),null}var iW=e.i(877249),iz=(0,eI.cssRecord)({overlay:[eT.rcss.position.absolute,eT.rcss.overflow("hidden"),eT.rcss.zIndex(ie.zIndexLevels.overlay)],surface:[eT.rcss.position.relative,eT.rcss.borderRadius(8),eT.rcss.flex.shrink(1),{maxHeight:"100%",maxWidth:"100%",border:"1px solid",borderColor:R.tokens.outlineDefault,opacity:0},eT.rcss.shadow(3)],innerSurface:[eT.rcss.borderRadius(8)]}),iH=(0,eI.cssRecord)({root:[{borderTop:"1px solid",borderColor:R.tokens.outlineDimmer}],row:[eT.rcss.rowWithGap(2),eT.rcss.align.center,eT.rcss.justify.spaceBetween]});function iq(){var e=(0,ek.useCmdOrCtrl)();return(0,g.jsxs)(A.View,{css:iH.root,p:8,gap:8,children:[(0,g.jsxs)(A.View,{css:iH.row,children:[(0,g.jsx)(ez.Text,{color:"dimmest",variant:"small",multiline:!1,children:"Move focus"}),(0,g.jsxs)(A.View,{row:!0,gap:4,children:[(0,g.jsx)(ro.KeyComboBlocks,{keyCombo:"".concat(e),small:!0}),(0,g.jsx)(ro.KeyBlock,{text:(0,g.jsx)(il,{duration:6e3,delay:6e3})})]})]}),(0,g.jsxs)(A.View,{css:iH.row,children:[(0,g.jsx)(ez.Text,{color:"dimmest",variant:"small",multiline:!1,children:"Move pane"}),(0,g.jsxs)(A.View,{row:!0,gap:4,children:[(0,g.jsx)(ro.KeyComboBlocks,{keyCombo:"".concat(e,"Shift-"),small:!0}),(0,g.jsx)(ro.KeyBlock,{text:(0,g.jsx)(il,{duration:6e3,delay:1500})})]})]})]})}var iK=(0,B.memo)(function(){var e=function(){var e=(0,es.useIsMaximized)(),n=(0,es.useQuickJumpFocusRect)();if(n){var t={width:n.width,height:n.height,transform:"translate(".concat(n.x,"px, ").concat(n.y,"px)")},r=t.width,i=t.height,o=t.transform,a={border:"1px solid",borderColor:R.tokens.accentPrimaryStronger,borderRadius:R.tokens.borderRadius6,boxShadow:R.tokens.shadow3,transitionProperty:"transform, height, width",transitionDuration:iW.TRANSITIONS.duration,transitionTimingFunction:iW.TRANSITIONS.timingFunction};return(0,m._)({width:r,height:i,transform:o},e?void 0:a)}}(),n=(0,es.useCancelQuickJump)(),t=(0,r9.default)(n,[]);return(0,B.useEffect)(function(){var e=setTimeout(function(){(0,r7.styleSet)(t,"opacity","1")});return function(){clearTimeout(e)}},[t]),(0,g.jsx)(r6.FocusScope,{restoreFocus:!0,autoFocus:!0,contain:!0,children:(0,g.jsx)(A.View,{style:e,css:iz.overlay,p:16,align:"end",children:(0,g.jsx)(E.Surface,{innerRef:t,elevated:!0,css:iz.surface,children:(0,g.jsx)(E.Surface,{css:iz.innerSurface,grow:!0,shrink:!0,elevated:!0,children:(0,g.jsx)(iJ,{})})})})})}),i$={ArrowUp:"above",ArrowDown:"below",ArrowRight:"rightOf",ArrowLeft:"leftOf"},iQ={ArrowUp:"up",ArrowDown:"down",ArrowRight:"right",ArrowLeft:"left"},iY=Object.keys(i$),iJ=(0,B.memo)(function(){var e=(0,es.useMoveFocus)(),n=(0,es.useMovePaneGroup)(),t=(0,es.useQuickJumpTo)(),r=(0,es.useIsMaximized)();iN({key:"Escape"},{run:function(){t()}}),iN(iY.map(function(e){return{key:e,cmdOrCtrlKey:!0}}),{run:function(n){e(i$[n.key])},enabled:!r}),iN(iY.map(function(e){return{key:e,cmdOrCtrlKey:!0,shiftKey:!0}}),{run:function(e){n({direction:iQ[e.key]})},enabled:!r});var i=(0,es.useQuickJumpMenuState)();return i&&"sidebar"!==i.target?(0,g.jsx)(iX,{paneGroupId:i.paneGroupId,paneId:i.paneId}):null});function iX(e){var n,t,r,i,o,a,s,l,u,c,d,p,f,h,m,v,x,y,b,w,j,_=(0,es.useIsMaximized)(),S=(0,es.useCancelQuickJump)(),C=(0,es.useQuickJumpTo)(),k=(n=e.paneGroupId,i=(r={paneId:t=e.paneId,paneGroupId:n}).paneId,o=r.paneGroupId,a=(0,ed.usePaneUIContext)(),s=(0,es.usePane)(i),l=(0,ep.usePaneBindings)(i),u=im(),c=ih({paneId:i,paneGroupId:o}),d=(0,$.default)(function(){var e=a.getTitle(s),n=function(e){return!!e&&(void 0===e?"undefined":(0,ni._)(e))==="object"&&"data"in e},t=[{data:{type:"group",key:"pane-actions"},commands:function(){var e,t;return(null!=(t=null==l||null==(e=l.commands)?void 0:e.flatMap(function(e){return e.commands}))?t:[]).filter(n)}},{data:{type:"group",key:"pane-close"},commands:function(){return[u(i)].concat((0,Z._)(c)).filter(n)}}];return{match:el.matchLabel,data:{type:"context",label:e,icon:(0,g.jsx)(a.Icon,{pane:s})},commands:function(e){var n=e.active,r=e.searchQuery;return n||r?t:[]}}},[s,l,a,i,c,u]),f=(p={paneId:t,paneGroupId:n}).paneGroupId,h=p.paneId,m=(0,es.usePaneGroups)(),v=(0,ed.usePaneUIContext)(),x=(0,es.useRevealPane)(),y=(0,es.useInsertTab)(),b=iM({paneId:h}),w=(0,$.default)(function(){var e=m.tiling,n=m.floating,t=e.reduce(function(e,n){return e+n.panes.length},0)+n.reduce(function(e,n){return e+n.panes.length},0),r={match:el.matchLabel,data:{type:"action",label:"New tab",icon:(0,g.jsx)(tS.default,{}),run:function(){y({paneGroupId:f,activate:!0,panes:[{type:"commands",data:{autoFocus:!0}}]})}}};return t?[b,{match:el.matchLabel,data:{type:"context",label:(0,iV.default)("Tab",t),icon:(0,g.jsx)(iU,{count:t})},commands:function(t){var i=t.active,o=t.searchQuery;if(!(i||o))return[];var a=(0,Z._)(e).concat((0,Z._)(n)).map(function(e,n){return{data:{type:"group",key:"paneGroups"+n},commands:function(){return e.panes.map(function(e){var n=(0,U._)(e,2),t=n[0],r=n[1];return{match:el.matchLabel,data:{type:"action",label:v.getTitle(r),icon:(0,g.jsx)(v.Icon,{pane:r}),run:function(){x({paneId:t,activate:!0})}}}})}}});return a.unshift(r),a}}]:[b,r]},[m,v,x,y,f,b]),j=iD({paneGroupId:n,paneId:t}),(0,$.default)(function(){return{data:{type:"group",key:"root",description:"Search"},commands:function(){return[d].concat((0,Z._)(w),(0,Z._)(j))}}},[d,w,j]));return(0,g.jsx)(eP.CommandBar,{iconBreadcrumbs:!0,command:k,onAction:function(){return S()},onKeyDown:function(e,n){var t=n.inputValue,r=n.hasHighlightedItem;if("Enter"===e.key&&!t&&!r){e.preventDefault(),C();return}(0,r5.getCmdOrCtrl)(e)&&e.preventDefault()},footer:_?null:(0,g.jsx)(iq,{}),compact:!0})}var iZ={id:"paneMenu.toggle",name:"Toggle pane context menu",default:(0,ek.defaultKeyCombo)({cmdOrCtrl:!0,key:"j"})};function i0(){var e=(0,es.useToggleQuickJump)(),n=(0,es.useIsQuickJumpActive)();return((0,eb.useCommandBinding)(function(){return[iZ.id,function(){return e()}]},[e]),n)?(0,g.jsx)(iK,{}):null}var i1={id:"sidebar.toggle",name:"Toggle sidebar",description:"Opens or closes the sidebar",default:(0,ek.defaultKeyCombo)({cmdOrCtrl:!0,shift:!0,key:"b"})},i2=e.i(971465),i4=e.i(933101),i8=e.i(159667),i3=e.i(759025),i6=e.i(782370),i9=e.i(128068),i5=e.i(63762),i7=e.i(200119),oe=e.i(602213);function on(e){var n=e.isInLayout,t=(0,iu._)(e,["isInLayout"]),r=(0,rO.useObservable)((0,i7.useAgentIsWorking)()),i=(0,rO.useObservable)((0,i5.useAgentIsWaitingOnUserInput)()),o=(0,U._)((0,B.useState)(!1),2),a=o[0],s=o[1];(0,B.useEffect)(function(){if(!i||r||n)return void s(!1);var e=setTimeout(function(){return s(!a)},a?1e3:5e3);return function(){clearTimeout(e)}},[a,i,r,n]);var l=!n&&r||a;return(0,g.jsx)(oe.AgentAvatar,(0,m._)({loading:l},t))}var ot=e.i(136540),or=e.i(918218),oi={id:"agent.toggle",name:"Toggle Agent",description:"Opens or closes the Agent",default:(0,ek.defaultKeyCombo)({cmdOrCtrl:!0,shift:!0,key:"i"})};function oo(){var e,n=(0,es.useAgentLayout)(),t=(0,rO.useObservable)(n.displayState),r=(0,rO.useObservable)(n.agentFiletreeOrder),i=(0,i9.useObservableRef)(n.isCollapsed),o=(0,eb.useKeyCombo)(oi.id),a=n.toggle;return(0,eb.useCommandBinding)(function(){return[oi.id,function(){return a(!!i.current)}]},[a,i]),(0,g.jsx)(A.View,{clsx:[or.default.root,(e={},(0,I._)(e,or.default.show,"collapsed"===t),(0,I._)(e,or.default.right,"filetree-agent"===r),e)],children:(0,g.jsx)(ot.IconButton,{tooltipContents:o?(0,g.jsx)(ro.KeyComboBlocks,{fontSize:10,keyCombo:o}):null,alt:"Expand Agent",onClick:function(){n.toggle(!0)},children:(0,g.jsx)(on,{size:16,isInLayout:!1})})})}var oa=[oi,i2.switchAgentModeCommand,i1,eE,iZ,rp].concat((0,Z._)(r8),(0,Z._)(tB.editorCommands),(0,Z._)(i8.gitCommands),[i6.clearOutputsHistoryCommand,i4.generateOrModifyWithAICommand,i3.generateWithAIInShellCommand]),os=e.i(202266);function ol(e){var n=(0,os.useSaveKeybindings)();return(0,g.jsx)(ey.KeybindingsProvider,{commands:oa,onChange:n,keybindings:e.keybindings,children:e.children})}var ou=e.i(574831),oc=e.i(135211);function od(e){var n=e.children,t=(0,$.default)(function(){return new tF.StateCache(tU.default.get("stateCache",n5.Type.Any()))},[]);return(0,g.jsx)(tF.StateCacheContext.Provider,{value:t,children:n})}function op(){return(0,tL.usePostDeployModal)(),null}function of(e){var n,t=e.ui,r=e.repl,i=e.services,o=e.userKeybindings,a=e.children;return(0,g.jsx)(ol,{keybindings:o,children:(0,g.jsx)(ed.PaneUIContextProvider,{value:t,children:(0,g.jsx)(od,{children:(0,g.jsx)(ou.default.Provider,{value:i,children:(0,g.jsxs)(tM.DeploymentProvider,{replId:r.id,orgId:null==(n=r.org)?void 0:n.id,container:i.container,fs:i.fs,dotReplit:i.dotReplit,ports:i.ports,secrets:i.secrets,children:[(0,g.jsx)(op,{}),(0,g.jsx)(r$.ForkContextProvider,{repl:r,forkParams:{trackingData:{forkSource:"replEnvironmentDesktop"}},children:(0,g.jsx)(tv.ExtensionStoreProvider,{children:(0,g.jsx)(oc.default,{children:a})})})]})})})})})}var og=e.i(736318);function oh(){var e,n,t,r,i,o;return e=(0,e2.default)().fs,n=(0,es.useActiveFile)(),t=(0,es.useOpenFile)(),r=(0,B.useCallback)(function(e){var n;(0,tu.isMarkdownFile)(e.path.toLowerCase())?n={paneType:"markdown"}:(0,tu.isCsvFile)(e.path.toLowerCase())&&(n={paneType:"csvPreview"}),t((0,e9._)((0,m._)({},e),{opener:n}))},[t]),i=(0,es.useLayoutInitType)(),o=(0,B.useRef)(!1),(0,B.useEffect)(function(){if(i&&!o.current){if(!n){if(!window.location.hash)return;var e=new URL(window.location.href);history.pushState((0,e9._)((0,m._)({},history.state),{as:e.pathname}),document.title,window.location.origin+window.location.pathname+window.location.search);return}var t=(0,og.deeplinkToHash)({path:n}),r=window.location.hash;if(!(r.slice(1)===n||r.startsWith(t+":"))){var a=new URL(window.location.href);a.hash=t,window.history.pushState((0,e9._)((0,m._)({},history.state),{as:a.pathname+a.hash}),"",a)}}},[n,i]),(0,B.useEffect)(function(){if(i){var n=function(){return(0,ee._)(function(){var n;return(0,en._)(this,function(t){switch(t.label){case 0:return o.current=!0,[4,(0,ee._)(function(){var n,t,r,i;return(0,en._)(this,function(o){switch(o.label){case 0:if(!(0,og.hasHash)())return[2,null];return[4,(0,og.parseHash)(e)];case 1:if(t=(n=o.sent()).path,r=n.line,i=n.col,!t)return[2,null];return[2,{path:t,line:r,col:i}]}})})()];case 1:return(n=t.sent())&&r(n),o.current=!1,[2]}})})()};return n(),window.addEventListener("hashchange",n),function(){window.removeEventListener("hashchange",n)}}},[i,e,r]),null}var om=e.i(545082),ov=e.i(375310),ox=e.i(557862);function oy(){var e=(0,ov.usePendingDeleteFile)(),n=(0,ov.useSetPendingDeleteFile)(),t=(0,e2.default)().fs,r=function(){n(null)};return(0,g.jsx)(eR.Modal,{isOpen:!!e,onRequestClose:r,children:e?(0,g.jsx)(ox.default,{name:e,description:e,entityType:"file",hideModal:r,delete:function(){e&&(t.deleteFile(e),n(null))}}):null})}var ob=e.i(569910),ow=e.i(134628),oj=e.i(479407),o_=e.i(203594),oS=e.i(16499);function oC(){var e,n,t=(0,h.useRouter)(),r=(0,Q.doesBonsaiWebviewSupportFeature)(t,"mobileBridge"),i=(0,es.useSidebar)(),o=(0,o_.default)(),a=o.isSaving,s=o.isOffline,l=(0,B.useRef)(null),u=(0,oS.useSetAppKeyboardState)(),c=(0,es.useOpenTool)(),d=eC(),p=(e=(0,rD.useWorkflowsRunner)(),n=(0,rD.useOnToggleRun)(),{runState:(0,B.useMemo)(function(){return e?e.step:r_.RunState.OFFLINE},[e]),toggleRunState:(0,B.useCallback)(function(){n()},[n])}),f=p.runState,g=p.toggleRunState,m=(0,B.useCallback)(function(e){var n=function(e){switch(e){case ow.BridgeWorkspaceAction.OPEN_FILETREE:i.toggleContent("filetree");break;case ow.BridgeWorkspaceAction.TOGGLE_RUN_STATE:g();break;case ow.BridgeWorkspaceAction.TOGGLE_ALLPANES:d();break;case ow.BridgeWorkspaceAction.OPEN_NEW_PANE:case ow.BridgeWorkspaceAction.TOGGLE_DRAWER:break;default:(0,ob.default)(e)}},t=function(e){u(e)},r=function(e){var n=e.type,t=e.messageId;try{c({pane:{type:n}})}catch(e){(0,oj.sendErrorMessage)(t)}};(0,oj.workspaceBridgeMessageHandler)(e,function(e){var i=e.type;switch(i){case ow.BridgeMessageType.SET_KEYBOARD_STATE:t(e.keyboardState);break;case ow.BridgeMessageType.WORKSPACE_REQUEST_ACTION:n(e.action);break;case ow.BridgeMessageType.WORKSPACE_REQUEST_OPEN_PANE:r({messageId:e.id,type:e.paneType});break;default:(0,ob.default)(i)}})},[g,u,c,d,i]);return(0,B.useEffect)(function(){if(r){var e={messageType:ow.BridgeMessageType.WORKSPACE_STATE,isDrawerOpen:!1,isShowingAllPanes:!0,isSaving:a,isOffline:s,runState:f,activePaneType:null,activePaneFilePath:null,isInAgentMode:!1,insets:{top:0,bottom:0}},n=l.current;return(null==n||JSON.stringify(e)!==JSON.stringify(n))&&((0,oj.sendMessage)(e,(0,iv.v4)()),l.current=e),window.addEventListener("message",m),function(){window.removeEventListener("message",m)}}},[r,m,f,a,s,l]),null}var ok=e.i(545150),oI=e.i(394212),oT=e.i(906368),oR=e.i(718398),oP=e.i(188507),oE=e.i(924908),oA=e.i(852155),oD=e.i(299798),oV=e.i(112942),oO=e.i(45442),oF=e.i(399144),oM=e.i(28432),oL=e.i(940745),oU=e.i(576779);function oB(e){var n=e.text,t=Math.floor(100*e.progress);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(A.View,{row:!0,align:"center",justify:"center",gap:8,style:{cursor:"not-allowed"},children:[(0,g.jsx)(oL.default,{}),(0,g.jsx)(ez.Text,{children:n})]}),(0,g.jsx)(A.View,{clsx:oU.default.progressBarContainer,children:(0,g.jsx)(A.View,{clsx:oU.default.progressBarTrack,children:(0,g.jsx)(A.View,{clsx:oU.default.progressBarFill,style:{width:"".concat(t,"%")}})})}),(0,g.jsx)(A.View,{justify:"center",align:"center",children:(0,g.jsxs)(ez.Text,{variant:"small",color:"dimmer",children:[t,"%"]})})]})}function oN(e){var n=e.errorMessage;return(0,g.jsxs)(A.View,{align:"center",gap:8,children:[(0,g.jsx)(ez.Text,{children:n}),(0,g.jsx)(ez.Text,{children:"Please try again or contact support"}),(0,g.jsx)(t1.default,{href:"/~",children:(0,g.jsx)(ez.Text,{children:"Return to Home"})})]})}function oG(e){var n=e.onClick;return(0,g.jsxs)(A.View,{align:"center",gap:16,children:[(0,g.jsx)(ez.Text,{children:"You must login again to continue importing"}),(0,g.jsx)(eW.Button,{text:"Reconnect to Figma",onClick:n,colorway:"primary",iconRight:(0,g.jsx)(ry.default,{})})]})}function oW(){var e,n,t,r,i,o,a,s,l,u,c,d,p,f,m,v,x,y,b,w,j,_,S=(0,h.useRouter)(),C=(e=(0,eN.default)(),n=(0,U._)((0,oR.useUpdateReplForFigmaImportMutation)(),1)[0],t=(0,U._)((0,oR.useGetFigmaIntermediateTokenMutation)(),1)[0],i=(r=(0,U._)((0,B.useState)({status:"not_started"}),2))[0],o=r[1],s=(a=(0,U._)((0,B.useState)(0),2))[0],l=a[1],c=(u=(0,oR.useFigmaImportFlowQuery)({variables:{replId:e}})).data,p=null!=(d=!u.loading&&c&&"Repl"===c.getRepl.__typename&&c.getRepl.config.figmaImportStatus===rq.FigmaImportStatus.Started?c.getRepl.config.figmaUrl:null)?d:null,f=ri(),m=(0,oE.useChatter)(),v=(0,B.useRef)(!1),x=(0,oO.useAgentSettings)().settings,y=(0,Y.useQueryParam)("initialQueuedPromptKey","string"),b=(0,eK.default)(p),w=(0,B.useCallback)(function(){return(0,ee._)(function(){var e,n,t,r,i,o;return(0,en._)(this,function(a){switch(a.label){case 0:if(v.current)return[2];return v.current=!0,[4,m.sessions.create({sessionType:oP.SessionType.AGENT_SESSION})];case 1:if(!(e=a.sent()).ok)throw Error("Failed to create Agent session");return f({type:"agentChat",data:{sessionId:e.payload.id}}),[4,(n=e.payload).appendEvent({kind:"setupImportedProject",importSource:oP.ProjectImportSource.PROJECT_IMPORT_SOURCE_FIGMA,agentConfig:(0,oV.convertAgentSettingsFromGQLToAiChat)(x)})];case 2:if(a.sent(),t="initial_queued_prompt_".concat(y),!(r=tU.default.get(t,"string")))return[2];return tU.default.remove(t),i=r,(o=b.current)&&(i=i.replaceAll(o,"")+"\n\n(Figma URL: ".concat(o," has already been imported.)")),[4,n.appendEvent({kind:"message",intent:oP.MessageAction.AGENT,message:i})];case 3:return a.sent(),[2]}})})()},[m,f,y,b,x]),j=(0,B.useCallback)(function(t){var r=t.errorMessage;return(0,ee._)(function(){return(0,en._)(this,function(t){switch(t.label){case 0:return o({status:"error",errorMessage:r}),[4,n({variables:{input:{id:e,figmaImportStatus:rq.FigmaImportStatus.Failed}}})];case 1:return t.sent(),[2]}})})()},[e,n]),((0,oD.usePid2)(function(r,i){var a=i.signal;return(0,ee._)(function(){var i,s,u,c,p,f,g,h,m,v,x,y,b,_,S,C;return(0,en._)(this,function(k){switch(k.label){case 0:if(!d)return[2];return[4,t({variables:{input:{figmaUrl:d}}})];case 1:if((null==(i=k.sent().data)?void 0:i.getFigmaIntermediateToken.__typename)==="NoOAuthFoundError")return o({status:"needs_auth",retryAuth:function(){return l(function(e){return e+1})}}),[2];if((null==i?void 0:i.getFigmaIntermediateToken.__typename)==="InvalidFigmaUrlError"||(null==i?void 0:i.getFigmaIntermediateToken.__typename)==="FigmaRateLimitError")return oT.captureException(i.getFigmaIntermediateToken,{extra:{replId:e,figmaUrl:d}}),th.logger.error("Failed to get Figma intermediate token",{repl:e,figmaUrl:d,payload:i.getFigmaIntermediateToken}),j({errorMessage:i.getFigmaIntermediateToken.message}),[2];if(!(s=null==i?void 0:i.getFigmaIntermediateToken)||"FigmaImportIntermediateToken"!==s.__typename)return th.logger.error("Failed to get Figma intermediate token",{repl:e,figmaUrl:d,payload:i}),j({errorMessage:"Something went wrong while authenticating. Please try again."}),[2];return u=s.token,o(function(e){return"in_progress"===e.status?e:{status:"in_progress",progress:0,text:"Preparing Figma import..."}}),[4,r.figmaImport.startImport.rpc({intermediateToken:u},{signal:a})];case 2:if(!(c=k.sent()).ok)switch(p=c.payload.code){case"INVALID_REQUEST":case"UNCAUGHT_ERROR":return j({errorMessage:c.payload.message||"Something went wrong while importing. Please try again."}),[2];case"UNEXPECTED_DISCONNECT":case"CANCEL":return[2];default:(0,ob.default)(p)}f=r.figmaImport.status.subscribe({},{signal:a}).resReadable,g=void 0,h=!1,m=!1,k.label=3;case 3:k.trys.push([3,8,9,14]),x=function(){var n=b.value;if(!n.ok){var t=n.payload.code;switch(t){case"FIGMA_TOKEN_EXPIRED":case"FIGMA_INVALID_TOKEN":return o({status:"needs_auth",retryAuth:function(){return l(function(e){return e+1})}}),{v:void 0};case"FIGMA_NODE_NOT_FOUND":return j({errorMessage:"The selected Figma component could not be found, please ensure you have selected a frame and copied the link to the frame."}),{v:void 0};case"FIGMA_FILE_NOT_FOUND":return j({errorMessage:"The Figma file could not be accessed, please ensure the linked account has permissions to access the frame."}),{v:void 0};case"FIGMA_SELECTION_TOO_LARGE":return j({errorMessage:"Your Figma selection is too large to process, please make sure you have selected a single frame."}),{v:void 0};case"FIGMA_RATE_LIMIT_EXCEEDED":return j({errorMessage:"Too many requests. Please wait a moment and try again."}),{v:void 0};case"NO_CODE_GENERATED":return j({errorMessage:"No code could be generated from your frame. Please try a different link."}),{v:void 0};case"TIMEOUT":return j({errorMessage:"The import took too long. Please try again, or try a smaller component."}),{v:void 0};case"FIGMA_NODE_NOT_SUPPORTED":return j({errorMessage:"The selected Figma component is not supported. Please make sure you have selected a frame and copied the link to the frame."}),{v:void 0};case"FIGMA_PAGE_WITH_MULTIPLE_CHILDREN":return j({errorMessage:"The selected Figma page has multiple children. Please make sure you have selected a single frame."}),{v:void 0};case"FIGMA_PAGE_WITH_NO_VALID_CHILDREN":return j({errorMessage:"The selected Figma page doesn't have any content we can convert to code. Please make sure you've selected a page with visible designs then try again."}),{v:void 0};case"INVALID_REQUEST":case"UNKNOWN":case"UNCAUGHT_ERROR":return j({errorMessage:n.payload.message||"Something went wrong while importing. Please try again."}),{v:void 0};case"NOT_STARTED":return th.logger.error("Figma Import: Failed to import from Figma",{repl:e,figmaUrl:d,payload:n.payload}),oT.captureException(Error("Figma import: not started"),{extra:{replId:e,figmaUrl:d,payload:n.payload}}),j({errorMessage:n.payload.message||"Something went wrong while importing. Please try again."}),{v:void 0};case"READABLE_BROKEN":case"CANCEL":case"UNEXPECTED_DISCONNECT":return{v:void 0};default:(0,ob.default)(t)}}var r=n.payload;"progress"===r.kind?o(function(e){return"in_progress"===e.status&&e.progress>=r.number?e:{status:"in_progress",progress:r.number,text:r.statusText}}):"success"===r.kind&&(g=function(e){var n=e.file,t=e.frame,r="".concat(n," (").concat(t,")");if(r.length<=oA.maxTitleLength)return r;var i=oA.maxTitleLength-3;if(n.length<=i-1){var o=i-n.length,a=t.length>o?t.substring(0,o-1)+"â€¦":t;return"".concat(n," (").concat(a,")")}var s=i-Math.min(t.length,10),l=n,u=t;n.length>s&&(l=n.substring(0,s-1)+"â€¦");var c=i-l.length;return t.length>c&&(u=t.substring(0,c-1)+"â€¦"),"".concat(l," (").concat(u,")")}({file:r.figmaFileName,frame:r.figmaSelectedFrameName}))},y=(0,oI._)(f),k.label=4;case 4:return[4,y.next()];case 5:if(!(h=!(b=k.sent()).done))return[3,7];if(_=x(),"object"===(0,ni._)(_))return[2,_.v];k.label=6;case 6:return h=!1,[3,4];case 7:return[3,14];case 8:return S=k.sent(),m=!0,v=S,[3,14];case 9:if(k.trys.push([9,,12,13]),!(h&&null!=y.return))return[3,11];return[4,y.return()];case 10:k.sent(),k.label=11;case 11:return[3,13];case 12:if(m)throw v;return[7];case 13:return[7];case 14:return o({status:"in_progress",progress:1,text:"Creating checkpoint"}),[4,r.git.init.rpc({initialCommit:!0,includeAllInitialFiles:!0},{signal:a})];case 15:if(!(C=k.sent()).ok)switch(C.payload.code){case"CANCEL":case"UNEXPECTED_DISCONNECT":return[2];default:oT.withScope(function(e){e.setExtra("gitInitError",C.payload),oT.captureException(Error("figma import: git init failed"))})}return o({status:"in_progress",progress:1,text:"Handing off to Agent"}),[4,w()];case 16:return k.sent(),[4,n({variables:{input:{id:e,title:g,makeTitleUnique:!0,figmaImportStatus:rq.FigmaImportStatus.Completed}}})];case 17:return k.sent(),(0,ei.track)(eo.events.FIGMA_IMPORT_USED,{action:"completed"}),(0,ei.track)(eo.events.IMPORT,{action:"import_success",import_type:"figma"}),o({status:"success"}),[2]}})})()},[d,e,n,w,s,t,j]),c&&"Repl"===c.getRepl.__typename&&c.getRepl.config.figmaImportStatus===rq.FigmaImportStatus.Failed&&"not_started"===i.status)?{status:"error",errorMessage:"Something went wrong"}:i);return"not_started"===C.status||"success"===C.status?null:("in_progress"===C.status?_=(0,g.jsx)(oB,{text:C.text,progress:C.progress}):"error"===C.status?_=(0,g.jsx)(oN,{errorMessage:C.errorMessage}):"needs_auth"===C.status&&(_=(0,g.jsx)(oG,{onClick:function(){S.push("/integrations")}})),(0,g.jsx)(oF.Portal,{children:(0,g.jsx)(A.View,{clsx:oU.default.overlay,style:{cursor:"in_progress"===C.status?"wait":"default"},children:(0,g.jsx)(ok.default,{children:(0,g.jsxs)(A.View,{clsx:oU.default.animationWrapper,tabIndex:-1,children:[(0,g.jsxs)(A.View,{align:"center",gap:16,children:[(0,g.jsx)(oM.Figma2ReplitIcons,{}),(0,g.jsx)(ez.Text,{multiline:!1,variant:"subheadBig",dataCy:"figma-lock-screen",children:"Importing from Figma..."})]}),(0,g.jsx)(A.View,{pt:16,px:16,gap:4,children:_})]})})})}))}var oz=e.i(850270),oH=e.i(278505),oq=e.i(119322);function oK(){var e=(0,e2.default)().replspaceApi,n=(0,U._)((0,B.useState)(!1),2),t=n[0],r=n[1],i=(0,U._)((0,B.useState)({status:"not_started"}),2),o=i[0],a=i[1],s=ri(),l=(0,oH.useSetGitHubImportMode)();if((0,oz.useDoGitHubImportFlow)({setConfigScreenLockIsOpen:r,openPane:s,onStatusChange:a}),(0,B.useEffect)(function(){if(!t)return void l(!1);l(!0);var n=e.onConfirmSendToken(function(e){e&&e(!0,!1)});return function(){n(),l(!1)}},[t,e,l]),!t)return null;var u="Importingâ€¦";return"in_progress"===o.status?u=o.text:"error"===o.status&&(u="Import failed: ".concat(o.errorMessage)),(0,g.jsx)(oq.default,{reason:u})}var o$=e.i(649960),oQ=e.i(332441),oY=e.i(418725),oJ=e.i(188019),oX=e.i(492267),oZ=e.i(12558),o0=e.i(659790),o1=e.i(908410),o2=e.i(740616),o4=e.i(629756),o8=e.i(6338),o3=(0,eI.cssRecord)({container:[eT.rcss.position.relative],loadingGeneratedIcon:[o8.loadingStyle.foregroundPulse(R.tokens.blurpleDimmest,R.tokens.blurpleDefault),eT.rcss.borderRadius()]});function o6(e){var n=e.replId,t=e.replIconUrl,r=e.size,i=(0,o4.usePollForGeneratedReplIcon)({replId:n,replIconUrl:t}),o=i.loading,a=i.generatedIconUrl;return(0,g.jsx)(A.View,{css:o3.container,children:(0,g.jsx)(A.View,{css:o&&o3.loadingGeneratedIcon,children:(0,g.jsx)(t7.default,{iconUrl:a||t,size:void 0===r?20:r,alt:""})})})}var o9=e.i(341727),o5=e.i(751273),o7=e.i(196353),ae=e.i(497627),an=(0,eI.cssRecord)({metadata:[],iconWrapper:[eT.rcss.position.relative],dimIcon:[{opacity:.2}],diconnectedIcon:[eT.rcss.position.absolute,{left:0,right:0,top:0,bottom:0,margin:"auto"}],title:[eT.rcss.flex.shrink(1),eT.rcss.truncate],placeholderTitle:[eT.rcss.width(100),eT.rcss.borderRadius("default"),{alignSelf:"stretch"},o8.loadingStyle.foregroundPulse(R.tokens.backgroundDefault,R.tokens.backgroundHigher)]});function at(e){var n,t=e.repl,r=e.hideTitle,i=(0,o9.default)().didDisconnect;return(0,g.jsxs)(A.View,{grow:!0,shrink:!0,row:!0,gap:6,align:"center",children:[(0,g.jsxs)(A.View,{css:an.iconWrapper,children:[(null==(n=t.project)?void 0:n.id)?(0,g.jsx)(g.Fragment,{children:r?(0,g.jsx)(o7.default,{}):null}):(0,g.jsx)(A.View,{css:i&&an.dimIcon,children:(0,g.jsx)(o6,{replId:t.id,replIconUrl:t.iconUrl,size:16})}),i?(0,g.jsx)(o5.Tooltip,{tooltip:"Reconnecting",children:(0,g.jsx)(ae.default,{size:16,css:an.diconnectedIcon})}):null]}),r?null:(0,g.jsx)(ez.Text,{multiline:!1,css:an.title,"data-cy":"header-repl-title",color:i?"dimmer":"default",translate:"no",children:t.title})]})}var ar=e.i(754873),ai=e.i(604963),ao=(0,eI.cssRecord)({popover:[eT.rcss.maxWidth(460),eT.rcss.width("100%")],button:[ar.interactive.nofill,eT.rcss.height(28),eT.rcss.flex.growAndShrink(1),eT.rcss.align.center,eT.rcss.rowWithGap(4),eT.rcss.px(6),eT.rcss.borderRadius(),eT.rcss.color.foregroundDefault,{'&[aria-expanded="true"]':{backgroundColor:R.tokens.interactiveBackgroundActive}}]});function aa(e){var n=e.repl,t=e.getDesktopLayoutState,r=e.hideTitle,i=(0,U._)((0,B.useState)(!1),2),o=i[0],a=i[1],s=function(){var e=(0,Q.useDoesBonsaiSupportFeature)("simplifiedTabletUI"),n=(0,B.useCallback)(function(){e&&(0,oj.sendMessage)({messageType:ow.BridgeMessageType.SHOW_REPL_INFO},(0,o1.nanoid)())},[e]);if(e)return n}();return(0,Q.useIsInBonsaiWebview)()?(0,g.jsx)(A.View,{css:ao.button,onClick:s,children:(0,g.jsx)(at,{repl:n,hideTitle:r})}):(0,g.jsxs)(ai.PopoverTrigger,{isOpen:o,onOpenChange:function(e){a(e),e&&(0,ei.track)(eo.events.MODAL_VIEWED,{modal_name:"repl_metadata_popover"})},placement:"bottom start",label:"Repl info",css:ao.popover,children:[(0,g.jsx)(A.SpecializedView.button,{dataCy:"ws-repl-info-container",css:ao.button,onClick:function(){(0,ei.track)(eo.events.WORKSPACE,{action:"repl_metadata_opened"})},"aria-expanded":o,children:(0,g.jsx)(at,{repl:n,hideTitle:r})}),(0,g.jsx)(o2.default,{getDesktopLayoutState:t,setIsEditing:a})]})}var as=e.i(76961),al=e.i(248011),au=e.i(663762),ac=e.i(57527),ad=e.i(596139),ap=e.i(443394),af=e.i(27820),ag=e.i(257811),ah=e.i(672685),am=e.i(788331),av=e.i(42458),ax=e.i(111724);function ay(e){var n=e.icon,t=e.title,r=e.subtitle,i=e.current,o=e.max,a=e.nextCreditsAt,s=e.isMonthly,l=Math.min(i,o),u=Math.min(l/o,1),c=(0,ah.getPercentageFillColor)({decimal:u}),d=i>=o,p=null!=a&&"countdown"===(0,ag.toCountdownDate)({date:a}).type;return(0,g.jsxs)(E.Surface,{clsx:ax.default.usageCard,p:8,gap:8,background:"higher",children:[(0,g.jsxs)(A.View,{children:[(0,g.jsxs)(A.View,{row:!0,align:"baseline",justify:"space-between",grow:!0,children:[(0,g.jsxs)(A.View,{row:!0,align:"end",gap:6,children:[n,(0,g.jsx)(ez.Text,{color:"dimmer",height:"singleLine",style:{fontWeight:R.tokens.fontWeightMedium},children:t}),d?(0,g.jsx)(av.default,{size:16,color:R.tokens.accentNegativeDefault}):null]}),(0,g.jsxs)(ez.Text,{color:"dimmer",children:[Math.floor(100*u),"%"]})]}),(0,g.jsx)(ez.Text,{variant:"small",color:"dimmer",children:r})]}),(0,g.jsx)(af.MeasureBar,{css:ax.default.measureBar,total:o,current:l,color:c,tooltipHidden:!0}),a&&p&&d?(0,g.jsxs)(A.View,{row:!0,gap:3,children:[(0,g.jsxs)(ez.Text,{color:"dimmer",children:[s?"Monthly":"Daily"," credits will reset in"," "]}),(0,g.jsx)(ag.Timestamp,{date:a,dateFormat:"countdown",live:!0,textColor:"dimmer"})]}):null]})}function ab(e){var n=e.agentLimit,t=e.agentUsage,r=e.cloudUsage,i=e.cloudLimit,o=e.agentNextCreditsAt,a=e.cloudNextCreditsAt,s=e.isUnderMonthlyQuota,l=(0,ap.getCurrentUrl)(),u=(0,K.useFlag)({controlName:"flag-free-plan",default:!1});if(void 0===n||void 0===t)return(0,g.jsx)(oL.default,{});var c=void 0!==r&&void 0!==i&&r/i>=.25;return(0,g.jsxs)(A.View,{gap:16,children:[(0,g.jsxs)(A.View,{gap:8,children:[(0,g.jsx)(ez.Text,{variant:"subheadDefault",height:"singleLine",children:"Free usage limits"}),(0,g.jsx)(ay,{icon:(0,g.jsx)(rN.default,{size:16}),title:u?!1===s?"Monthly Agent credits":"Daily Agent credits":"Agent usage",subtitle:"Build, test, and iterate in fast mode",current:t,max:n,nextCreditsAt:o,isMonthly:!1===s}),u&&c?(0,g.jsx)(ay,{icon:(0,g.jsx)(am.default,{size:16}),title:"Monthly Cloud credits",subtitle:"AI integrations, publishing, and storing assets",current:r,max:i,nextCreditsAt:a,isMonthly:!0}):null]}),(0,g.jsx)(oY.default,{text:"Upgrade to Replit ".concat(ad.corePlanName),colorway:"primary",variant:"default",context:"agent_freemium_quota_v2",redirectPath:l,modalHeadingText:"Upgrade for more Agent usage",modalSubHeadingText:"Get more credits and build faster with Replit ".concat(ad.corePlanName)})]})}var aw=e.i(573605),aj=e.i(176843),a_=e.i(552488),aS=(0,eI.cssRecord)({root:[eT.rcss.px(8),ar.interactive.nofill,eT.rcss.height(32),eT.rcss.align.center,eT.rcss.rowWithGap(4),eT.rcss.px(6),eT.rcss.borderRadius(),eT.rcss.color.foregroundDefault],measureBar:[eT.rcss.width(50),eT.rcss.height(8),{pointerEvents:"none"}],popoverWrapper:[eT.rcss.width(300)]});function aC(){var e,n,t,r,i,o,a,s=(0,U._)((0,B.useState)(!1),2),l=s[0],u=s[1],c=(0,aw.useGetAgentFreeUsage)(),d=c.agentUsage,p=c.agentUsageV2,f=c.refetch,h=(0,aj.useGetCloudFreeUsage)(),m=h.cloudUsage,v=h.refetch;(0,ac.useOnPresentToUser)((0,B.useCallback)(function(e){"cloudBudgetExceeded"===e.$kind&&u(!0)},[])),p?(e=p.usage,n=p.limit,t=p.nextCreditsAt,a=p.isUnderMonthlyQuota):(e=null==d?void 0:d.usage,n=null==d?void 0:d.limit),m&&"FreemiumCloudUsageLimits"===m.__typename&&(r=null==m?void 0:m.usage,i=null==m?void 0:m.limit,o=null==m?void 0:m.nextCreditsAt),(0,a_.useOnHitFreemiumAlertThreshold)({usage:e,limit:n,percentThreshold:a_.FREEMIUM_POPUP_WARNING_ALERT_THRESHOLD,onHitThreshold:function(){u(!0)}}),(0,a_.useOnHitFreemiumAlertThreshold)({usage:e,limit:n,percentThreshold:a_.FREEMIUM_POPUP_NEAR_LIMIT_ALERT_THRESHOLD,onHitThreshold:function(){u(!0)}}),(0,a_.useOnHitFreemiumAlertThreshold)({usage:e,limit:n,percentThreshold:a_.FREEMIUM_POPUP_REACHED_ALERT_THRESHOLD,onHitThreshold:function(){u(!0),(0,ei.track)(eo.events.AGENT_USED,{action:"hit_freemium_quota"})}});var x=n&&e?e/n:0,y=i&&r?r/i:0;x=Math.min(x,1);var b=(0,ah.getPercentageFillColor)({decimal:x}),w=x>=1||y>=1;return x<.25&&y<.25?null:(0,g.jsxs)(ai.PopoverTrigger,{isOpen:l,onOpenChange:function(e){u(e),e&&(f(),v())},label:"Agent usage",placement:"bottom start",children:[(0,g.jsx)(eW.BaseButton,{css:aS.root,children:(0,g.jsxs)(A.View,{row:!0,align:"center",gap:8,children:[(0,g.jsx)(af.MeasureBar,{css:aS.measureBar,total:null!=n?n:0,current:null!=e?e:0,color:b,tooltipHidden:!0}),(0,g.jsxs)(ez.Text,{variant:"small",color:"dimmer",children:[Math.floor(100*x),"%"]}),w?(0,g.jsx)(av.default,{size:16,color:R.tokens.accentNegativeDefault}):null]})}),(0,g.jsx)(A.View,{css:aS.popoverWrapper,p:10,children:(0,g.jsx)(ab,{agentLimit:n,agentUsage:e,cloudUsage:r,cloudLimit:i,agentNextCreditsAt:t,cloudNextCreditsAt:o,isUnderMonthlyQuota:a})})]})}function ak(){var e=eC(),n=(0,eb.useKeyCombo)(eE.id),t=n?"".concat(eS," (").concat(n,")"):eS;return(0,g.jsx)(ot.IconButton,{alt:t,onClick:function(){return e()},size:28,dataCy:"command-bar-btn",children:(0,g.jsx)(t0.default,{})})}var aI=e.i(344677),aT=e.i(914279),aR=e.i(68893),aP=e.i(241703),aE=e.i(729678),aA=e.i(187505),aD=e.i(86159),aV=e.i(522821),aO=e.i(293265),aF=e.i(469429),aM=e.i(76430),aL=e.i(629536);e.i(709867),e.i(812432),e.i(33914);var aU=e.i(503536);e.i(709263),e.i(406345);var aB=e.i(634669);e.i(919015);var aN=e.i(733257);e.i(362874),e.i(680189);var aG=((r={}).Welcome="Welcome",r.AiFirstWorkspace="AiFirstWorkspace",r.Assistant="Assistant",r.Agent="Agent",r.SidebarDock="SidebarDock",r.Run="Run",r.Deploy="Deploy",r.NewTab="NewTab",r.Filetree="Filetree",r);(0,eI.cssRecord)({tooltipContainer:[eT.rcss.width("100%"),eT.rcss.maxWidth(300),eT.rcss.position.relative,eT.rcss.colWithGap(8),eT.rcss.pb(8)],textContent:[eT.rcss.width("100%"),{wordBreak:"break-word",overflowWrap:"anywhere"}]}),aL.AGENT_NAME;var aW="workspace-desktop-tour-2025",az=e.i(785719),aH=e.i(980713);function aq(e){var n=e.color;return(0,g.jsxs)(A.View,{clsx:aH.default.deployIconWithStatus,children:[(0,g.jsx)(aU.default,{}),(0,g.jsx)(A.View,{tag:"span",clsx:aH.default.deployIconDotWrapper,children:(0,g.jsx)(A.View,{tag:"span",clsx:aH.default.deployIconDot,style:{backgroundColor:n}})})]})}function aK(e){var n=e.text,t=e.icon,r=e.disabled,i=e.rounded,o=e.onClick,a=e.tooltip,s=e.loading,l=e.iconOnly,u=e.tourStepRef,c=e.colorway,d=(0,g.jsx)(eW.Button,{ref:u,loading:s,size:"small",text:n,iconLeft:t,colorway:c,clsx:i?s?aH.default.roundedButtonLoading:aH.default.roundedButton:s?aH.default.baseButtonLoading:aH.default.baseButton,disabled:r,onClick:o,"data-icon-only":l});return a?(0,g.jsx)(o5.Tooltip,{tooltip:a,children:d}):d}function a$(e){var n,t,r,i,o,a,s,l,u,c,d,p,f,h,m=e.iconOnly,v=e.shouldSkipOpeningPane,x=void 0!==v&&v,y=(0,aT.useDeploymentMode)(),b=(0,aI.usePauseProvisionStage)(),w=(0,oX.useIsAgentStackRepl)().isAgentStackRepl,j=(0,aO.useAgentStackPlatformType)().agentStackPlatformType,_=function(e,n,t){switch(e){case aR.DeploymentMode.Ready:case aR.DeploymentMode.Suspended:case aR.DeploymentMode.ProcessingLifecycleCommand:case aR.DeploymentMode.Loading:switch(n){case rq.AgentStackPlatformType.Slack:return"Publish to Slack";case rq.AgentStackPlatformType.Telegram:return"Publish to Telegram";case rq.AgentStackPlatformType.TimeBased:return"Publish Automation";default:return"Publish"}case aR.DeploymentMode.Preparing:return"Preparing";case aR.DeploymentMode.PreparingDatabase:switch(t){case!0:return"Approve";case!1:return"Preparing"}break;case aR.DeploymentMode.Deploying:switch(n){case rq.AgentStackPlatformType.Slack:return"Publishing to Slack";case rq.AgentStackPlatformType.Telegram:return"Publishing to Telegram";case rq.AgentStackPlatformType.TimeBased:return"Publishing Automation";default:return"Publishing"}default:(0,ob.default)(e)}}(y,w&&j||null,!!b),S=!1,C=!1;switch(y){case aR.DeploymentMode.Ready:case aR.DeploymentMode.Suspended:case aR.DeploymentMode.ProcessingLifecycleCommand:h=(0,g.jsx)(aU.default,{});break;case aR.DeploymentMode.Loading:h=(0,g.jsx)(aU.default,{}),S=!0;break;case aR.DeploymentMode.Preparing:h=(0,g.jsx)(aU.default,{}),S=!0,C=!0;break;case aR.DeploymentMode.PreparingDatabase:b?(h=(0,g.jsx)(az.default,{color:R.tokens.orangeStronger}),C=!0,S=!1):(h=(0,g.jsx)(oL.default,{}),C=!0,S=!0);break;case aR.DeploymentMode.Deploying:h=(0,g.jsx)(oL.default,{}),C=!0;break;default:(0,ob.default)(y)}var k=(0,es.useOpenTool)(),I=(0,tL.useSetDeploymentTriggerSource)(),T=!!(0,aV.useActiveAgentSessionId)(),P=(n=(0,e2.default)().dotReplit,r=(t=(0,U._)((0,B.useState)(null),2))[0],i=t[1],(0,B.useEffect)(function(){return n.watch(function(e){var n;if(e.error)return i(null);i((null==(n=e.config.deployment)?void 0:n.target)||null)})},[n]),r),E=(o=(0,tL.useDeployBuild)().deployBuild,a=(0,eN.default)(),s=(0,tL.useDotReplitService)(),l=(0,e$.default)().showError,u=(0,tL.useSecretsService)(),c=(0,tL.useDeploymentSubdomain)(),d=(0,tL.useDeploymentSecurityScanState)().enabled,p=(0,aE.useGetSecretsAsDeploymentEntries)({secrets:u,replId:a}),f=!!(0,aV.useActiveAgentSessionId)(),(0,B.useCallback)(function(){return(0,ee._)(function(){var e,n,t;return(0,en._)(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),[4,(0,aE.getDotReplitDeploymentConfig)(s)];case 1:return e=r.sent(),[4,p()];case 2:if(n=r.sent(),!(t=c)||!e.publicDir)return[2,!1];return[4,o({provider:rq.HostingBuildProvider.Static,subdomain:t,config:{buildCommand:e.buildCommand,publicDir:e.publicDir,appType:rq.DeployHostingBuildAppType.Static,ignorePorts:!1,runCommand:null},envVars:n,privacyMode:rq.DeployHostingBuildPrivacyMode.Public,ignoredSecrets:[],hasAgentSession:f,enableSecurityScan:d,createNeonProductionDatabase:!1,pushDevelopmentDatabaseObjects:null})];case 3:return r.sent(),[2,!0];case 4:return l(r.sent().message||"Failed to deploy"),[2,!1];case 5:return[2]}})})()},[o,l,s,p,c,d,f])),A=(0,aD.useSetTourStepTarget)(aW,aG.Deploy);return(0,g.jsx)(aK,{text:_,icon:h,onClick:function(){return(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:if(y===aR.DeploymentMode.Ready&&(0,ei.track)(eo.events.DEPLOY_PROJECT_SELECTED,{source:"deploy_button",has_agent_session:T}),I("workspace_header_publish_button"),!x)return[3,2];return[4,E()];case 1:if(e.sent())return[2];e.label=2;case 2:return k({pane:{type:"deployments",flow:{skipIntro:null!==P&&T,isAgentDeployment:null!==P&&T}}}),[2]}})})()},disabled:S,loading:C,rounded:!0,iconOnly:void 0!==m&&m,tourStepRef:A,colorway:y===aR.DeploymentMode.Ready?"primary":void 0})}function aQ(){var e,n,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.hideOpenPaneButton,i=t.forcePrimaryColorway,o=(0,aA.useTrackClick)().trackClick,a=(0,aT.useDeploymentMode)(),s=(0,tL.useDeploymentError)(),l=(0,tL.useActiveBuildAction)(),u=(0,tL.useSetDeploymentTriggerSource)(),c=(0,es.useOpenTool)(),d=(0,tL.useDeployBuild)({openDeploymentsPane:function(){c({pane:{type:"deployments"}})}}).redeployWithNoNewOptions,p=(0,e$.default)().showError,f=(0,aI.usePauseProvisionStage)(),h=(0,aO.useAgentStackPlatformType)().agentStackPlatformType,m=(0,aM.useIsExpoStackWithLaunchEnabled)(),v=(0,G.useSupportsAgent)(),x=(0,U._)((0,B.useState)(void 0),2),y=x[0],b=x[1];(0,B.useEffect)(function(){if(l&&"HostingBuildDeployStatusAction"===l.__typename)switch(l.status){case rq.HostingBuildStatus.Success:case rq.HostingBuildStatus.Failed:b(l.status)}},[l]),(0,B.useEffect)(function(){a===aR.DeploymentMode.Deploying&&b(void 0)},[a]);var w=function(){switch(h){case rq.AgentStackPlatformType.Slack:return"Republish to Slack";case rq.AgentStackPlatformType.Telegram:return"Republish to Telegram";case rq.AgentStackPlatformType.TimeBased:return"Republish Automation";default:return"Republish"}}(),j=function(){switch(h){case rq.AgentStackPlatformType.Slack:return"Publishing to Slack";case rq.AgentStackPlatformType.Telegram:return"Publishing to Telegram";case rq.AgentStackPlatformType.TimeBased:return"Publishing Automation";default:return"Publishing"}}(),_=void 0,S=!1,C=!1;switch(a){case aR.DeploymentMode.Ready:e="Republish",n=(0,g.jsx)(aU.default,{}),y&&(y===rq.HostingBuildStatus.Success?(n=(0,g.jsx)(aq,{color:R.tokens.accentPositiveDefault}),_="Success"):(n=(0,g.jsx)(aq,{color:R.tokens.accentNegativeDefault}),_="An error occurred"));break;case aR.DeploymentMode.Suspended:e=w,n=(0,g.jsx)(aq,{color:R.tokens.greyDefault}),_="Published app suspended";break;case aR.DeploymentMode.Loading:e=w,n=(0,g.jsx)(aU.default,{}),S=!0,C=!0;break;case aR.DeploymentMode.ProcessingLifecycleCommand:e=w,n=(0,g.jsx)(aq,{color:R.tokens.orangeStronger}),C=!0,_="Updating published app";break;case aR.DeploymentMode.Preparing:e="Preparing",n=(0,g.jsx)(oL.default,{}),C=!0,S=!0;break;case aR.DeploymentMode.PreparingDatabase:f?(e="Approve",n=(0,g.jsx)(az.default,{color:R.tokens.orangeStronger}),C=!0,S=!1):(e="Preparing",n=(0,g.jsx)(oL.default,{}),C=!0,S=!0);break;case aR.DeploymentMode.Deploying:e=j,n=(0,g.jsx)(oL.default,{}),C=!0;break;default:(0,ob.default)(a)}return s&&(e="Error",n=(0,g.jsx)(aq,{color:R.tokens.accentNegativeDefault}),_=s),(0,g.jsxs)(A.View,{row:!0,gap:2,children:[(0,g.jsx)(aK,{text:e,icon:n,tooltip:_,onClick:function(){o({productArea:"publishing",target:"redeploy_button"}),(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:if(m||a===aR.DeploymentMode.Deploying||a===aR.DeploymentMode.Suspended||a===aR.DeploymentMode.ProcessingLifecycleCommand||a===aR.DeploymentMode.Preparing||a===aR.DeploymentMode.PreparingDatabase||y&&(b(void 0),y===rq.HostingBuildStatus.Failed)||s)return c({pane:{type:"deployments",data:{view:aP.Views.Deployment}}}),[2];e.label=1;case 1:return e.trys.push([1,3,,4]),u("workspace_header_republish_button"),[4,d({hasAgentSession:v})];case 2:return e.sent(),[3,4];case 3:return p(e.sent().message),[3,4];case 4:return[2]}})})()},disabled:S,loading:C,colorway:i?"primary":void 0}),r?null:(0,g.jsx)(ot.IconButton,{filled:!0,size:28,alt:"Open Publishing pane",onClick:function(){c({pane:{type:"deployments"}})},clsx:aH.default.openPaneButton,children:(0,g.jsx)(rX.default,{})})]})}var aY=function(){var e=(0,es.useOpenTool)();return(0,g.jsx)(eW.Button,{size:"small",text:"Republish",iconLeft:(0,g.jsx)(aU.default,{}),onClick:function(){e({pane:{type:"deployments"}})}})};function aJ(e){var n=e.iconOnly,t=e.isDesignMode,r=e.hideOpenPaneButton,i=e.forcePrimaryColorway,o=(0,tL.useDeploymentId)(),a=(0,tL.useDeploymentCurrentBuild)(),s=(0,tL.useDeploymentDeployability)().deployability,l=(0,tL.useDeploymentSessionOrg)(),u=!!(null==l?void 0:l.id),c=(0,aF.useHasAgentCheckpoint)();return o&&a?s.redeploy.isAuthorized?(0,g.jsx)(aQ,{hideOpenPaneButton:r,forcePrimaryColorway:i}):(0,g.jsx)(aY,{}):(0,g.jsx)(a$,{iconOnly:n,shouldSkipOpeningPane:t&&!u&&c})}var aX=e.i(239612);function aZ(){var e=(0,v._)(["\n  fragment ProjectHeaderMenuOrg on Org {\n    id\n    slug\n  }\n"]);return aZ=function(){return e},e}function a0(){var e=(0,v._)(["\n  query ProjectHeaderMenu($id: String!, $input: ProjectReplsInput!) {\n    getRepl(id: $id) {\n      ... on Repl {\n        id\n        title\n        ...CreateProjectForkRepl\n        project {\n          id\n          mainRepl {\n            id\n            title\n            ...CreateProjectForkRepl\n          }\n          repls(input: $input) {\n            items {\n              id\n              title\n              ...ReplLinkRepl\n            }\n            pageInfo {\n              hasNextPage\n              nextCursor\n            }\n          }\n        }\n      }\n    }\n  }\n  ","\n  ","\n"]);return a0=function(){return e},e}var a1={};(0,x.gql)(aZ());var a2=(0,x.gql)(a0(),aX.CreateProjectForkReplFragmentDoc,t2.ReplLinkReplFragmentDoc),a4=e.i(691056),a8=e.i(611361),a3=e.i(341126),a6=e.i(700582),a9=e.i(537548),a5=e.i(91720),a7=e.i(988676),se=e.i(85742),sn=e.i(458496),sn=sn,st=e.i(119274),sr=e.i(698043),si=e.i(498540),so=e.i(690821),sa=e.i(185591),ss=e.i(616278),sl=e.i(606867),su=(0,eI.cssRecord)({self:[eT.rcss.display.grid,eT.rcss.p(4),{gap:4,alignItems:"stretch"}],list:[eT.rcss.maxHeight(640)],listItem:[sn.default.item,eT.rcss.px(8),eT.rcss.height(28),{span:eT.rcss.color.foregroundDefault}],listItemLabel:{flex:1},listButtonLink:[eT.rcss.height(28),eT.rcss.px(6),eT.rcss.transition.none],currentReplIcon:[eT.rcss.color.foregroundDimmer],tourWrapper:[eT.rcss.p(8)]});function sc(e){var n=e.label,t=e.icon,r=(0,iu._)(e,["label","icon"]);return(0,g.jsxs)(se.BaseListBoxItem,(0,e9._)((0,m._)({css:su.listItem},r),{textValue:n,children:[(0,g.jsx)(se.ListBoxItemLabel,{css:su.listItemLabel,children:n}),(0,g.jsx)(sl.IconProvider,{size:16,children:t})]}))}var sd=(0,B.forwardRef)(function(e,n){var t,r,i,o,a,s,l,u,c,d,p,f,h=(0,eN.default)(),v=(0,U._)((0,B.useState)(""),2),x=v[0],b=v[1],w=(0,aD.useTourStep)(a9.projectsTour.id,a9.StepIds.Forks),j=(t={variables:{id:h,input:{}},notifyOnNetworkStatusChange:!0},r=(0,m._)({},a1,t),y.useQuery(a2,r)),_=j.refetch,S=(0,e$.default)(),C=S.showConfirm,k=S.showError,I=(0,U._)((0,a6.useCreateProjectFork)({onFork:function(){C("App forked, redirecting...")},onError:function(){k("Error creating fork - please try again")}}),2),T=I[0],R=I[1].loading;(0,a4.default)(function(){_({input:{filters:{title:{search:x}}},id:h})},[x],300);var P=(null==(i=j.data)?void 0:i.getRepl.__typename)==="Repl"?j.data.getRepl.project:null,E=(null==(o=j.previousData)?void 0:o.getRepl.__typename)==="Repl"?null==(a=j.previousData.getRepl.project)?void 0:a.repls.items:null,D=null!=(d=null==P?void 0:P.mainRepl)?d:(null==(s=j.previousData)?void 0:s.getRepl.__typename)==="Repl"&&null!=(c=null==(l=j.previousData.getRepl.project)?void 0:l.mainRepl)?c:null,V=(null==(u=j.data)?void 0:u.getRepl.__typename)==="Repl"?j.data.getRepl:null,O=(0,a8.useProjectPresenceUsersByRepl)({orgId:e.org.id,projectId:e.projectId}),F=(0,aD.useActiveTourStep)();return(0,g.jsxs)("div",{css:su.self,ref:n,children:[(0,g.jsxs)(sr.SearchableListBox,{children:[(0,g.jsx)(si.SearchField,{"aria-label":"Search Apps in Project",placeholder:"Search by App title...",onChange:b,isLoading:j.loading,autoFocus:!0}),(0,g.jsx)(se.ListBox,{isLoading:j.loading,items:null!=(f=null!=(p=null==P?void 0:P.repls.items)?p:E)?f:[],css:su.list,children:function(e){var n;return(0,g.jsx)(sc,(0,e9._)((0,m._)({icon:e.id===h?(0,g.jsx)(o5.Tooltip,{tooltip:"You are here",placement:"right",children:(0,g.jsx)(ss.default,{css:su.currentReplIcon})}):void 0,isDisabled:e.id===h,id:e.id,label:e.title},(0,sa.replLinkProps)(e)),{sessions:null!=(n=O[e.id])?n:[]}),e.id)}})]}),(0,g.jsx)(a7.DividerH,{}),(0,g.jsxs)(A.View,{children:[(0,g.jsx)(a5.ButtonLink,(0,e9._)((0,m._)({alignment:"start"},(0,a3.orgProjectLink)({org:e.org,projectId:e.projectId})),{target:"_blank",iconLeft:(0,g.jsx)(rY.default,{}),text:"Project dashboard",variant:"nofill",css:su.listButtonLink})),(0,g.jsxs)(st.PopupMenu,{elevated:!1,placement:"right top",trigger:(0,g.jsx)(eW.Button,{alignment:"start",variant:"nofill",text:"New fork",iconLeft:R?(0,g.jsx)(oL.default,{}):(0,g.jsx)(tS.default,{}),loading:R,css:su.listButtonLink}),children:[V?(0,g.jsx)(st.MenuItem,{label:"From here (".concat(V.title,")"),isDisabled:R,onAction:function(){T({forkSource:"projectHeaderMenu",orgId:e.org.id,repl:V})}}):null,V&&D&&V.id!==D.id?(0,g.jsx)(st.MenuItem,{label:"From main App (".concat(D.title,")"),isDisabled:!D||R,onAction:function(){D&&T({orgId:e.org.id,repl:D,forkSource:"projectHeaderMenu"})}}):null]}),w.isActive&&F?(0,g.jsx)("div",{css:su.tourWrapper,children:(0,g.jsx)(so.Tour,{content:F.content,title:F.title,onDismiss:w.next,onCurrentStepChange:w.goto,currentStepIndex:a9.projectsTour.steps.findIndex(function(e){return e.id===a9.StepIds.Forks}),totalSteps:a9.projectsTour.steps.length})}):null]})]})}),sp=e.i(782096),sf=(0,eI.cssRecord)({projectLinkTooltip:[eT.rcss.maxWidth(400),eT.rcss.flex.shrink(2)],projectLink:[eT.rcss.px(6),eT.rcss.noDragRegion,eT.rcss.flex.growAndShrink(1)],inheritanceChevron:[eT.rcss.color.outlineStrongest,{marginInline:-1}]});function sg(e){var n=e.repl,t=e.hideTitle,r=(0,U._)((0,B.useState)(!1),2),i=r[0],o=r[1];return n.project&&n.org?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(o5.Tooltip,{tooltip:"Project forks",css:sf.projectLinkTooltip,isOpen:!i&&void 0,children:(0,g.jsxs)(ai.PopoverTrigger,{label:"Project Menu",isOpen:i,onOpenChange:o,placement:"bottom start",children:[(0,g.jsx)(eW.Button,{iconLeft:(0,g.jsx)(o6,{replId:n.id,replIconUrl:n.iconUrl}),text:t?"":n.project.title,variant:"nofill",css:sf.projectLink}),(0,g.jsx)(sd,{org:n.org,projectId:n.project.id})]})}),(0,g.jsx)(sp.default,{size:12,css:sf.inheritanceChevron})]}):null}var sh=e.i(782672),sm=e.i(550801);function sv(e){var n=e.nixError,t=(0,U._)((0,B.useState)(!1),2),r=t[0],i=t[1],o=ri(),a=(0,B.useCallback)(function(e){o({type:"codeEditor",data:{path:e}})},[o]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(ot.IconButton,{alt:"App is in recovery mode",onClick:function(){i(!0)},children:["error"===n.status?(0,g.jsx)(av.default,{color:R.tokens.orangeStronger}):null,"rebuilding-after-error"===n.status?(0,g.jsx)(oL.default,{}):null]}),(0,g.jsx)(sm.NixIsBrokenModal,{isOpen:r,setIsOpen:i,nixError:n,openFile:a})]})}function sx(){var e=(0,v._)(["\n  query WorkspaceRunButton($id: String!) {\n    getRepl(id: $id) {\n      ... on Repl {\n        id\n        title\n        rootOriginReplUrl\n        source {\n          release {\n            id\n            repl {\n              id\n              title\n              owner {\n                ... on User {\n                  id\n                  username\n                }\n                ... on Team {\n                  id\n                  username\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n    currentUser {\n      id\n    }\n  }\n"]);return sx=function(){return e},e}var sy={},sb=(0,x.gql)(sx()),sw=e.i(353583),sj=(p={},(0,I._)(p,r_.RunState.IDLE,"Run"),(0,I._)(p,r_.RunState.RUNNING,"Stop"),(0,I._)(p,r_.RunState.STOPPING,"Stopping"),(0,I._)(p,r_.RunState.OFFLINE,"Working"),(0,I._)(p,r_.RunState.BEFORE_RUN,"Working"),p),s_=e.i(796817);function sS(e){var n=e.stop,t=e.cancel;return(0,g.jsxs)(A.View,{children:[(0,g.jsx)(ez.Text,{children:"Stopping your project while the agent is working can lead to unexpected interruptions that incur additional costs. Are you sure you want to stop?"}),(0,g.jsxs)(A.View,{pt:12,row:!0,gap:12,justify:"end",children:[(0,g.jsx)(eW.Button,{text:"Cancel",onClick:t}),(0,g.jsx)(eW.Button,{iconLeft:(0,g.jsx)(s_.default,{}),text:"Stop",onClick:function(){n(),t()},colorway:"negative"})]})]})}var sC=e.i(978669),sk=e.i(60166);function sI(e){var n={running:(0,g.jsx)(s_.default,{color:R.tokens.foregroundDimmest}),stopped:(0,g.jsx)(sC.default,{color:e.disabled?R.tokens.foregroundDimmest:R.tokens.accentPositiveStronger}),loading:(0,g.jsx)(oL.default,{color:R.tokens.foregroundDimmest})}[e.status];return(0,g.jsx)(E.Surface,{elevated:e.elevated,clsx:sk.default.root,children:(0,g.jsx)(ot.IconButton,{disabled:e.disabled,dataCy:"ws-run-btn",alt:"Run or stop the app",tooltipContents:e.tooltip,onClick:e.onClick,size:28,children:n})})}function sT(){var e,n,t,r,i,o,a,s,l,u,c,d,p,f,h,v,x,b,w,j,_,S,C,k=(a=(null==(o=(r={variables:{id:(0,eN.default)()}},i=(0,m._)({},sy,r),y.useQuery(sb,i)).data)?void 0:o.getRepl.__typename)==="Repl"?o.getRepl:null,s=(n=null==(e=(0,aD.useTourStep)("workspace-desktop-tour-2024",aG.Run))?void 0:e.isActive,{tourRefs:e.tourRef,isAnyTourStepActive:n}).tourRefs,l=(0,eb.useKeyCombo)(rK.run.id),c=(u=(0,U._)((0,B.useState)(!1),2))[0],d=u[1],f=null!=(t=null==(p=(0,rD.useWorkflowsRunner)())?void 0:p.workflowId)?t:r_.PID1_RUNNER_NAME,v=(h=(0,rD.useRunInfo)()).isRunning,x=h.isAgentRunningWorkflow,b=h.isOffline,w=h.isWorkflowsLoading,j=h.isDisabled,_=(0,B.useMemo)(function(){return b||w},[b,w]),S=(0,sw.useIsAgentRunButtonNotConfigured)(),C=(0,rD.useOnToggleRun)(),(0,B.useEffect)(function(){x&&c&&d(!1)},[x,c]),{tourRefs:s,isAgentRunningWorkflow:x,isOffline:b,isOfflineOrLoading:_,isWorkflowsLoading:w,runButtonName:f,runShortcut:l,isRunning:v,isDisabled:j,handleRunButtonClick:(0,B.useCallback)(function(){if(a){var e,n,t,r,i,o,s;(0,ei.track)(eo.events.PROJECT_RAN,{placement:"primary_btn",replId:a.id,replTitle:a.title,rootOriginReplUrl:a.rootOriginReplUrl,templateTitle:null==(t=a.source)||null==(n=t.release)||null==(e=n.repl)?void 0:e.title,templateOwner:null==(s=a.source)||null==(o=s.release)||null==(i=o.repl)||null==(r=i.owner)?void 0:r.username})}(0,ei.track)(eo.events.WORKSPACE,{action:"run_button_used",usage:"clicked",source:"header",runner:"workflows"}),C()},[a,C]),dropdownEnabled:!_&&!S,isAgentRunButtonNotConfigured:S}),I=k.isOfflineOrLoading,T=k.isRunning,R=k.handleRunButtonClick,P=k.isAgentRunningWorkflow,E=k.isDisabled,D=k.runButtonName,V=k.runShortcut,O=k.isAgentRunButtonNotConfigured,F=(0,sh.useNixError)(),M=(0,U._)((0,B.useState)(!1),2),L=M[0],N=M[1],G=T?"running":"stopped";I&&(G="loading");var W=P?function(){return N(!0)}:R;return F?(0,g.jsx)(sv,{nixError:F}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(sI,{disabled:E||O,status:G,isAgentRunningWorkflow:P,onClick:W,tooltip:function(e){var n=e.isOffline,t=e.isAgentRunningWorkflow,r=e.isDisabled,i=e.isRunning,o=e.runButtonName,a=e.shortcut,s=e.isAgentRunButtonNotConfigured,l=e.isStatusButton;if(n)return"Connecting to the workspace";if(t)return l?"Stop App (Agent is running it)":"Agent is running your App";if(s)return"Agent hasn't configured the run button yet";if(r)return"Run button is not configured";var u=(0,r_.removeRunPrefix)(o);return(0,g.jsxs)(A.View,{px:4,gap:4,justify:"center",align:"center",children:[o?(0,g.jsx)(ez.Text,{color:"dimmer",variant:"small",children:i?sj[r_.RunState.RUNNING]+" all workflows":sj[r_.RunState.IDLE]+" ".concat(u)}):null,a?(0,g.jsx)(ro.KeyComboBlocks,{keyCombo:a,fontSize:12}):null]})}({isRunning:T,isAgentRunningWorkflow:P,isDisabled:E,isOffline:I,runButtonName:D,shortcut:V,isAgentRunButtonNotConfigured:O,isStatusButton:!0})}),(0,g.jsx)(eR.Modal,{isOpen:L,onRequestClose:function(){return N(!1)},children:(0,g.jsx)(sS,{stop:R,cancel:function(){return N(!1)}})})]})}function sR(e){var n=e.shortcut,t=e.content;return(0,g.jsxs)(A.View,{row:!0,gap:8,align:"center",children:[(0,g.jsxs)(ez.Text,{multiline:!1,variant:"small",children:["Toggle ",t]}),n?(0,g.jsx)(ro.KeyComboBlocks,{fontSize:10,keyCombo:n}):null]})}var sP=e.i(537754),sE=e.i(700283);function sA(e){var n=e.flipped,t=(0,es.useSidebar)(),r=(0,ix.default)(t.activeContent),i=(0,ix.default)(t.isOpen)&&"filetree"===r,o=(0,eb.useKeyCombo)(i1.id);(0,eb.useCommandBinding)(function(){return[i1.id,function(){return t.toggle()}]},[t]);var a=i?aN.default:sP.default;return(0,g.jsx)(ot.IconButton,{onClick:function(){return t.toggleContent("filetree")},alt:"Toggle files",dataCy:"toggle-files-sidebar",tooltipContents:(0,g.jsx)(sR,{shortcut:o,content:"files"}),size:28,children:(0,g.jsx)(a,{clsx:(0,I._)({},sE.default.flipped,n)})})}var sD=e.i(325990),sV=e.i(467716);function sO(){var e=(0,sD.useOrgFlag)({controlName:"flag-agent-inbox",default:!1}),n=(0,es.useSidebar)(),t=(0,eb.useKeyCombo)(i1.id);return e?(0,g.jsx)(ot.IconButton,{onClick:function(){return n.toggleContent("inbox")},alt:"Toggle inbox",dataCy:"toggle-inbox-sidebar",tooltipContents:(0,g.jsx)(sR,{shortcut:t,content:"inbox"}),size:28,children:(0,g.jsx)(sV.default,{})}):null}var sF=e.i(923893),sM=e.i(433788),sL=e.i(951262),sU=e.i(915598),sB=e.i(732947);function sN(){var e=(0,v._)(["\n  fragment ReplMultiplayerOrg on Org {\n    ...OrgMetadata\n    membersCount\n  }\n  ","\n"]);return sN=function(){return e},e}function sG(){var e=(0,v._)(["\n  fragment ReplMultiplayerOrgGroup on OrgGroup {\n    ...OrgGroupsOrgGroup\n  }\n  ","\n"]);return sG=function(){return e},e}function sW(){var e=(0,v._)(["\n  fragment ReplMultiplayerGroup on ReplMultiplayerGroupScope {\n    group {\n      __typename\n      ...ReplMultiplayerOrgGroup\n    }\n    options {\n      __typename\n      role\n      status\n    }\n  }\n  ","\n"]);return sW=function(){return e},e}function sz(){var e=(0,v._)(["\n  fragment ReplMultiplayerIndividual on ReplMultiplayerIndividualScope {\n    group {\n      __typename\n      ...ReplMultiplayerOrgGroup\n    }\n    user {\n      __typename\n      id\n      displayName\n      image\n      username\n    }\n    options {\n      __typename\n      role\n      status\n    }\n  }\n  ","\n"]);return sz=function(){return e},e}function sH(){var e=(0,v._)(["\n  fragment ReplMultiplayerStatus on Repl {\n    id\n    title\n    isPrivate\n    url\n    org {\n      ...ReplMultiplayerOrg\n    }\n    multiplayerStatus {\n      __typename\n      groups {\n        __typename\n        ...ReplMultiplayerGroup\n      }\n      individuals {\n        __typename\n        ...ReplMultiplayerIndividual\n      }\n    }\n    authorizations {\n      editPermissions {\n        isAuthorized\n        message\n      }\n      editVisibility {\n        isAuthorized\n        message\n      }\n      removeSelf {\n        isAuthorized\n        message\n      }\n      viewPermissions {\n        isAuthorized\n        message\n      }\n    }\n  }\n  ","\n  ","\n  ","\n"]);return sH=function(){return e},e}function sq(){var e=(0,v._)(["\n  query ReplMultiplayerStatus($replId: String!) {\n    getRepl(id: $replId) {\n      __typename\n      ... on Repl {\n        __typename\n        ...ReplMultiplayerStatus\n      }\n    }\n  }\n  ","\n"]);return sq=function(){return e},e}function sK(){var e=(0,v._)(["\n  mutation UpdateOrgReplVisibility($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        ...ReplMultiplayerStatus\n      }\n    }\n  }\n  ","\n"]);return sK=function(){return e},e}var s$={},sQ=(0,x.gql)(sN(),sB.OrgMetadataFragmentDoc),sY=(0,x.gql)(sG(),sU.OrgGroupsOrgGroupFragmentDoc),sJ=(0,x.gql)(sW(),sY),sX=(0,x.gql)(sz(),sY),sZ=(0,x.gql)(sH(),sQ,sJ,sX),s0=(0,x.gql)(sq(),sZ),s1=(0,x.gql)(sK(),sZ),s2=e.i(766774),s4=e.i(813479),s8=e.i(306694),s3=e.i(967667),s6=e.i(479420),s9=e.i(714165),s5=e.i(396776),s7=e.i(576073),le=e.i(987154),ln=e.i(626729),lt=(0,eI.cssRecord)({section:[eT.rcss.colWithGap(12),eT.rcss.px(12)],sectionWithBorders:[eT.rcss.colWithGap(12),eT.rcss.p(12),eT.rcss.border({direction:"top"}),eT.rcss.border({direction:"bottom"}),{"&:last-of-type":{borderBottom:0,paddingBottom:0}}],sectionTitle:[eT.rcss.fontWeight.medium],subtitle:[eT.rcss.fontWeight.medium],item:[eT.rcss.rowWithGap(16),eT.rcss.align.center,eT.rcss.justify.spaceBetween],groupName:[eT.rcss.colWithGap(6),eT.rcss.justify.center],visibilitySelector:[eT.rcss.position.relative,eT.rcss.justify.start,eT.rcss.align.center]}),lr=function(e){var n,t,r,i,o,a,s,l,u,c,d,p=e.replId,f=(0,eB.useCurrentUserId)(),h=(0,q.default)(),v=(n={variables:{replId:p}},t=(0,m._)({},s$,n),y.useQuery(s0,t)),x=v.data,b=v.loading,w=v.error,j=v.refetch,_=(null==x||null==(r=x.getRepl)?void 0:r.__typename)==="Repl"?x.getRepl:void 0,S=(null!=(u=null==_||null==(i=_.multiplayerStatus)?void 0:i.groups)?u:[]).filter(function(e){return"custom"!==e.group.type}),C=(null!=(c=null==_||null==(o=_.multiplayerStatus)?void 0:o.groups)?c:[]).filter(function(e){return"custom"===e.group.type}),k=null!=(d=null==_||null==(a=_.multiplayerStatus)?void 0:a.individuals)?d:[],I=S.map(function(e){return e.group}).concat(C.map(function(e){return e.group})).concat(k.map(function(e){return e.group})),T=function(){return(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:return[4,j()];case 1:return e.sent(),[2]}})})()};return(null==w?void 0:w.message)?(0,g.jsx)(A.View,{gap:12,children:(0,g.jsx)(s5.StatusBanner,{colorway:"negative",text:w.message})}):b||!_?(0,g.jsx)(A.View,{px:12,align:"center",justify:"center",children:(0,g.jsx)(oL.default,{})}):(0,g.jsxs)(A.View,{gap:12,children:[(0,g.jsxs)(A.View,{tag:"header",px:12,gap:2,children:[(0,g.jsx)(ez.Text,{variant:"subheadDefault",children:"Share App"}),(0,g.jsxs)(A.View,{css:lt.subtitle,row:!0,gap:4,children:[_.org?(0,g.jsxs)(ez.Text,{variant:"small",color:"dimmer",children:[_.org.name," /"]}):null,(0,g.jsx)(ez.Text,{variant:"small",children:_.title})]})]}),(null==(s=_.org)?void 0:s.id)&&_.authorizations.editPermissions.isAuthorized?(0,g.jsx)(A.View,{css:lt.sectionWithBorders,children:(0,g.jsx)(la,{orgId:_.org.id,selectedGroups:I,repl:_,onScopeChange:T})}):null,(0,g.jsxs)(A.View,{css:lt.section,children:[(0,g.jsx)(ez.Text,{variant:"small",css:lt.sectionTitle,children:"Roles with access"}),(0,g.jsx)(A.View,{gap:12,children:S.map(function(e){var n=e.group,t=e.options;return(0,g.jsx)(lo,{repl:_,group:n,options:t,onScopeChange:T},n.id)})}),C.length>0?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(ez.Text,{variant:"small",css:lt.sectionTitle,children:"Groups with access"}),(0,g.jsx)(A.View,{gap:12,children:C.map(function(e){var n=e.group,t=e.options;return(0,g.jsx)(lo,{repl:_,group:n,options:t,onScopeChange:T},n.id)})})]}):null]}),k.length>0?(0,g.jsxs)(A.View,{css:lt.section,children:[(0,g.jsx)(ez.Text,{variant:"small",css:lt.sectionTitle,children:"People with access"}),k.map(function(e){var n=e.group,t=e.user,r=e.options;return(0,g.jsx)(li,{currentUserId:f,repl:_,group:n,user:t,options:r,onScopeChange:T},t.id)})]}):null,(0,g.jsx)(A.View,{css:lt.section,children:(0,g.jsx)(s3.OrgPermissionsInfoBanner,{type:"repl"})}),(null==(l=_.org)?void 0:l.id)?(0,g.jsx)(A.View,{css:lt.sectionWithBorders,children:(0,g.jsxs)(A.View,{row:!0,justify:"space-between",children:[(0,g.jsx)(ls,{repl:_,org:_.org}),h?null:(0,g.jsx)(a5.ButtonLink,(0,e9._)((0,m._)({prefetch:!1},(0,sa.replViewLinkProps)(_)),{iconRight:(0,g.jsx)(rY.default,{}),variant:"outlined",text:"Cover page",target:"_blank",style:{pointerEvents:"auto"}}))]})}):null]})},li=function(e){var n=e.user,t=e.currentUserId,r=e.repl,i=e.group,o=e.options,a=e.onScopeChange,s=t===n.id;return(0,g.jsxs)(A.View,{css:lt.item,children:[(0,g.jsxs)(A.View,{row:!0,gap:8,children:[(0,g.jsx)(s9.Avatar,{src:n.image,username:n.username,fullName:n.displayName,size:24}),(0,g.jsxs)(A.View,{css:lt.groupName,children:[(0,g.jsxs)(A.View,{row:!0,gap:8,children:[(0,g.jsx)(ez.Text,{height:"singleLine",children:n.username}),s?(0,g.jsx)(ez.Text,{height:"singleLine",color:"dimmest",children:"(You)"}):null]}),n.username!==n.displayName?(0,g.jsx)(ez.Text,{variant:"small",color:"dimmest",height:"singleLine",children:n.displayName}):null]})]}),(0,g.jsx)(A.View,{children:(0,g.jsx)(s6.default,{repl:r,group:i,options:o,onScopeChange:a})})]})},lo=function(e){var n=e.repl,t=e.group,r=e.options,i=e.onScopeChange;return(0,g.jsxs)(A.View,{css:lt.item,children:[(0,g.jsxs)(A.View,{row:!0,gap:8,children:[(0,g.jsx)(s4.default,{group:t}),(0,g.jsxs)(A.View,{css:lt.groupName,children:[(0,g.jsx)(ez.Text,{height:"singleLine",children:t.name}),(0,g.jsxs)(A.View,{row:!0,gap:8,children:[t.isMember?(0,g.jsx)(ez.Text,{variant:"small",color:"dimmest",height:"singleLine",children:"(you)"}):null,null!=t.memberCount?(0,g.jsx)(ez.Text,{variant:"small",color:"dimmest",height:"singleLine",children:(0,iV.default)("member",t.memberCount,!0)}):null]})]})]}),(0,g.jsx)(A.View,{children:(0,g.jsx)(s6.default,{repl:n,group:t,options:r,onScopeChange:i})})]})},la=function(e){var n,t,r,i,o,a,s,l=e.orgId,u=e.selectedGroups,c=e.repl,d=e.onScopeChange,p="group-search-".concat((0,B.useId)()),f=(0,U._)((0,B.useState)(),2),h=f[0],m=f[1],v=(0,U._)((0,B.useState)(""),2),x=v[0],y=v[1],b=(0,U._)((0,s2.useOrgGroupReplScopeOptionsLazyQuery)(),2),w=b[0],j=b[1],_=j.data,S=j.error,C=j.loading,k=_&&(null==(t=_.currentUser)||null==(n=t.org)?void 0:n.__typename)==="Org"&&"OrgGroup"===_.currentUser.org.group.__typename&&(null==(r=_.currentUser.org.group.replScopeOptions)?void 0:r.__typename)==="OrgGroupReplScopeOptions"?_.currentUser.org.group.replScopeOptions.items[0].options:void 0,I=(null==_?void 0:_.currentUser)&&"Org"!==_.currentUser.org.__typename?_.currentUser.org.message:void 0,T=(null==_?void 0:_.currentUser)&&"Org"===_.currentUser.org.__typename&&"OrgGroup"!==_.currentUser.org.group.__typename?_.currentUser.org.group.message:void 0,R=(null==_?void 0:_.currentUser)&&"Org"===_.currentUser.org.__typename&&"OrgGroup"===_.currentUser.org.group.__typename&&(null==(i=_.currentUser.org.group.replScopeOptions)?void 0:i.__typename)!=="OrgGroupReplScopeOptions"?null==(o=_.currentUser.org.group.replScopeOptions)?void 0:o.message:void 0,P=null!=(s=null!=(a=null!=I?I:T)?a:R)?s:null==S?void 0:S.message;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(A.View,{row:!0,gap:8,children:[(0,g.jsx)(A.View,{grow:!0,shrink:!0,children:(0,g.jsx)(s8.default,{inputId:p,orgId:l,types:[rq.OrgGroupType.Custom,rq.OrgGroupType.SystemIndividual],selectedGroups:u,value:x,setValue:y,onSelect:function(e){m(e),y(e.name),w({variables:{orgId:l,groupId:e.id,input:{replIds:[c.id]}}})},onClear:function(){return m(void 0)},placeholder:"Share with groups or other members"})}),h&&k||C?(0,g.jsxs)(A.View,{pl:24,row:!0,align:"center",children:[h&&k&&!C?(0,g.jsx)(s6.default,{group:h,repl:c,options:k,onScopeChange:function(){return(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:return[4,d()];case 1:return e.sent(),y(""),m(void 0),[2]}})})()}}):null,C?(0,g.jsx)(oL.default,{size:24}):null]}):null]}),P?(0,g.jsx)(s5.StatusBanner,{colorway:"negative",text:P}):null]})},ls=function(e){var n,t,r,i=e.repl,o=e.org,a=(0,U._)((0,B.useState)(),2),s=a[0],l=a[1],u=(0,U._)((0,B.useState)(),2),c=u[0],d=u[1],p=(0,U._)((n={variables:{input:{id:i.id}},onError:function(e){d(e.message)}},t=(0,m._)({},s$,n),sL.useMutation(s1,t)),2),f=p[0],h=p[1].loading,v="repl-visibility-".concat((0,B.useId)()),x=i.authorizations.editVisibility.isAuthorized,y=i.authorizations.editVisibility.message,b=[{id:"private",icon:(0,g.jsx)(ln.default,{}),name:"Internal to ".concat(o.name),selected:i.isPrivate,description:"Only selected organization members can view or edit."},{id:"public",icon:(0,g.jsx)(le.default,{}),name:"Public on Replit",selected:!i.isPrivate,description:"Anyone on Replit can see or fork. You choose who can edit."}],w=b.find(function(e){return e.selected}),j=w?(0,g.jsxs)(A.View,{row:!0,gap:8,align:"center",children:[w.icon," ",w.name]}):void 0;return r=c?(0,g.jsx)(o5.Tooltip,{tooltip:c,children:(0,g.jsx)(av.default,{size:24,color:R.tokens.accentNegativeDefault})}):h?(0,g.jsx)(oL.default,{size:24}):s?(0,g.jsx)(ss.default,{size:24,color:R.tokens.accentPositiveDefault}):null,(0,g.jsxs)(A.View,{css:lt.visibilitySelector,grow:!0,shrink:!0,row:!0,gap:4,children:[(0,g.jsx)(o5.Tooltip,{tooltip:y,isDisabled:x,children:(0,g.jsx)(st.PopupMenu,{id:v,trigger:(0,g.jsx)(eW.Button,{iconRight:(0,g.jsx)(s7.default,{}),text:null!=j?j:"Control Repl visibility",disabled:!x}),"aria-label":"Control ".concat(i.title," visibility"),onAction:function(e){var n="private"===e;n!==i.isPrivate&&(d(void 0),f({variables:{input:{id:i.id,isPrivate:n}},optimisticResponse:{__typename:"RootMutationType",updateRepl:{__typename:"UpdateReplPayload",repl:(0,e9._)((0,m._)({},i),{isPrivate:n})}},onCompleted:function(e){"UpdateReplPayload"===e.updateRepl.__typename&&(l(!0),setTimeout(function(){return l(!1)},2e3))}}))},items:b,disallowEmptySelection:!0,isDisabled:!x,children:function(e){return(0,g.jsx)(st.MenuItem,{id:e.id,label:e.name,description:e.description,icon:e.icon},e.id)}})}),r?(0,g.jsx)(A.View,{children:r}):null]})},ll=e.i(84466),lu=e.i(635925);function lc(){var e=(0,v._)(["\n  query TeamMultiplayerManagerMultiplayers($replId: String!) {\n    currentUser {\n      id\n    }\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        isOwner\n        collaborators {\n          type\n          permission\n          user {\n            ...MultiplayerUser\n          }\n        }\n        authorizations {\n          editPermissions {\n            isAuthorized\n          }\n          inviteGuests {\n            isAuthorized\n          }\n        }\n        multiplayerInvites {\n          email\n          type\n        }\n        owner {\n          ... on User {\n            id\n          }\n          ... on Team {\n            id\n            username\n            displayName\n            capabilities {\n              isBusinessPlan\n              hasValidSubscription\n              availableSeats\n            }\n            members {\n              id\n              permissions\n              user {\n                id\n                ...MultiplayerUser\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return lc=function(){return e},e}var ld={},lp=(0,x.gql)(lc(),lu.MultiplayerUserFragmentDoc),lf=e.i(204070),lg=(0,eI.cssRecord)({root:[eT.rcss.color.foregroundDefault,eT.rcss.p(24),eT.rcss.display.grid,{gap:R.tokens.space24}],controls:[eT.rcss.display.grid,{gap:R.tokens.space8,gridAutoFlow:"column"}],message:[eT.rcss.pb(16)],textContainer:[eT.rcss.textAlign.center]});function lh(e){var n=e.email,t=e.onInvite,r=e.onCancel;return(0,g.jsxs)("div",{css:lg.root,children:[(0,g.jsx)(ez.Header,{level:3,textAlign:"center",variant:"subheadBig",children:"Are you sure?"}),(0,g.jsx)("div",{css:lg.textContainer,children:(0,g.jsxs)(ez.Text,{variant:"text",children:[(0,g.jsx)("p",{css:lg.message,children:"Adding an external user as a guest to this repl will give the user read and write access. Please confirm the below email address before inviting the user as a guest."}),(0,g.jsx)("p",{children:n})]})}),(0,g.jsxs)("div",{css:lg.controls,children:[(0,g.jsx)(eW.Button,{onClick:r,text:"Cancel"}),(0,g.jsx)(eW.Button,{colorway:"primary",onClick:t,text:"Invite"})]})]})}var lm=e.i(802482),lv=e.i(613349),lx=e.i(552144),ly=e.i(652219);function lb(e){var n,t,r,i,o,a,s,l,u,c,d,p,f=e.replId,v=(0,h.useRouter)(),x=(0,Q.isInBonsaiWebview)(v),b=(0,au.useActiveUsers)(),w=(0,U._)((0,B.useState)(null),2),j=w[0],_=w[1],S=(n={variables:{replId:f}},t=(0,m._)({},ld,n),y.useQuery(lp,t)),C=S.data,k=S.loading,I=(null==C||null==(r=C.currentUser)?void 0:r.id)||null,T=(null==C?void 0:C.getRepl.__typename)==="Repl"?C.getRepl:null,P=(0,lf.default)({isMobileApp:x,isTeam:!0,replId:f}),D=P.addOrInviteReplMultiplayer,V=P.loadingAddMutation;if(T&&!T.owner)throw Error("Cannot manage members on anon repls");if((null==T?void 0:T.owner)&&(null==T?void 0:T.owner.__typename)!=="Team")throw Error("Expect repl owned by a team");var O=(null==T||null==(i=T.owner)?void 0:i.__typename)==="Team"?T.owner:null,F=!(null==O||null==(o=O.capabilities)?void 0:o.hasValidSubscription)&&!(null==O||null==(a=O.capabilities)?void 0:a.isBusinessPlan),M=(null!=(s=null==T?void 0:T.collaborators)?s:[]).reduce(function(e,n){var t=n.user.username;return -1===e.indexOf(t)&&e.push(),e},[]),L=null==T?void 0:T.multiplayerInvites,N=(null!=(l=null==T?void 0:T.collaborators)?l:[]).filter(function(e){return"guest"===e.type}).map(function(e){return e.user}),G=N.length,W=(null!=(u=null==T?void 0:T.collaborators)?u:[]).filter(function(e){return"member"===e.type}).map(function(e){return e.user}),z=(null!=(c=null==T?void 0:T.collaborators)?c:[]).filter(function(e){return"admin"===e.type}).map(function(e){return e.user}),H=z.some(function(e){return e.id===I}),q=W.filter(function(e){return b.some(function(n){return n.id===e.id})}),K=W.filter(function(e){return!b.some(function(n){return n.id===e.id})}),$=null!=(d=null==T?void 0:T.authorizations.editPermissions.isAuthorized)&&d,Y=null!=(p=null==T?void 0:T.authorizations.inviteGuests.isAuthorized)&&p;return k?(0,g.jsx)(E.Surface,{css:[sM.MultiplayerControlCSS.root],background:"default",children:(0,g.jsxs)(A.View,{css:sM.MultiplayerControlCSS.loading,children:[(0,g.jsx)(oL.default,{color:R.tokens.foregroundDimmer}),(0,g.jsx)(ez.Text,{color:"dimmer",multiline:!1,children:"Loading..."})]})}):(0,g.jsxs)(E.Surface,{css:sM.MultiplayerControlCSS.root,background:"default",children:[(0,g.jsx)(A.View,{css:[sM.MultiplayerControlCSS.header,x&&sM.MultiplayerControlCSS.header_mobile],children:(0,g.jsx)(A.View,{css:sM.MultiplayerControlCSS.titleContainer,children:(0,g.jsx)(ez.Text,{variant:"subheadDefault",multiline:!1,children:"Team Multiplayers"})})}),Y?(0,g.jsx)(A.View,{css:sM.MultiplayerControlCSS.searchContainer,children:(0,g.jsx)(lv.default,{existingUsernames:M,onSubmit:function(e){if(!V){if((0,ll.default)(e))return void _(e);D({variables:{input:{replId:f,target:{method:rq.MultiplayerInviteMethod.Username,value:e},level:rq.ReplPermissionLevel.Rw}}})}},isDisabled:k})}):null,!Y&&F?(0,g.jsx)(A.View,{px:16,children:(0,g.jsx)(lx.StatusBannerButton,{iconLeft:(0,g.jsx)(ly.default,{}),text:'You can add people to this App by inviting them to the "'.concat(null==O?void 0:O.displayName,'" Friends Team.'),href:"/teams/".concat(null==O?void 0:O.username),target:"_blank"})}):null,(0,g.jsx)(eR.Modal,{isOpen:!!j,onRequestClose:function(){return _(null)},children:j?(0,g.jsx)(lh,{email:j,onInvite:function(){D({variables:{input:{replId:f,target:{method:rq.MultiplayerInviteMethod.Email,value:j},level:rq.ReplPermissionLevel.Rw}}}),_(null)},onCancel:function(){return _(null)}}):null}),(0,g.jsxs)(E.Surface,{css:sM.MultiplayerControlCSS.userList,children:[(null==L?void 0:L.length)?(0,g.jsxs)(A.View,{css:sM.MultiplayerControlCSS.userGroup.root,children:[(0,g.jsx)(sM.UserGroupTitle,{title:"Pending Invitations",color:R.tokens.outlineStrongest,count:G}),null==L?void 0:L.map(function(e){return(0,g.jsx)(lm.default,{canEditMultiplayers:H||!1,email:e.email,isPendingInvitation:!0,replId:f},e.email)})]}):null,N.length?(0,g.jsxs)(A.View,{css:sM.MultiplayerControlCSS.userGroup.root,children:[(0,g.jsx)(sM.UserGroupTitle,{title:"External Guests",color:R.tokens.outlineStrongest,count:null==N?void 0:N.length,tooltip:"External Guests are not members of your team and were invited via a Join Link or by username."}),N.map(function(e){return(0,g.jsx)(lm.default,{canEditMultiplayers:H||!1,isPendingInvitation:!1,replId:f,user:e},e.id)})]}):null,q.length?(0,g.jsxs)(A.View,{css:sM.MultiplayerControlCSS.userGroup.root,children:[(0,g.jsx)(sM.UserGroupTitle,{title:"Online Members",color:R.tokens.greenStrongest,count:null==q?void 0:q.length}),q.map(function(e){return(0,g.jsx)(lm.default,{isPendingInvitation:!1,canEditMultiplayers:!!H,replId:f,user:e},e.id)})]}):null,K.length?(0,g.jsxs)(A.View,{css:sM.MultiplayerControlCSS.userGroup.root,children:[(0,g.jsx)(sM.UserGroupTitle,{title:"Offline Members",color:R.tokens.outlineStrongest,count:null==K?void 0:K.length}),K.map(function(e){return(0,g.jsx)(lm.default,{isPendingInvitation:!1,canEditMultiplayers:!!H,replId:f,user:e},e.id)})]}):null,z.length?(0,g.jsxs)(A.View,{css:sM.MultiplayerControlCSS.userGroup.root,children:[(0,g.jsx)(sM.UserGroupTitle,{title:"Admins",color:R.tokens.accentPrimaryStronger,count:z.length}),z.map(function(e){return(0,g.jsx)(lm.default,{canEditMultiplayers:!1,isPendingInvitation:!1,user:e,replId:f},e.id)})]}):null,$||k?null:(0,g.jsx)(ez.Text,{color:"dimmer",variant:"small",multiline:!1,children:"Only admins can add and remove members to multiplayer"})]})]})}var lw=e.i(758386),lj=e.i(841691),l_=function(){var e=(0,lw.useUpsellContext)(),n=e.showPrivateUpsell,t=e.refetch,r=(0,tz.useGlobalModal)().show;return n?(0,g.jsx)(A.View,{px:12,children:(0,g.jsx)(A.View,{tag:"button",css:lS.bannerWrapper,onClick:function(){return(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:return[4,r("MembershipPurchaseModal",{headingText:"Upgrade for private Apps",subHeadingText:"Keep your code secure and private",analyticsContext:{upgrade:{context:"workspace_multiplayer_header"}},onPurchaseComplete:function(){return t()}})];case 1:return e.sent(),[2]}})})()},children:(0,g.jsx)(s5.StatusBanner,{icon:(0,g.jsx)(lj.default,{}),colorway:"yellow",text:"This App is publicly visible. Upgrade for unlimited private Apps, better AI, more storage, speed, and more."})})}):null},lS=(0,eI.cssRecord)({bannerWrapper:[eT.rcss.cursor.pointer,eT.rcss.borderRadius(),eT.rcss.textAlign.left]}),lC=(0,eI.cssRecord)({self:[eT.rcss.borderRadius(8),eT.rcss.align.stretch,eT.rcss.flex.growAndShrink(1),eT.rcss.maxHeight("calc(100vh - ".concat(D.HEADER_HEIGHT+12,"px)")),eT.rcss.backgroundColor.backgroundDefault]});let lk=function(e){var n,t=e.replId,r=e.handleUpgradeTriggered,i=e.isTeamRepl,o=e.org;return n=o?(0,g.jsx)(lr,{replId:t}):i?(0,g.jsx)(lb,{replId:t}):(0,g.jsx)(sM.default,{replId:t,handleUpgradeTriggered:r}),(0,g.jsxs)(A.View,{css:lC.self,py:12,gap:12,children:[n,o&&"personal"!==o.type?null:(0,g.jsx)(l_,{}),o?null:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(a7.DividerH,{}),(0,g.jsx)(sF.default,{replId:t})]})]})};var lI=e.i(781478),lT=e.i(317941);function lR(e){var n,t,r,i=e.users,o=void 0===i?[]:i,a=e.onAvatarClick,s=e.repl,l=(null==(n=s.owner)?void 0:n.__typename)==="Team",u=(0,U._)((0,B.useState)(!1),2),c=u[0],d=u[1];return(0,g.jsxs)(A.View,{row:!0,align:"center",gap:4,children:[o.length?(0,g.jsx)(lP,{users:o,onAvatarClick:a}):null,(0,g.jsxs)(ai.PopoverTrigger,{isOpen:c,onOpenChange:d,label:"Home",placement:"bottom start",children:[(null==(t=s.org)?void 0:t.type)==="team"?(0,g.jsx)(eW.Button,{size:"small",iconLeft:(0,g.jsx)(lI.default,{}),text:"Access"}):(0,g.jsx)(ot.IconButton,{alt:"Invite collaborator",size:28,children:(0,g.jsx)(lI.default,{})}),(0,g.jsx)(A.View,{clsx:lT.default.inviteDialog,children:(0,g.jsx)(lk,{replId:s.id,isTeamRepl:l,org:null!=(r=s.org)?r:void 0,handleUpgradeTriggered:function(){}})})]})]})}function lP(e){var n=e.users,t=e.onAvatarClick,r=n.slice(0,2),i=n.length-2,o=(0,U._)((0,B.useState)(!1),2),a=o[0],s=o[1];return(0,g.jsxs)(A.View,{row:!0,gap:4,children:[r.map(function(e,n){return(0,g.jsx)(lE,{onClick:function(){return t(e)},user:e,stacked:n>0},e.username)}),i>0?(0,g.jsxs)(ai.PopoverTrigger,{isOpen:a,onOpenChange:s,label:"Home",placement:"bottom start",children:[(0,g.jsx)(eW.Button,{size:"small",text:"+".concat(i),clsx:[lT.default.stacked,lT.default.remainingCountButton]}),(0,g.jsxs)(st.Menu,{children:[(0,g.jsx)(st.MenuHeader,{text:"Observe..."}),n.slice(2).map(function(e){return(0,g.jsx)(st.MenuItem,{onAction:function(){return t(e)},icon:(0,g.jsx)(s9.Avatar,{size:24,src:e.image||null,username:e.username,ringColor:e.color}),label:e.username},e.username)})]})]}):null]})}function lE(e){var n=e.user,t=e.stacked,r=e.onClick;return(0,g.jsx)(ot.IconButton,{alt:"Observe ".concat(n.username),onClick:r,clsx:[lT.default.avatar,(0,I._)({},lT.default.stacked,t)],children:(0,g.jsx)(s9.Avatar,{size:24,src:n.image||null,username:n.username,ringColor:n.color})})}var lA=e.i(625251),lD=e.i(183462),lV=e.i(987143),lO=e.i(825516);function lF(){var e=(0,v._)(["\n  fragment WorkspaceHeaderNavMenuRepl on Repl {\n    id\n    org {\n      id\n      slug\n    }\n    ...ReplEnvironmentHeaderInviteButtonRepl\n  }\n  ","\n"]);return lF=function(){return e},e}function lM(){var e=(0,v._)(["\n  fragment WorkspaceHeaderNavMenuCurrentUser on CurrentUser {\n    id\n    isMemberOfAnyOrg\n    image\n    username\n    ...UserLinkCurrentUser\n    ...OrgSwitcherCurrentUser\n  }\n  ","\n  ","\n"]);return lM=function(){return e},e}function lL(){var e=(0,v._)(["\n  query WorkspaceHeaderNavMenu($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        ...WorkspaceHeaderNavMenuRepl\n      }\n    }\n    currentUser {\n      ...WorkspaceHeaderNavMenuCurrentUser\n    }\n  }\n  ","\n  ","\n"]);return lL=function(){return e},e}var lU={},lB=(0,x.gql)(lF(),lO.ReplEnvironmentHeaderInviteButtonReplFragmentDoc),lN=(0,x.gql)(lM(),lV.UserLinkCurrentUserFragmentDoc,lD.OrgSwitcherCurrentUserFragmentDoc),lG=(0,x.gql)(lL(),lB,lN),lW=e.i(641555),lz=e.i(548733),lH=e.i(927196),lq=e.i(845411),lK=e.i(805518),l$=e.i(935267),lQ=e.i(429878),lY=e.i(266899),lJ=e.i(273929),lX=e.i(495764),lZ=e.i(531603),l0=e.i(371816),l1=e.i(995045),l2=e.i(344718),l4=e.i(841412),l8=e.i(988072),l3=e.i(346606),l6=e.i(144459),l9=e.i(384132);function l5(e){var n,t,r,i=(0,U._)((0,B.useState)(null),2),o=i[0],a=i[1],s=(0,l$.default)().count,l=(0,aw.useGetAgentFreeUsage)({skip:!e.showUpsell}).refetch,u=(0,aj.useGetCloudFreeUsage)({skip:!e.showUpsell}).refetch,c=(0,Q.useIsInBonsaiWebview)(),d=(0,Q.useDoesBonsaiSupportFeature)("simplifiedTabletUI"),p=c&&d,f=(n={variables:{replId:e.replId},skip:p},t=(0,m._)({},lU,n),y.useQuery(lG,t)).data,h=(null==f?void 0:f.getRepl.__typename)==="Repl"?f.getRepl:null,v=null==f?void 0:f.currentUser,x=function(e){var n,t,r,i,o,a,s,l={ssr:!1,fetchPolicy:"cache-and-network",nextFetchPolicy:"cache-first"},u=lX.RECENT_REPLS_SIDEBAR_MENU_COUNT,c=(0,lY.useSidebarRecentReplsQuery)((0,m._)({variables:{count:u},skip:null===e||!!(null==(n=e.org)?void 0:n.id)},l)),d=(0,lY.useSidebarRecentOrgReplsQuery)((0,m._)({variables:{count:u,orgId:null==e||null==(t=e.org)?void 0:t.id},skip:null==e||!(null==e||null==(r=e.org)?void 0:r.id)},l));if(!e)return null;var p=[];return((null==(a=d.data)||null==(o=a.currentUser)||null==(i=o.org)?void 0:i.__typename)==="Org"?p=d.data.currentUser.org.recentRepls.items:(null==(s=c.data)?void 0:s.allRecentRepls)&&(p=c.data.allRecentRepls),(p=p.filter(function(n){return n.id!==e.id}).slice(0,lJ.RECENT_REPLS_DISPLAY_COUNT)).length)?p:null}(h);if(p)return(0,g.jsx)(A.View,{clsx:l9.default.emptySpacer});var b=null==h||null==(r=h.org)?void 0:r.slug,w=b?(0,a3.orgLinks)({slug:b}).home:{href:"/home",as:"/~"};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(lH.AgentStatusProvider,{children:(0,g.jsx)(V.NavMenu,{onOpenChange:function(n){n&&e.showUpsell&&(l(),u())},children:v&&h?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(st.Menu,{"aria-label":"Navigation menu",clsx:l9.default.menu,children:[(0,g.jsx)(st.MenuItem,{icon:(0,g.jsx)(ln.default,{}),label:"Home",href:w.href,as:w.as}),x?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(un,{repls:x}),(0,g.jsx)(st.Separator,{})]}):null,v?(0,g.jsx)(l0.AccountItems,{setActiveModal:function(e){return a({type:e})},currentUser:v,notificationCount:s}):null,(null==v?void 0:v.isMemberOfAnyOrg)?(0,g.jsx)(l8.TeamsItem,{currentUser:v}):null,(0,g.jsx)(l3.ThemeItem,{}),(0,g.jsx)(l2.HelpItem,{setActiveModal:function(e){return a({type:e})},children:(0,g.jsx)(ur,{setActiveModal:a})}),v?(0,g.jsx)(l1.DevCopyUsernameItem,{currentUser:v}):null,(0,g.jsx)(st.Separator,{}),(0,g.jsx)(l4.LogoutItem,{})]}),e.showUpsell?(0,g.jsx)(A.View,{pb:10,children:(0,g.jsx)(ue,{})}):null]}):(0,g.jsx)(oL.default,{})})}),(0,g.jsxs)(eR.Modal,{isOpen:null!==o,onRequestClose:function(){return a(null)},children:[(null==o?void 0:o.type)==="support"?(0,g.jsx)(lZ.default,{onRequestClose:function(){return a(null)}}):null,(null==o?void 0:o.type)==="notifications"?(0,g.jsx)(l7,{}):null,(null==o?void 0:o.type)==="referral"?(0,g.jsx)(lz.ReferralLinkModalContent,{trackingContext:"workspace-nav-menu"}):null,(null==o?void 0:o.type)==="feedback"?(0,g.jsx)(lQ.AIFeedback,{session:o.session,onClose:function(){return a(null)}}):null]})]})}function l7(){return(0,g.jsxs)(A.View,{gap:12,children:[(0,g.jsx)(ez.Text,{variant:"subheadDefault",children:"Notifications"}),(0,g.jsx)(lK.default,{count:10,loadMore:!0,markAsSeen:!0})]})}function ue(){var e=(0,al.useIsFreemiumStarterPlanUsersOwnRepl)().isFreemiumStarterPlanUsersOwnRepl,n=(0,aw.useGetAgentFreeUsage)(),t=n.agentUsage,r=n.agentUsageV2,i=(0,aj.useGetCloudFreeUsage)().cloudUsage;return e?(0,g.jsx)(A.View,{gap:8,px:8,pt:12,clsx:l9.default.usage,children:(0,g.jsx)(ab,{agentLimit:r?r.limit:null==t?void 0:t.limit,agentUsage:r?r.usage:null==t?void 0:t.usage,cloudLimit:null==i?void 0:i.limit,cloudUsage:null==i?void 0:i.usage,agentNextCreditsAt:null==r?void 0:r.nextCreditsAt,cloudNextCreditsAt:null==i?void 0:i.nextCreditsAt,isUnderMonthlyQuota:null==r?void 0:r.isUnderMonthlyQuota})}):null}function un(e){var n=e.repls;return(0,g.jsxs)(lA.MenuSection,{children:[(0,g.jsx)(st.MenuHeader,{text:"Recent"}),n.map(function(e){return(0,g.jsx)(ut,{repl:e},e.id)})]})}function ut(e){var n=e.repl,t=(0,rO.useObservable)((0,lq.useReplAgentStatus)(n));return(0,g.jsxs)(st.BaseMenuItem,(0,e9._)((0,m._)({textValue:n.title,clsx:l9.default.repl},(0,sa.replLinkProps)(n)),{children:[(0,g.jsxs)(A.View,{align:"center",row:!0,gap:6,grow:!0,shrink:!0,pl:0,children:[(0,g.jsx)(t7.default,{size:20,alt:n.title,iconUrl:n.iconUrl}),(0,g.jsx)(ez.Text,{translate:"no",children:n.title})]}),t&&"Paused"!==t.label?(0,g.jsx)(ez.Text,{variant:"small",color:"dimmer",children:t.label}):null]}),n.id)}function ur(e){var n=(0,al.useIsFreemiumStarterPlanUsersOwnRepl)().isFreemiumStarterPlanUsersOwnRepl,t=(0,G.useSupportsAgent)(),r=(0,oE.useChatter)(),i=(0,lW.useObservableMemo)(function(){return t?r.sessions.agent.current:r.sessions.chat.open.latest},[r,t]);return!i||n?null:(0,g.jsx)(st.MenuItem,{icon:(0,g.jsx)(l6.default,{}),label:"Submit feedback",onAction:function(){return e.setActiveModal({type:"feedback",session:i})}})}e.i(242933);var ui=e.i(424360),uo=e.i(279606);function ua(e){var n=(0,es.useCornerPaneHeaderWidths)(),t=(0,es.useHeaderInset)(),r=(0,es.useSidebarWidths)();return(0,B.useMemo)(function(){var i,o,a;return i={headerWidth:uo.Observable.from(t).select(function(n){return n[e]}),tabHeaderWidth:n.select(function(n){return n[e]}),sidebarWidth:uo.Observable.from(r).select(function(n){return n[e]})},o=null,a=null,new ui.Multicast(function(e){return uo.Observable.combine(i.headerWidth,i.tabHeaderWidth,i.sidebarWidth).subscribe(function(n){var t=(0,U._)(n,3),r=t[0],i=t[1],s=t[2];if(null!==r){var l=null===a?null:a-r+10;if(null!==a&&s>a){"large"!==o&&(o="large",e.next("large"));return}if(i<=200&&"small"!==o){o="small",a=r,e.next("small");return}i>200&&"large"!==o&&(null===l||i>200+l)&&(o="large",e.next("large"))}})})},[n,t,r,e])}var us=e.i(782514),ul=e.i(292642),uu=e.i(342571),uc=(0,R.cvarsFrom)("index.module.css",["--z-index","--height"]);function ud(e){var n=(0,es.useSetHeaderInset)(),t=(0,q.default)();return(0,o$.default)(function(r){t||n(e,r.width)})}function up(){var e;return e={},(0,I._)(e,uc.zIndex,ie.zIndexLevels.tiledPane.toString()),(0,I._)(e,uc.height,D.APP_HEADER_HEIGHT+"px"),e}function uf(e){var n=e.repl,t=(0,es.useIsAgentCentered)(),r=(0,q.default)();return(0,g.jsxs)(us.TrackingHierarchyProvider,{hierarchy:{surface:"workspace_header"},children:[r?(0,g.jsx)(A.View,{clsx:uu.default.desktopDragRegion}):null,(0,g.jsx)(ug,{repl:n}),(0,g.jsx)(um,{repl:n}),t?(0,g.jsx)(uv,{repl:n}):null]})}function ug(e){var n=e.repl,t=(0,es.useAgentLayout)(),r=(0,ix.default)(t.agentFiletreeOrder),i=up(),o=(0,es.useGetLayoutState)(),a=ud("left"),s=(0,rO.useObservable)(ua("left")),l=(0,as.useIsAgentWebDesignMockup)().isWebDesignMockup,u=(0,oE.useChatter)(),c=(0,rO.useObservable)(u.sessions.agent.current),d=(0,K.useFlag)({controlName:"flag-hide-run-button-design-mode",default:!1});return(0,g.jsx)(A.View,{row:!0,align:"center",innerRef:a,style:i,clsx:uu.default.left,children:(0,g.jsxs)(A.View,{px:6,row:!0,align:"center",children:[(0,g.jsx)(T.default,{}),"agent-filetree"!==r?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(sA,{}),(0,g.jsx)(sO,{})]}):(0,g.jsx)(oo,{}),(0,g.jsx)(l5,{replId:n.id,showUpsell:"small"===s}),(0,g.jsx)(sg,{hideTitle:"small"===s,repl:n}),(0,g.jsxs)(A.View,{row:!0,gap:4,align:"center",children:[(0,g.jsx)(aa,{repl:n,getDesktopLayoutState:o,hideTitle:"small"===s}),l?(0,g.jsx)(oJ.DesignMockupPill,{session:c}):null,l&&d?null:(0,g.jsx)(sT,{}),"small"===s?null:(0,g.jsx)(uh,{replUrl:n.url})]})]})})}function uh(e){var n=e.replUrl;return(0,al.useIsFreemiumStarterPlanUsersOwnRepl)().isFreemiumStarterPlanUsersOwnRepl?(0,g.jsxs)(A.View,{row:!0,gap:4,align:"center",children:[(0,g.jsx)(aC,{}),(0,g.jsx)(oY.default,{text:"Upgrade",context:"agent_freemium_quota_v2",colorway:"primary",variant:"default",size:"small",redirectPath:n,modalHeadingText:"Compare Replit plans",modalSubHeadingText:"Autonomy for all. Choose the best plan for you."})]}):null}function um(e){var n,t,r,i,o,a,s,l=e.repl,u=ud("right"),c=up(),d=(0,es.useAgentLayout)(),p=(0,ix.default)(d.agentFiletreeOrder),f=(0,rO.useObservable)(ua("right")),h=l.authorizations.viewPermissions.isAuthorized,m=null==(a=l.authorizations)||null==(o=a.viewDeploymentConfig)?void 0:o.isAuthorized,v=(null==(s=l.hostingDeployment)?void 0:s.__typename)==="HostingDeployment"?l.hostingDeployment:null,x=(0,oX.useIsAgentStackRepl)().isAgentStackRepl,y=(null==v?void 0:v.replitAppSubdomain)?"https://".concat(v.replitAppSubdomain,".replit.app"):null,b=(null==v?void 0:v.latestBuildStatus)==="running"||(null==v?void 0:v.latestBuildStatus)==="success",w=(0,au.useActiveUsers)(),j=(n=(0,es.useOpenFile)(),t=(0,e2.default)().presence,r=(0,ef.useGetActiveFile)(),i=(0,eK.default)(n),(0,B.useCallback)(function(e){var n=e.username,o=e.id,a=t.getFollowedUser();if((null==a?void 0:a.username)===n)return void t.unfollowUser();t.followUser(n);var s=t.getActiveFileForUser(o),l=r();s&&s!==l&&i.current({path:s})},[i,r,t])),_=(0,e$.default)().showConfirm,S=(0,q.default)(),C=(0,oQ.useIsWindows)();return(0,g.jsx)(A.View,{row:!0,align:"center",style:c,clsx:uu.default.right,innerRef:u,children:(0,g.jsxs)(A.View,{px:6,row:!0,gap:4,align:"center",clsx:(0,I._)({},uu.default.desktopAppWindowsOs,C&&S),children:[(0,g.jsx)(ak,{}),h?(0,g.jsx)(lR,{repl:l,users:w,onAvatarClick:j}):null,m&&!x&&y&&b?(0,g.jsx)(eW.Button,{size:"small",text:"Share",iconLeft:(0,g.jsx)(ul.default,{}),colorway:"primary",onClick:function(){(0,tW.default)(y),_("App link copied to clipboard!")}}):null,m?(0,g.jsx)(aJ,{iconOnly:"small"===f,isDesignMode:!!l.config.isWebDesignMockup}):null,"agent-filetree"===p?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(sO,{}),(0,g.jsx)(sA,{flipped:!0})]}):(0,g.jsx)(oo,{})]})})}function uv(e){var n=e.repl,t=up();(0,es.useTransitionToAgentPresentation)();var r=(0,K.useFlag)({controlName:"flag-agent-debug-info-button"});return(0,g.jsxs)(E.Surface,{row:!0,clsx:uu.default.planningHeader,justify:"space-between",align:"center",px:6,style:t,children:[(0,g.jsxs)(A.View,{row:!0,align:"center",clsx:uu.default.planningHeaderLeft,children:[(0,g.jsx)(T.default,{}),(0,g.jsx)(l5,{showUpsell:!1,replId:n.id}),(0,g.jsx)(ez.Text,{translate:"no",children:n.title})]}),(0,g.jsx)(A.View,{align:"center",justify:"center",clsx:uu.default.planningTimeline,children:(0,g.jsx)(oZ.PlanningTimeline,{onBuildClick:void 0})}),r?(0,g.jsx)(ux,{}):null]})}function ux(){var e=(0,oE.useChatter)(),n=(0,rO.useObservable)(e.sessions.agent.current);return n?(0,g.jsx)(o0.AiSessionDebugInfoButton,{sessionId:n.id,sessionType:oP.SessionType.AGENT_SESSION}):null}var uy=e.i(14146),ub=e.i(71998),uw=e.i(906910),uj=e.i(502108),u_=e.i(848415);e.i(312917);var uS=e.i(675186),uC=e.i(387491);function uk(e,n){var t=(0,eK.default)(n);return(0,B.useMemo)(function(){var n,r;return n="current"in e?new ui.Multicast(function(n){return n.next(e.current),e.subscribe(function(e){return n.next(e)})}):e,r=function(){return t.current()},new ui.Multicast(function(e){var t=null,i=null,o=null,a=null,s=n.subscribe(function(n){null==t||t.stop(),i&&(clearTimeout(i),i=null);var s=r();if(!s&&a&&(s=a),!1===s){o=n,e.next(n);return}a=s;var l=!0===s?{}:s,u=l.snappiness,c=void 0===u?400:u,d=l.ramp,p=l.delay,f=void 0===p?0:p,g=0,h={};for(var v in n)h[v]=o&&v in o?o[v]:n[v];t=new uS.AnimationLoop(function(t,r){for(var i in g+=t,n){if("number"!=typeof h[i]||"number"!=typeof n[i]){h[i]=n[i];continue}var s=h[i],l=n[i],u=s>=0&&s<=1&&l>=0&&l<=1?.001:void 0;h[i]=(0,uC.damp)({current:s,target:l,elapsed:g,delta:t,snappiness:c,ramp:d,minStepSize:u})}e.next((0,m._)({},h)),(0,eQ.default)(h,n)&&(a=null,o=n,r())}),f>0?i=setTimeout(function(){i=null,null==t||t.start()},f):t.start()});return function(){null==t||t.stop(),i&&clearTimeout(i),s()}})},[e,t])}var uI=e.i(869226),uT=e.i(696896),uR=e.i(802088),uP=e.i(516351),uE=e.i(375032),uA=(0,R.cvarsFrom)("Border.module.css",["--header-height","--border-color","--box-shadow","--y-offset"]);let uD=(0,B.memo)(function(e){var n,t=e.paneId,r=(0,iu._)(e,["paneId"]),i=(0,es.usePaneView)(t),o=(0,ix.default)(i.paneType),a=(0,ix.default)(i.border),s=(0,ix.default)(i.isMaximized),l=(0,uP.default)(),u=R.tokens.outlineDefault,c="none",d=0,p=0;switch(a){case"dragging":case"floating":u=R.tokens.outlineDefault,c=R.tokens.shadow2,d=r.headerHeight,p=6}var f=(0,es.useIsActivePane)({paneId:t});l&&f&&(u=l.color,c="0 0 0 3px ".concat(l.color));var h=(0,U._)((0,B.useState)(!1),2),m=h[0],v=h[1];return((0,uR.useObserver)((0,i7.useAgentIsWorking)(),{next:"webview"===o?v:void 0}),s)?null:(0,g.jsx)(A.View,{style:(n={},(0,I._)(n,uA.headerHeight,"".concat(d,"px")),(0,I._)(n,uA.borderColor,u),(0,I._)(n,uA.boxShadow,c),(0,I._)(n,uA.yOffset,p+"px"),n),clsx:[uE.default.root,(0,I._)({},uE.default.pulse,m)]})});var uV=e.i(31290),uO=A.SpecializedView.div,uF=(0,it.css)([eT.rcss.width("100%"),eT.rcss.position.absolute,eT.rcss.left(0),{cursor:"ns-resize",zIndex:1,":hover":{transform:"scaleY(4)"}}]),uM=(0,it.css)([eT.rcss.height("100%"),eT.rcss.position.absolute,eT.rcss.top(0),{cursor:"ew-resize",zIndex:1,":hover":{transform:"scaleX(4)"}}]),uL=(0,it.css)([eT.rcss.position.absolute,{zIndex:2,transform:"scale(2)",":hover":{transform:"scale(4)"}}]);function uU(e){return{transformOrigin:"".concat("topLeft"===e||"bottomLeft"===e?"right":"left"," ").concat("topLeft"===e||"topRight"===e?"bottom":"top")}}var uB={topLeft:(0,it.css)([eT.rcss.top(0),eT.rcss.left(0),uU("topLeft")]),topRight:(0,it.css)([eT.rcss.top(0),eT.rcss.right(0),uU("topRight")]),bottomLeft:(0,it.css)([eT.rcss.bottom(0),eT.rcss.left(0),uU("bottomLeft")]),bottomRight:(0,it.css)([eT.rcss.bottom(0),eT.rcss.right(0),uU("bottomRight")])};function uN(e){var n=e.edge,t=e.size,r=e.onPointerDown;if("top"===n||"bottom"===n)return(0,g.jsx)(uO,{onPointerDown:r,style:(0,I._)({height:t},n,-t),css:uF});if("right"===n||"left"===n)return(0,g.jsx)(uO,{onPointerDown:r,style:(0,I._)({width:t},n,-t),css:uM});var i="topLeft"===n||"bottomRight"===n?"nwse-resize":"nesw-resize";return(0,g.jsx)(uO,{onPointerDown:r,style:{height:t,width:t,cursor:i},css:[uL,uB[n]]})}var uG=["bottom","right","left","bottomRight","bottomLeft"],uW=(0,B.memo)(function(e){var n=(0,es.useResizeFloating)();return(0,g.jsx)(g.Fragment,{children:uG.map(function(t){return(0,g.jsx)(uN,{size:8,edge:t,onPointerDown:function(r){(0,uV.measureMouseMove)(r,{start:function(){n({type:"start",paneId:e.paneId,edge:t})},move:function(e){n({type:"update",moveDelta:e.delta})},end:function(){n({type:"end"})}})}},t)})})}),uz=["top","right","left","topRight","topLeft"],uH=(0,B.memo)(function(e){var n=(0,es.useResizeFloating)();return(0,g.jsx)(g.Fragment,{children:uz.map(function(t){return(0,g.jsx)(uN,{size:8,edge:t,onPointerDown:function(r){(0,uV.measureMouseMove)(r,{start:function(){n({type:"start",paneId:e.paneId,edge:t})},move:function(e){n({type:"update",moveDelta:e.delta})},end:function(){n({type:"end"})}})}},t)})})}),uq={isConnecting:!0,channel:null,context:null};function uK(e){var n=e.container,t=e.service,r=e.name,i=e.skip,o=void 0!==i&&i,a=(0,U._)((0,B.useState)(uq),2),s=a[0],l=a[1];return(0,B.useEffect)(function(){l(uq);var e=!1,i=n.openChannel({service:t,name:r,skip:function(){return o}},function(n){if(!e)return l({context:n.context,channel:n.channel,isConnecting:!1}),function(n){e||l({isConnecting:n.willReconnect,channel:null,context:null})}});return function(){e=!0,i()}},[n,t,r,o]),s}var u$=e.i(259475),uQ=e.i(57613),uY=e.i(231927),uJ=(0,R.cvarsFrom)("index.module.css",["--transform-x","--transform-y","--scale","--transform-origin-x","--width","--height","--opacity","--interaction-blanket-display","--pointer-events","--user-select","--border-top-left-radius","--border-top-right-radius","--border-gap","--iframe-pointer-events"]),uX=(0,B.memo)(function(e){var n,t,r,i,o,a,s=e.paneId,l=(0,ed.usePaneUIContext)().Content,u=(0,es.usePaneView)(s),c=(0,ix.default)(u.isHidden),d=(0,ix.default)(u.data),p=(0,ix.default)(u.isActive),f=(0,ix.default)(u.isCommitted);(0,ef.usePaneSession)(s,d);var h=(n=eJ(),t=(0,es.useInsertFloatingPaneIfNotExists)(),r=(0,es.useUpdatePane)(),i=(0,es.useCommitPane)(),o=(0,es.useRemovePane)(),(0,$.default)(function(){return function(e){switch(e.operation){case"commit":i(s);return;case"open":if(e.floating)return void t(e.pane,{commit:!0,location:"center"});n({pane:e.pane,activate:!0,placement:{type:"after",paneId:s}});return;case"replace":r({paneId:s,pane:e.pane});return;case"remove":o(e.pane.id);return;case"openPip":return;default:(0,ob.default)(e)}}},[i,s,r,o,n,t])),m=(a=uK({container:(0,e2.default)().container,service:"panetracker"}).channel,(0,B.useCallback)(function(e,n){a&&a.send({paneMetricsTracker:{pane:e,flow:n}})},[a]));return(0,g.jsx)(l,{pane:d,options:{paneId:s,isHidden:c,performPaneOperation:h,isActive:p,isCommitted:f,emitPaneMetrics:m}})});let uZ=(0,B.memo)(function(e){var n,t,r,i,o=e.paneId,a=(0,es.useActivatePane)(),s=(t=(n=(0,U._)((0,u_.useDrop)({accept:[td.FileType.File,u$.DragItems.Pane,u$.DragItems.NewPane],collect:function(e){return{isOver:e.isOver()}},hover:function(e,n){var t=n.getClientOffset();t&&i.drag({pageX:t.x,pageY:t.y,over:o})},drop:function(e,n){var t=n.getClientOffset();if(t){if(e.type===u$.DragItems.Pane)return void i.drop({type:"pane",paneId:e.paneId,pageX:t.x,pageY:t.y,over:o});if("nodes"===e.type){var r=(0,ec.fsNodeToPanes)(e.nodes);r.length>0&&i.drop({type:"newPaneGroup",panes:r,pageX:t.x,pageY:t.y,over:o})}if(e.type===u$.DragItems.NewPane){var a=e.pane;i.drop({type:"newPaneGroup",panes:[a],pageX:t.x,pageY:t.y,over:o})}}}}),2))[0].isOver,r=n[1],i=(0,es.usePaneDragAndDrop)({isOver:t}),r),l=(0,es.usePaneView)(o),u=(0,ix.default)(l.isActive),c=(0,ix.default)(l.isFloating),d=(0,ix.default)(l.isModal),p=(0,ix.default)(l.paneType),f=(0,q.default)(),h=(0,oQ.useIsMac)(),m=(0,oQ.useIsWindows)(),v=(h||m)&&f?D.HEADER_HEIGHT:0,x=(0,B.useRef)(null);(0,uI.useStyleSet)(x,uk(l.properties,l.getTransitionEnabled),function(e){var n,t=e.width,r=e.height,i=e.x,o=e.y,a=e.scale,s=e.opacity;return n={},(0,I._)(n,uJ.width,t+"px"),(0,I._)(n,uJ.height,r+"px"),(0,I._)(n,uJ.transformX,i+"px"),(0,I._)(n,uJ.transformY,o+"px"),(0,I._)(n,uJ.scale,a.toString()),(0,I._)(n,uJ.opacity,s.toString()),n}),(0,uI.useStyleSet)(x,l.transformOriginXAtom,function(e){return(0,I._)({},uJ.transformOriginX,e)}),(0,uI.useStyleSet)(x,l.viewportInset,function(e){return{"--fixed-position-offset-x":-e.x+"px","--fixed-position-offset-y":-e.y-v+"px"}}),(0,uI.useStyleSet)(x,l.isHidden,function(e){return(0,I._)({},uJ.pointerEvents,e?"none":"auto")}),(0,uI.useStyleSet)(x,l.zIndex,function(e){return{"z-index":e.toString()}}),(0,uI.useStyleSet)(x,l.disableInteractions,function(e){var n;return n={},(0,I._)(n,uJ.interactionBlanketDisplay,e?"block":"none"),(0,I._)(n,uJ.userSelect,e?"none":"auto"),(0,I._)(n,uJ.iframePointerEvents,e?"none":"auto"),n});var y=u?void 0:function(){a(o,{commit:"codeEditor"!==p})},b=(0,ep.useSetPaneElement)(),w=(0,I._)({},uJ.borderGap,"".concat(4,"px"));c||(w[uJ.borderTopLeftRadius]="".concat(8,"px"),w[uJ.borderTopRightRadius]="".concat(8,"px"));var j=(0,ne.useMergeRefs)([x,c?void 0:s],{breadcrumb:"client/replEnvironmentDesktop/Pane/index.tsx:324"}),_=(0,uT.useSetHoveredPane)(),S=(0,ix.default)(l.headerHeight);return(0,g.jsx)(us.TrackingHierarchyProvider,{hierarchy:{surface:"".concat(p,"_pane")},children:(0,g.jsx)(ep.PaneIdProvider,{value:o,children:(0,g.jsx)(E.Surface,{role:"tabpanel",id:o,"aria-labelledby":"tab-".concat(o),innerRef:j,clsx:uY.default.root,style:w,onMouseEnter:function(){return _(o)},onMouseLeave:function(){return _(null)},children:(0,g.jsxs)(uQ.default,{origin:"ErrorBoundary: PaneContainer",bsod:!0,tags:(0,$.default)(function(){return{paneType:p}},[p]),children:[(0,g.jsxs)(A.View,{clsx:uY.default.container,onMouseDown:y,onContextMenu:y,innerRef:function(e){return b(o,e)},style:"agentChat"===p?{overflowX:"hidden"}:void 0,children:[(0,g.jsx)(A.View,{tabIndex:-1}),(0,g.jsx)(uX,{paneId:o})]}),(0,g.jsx)(uD,{headerHeight:S,paneId:o}),c&&!d?(0,g.jsx)(uW,{paneId:o}):null,(0,g.jsx)(A.View,{clsx:uY.default.interactionBlanket})]},o)})})})});var u0=e.i(822243),u1=e.i(429225),u2=e.i(59380);(0,eI.cssRecord)({handle:[eT.rcss.minWidth(16),eT.rcss.height("100%")]});var u4=e.i(112077),u8=e.i(33171),u3=(0,R.cvarsFrom)("Tab.module.css",["--width","--x","--color","--bg","--font-style"]);function u6(e){var n;return n={},(0,I._)(n,u3.width,e.width+"px"),(0,I._)(n,u3.x,e.x+"px"),(0,I._)(n,u3.bg,e.active?R.tokens.surfaceBackground:""),(0,I._)(n,u3.color,e.active?R.tokens.foregroundDefault:""),n}function u9(e){var n=e.layout,t=e.paneId,r=e.paneGroupId,i=(0,es.usePane)(t),o=(0,B.useMemo)(function(){return n.tab(t)},[n,t]),a=(0,B.useRef)(null),s=(0,es.usePaneView)(e.paneId),l=(0,rO.useObservable)(s.isCommitted),u=(0,ef.useUniquePath)((0,ec.isFilePane)(i)?i.data.path:null),c=(V=(D={paneId:t,paneGroupId:r}).paneId,O=D.paneGroupId,F=(0,ep.useGetPaneBindings)(),M=(0,es.useGetPane)(),L=iM({paneId:V}),N=ih({paneId:V,paneGroupId:O}),G=im(),W=(0,ed.usePaneUIContext)(),(0,B.useCallback)(function(){var e=M(V).pane,n=F(V),t=function(e){return!!e&&(void 0===e?"undefined":(0,ni._)(e))==="object"&&"data"in e};return{data:{type:"context",label:"Search actions",icon:(0,g.jsx)(W.Icon,{pane:e})},commands:function(){return[{data:{type:"group",key:"pane-actions"},commands:function(){var e,r;return(null!=(r=null==n||null==(e=n.commands)?void 0:e.flatMap(function(e){return e.commands}))?r:[]).filter(t)}},{data:{type:"group",key:"secondary"},commands:function(){return[G(V),L].concat((0,Z._)(N)).filter(t)}}]}}},[F,W,M,V,L,N,G])),d=(0,u2.useContextMenu)().onContextMenu;(0,uI.useStyleSet)(a,uk(o,function(){return!0}),u6);var p=(0,es.useRemovePane)(),f=(0,es.useSelectTab)(),h=(0,ed.usePaneUIContext)(),v=h.getTitle(i),x=h.Icon({pane:i,size:16}),y=function(){var e=(0,B.useRef)(null),n=(0,B.useRef)(!1),t=(0,u4.useCreateObservable)(!1);function r(){var r=e.current;if(r){var i=r.scrollWidth>r.clientWidth;t.set(i),n.current=!1}}var i=(0,o$.default)(function(){n.current||(n.current=!0,requestAnimationFrame(r))});return{state:t,ref:(0,ne.useMergeRefs)([e,i])}}(),b=(0,rO.useObservable)(y.state),w=void 0;(0,ec.isFilePane)(i)&&i.data.path?w=i.data.path:b&&(w=v);var j=!l&&"commands"!==i.type,_=(0,es.useCommitPane)(),S=(0,i9.useObservableRef)(s.isActive),C=function(){S.current&&!l?_(t):f(t)},k=(z=e.paneId,H=e.layout,K=(q=(0,U._)((0,u0.useDrag)({type:u$.DragItems.Pane,item:function(){return{type:u$.DragItems.Pane,paneId:z,width:80}},end:function(){H.dragState.set(null)},collect:function(e){var n=e.getItem();return{isActive:(null==n?void 0:n.paneId)===z,isDragging:e.isDragging()}}}),2))[0],$=q[1],Q=(0,es.useSetIsDraggingTab)(),Y=K.isDragging,J=K.isActive,(0,B.useEffect)(function(){Q(Y)},[Q,Y]),(0,B.useEffect)(function(){H.dragState.set(J?{id:z}:null)},[H,J,z]),{dragRef:$}).dragRef,T=(0,ne.useMergeRefs)([a,e.isOnlyTab?void 0:k]),R=(0,i9.useObservableRef)(n.state),P=(0,B.useRef)(null);if(null===P.current){var D,V,O,F,M,L,N,G,W,z,H,q,K,$,Q,Y,J,X,ee=null==(X=R.current)?void 0:X.tabs.get(t);ee&&(P.current=u6((0,e9._)((0,m._)({},ee),{active:!0})))}return(0,g.jsxs)(E.Surface,{style:(0,m._)((0,I._)({},u3.fontStyle,j?"italic":"inherit"),P.current),onMouseUp:function(e){1===e.button&&(e.preventDefault(),e.stopPropagation(),p(t))},elevated:!0,innerRef:T,align:"center",justify:"center",row:!0,clsx:u8.default.tab,onContextMenu:function(e){return d(e,{command:c()})},children:[(0,g.jsx)(o5.Tooltip,{tooltip:w,delay:"long",placement:"bottom",isDisabled:!w,children:function(e,n){return(0,g.jsxs)(A.View,(0,e9._)((0,m._)({},e),{innerRef:n,pl:6,tag:"button",clsx:u8.default.tabButton,row:!0,grow:!0,shrink:!0,align:"center",gap:6,onClick:C,children:[x,(0,g.jsx)(ez.Text,{ref:u?void 0:y.ref,multiline:!1,clsx:u8.default.title,children:v}),u?(0,g.jsx)(ez.Text,{variant:"small",clsx:u8.default.title,color:"dimmest",multiline:!1,children:u}):null]}))}}),(0,g.jsx)(ot.IconButton,{alt:"Close tab",clsx:u8.default.closeButton,size:28,onClick:function(){return p(t)},children:(0,g.jsx)(ic.default,{size:12})})]})}var u5=e.i(904851),u7=e.i(90659),ce=e.i(790164),cn={newTabButtonWidth:28,defaultTabWidth:160,gap:4},ct=function(){function e(n){var t=this;(0,u5._)(this,e),(0,I._)(this,"containerWidth",new ce.ObservableState(0)),(0,I._)(this,"isHovered",new ce.ObservableState(!1)),(0,I._)(this,"dragState",new ce.ObservableState(null)),(0,I._)(this,"dropState",new ce.ObservableState(null)),(0,I._)(this,"activeId",void 0),(0,I._)(this,"paneIds",void 0),(0,I._)(this,"state",new ui.Multicast(function(e){var n=null;return uo.Observable.combine(t.paneIds,t.containerWidth,t.isHovered,t.dragState,t.dropState).subscribe(function(t){var r=(0,U._)(t,5),i=r[0],o=r[1],a=r[2],s=r[3],l=r[4];if(l){var u,c,d=l.item.type===u$.DragItems.Pane?l.item:null,p=d?null==n||null==(c=n.tabs)?void 0:c.get(d.paneId):null;u={xOffset:l.pointer.x,width:p?p.width:cn.defaultTabWidth,id:d?d.paneId:void 0}}var f=function(e){var n,t,r=e.ids,i=e.gap,o=e.containerWidth,a=e.defaultTabWidth,s=e.newTabButtonWidth,l=e.matchWidths,u=e.dropArea,c=e.dragState,d=new Map;if(0===r.length||0===o)return{tabs:d};c?j="own-tab":(null==u?void 0:u.id)&&(j="external");var p=o-s-i,f=r.length;"external"===j&&(f+=1);var g=f-1,h=f*a+g*i<=p?a:(p-g*i)/f,m=l&&r.length<l.size,v=0,x=!0,y=!1,b=void 0;try{for(var w,j,_,S=r[Symbol.iterator]();!(x=(_=S.next()).done);x=!0){var C,k,I=_.value,T=m&&null!=(k=null==l||null==(C=l.get(I))?void 0:C.width)?k:h,R=v+T+i/2;u&&u.xOffset>=v&&u.xOffset<R&&(w={preview:{x:v,width:T},index:d.size},v+=T+i);var P=(null==c?void 0:c.id)===I;d.set(I,{x:v,width:P?0:T}),P||(v+=T+i)}}catch(e){y=!0,b=e}finally{try{x||null==S.return||S.return()}finally{if(y)throw b}}return u&&!w&&(w={preview:{x:v,width:m&&null!=(t=null==l||null==(n=l.get(r[r.length-1]))?void 0:n.width)?t:h},index:d.size}),{tabs:d,dropData:w}}((0,e9._)((0,m._)({containerWidth:o,ids:i,matchWidths:a&&n?n.tabs:void 0},cn),{dropArea:u,dragState:s||void 0}));(0,eQ.default)(n,f)||(n=f,e.next(f))})})),(0,I._)(this,"dropIndex",new ui.Multicast(function(e){var n=null;return t.state.subscribe(function(t){var r,i,o=null!=(i=null==(r=t.dropData)?void 0:r.index)?i:null;o!==n&&(n=o,e.next(o))})})),(0,I._)(this,"setContainerWidth",function(e){t.containerWidth.set(e)}),(0,I._)(this,"tabs",new ui.Multicast(function(e){return t.state.select(function(e){return e?Array.from(e.tabs.keys()):[]}).subscribe(e)})),(0,I._)(this,"newTab",new ui.Multicast(function(e){var n=null;return t.state.subscribe(function(t){var r,i=Array.from(t.tabs.keys()).pop(),o=i?t.tabs.get(i):null;if(o){var a={x:o.x+o.width+4,width:28,visible:!t.dropData};t.dropData&&(null==(r=t.dropData)?void 0:r.index)>=t.tabs.size&&(a.x+=t.dropData.preview.width+4),(0,eQ.default)(n,a)||(n=a,e.next(a))}})})),(0,I._)(this,"dropPreview",new ui.Multicast(function(e){var n=null;return t.state.subscribe(function(t){var r,i,o=null!=(i=null==(r=t.dropData)?void 0:r.preview)?i:null;(0,eQ.default)(n,o)||(n=o,e.next(o))})})),(0,I._)(this,"width",new ui.Multicast(function(e){return t.containerWidth.subscribe(e)})),this.paneIds=n.paneIds,this.activeId=n.activeId}return(0,u7._)(e,[{key:"tab",value:function(e){var n=this;return new ui.Multicast(function(t){var r=null;return uo.Observable.combine(n.state,n.activeId,n.dropState).subscribe(function(n){var i,o,a=(0,U._)(n,3),s=a[0],l=a[1],u=a[2],c=s.tabs.get(e);if(c){var d=(0,e9._)((0,m._)({},c),{active:l===e,isBeingDragged:(null==u||null==(i=u.item)?void 0:i.type)===u$.DragItems.Pane&&(null==u||null==(o=u.item)?void 0:o.paneId)===e});(0,eQ.default)(r,d)||(r=d,t.next(d))}})})}}]),e}(),cr=e.i(13891),ci=(0,R.cvarsFrom)("index.module.css",["--new-tab-width","--new-tab-x","--drop-preview-width","--drop-preview-x","--drop-preview-opacity"]),co=(0,B.memo)(function(e){var n,t,r,i,o,a,s,l,u,c,d,p,f,h,m,v,x,y,b,w,j,_=(0,es.usePaneGroup)(e.headerId),S=(0,B.useMemo)(function(){return new ct({paneIds:uo.Observable.from(_.panes),activeId:uo.Observable.from(_.activeTabPaneId)})},[_.panes,_.activeTabPaneId]),C=(0,rO.useObservable)(S.tabs),k=(0,o$.default)(function(e){return S.setContainerWidth(e.width)},{type:"debounce",wait:100}),R=(0,es.useInsertTab)(),P=(null==C?void 0:C.length)===1,E=(0,ix.default)(_.activeTabPaneId),D=(t=(n={paneGroupId:e.headerId,activeTabPaneId:E}).paneGroupId,r=n.activeTabPaneId,o=(i=(0,es.usePaneGroupDragAndDrop)({paneGroupId:t})).isDragging,a=i.dnd,s=(0,es.useMaximizedPane)().toggleMaximizedPaneGroup,l=(0,es.useHeaderView)(t),u=(0,ix.default)(l.isMaximized),c=(0,es.useActivatePane)(),{dnd:a,cursor:o?"grabbing":"grab",onPointerDown:function(e){c(r),!u&&"button"in e&&0===e.button&&(0,uV.measureMouseMove)(e,{start:a.start,move:a.update,end:a.end})},toggleMaximizedPaneGroup:s,isMaximized:u}),V=D.cursor,O=D.onPointerDown,F=D.toggleMaximizedPaneGroup,M=D.isMaximized,L=(0,B.useRef)(null),N=(d=e.headerId,p=(0,B.useRef)(null),f=(0,i9.useObservableRef)(S.dropIndex),h=(0,es.useInsertTab)(),m=(0,es.useMoveTab)(),v=(0,es.usePaneGroup)(d),x=(0,ix.default)(v.panes),y=(0,B.useCallback)(function(e,n){var t=(null==n?void 0:n.index)!==null?null==n?void 0:n.index:x.length;if("nodes"===e.type){var r=(0,ec.fsNodeToPanes)(e.nodes);r.length>0&&h({activate:!0,commit:!0,paneGroupId:d,index:t,panes:r});return}if(e.type===u$.DragItems.NewPane)return void h({activate:!0,paneGroupId:d,index:t,panes:[e.pane]});if("paneId"in e){var i=x.includes(e.paneId)?x.length-1:x.length;m({paneId:e.paneId,index:void 0!==t&&t<i?t:i,toPaneGroupId:d})}},[h,m,d,x]),w=(b=(0,U._)((0,u_.useDrop)({accept:[td.FileType.File,u$.DragItems.Pane,u$.DragItems.NewPane],hover:function(e,n){var t=n.getClientOffset(),r=t&&p.current?{x:t.x-p.current.x,y:t.y-p.current.y}:{x:0,y:0};S.dropState.set({item:e,pointer:r})},collect:function(e){var n,t;return p.current=null!=(t=null==(n=L.current)?void 0:n.getBoundingClientRect())?t:null,{isOver:e.isOver()}},drop:function(e,n){var t,r=null!=(t=f.current)?t:null;S.dropState.set(null),n.didDrop()||y(e,null!==r?{index:r}:null)}}),2))[0].isOver,j=b[1],(0,B.useEffect)(function(){w||S.dropState.set(null)},[w,S]),{dropRef:j}).dropRef,G=(0,ne.useMergeRefs)([k,L,N]),W=(0,q.default)(),z=(0,oQ.useIsWindows)();return(0,g.jsxs)(A.View,{row:!0,grow:!0,shrink:!0,align:"start",clsx:cr.default.tabBar,children:[M?(0,g.jsx)(T.default,{}):null,(0,g.jsxs)(A.View,{grow:!0,shrink:!0,row:!0,clsx:cr.default.tabs,innerRef:G,onMouseEnter:function(){return S.isHovered.set(!0)},onMouseLeave:function(){return S.isHovered.set(!1)},onPointerDown:P&&!M?O:void 0,children:[(0,g.jsx)(ca,{paneGroupId:e.headerId,activeTabPaneId:E,isMaximized:M,toggleMaximizedPaneGroup:F,cursor:V,onPointerDown:P?void 0:O}),(0,g.jsx)(cl,{layout:S}),null==C?void 0:C.map(function(n){return(0,g.jsx)(u9,{paneGroupId:e.headerId,paneId:n,layout:S,isOnlyTab:P},n)}),(0,g.jsx)(cs,{layout:S,onClick:function(){return R({paneGroupId:e.headerId,activate:!0,panes:[{type:"commands",data:{autoFocus:!0}}]})}})]}),M?(0,g.jsx)(ot.IconButton,{clsx:(0,I._)({},cr.default.desktopAppWindowsOs,z&&W),size:28,alt:"Minimize",onClick:function(){return F({paneGroupId:e.headerId})},children:(0,g.jsx)(iP.default,{})}):null]})});function ca(e){var n=e.paneGroupId,t=e.activeTabPaneId,r=e.toggleMaximizedPaneGroup,i=e.isMaximized,o=e.cursor,a=e.onPointerDown,s=iD({paneId:t,paneGroupId:n}),l=(0,u2.useContextMenu)().onContextMenu;return(0,g.jsx)(A.View,{onContextMenu:function(e){return l(e,{command:s})},onDoubleClick:function(){r({paneGroupId:n})},title:i?"Double click to restore.":"Double click to maximize. Drag to move.",clsx:cr.default.dragArea,style:{cursor:i?void 0:o},onPointerDown:a})}function cs(e){var n,t=e.layout,r=(0,B.useRef)(null),i=(0,es.useHasSingleTiledPane)(),o=(0,aD.useSetTourStepTarget)(aW,aG.NewTab);(0,uI.useStyleSet)(r,t.newTab,function(e){var n;return n={},(0,I._)(n,ci.newTabWidth,e.width+"px"),(0,I._)(n,ci.newTabX,e.x+"px"),(0,I._)(n,"opacity",e.visible?"1":"0"),n});var a={isDragging:(n=(0,U._)((0,u0.useDrag)({type:u$.DragItems.NewPane,item:function(){return{type:u$.DragItems.NewPane,pane:{type:"commands",data:{autoFocus:!0}},width:80}},collect:function(e){return{isDragging:e.isDragging()}}}),2))[0].isDragging,dragRef:n[1]},s=a.dragRef,l=a.isDragging,u=(0,ne.useMergeRefs)([r,o,s]),c=(0,lW.useObservableMemo)(function(){return t.width.select(function(e){return e>320})},[t]),d="Tools & files";return(0,g.jsx)(A.View,{innerRef:u,clsx:cr.default.newTab,children:l?null:(0,g.jsx)(g.Fragment,{children:i&&c?(0,g.jsx)(eW.Button,{clsx:cr.default.newTabTextButton,onClick:e.onClick,variant:"nofill",iconLeft:(0,g.jsx)(tS.default,{}),text:d,style:{width:160}}):(0,g.jsx)(ot.IconButton,{clsx:cr.default.newTabIconButton,size:28,alt:d,onClick:e.onClick,children:(0,g.jsx)(tS.default,{})})})})}function cl(e){var n=e.layout,t=(0,B.useRef)(null);return(0,uI.useStyleSet)(t,n.dropPreview,function(e){var n;return n={},(0,I._)(n,ci.dropPreviewWidth,(e?e.width:80)+"px"),(0,I._)(n,ci.dropPreviewX,(e?e.x:"50%")+"px"),(0,I._)(n,ci.dropPreviewOpacity,e?"1":"0"),n}),(0,g.jsx)(A.View,{innerRef:t,clsx:cr.default.dropPreview})}var cu=e.i(248611),cc=(0,R.cvarsFrom)("index.module.css",["--left","--top","--scale","--transform-origin-x","--width","--height","--z-index","--transform-x","--transform-y","--border-radius","--controls-opacity","--opacity","--padding-left","--padding-top"]);let cd=(0,B.memo)(function(e){var n,t=e.headerId,r=(0,es.usePaneGroup)(t),i=(0,ix.default)(r.activeTabPaneId),o=(0,es.useHeaderView)(t),a=(0,ix.default)(o.isFloating),s=(0,ix.default)(o.isBeingDragged),l=(0,ix.default)(o.isModal),u=(0,ix.default)(o.isMaximized),c=(0,B.useRef)(null);(0,uI.useStyleSet)(c,uk(o.properties,o.getTransitionEnabled),function(e){var n,t,r,i=e.width,o=e.height,a=e.x,s=e.y,l=e.scale,u=e.opacity,c=e.positioning;return(0,m._)((n={},(0,I._)(n,cc.width,i+"px"),(0,I._)(n,cc.height,o+"px"),(0,I._)(n,cc.scale,l.toString()),(0,I._)(n,cc.opacity,u.toString()),n),"transform"===c?(t={},(0,I._)(t,cc.transformX,Math.round(a)+"px"),(0,I._)(t,cc.transformY,Math.round(s)+"px"),(0,I._)(t,cc.top,"0px"),(0,I._)(t,cc.left,"0px"),t):(r={},(0,I._)(r,cc.transformX,"0px"),(0,I._)(r,cc.transformY,"0px"),(0,I._)(r,cc.top,Math.round(s)+"px"),(0,I._)(r,cc.left,Math.round(a)+"px"),r))}),(0,uI.useStyleSet)(c,o.transformOriginX,function(e){return(0,I._)({},cc.transformOriginX,e)}),(0,uI.useStyleSet)(c,o.zIndex,function(e){return{"z-index":e.toString()}});var d=(0,uT.useSetHoveredPane)();return(0,uI.useStyleSet)(c,(0,uT.useIsPaneHovered)(i),function(e){return(0,I._)({},cc.controlsOpacity,e?"1":"0")}),(0,g.jsxs)(E.Surface,{innerRef:c,clsx:cu.default.surface,row:!0,align:"center",style:(n={},(0,I._)(n,cc.borderRadius,"8px"),(0,I._)(n,cc.paddingTop,(!u&&a?6:0)+"px"),(0,I._)(n,cc.paddingLeft,(u||s||a?6:0)+"px"),n),onMouseEnter:function(){return d(i)},onMouseLeave:function(){return d(null)},children:[(0,g.jsx)(co,{headerId:t}),a&&!l?(0,g.jsx)(uH,{paneId:i}):null]})});function cp(){var e=(0,es.useOpenTool)(),n=(0,B.useCallback)(function(n){return e({pane:n})},[e]),t=(0,es.useGetPanes)(),r=(0,es.useRemovePane)();return(0,B.useCallback)(function(e){var i=ec.STACK_TO_OUTPUT_PANE_MAP[e];i&&(n({type:i}),t().forEach(function(e){var n=(0,U._)(e,2),t=n[0],o=n[1];"agentChat"!==o.type&&o.type!==i&&r(t)}))},[n,t,r])}var cf=e.i(391119),cg=e.i(700966),ch=e.i(716636),cm=e.i(398014),cv={Content:function(e){var n,t=(0,U._)((0,B.useState)(null),2),r=t[0],i=t[1];(0,ep.useSetFocusTarget)(function(){return r},[r]),(0,ep.useSetPaneBindings)(function(){return{type:"agentChat",focusInput:function(){return null==r?void 0:r.focus()}}},[r]);var o=e.options.performPaneOperation,a=(0,B.useCallback)(function(e){return o({operation:"open",pane:e,secondary:"ghostwriterChat"!==e.type})},[o]),s=cp(),l=(0,B.useCallback)(function(e){o({operation:"openPip",data:e})},[o]),u=(0,cf.useCurrentSession)(null==(n=e.pane.data)?void 0:n.sessionId),c=u.session,d=u.setSession,p=(0,B.useCallback)(function(e){o({operation:"replace",pane:{type:"agentChat",data:{sessionId:e.id}}}),d(e)},[o,d]),f=(0,es.useIsAgentCentered)(),h=(0,es.useTransitionToAgentPresentation)(),m=(0,es.useIsAgentPresentationTransitionInProgress)(),v=(0,e2.default)(),x=v.secrets,y=v.fs;return(0,g.jsx)(cg.AgentMain,{secrets:x,readFile:y.readFile,session:c,setSession:p,inputRef:i,openPane:a,onPlanApproval:function(e){e&&s(e),h("sidebar")},isDesktopOrTabletAgentPresentationCentered:f,isDesktopLayoutAgentPresentationTransitionInProgress:m,openPip:l})},Icon:function(e){var n=e.size;return(0,g.jsx)(oe.AgentAvatar,{size:n})},getTitle:function(){return"Agent"},description:aL.AGENT_DESCRIPTION,category:ch.PaneCategory.WorkspaceFeatures,decode:function(e){return n7.Value.Decode(cm.AgentChatPaneSchema,e)}},cx=e.i(795564),cy={Content:function(e){var n=e.options,t=n.performPaneOperation,r=n.paneId,i=e.pane.data.autoFocus,o=(0,es.useCommitPane)(),a=(0,B.useRef)(null);(0,ep.useSetFocusTarget)(function(){return{focus:function(){var e;return null==(e=a.current)?void 0:e.call(a)}}},[]);var s=(0,B.useCallback)(function(e){t({operation:"replace",pane:e.pane}),o(r),(0,ei.track)(eo.events.TOOL_OPENED,{source:"New Tab",tool:e.pane.type})},[t,r,o]),l=rG({currentPaneId:r,openPane:s});return(0,g.jsx)(A.View,{pt:16,grow:!0,shrink:!0,children:(0,g.jsx)(eP.CommandBar,{autoFocus:i,command:l,focusRef:a,showToolDescriptions:!0})})},Icon:function(){return null},getTitle:function(){return"New tab"},category:ch.PaneCategory.Other,decode:cx.decode},cb=e.i(827836),cw=e.i(818283),cj=e.i(999519),c_={Content:function(e){var n=e.options,t=n.paneId,r=n.performPaneOperation,i=e.pane.flow,o=(0,es.useSidebar)(),a=(0,ix.default)(o.activeContent),s=(0,B.useCallback)(function(){"filetree"!==a&&o.toggleContent("filetree")},[o,a]);return(0,g.jsx)(cw.default,{flow:i,closeConfigPane:function(){return r({operation:"remove",pane:{id:t}})},useReadFile:cb.default,openSidebar:s,onNewPaneSelected:function(e){return r({operation:"open",pane:e})},openConsole:function(){return r({operation:"open",pane:{type:"runnerOutput"}})}})},Icon:function(){return(0,g.jsx)(rw.default,{})},getTitle:function(){return"Configure Repl"},category:ch.PaneCategory.WorkspaceFeatures,decode:cj.decode},cS=e.i(746382),cC=(0,it.css)([eT.rcss.backgroundColor.backgroundDefault,eT.rcss.height("100%"),eT.rcss.borderRadius(4),{overflow:"hidden"}]),ck=(0,it.css)([eT.rcss.width("100%"),eT.rcss.height("100%"),eT.rcss.justify.center,eT.rcss.align.center,eT.rcss.display.flex]);function cI(e){var n=e.paneId,t=e.extensionPaneData,r=e.environmentAPIs,i=(0,e4.useExtensionByInstallationId)(t.installationId),o=(0,e4.useExtensionStateAtom)(t.installationId),a=ty({extension:i,environmentAPIs:r,sandboxTitle:t.name,sandboxUrl:(0,e6.getAssetUrl)(t.baseUrl,t.path),paneId:n,filePath:t.filePath||null}),s=a.didConnectOnce,l=a.isValidExtensionPaneUrl,u=a.getIframeProps,c=a.reloadSandbox;return(0,ep.useSetPaneBindings)(function(){return{type:"extension",commands:[{name:"Actions",commands:[{match:el.matchLabel,data:{icon:(0,g.jsx)(r0.default,{}),label:"Refresh",type:"action",description:"Refresh extension",key:"refresh",run:function(){c()}}}]}]}},[c]),(0,g.jsx)(A.View,{className:"extension-pane",css:cC,children:o&&s?(0,g.jsx)(g.Fragment,{children:l()?(0,g.jsx)("iframe",(0,m._)({},u({css:{width:"100%",height:"100%",border:"none"}}))):(0,g.jsx)(A.View,{p:12,children:(0,g.jsxs)(ez.Text,{children:["Invalid url:"," ",(0,g.jsx)(cS.InlineCode,{children:t.baseUrl+t.path}),". Please contact the extension author, or Replit support."]})})}):(0,g.jsx)(A.View,{css:ck,children:(0,g.jsx)(oL.default,{})})})}var cT=n5.Type.Object({extensionId:n5.Type.Unsafe(n5.Type.String()),installationId:n5.Type.Unsafe(n5.Type.String()),baseUrl:n5.Type.String(),path:n5.Type.String(),name:n5.Type.String(),filePath:n5.Type.Optional(n5.Type.Union([n5.Type.String(),n5.Type.Null(),n5.Type.Undefined()])),icon:n5.Type.Optional(n5.Type.Union([n5.Type.String(),n5.Type.Null(),n5.Type.Undefined()]))}),cR=n5.Type.Object({type:n5.Type.Literal("extension"),data:cT}),cP=e.i(211397),cE={Content:function(e){var n=e.pane,t=e.options,r=eZ();return(0,g.jsx)(cI,{extensionPaneData:n.data,paneId:t.paneId,environmentAPIs:r})},Icon:function(e){var n=e.pane,t=e.size;return n.data.icon?(0,g.jsx)(A.View,{style:{width:t,height:t,position:"relative"},children:(0,g.jsx)(cP.default,{src:(0,e6.getAssetUrl)(n.data.baseUrl,n.data.icon),layout:"fill",alt:""})}):(0,g.jsx)(tC.default,{size:t})},getTitle:function(e){return e.data.filePath?e.data.filePath+" â€” "+e.data.name:e.data.name},category:ch.PaneCategory.WorkspaceExtensions,decode:function(e){return n7.Value.Decode(cR,e)}},cA=e.i(144494),cD=e.i(915793),cV=e.i(328751),cO=e.i(198769),cF=e.i(904678);function cM(){var e=(0,v._)(["\n  query ExtensionOwnerDetails($extensionId: String!) {\n    extension(id: $extensionId) {\n      ... on Extension {\n        id\n        isListed\n        user {\n          id\n          username\n        }\n      }\n      ... on NotFoundError {\n        message\n      }\n    }\n  }\n"]);return cM=function(){return e},e}function cL(){var e=(0,v._)(["\n  query currentExtensionStatus($id: String!) {\n    extension(id: $id) {\n      ... on Extension {\n        id\n        isListed\n        user {\n          id\n        }\n      }\n    }\n  }\n"]);return cL=function(){return e},e}var cU={};(0,x.gql)(cM());var cB=(0,x.gql)(cL()),cN=e.i(888136),cG=e.i(619319),cW=e.i(428596),cz=e.i(607278),cH=e.i(363201),cq=(0,eI.cssRecord)({codeBlock:[eT.rcss.borderRadius(8),eT.rcss.position.relative],codeBlockCopyButton:[eT.rcss.position.absolute,eT.rcss.top(4),eT.rcss.right(4)],selectionContainer:[eT.rcss.maxHeight(400),eT.rcss.overflowY("scroll")],fsNode:[eT.rcss.flex.row,eT.rcss.rowWithGap(8),eT.rcss.align.center,eT.rcss.px(4),eT.rcss.py(2),eT.rcss.borderRadius(8),eT.rcss.cursor.pointer],fsNodeActive:[eT.rcss.backgroundColor.backgroundHigher]});function cK(e){var n=e.content,t=(0,e$.default)().showConfirm;return(0,g.jsxs)(E.Surface,{tag:"code",elevated:!0,css:cq.codeBlock,p:8,children:[n,(0,g.jsx)(ot.IconButton,{alt:"Copy",tooltipBehavior:"hidden",css:cq.codeBlockCopyButton,onClick:function(){return navigator.clipboard.writeText(n).then(function(){return t("Copied")})},children:(0,g.jsx)(rQ.default,{})})]})}function c$(e){var n,t=e.glob,r=e.openFile,i=e.children,o=(0,U._)((0,B.useState)([]),2),a=o[0],s=o[1],l=(0,U._)((0,B.useState)(""),2),u=l[0],c=l[1],d=(0,cW.useIdSeed)(),p=(0,e2.default)().fs,f=(0,tw.useStaticDirectoryPath)(),h=(0,B.useMemo)(function(){return(0,cG.globToRegExp)(t)},[t]);return((0,B.useEffect)(function(){h&&p.listFiles().then(function(e){e.files&&s(e.files.filter(function(e){return e.match(h)}).map(function(e){var n=e.split("/");return{path:e,dir:n.slice(0,n.length-1).join("/"),filename:n[n.length-1]||""}}))})},[h,f]),h)?(0,g.jsxs)(A.View,{css:cq.selectionContainer,gap:16,children:[(0,g.jsx)(ez.Text,{variant:"subheadDefault",children:(0,g.jsxs)(A.View,{gap:12,children:[(0,g.jsx)(ez.Text,{variant:"subheadDefault",children:"Choose an image"}),f?(0,g.jsx)(s5.StatusBanner,{icon:(0,g.jsx)(cH.default,{}),colorway:"primary",text:(0,g.jsxs)(A.View,{gap:2,children:[(0,g.jsxs)(ez.Text,{children:["Images must be served from"," ",(0,g.jsx)("span",{css:[eT.rcss.font.code,eT.rcss.backgroundColor.accentPrimaryDimmer,eT.rcss.borderRadius(4),eT.rcss.px(4),eT.rcss.py(2),eT.rcss.mr(2),eT.rcss.border({color:R.tokens.accentPrimaryDefault})],children:f.path}),"."]}),(0,g.jsx)(ez.Text,{css:[eT.rcss.fontWeight.normal],children:"You can change your extension's static directory in the .replit file."})]})}):null,(0,g.jsxs)(ez.Text,{css:[eT.rcss.fontWeight.normal],color:"dimmer",children:["Supported file types:"," ",(0,g.jsx)("span",{css:[eT.rcss.font.code,eT.rcss.fontSize("small"),eT.rcss.backgroundColor.backgroundHigher,eT.rcss.borderRadius(4),eT.rcss.px(4),eT.rcss.py(2),eT.rcss.mr(2),eT.rcss.border({color:R.tokens.outlineDefault})],children:null==(n=t.match(/\{(.*)\}/))?void 0:n[1].split(",").map(function(e){return e.replace(".","")}).join(", ")})]})]})}),i,(0,g.jsx)(cN.default,{onChange:function(e){return r(e.path)},initialHighlightedIndex:0,defaultHighlightedIndex:0,itemToString:function(e){return(null==e?void 0:e.path)||""},children:function(e){var n=e.getInputProps,r=e.getItemProps,i=e.highlightedIndex,o=e.getRootProps,s=e.getMenuProps;return(0,g.jsxs)(A.View,(0,e9._)((0,m._)({},o({refKey:"innerRef"})),{gap:16,children:[(0,g.jsx)(A.View,{css:[eT.rcss.position.relative],children:(0,g.jsx)(cz.Input,(0,m._)({id:d("file-search")},n({ref:null,value:u,onChange:function(e){return c(e.currentTarget.value)},placeholder:"Find a file",autoComplete:"off",autoFocus:!0})))}),(0,g.jsx)(A.View,{children:a&&a.length?(0,g.jsx)(A.View,(0,e9._)((0,m._)({elevated:!0,tag:"ul",css:(eT.rcss.pt(8),eT.rcss.colWithGap(8))},s({refKey:"innerRef"})),{children:a.filter(function(e){return e.path.includes(u)}).filter(function(e){return!f||e.path.startsWith(f.relativePath)||e.path.startsWith("public")}).map(function(e,n){return(0,g.jsxs)(A.View,(0,e9._)((0,m._)({tag:"li",css:[cq.fsNode,n===i&&cq.fsNodeActive]},r({item:e,index:n,disabled:!!f&&!e.path.startsWith(f.relativePath)})),{children:[(0,g.jsx)(rB.default,{path:e.path,size:16}),(0,g.jsx)(ez.Text,{children:e.filename}),(0,g.jsx)(ez.Text,{variant:"small",color:"dimmest",children:e.dir})]}),n)})})):(0,g.jsx)(A.View,{pt:8,children:(0,g.jsx)(ez.Text,{color:"dimmer",children:(0,g.jsxs)("em",{children:["No files found matching ",(0,g.jsx)("code",{children:t})]})})})})]}))}})]}):(0,g.jsxs)(A.View,{css:[eT.rcss.flex.column,eT.rcss.colWithGap(16)],children:[(0,g.jsx)(ez.Text,{variant:"subheadDefault",children:"Invalid Glob Pattern"}),(0,g.jsxs)(ez.Text,{children:["The glob pattern ",(0,g.jsx)("code",{children:t})," could not be parsed."]}),(0,g.jsx)(A.View,{css:eT.rcss.border({direction:"bottom",color:R.tokens.backgroundHigher})}),(0,g.jsxs)(A.View,{gap:8,children:[(0,g.jsx)(ez.Text,{children:(0,g.jsx)("strong",{children:"Match all Javascript Files"})}),(0,g.jsx)(cK,{content:"**/*.js"})]}),(0,g.jsxs)(A.View,{gap:8,children:[(0,g.jsx)(ez.Text,{children:(0,g.jsx)("strong",{children:"Match JSON files at root level"})}),(0,g.jsx)(cK,{content:"*.json"})]}),(0,g.jsxs)(A.View,{gap:8,children:[(0,g.jsx)(ez.Text,{children:(0,g.jsx)("strong",{children:"Match specified file extensions"})}),(0,g.jsx)(cK,{content:"**/*.{js,ts,jsx,tsx}"})]})]})}var cQ=e.i(549762),cY=e.i(658975),cJ=((i=cJ||{}).Installing="Installing",i.Loading="Loading",i.Failed="Failed",i.Success="Success",i),cX={Installing:"Installing Extension...",Loading:"Loading Asset...",Failed:"Failed to load asset from Extension URL",Success:"Asset loaded successfully"};function cZ(e){var n=e.isOpen,t=e.close,r=e.onSubmit,i=(0,e8.useInstallCurrentReplAsExtension)(),o=(0,e8.useCurrentReplExtension)(),a=(0,U._)((0,B.useState)(null),2),s=a[0],l=a[1],u=(0,U._)((0,B.useState)(!0),2),c=u[0],d=u[1],p=(0,U._)((0,B.useState)(null),2),f=p[0],h=p[1],m=(0,U._)((0,B.useState)(null),2),v=m[0],x=m[1],y=(0,B.useRef)(null),b=(0,U._)((0,B.useState)(null),2),w=b[0],j=b[1],_=(0,U._)((0,B.useState)(null),2),S=_[0],C=_[1],k=(v||S||"").startsWith("/")?v||S:"/"+(v||S),I=(0,U._)((0,B.useState)(null),2),T=I[0],R=I[1],P=function(){C(null),l(null),x(null),j(null),R(null),h(null)},E=function(){d(!0),l(null)};(0,B.useEffect)(function(){x(S)},[S]);var D=(0,B.useCallback)(function(e){return(0,ee._)(function(){var n,t,r,a;return(0,en._)(this,function(u){switch(u.label){case 0:if(!k||!c||"Success"===s||"Failed"===s)return[2];if(n=function(e,n){return(0,ee._)(function(){var t;return(0,en._)(this,function(r){switch(r.label){case 0:return l("Loading"),h(t=(0,e6.getAssetUrl)(e.baseUrl,n)),[4,fetch(t)];case 1:if(r.sent().ok)return R(n),l("Success"),d(!1),[2,!0];return[2,!1]}})})()},t=e||o)return[3,8];l("Installing"),u.label=1;case 1:return u.trys.push([1,5,,8]),[4,i()];case 2:if(!(r=u.sent()))return[3,4];return[4,D(r)];case 3:case 6:return u.sent(),[2];case 4:case 7:return[3,8];case 5:if(u.sent(),!o)return[3,7];return[4,D(o)];case 8:if(!t)return[3,11];return a=k.replace(/^(\/public|\/static)/,""),[4,n(t,a.slice(1))];case 9:if(u.sent())return[3,11];return[4,n(t,k)];case 10:u.sent(),u.label=11;case 11:return[2]}})})()},[o,k,i,s,c]);(0,B.useEffect)(function(){if(w){var e=w.split("/"),n=e.pop(),t=e.findIndex(function(e){return["public","static"].includes(e)});C((-1!==t?"/".concat(w):"/".concat(e.slice(t+1).join("/"),"/").concat(n))||w),d(!0),D()}},[D,w]);var V=w?w.split("/"):[],O=V[V.length-1];return(0,g.jsx)(eR.Modal,{isOpen:n,onRequestClose:t,children:w?(0,g.jsxs)(A.View,{css:[eT.rcss.flex.column,eT.rcss.colWithGap(16)],children:[(0,g.jsxs)(A.View,{row:!0,gap:8,align:"center",children:[(0,g.jsx)(eW.Button,{text:"Back",size:"small",iconLeft:(0,g.jsx)(cQ.default,{}),onClick:function(){j(null),P()}}),(0,g.jsxs)(A.View,{row:!0,gap:4,align:"center",children:[(0,g.jsx)(cY.default,{}),(0,g.jsx)(ez.Text,{color:"dimmer",children:O||""})]})]}),(0,g.jsx)(ez.Text,{multiline:!0,children:"Extension assets should be stored in the public asset directory. Move the image or modify the file path, or try again."}),(0,g.jsxs)(A.View,{gap:4,children:[(0,g.jsx)(cz.Input,{defaultValue:v||"",ref:y,placeholder:"/icon.png",onChange:function(e){return x(e.target.value)},autoFocus:!0,disabled:"Loading"===s||"Installing"===s||"Success"===s}),f&&("Loading"===s||"Success"===s||"Failed"===s)?(0,g.jsx)("a",{href:f,target:"_blank",children:(0,g.jsxs)(ez.Text,{color:"dimmer",variant:"small",css:[eT.rcss.rowWithGap(4),eT.rcss.display.flex,{fontStyle:"italic"}],children:[(0,g.jsxs)("span",{css:[eT.rcss.truncate],children:["Loading"===s?"Checking ":null,"Success"===s?"Found at ":null,"Failed"===s?"Failed to load ":null,f]}),(0,g.jsx)(A.View,{css:[eT.rcss.display.inlineBlock],children:(0,g.jsx)(rY.default,{})})]})}):null]}),(0,g.jsxs)(A.View,{row:!0,justify:"space-between",align:"center",children:[(0,g.jsx)(A.View,{row:!0,gap:4,align:"center",children:s?(0,g.jsx)(g.Fragment,{children:"Loading"===s?(0,g.jsx)(oL.default,{}):(0,g.jsx)(s5.StatusBanner,{text:cX[s],colorway:"Failed"===s?"negative":"positive",icon:"Failed"===s?(0,g.jsx)(av.default,{}):(0,g.jsx)(ss.default,{})})}):null}),"Failed"===s?(0,g.jsxs)(A.View,{row:!0,gap:8,children:[(0,g.jsx)(eW.Button,{text:"Add Anyways",onClick:function(){var e=S||w;null!==e&&r(e),P(),t()},size:"small"}),(0,g.jsx)(eW.Button,{text:"Try Again",onClick:function(){E()},size:"small"})]}):null,T&&"Success"===s?(0,g.jsx)(eW.Button,{text:"Continue",iconLeft:(0,g.jsx)(ss.default,{}),colorway:"primary",onClick:function(){r(T),P(),t()}}):null]})]}):(0,g.jsx)(c$,{openFile:j,glob:"**/*.{png,jpg,jpeg,webp,svg,gif}"})})}var c0=e.i(283023),c1=e.i(883002),c2=e.i(703505),c4=(0,eI.cssRecord)({centerRowGap8:[eT.rcss.rowWithGap(8),eT.rcss.align.center],featureContainer:[eT.rcss.flex.column,eT.rcss.borderRadius(8),{overflow:"hidden"}],noFeaturesPlaceholder:[eT.rcss.border({style:"dashed"}),eT.rcss.borderRadius(8),eT.rcss.p(16),eT.rcss.colWithGap(8),eT.rcss.center],featureDetails:[eT.rcss.flex.column,eT.rcss.colWithGap(4),eT.rcss.flex.growAndShrink(1)],newFeatureFieldWrapper:[eT.rcss.border({direction:"bottom",color:R.tokens.backgroundHighest})],inputCounterFlex:[eT.rcss.flex.row,eT.rcss.justify.spaceBetween,eT.rcss.align.center]});function c8(e){var n=e.features,t=e.onCreate,r=e.onUpdate,i=e.onDelete,o=(0,U._)((0,B.useState)([]),2),a=o[0],s=o[1],l=(0,U._)((0,B.useState)(!1),2),u=l[0],c=l[1];return(0,g.jsxs)(A.View,{children:[(0,g.jsxs)(A.View,{pb:12,children:[(0,g.jsxs)(A.View,{css:c4.centerRowGap8,children:[(0,g.jsxs)(A.View,{css:c4.centerRowGap8,children:[(0,g.jsx)(c1.default,{}),(0,g.jsx)(ez.Text,{variant:"subheadDefault",children:"Feature Descriptions"})]}),(0,g.jsx)(ot.IconButton,{onClick:function(){c(!u)},alt:"Add a new Feature",tooltipBehavior:u?"hidden":"default",disabled:u,children:(0,g.jsx)(tS.default,{})})]}),(0,g.jsx)(ez.Text,{color:"dimmer",variant:"small",multiline:!0,children:"Describe what your extension can do. Descriptions will appear on the store listing page."})]}),(0,g.jsxs)(A.View,{gap:8,children:[u?(0,g.jsx)(c6,{onSubmit:function(e){t(e),c(!1)},onCancel:function(){return c(!1)}}):null,(0,g.jsx)(A.View,{css:c4.featureContainer,children:n.length>0?n.map(function(e,t){return a.includes(t)?(0,g.jsx)(c6,{feature:e,isLast:t===n.length-1,onSubmit:function(e){r(e,t),s(function(e){return e.filter(function(e){return e!==t})})},onCancel:function(){return s(function(e){return e.filter(function(e){return e!==t})})}},t):(0,g.jsx)(c3,{isLast:t===n.length-1,feature:e,onEdit:function(){return s(function(e){return(0,Z._)(e).concat([t])})},onDelete:function(){i(t)}},t)}):(0,g.jsx)(g.Fragment,{children:u?null:(0,g.jsxs)(A.View,{css:c4.noFeaturesPlaceholder,children:[(0,g.jsx)(ez.Text,{color:"dimmest",multiline:!0,children:"You haven't added any features yet"}),(0,g.jsx)(eW.Button,{variant:"outlined",text:"New Feature",iconLeft:(0,g.jsx)(tS.default,{}),onClick:function(){return c(!0)}})]})})})]})]})}function c3(e){var n=e.feature,t=e.onEdit,r=e.onDelete,i=e.isLast;return(0,g.jsxs)(E.Surface,{elevated:!0,css:[eT.rcss.flex.row,eT.rcss.rowWithGap(8),eT.rcss.align.center,eT.rcss.p(8),i?null:eT.rcss.border({direction:"bottom",color:R.tokens.backgroundHighest})],children:[(0,g.jsx)(c9,{size:64,icon:n.image}),(0,g.jsxs)(A.View,{css:c4.featureDetails,children:[(0,g.jsxs)(A.View,{row:!0,gap:8,align:"center",justify:"space-between",children:[(0,g.jsx)(ez.Text,{children:n.title}),(0,g.jsxs)(A.View,{row:!0,gap:8,children:[(0,g.jsx)(ot.IconButton,{alt:"Delete",tooltipBehavior:"hidden",onClick:r,children:(0,g.jsx)(c2.default,{color:R.tokens.accentNegativeStronger})}),(0,g.jsx)(ot.IconButton,{alt:"Edit",tooltipBehavior:"hidden",onClick:t,children:(0,g.jsx)(c0.default,{})})]})]}),(0,g.jsx)(ez.Text,{color:"dimmest",multiline:!0,maxLines:1,children:n.body})]})]})}function c6(e){var n=e.onSubmit,t=e.onCancel,r=e.feature,i=e.isLast,o=(0,U._)((0,B.useState)((null==r?void 0:r.title)||""),2),a=o[0],s=o[1],l=(0,U._)((0,B.useState)((null==r?void 0:r.body)||""),2),u=l[0],c=l[1],d=(0,U._)((0,B.useState)((null==r?void 0:r.image)||null),2),p=d[0],f=d[1],h=a.length>=3&&u.length>=16;return(0,g.jsxs)(E.Surface,{css:[eT.rcss.flex.column,i||r?null:eT.rcss.borderRadius(8),r?eT.rcss.border({color:R.tokens.outlineDefault}):[i?null:eT.rcss.border({direction:"bottom",color:R.tokens.backgroundHighest})]],elevated:!0,children:[(0,g.jsxs)(A.View,{css:c4.newFeatureFieldWrapper,p:8,row:!0,gap:8,align:"center",justify:"space-between",children:[(0,g.jsx)(ez.Text,{children:a||"New Feature"}),(0,g.jsxs)(A.View,{row:!0,gap:8,children:[(0,g.jsx)(eW.Button,{text:"Cancel",onClick:t}),(0,g.jsx)(eW.Button,{text:r?"Save":"Create",colorway:"primary",onClick:function(){return n({title:a,body:u,image:p})},disabled:!h})]})]}),(0,g.jsxs)(A.View,{p:8,gap:8,children:[(0,g.jsxs)(A.View,{gap:4,children:[(0,g.jsxs)(A.View,{css:c4.inputCounterFlex,children:[(0,g.jsx)(ez.Text,{color:"dimmer",children:"Title"}),(0,g.jsx)(c5,{value:a.length,min:3})]}),(0,g.jsx)(cz.Input,{value:a,onChange:function(e){return s(e.target.value)},placeholder:"Seamless Editing",maxLength:60})]}),(0,g.jsxs)(A.View,{gap:4,children:[(0,g.jsxs)(A.View,{css:c4.inputCounterFlex,children:[(0,g.jsx)(ez.Text,{color:"dimmer",children:"Body"}),(0,g.jsx)(c5,{value:u.length,min:16})]}),(0,g.jsx)(cz.MultiLineInput,{value:u,onChange:function(e){return c(e.target.value)},placeholder:"Describe what this feature does and how to use it (Markdown supported)",autoSize:!0,maxLength:2e3})]}),(0,g.jsxs)(A.View,{row:!0,gap:8,children:[(0,g.jsxs)(A.View,{gap:4,grow:!0,shrink:!0,children:[(0,g.jsx)(ez.Text,{color:"dimmer",children:"Image (Recommended)"}),(0,g.jsx)(ez.Text,{color:"dimmest",multiline:!0,children:"Choose a statically-served image from your App. The Recommended aspect ratio for a cover image is 800x600."})]}),(0,g.jsx)(c9,{size:100,icon:p,editable:!0,onSubmit:function(e){f(e)}})]})]})]})}function c9(e){var n=e.size,t=e.icon,r=e.editable,i=void 0!==r&&r,o=e.onSubmit,a=(0,e2.default)().container,s=(0,e1.default)(a).url,l=s&&t?(0,e6.getAssetUrl)(s,t):null,u=(0,U._)((0,B.useState)(!1),2),c=u[0],d=u[1];return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(E.Surface,{background:"default",css:[i?ar.interactive.filledAndOutlined:null,eT.rcss.flex.row,eT.rcss.center,eT.rcss.width(n),eT.rcss.height(.75*n),eT.rcss.maxWidth(n),eT.rcss.maxHeight(.75*n),eT.rcss.borderRadius(4),eT.rcss.border({color:R.tokens.backgroundHighest}),eT.rcss.flex.grow(1),{background:l?"".concat(R.tokens.backgroundDefault," url(").concat(l,") no-repeat center center / cover"):R.tokens.backgroundDefault}],onClick:function(){return d(!0)},children:l?null:(0,g.jsx)(cY.default,{color:R.tokens.foregroundDimmest,size:24})}),i?(0,g.jsx)(cZ,{isOpen:c,close:function(){return d(!1)},onSubmit:function(e){null==o||o(e)}}):null]})}function c5(e){var n=e.value,t=e.min;return(0,g.jsxs)(ez.Text,{css:{color:n>=t?R.tokens.accentPositiveStronger:R.tokens.foregroundDimmest},children:[n,"/",t]})}var c7=e.i(316953),de="Failed to read manifest file, please try again",dn="No extension.json found",dt=function(){var e=(0,U._)((0,B.useState)(null),2),n=e[0],t=e[1],r=(0,B.useCallback)(function(e){t(function(n){if(!n)throw Error("State should be defined");return(0,e9._)((0,m._)({},n),{manifestStr:e})})},[]);return{state:n,setState:t,updateString:r}},dr=function(){var e=(0,e2.default)(),n=e.fs,t=e.dotReplit,r=dt(),i=r.state,o=r.setState,a=r.updateString,s=(0,U._)((0,B.useState)(0),2),l=s[0],u=s[1],c=(0,U._)((0,B.useState)(!1),2),d=c[0],p=c[1],f=(0,B.useCallback)(function(){return(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:return[4,(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:return[4,n.writeFile("extension.json",JSON.stringify({name:"My Extension",description:"My Extension Description",version:"0"},null,2))];case 1:return e.sent(),[2]}})})()];case 1:return e.sent(),[2]}})})()},[n]);(0,B.useEffect)(function(){o(null);var e=!1,r=function(){};return(0,ee._)(function(){var i,s,l,u,c,d,p;return(0,en._)(this,function(f){switch(f.label){case 0:return[4,Promise.all([n.listFiles(),t.getConfig()])];case 1:var g,h,m,v;if(l=(s=U._.apply(void 0,[f.sent(),2]))[0],u=s[1],e)return[2];if(!l.files||u.error)return o({fileReadError:de}),[2];if(d=(0,tc.asDir)((h="/"===(g=null!=(c=null==(i=u.config.extension)?void 0:i.outputDirectory)?c:"dist").charAt(0),m="/"===g.slice(-1),(v=(function(e,n){for(var t=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),t++):t&&(e.splice(r,1),t--)}if(n)for(;t--;)e.unshift("..");return e})(g.split("/").filter(function(e){return!!e}),!h).join("/"))||h||(v="."),v&&m&&(v+="/"),(h?"/":"")+v)),!(p=function(e){var n,t=e.filePaths,r=e.outputDir,i=[],o=!0,a=!1,s=void 0;try{for(var l,u=t[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;if("extension.json"===c)return c;c.endsWith("/extension.json")&&i.push(c)}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}var d=!0,p=!1,f=void 0;try{for(var g,h=i[Symbol.iterator]();!(d=(g=h.next()).done);d=!0){var m=g.value;if(!m.startsWith(r))return m}}catch(e){p=!0,f=e}finally{try{d||null==h.return||h.return()}finally{if(p)throw f}}return null!=(n=i[0])?n:null}({filePaths:l.files,outputDir:d})))return o({fileReadError:dn}),[2];return r=n.watchTextFile(p,{onReady:function(e){o({fileReadError:null,writeChange:e.writeChange,manifestStr:e.initialContent,manifestPath:p})},onChange:function(e){a(e.latestContent)},onMoveOrDelete:function(){o({fileReadError:"extension.json was moved or deleted, please re-create it in your static directory"})},onError:function(){o({fileReadError:de})}}),[2]}})})(),function(){r(),e=!0}},[n,a,t,l,o]);var g=(0,B.useMemo)(function(){if(!i||null!==i.fileReadError)return null;try{var e=cD.evaluate(i.manifestStr);return(0,c7.parseManifestOrError)(e)}catch(e){return{error:e,manifest:null}}},[i]),h=(0,B.useCallback)(function(e){if(!i||(null==g?void 0:g.error)||null!==i.fileReadError)throw Error("Failed to parse manifest file");var n=cD.patch(i.manifestStr,e);i.writeChange((0,cV.changeSetFromDiff)(i.manifestStr,n)),a(n)},[i,g,a]),v={retry:function(){u(function(e){return e+1})},creatingExtensionJson:d,setCreatingExtensionJson:p,createExtensionJson:f,updateString:a,updateManifest:h};return i?"string"==typeof i.fileReadError?(0,e9._)((0,m._)({},v),{__status:"fileReadError",state:{fileReadError:i.fileReadError},parsed:null}):g?g.manifest?(0,e9._)((0,m._)({},v),{__status:"success",state:{fileReadError:null,writeChange:i.writeChange,manifestStr:i.manifestStr,manifestPath:i.manifestPath},parsed:g}):(0,e9._)((0,m._)({},v),{__status:"fileParseError",state:i,parsed:{manifest:null,error:g.error}}):(0,e9._)((0,m._)({},v),{__status:"fileReadError",state:{fileReadError:dn},parsed:null}):(0,e9._)((0,m._)({},v),{__status:"loading",state:null,parsed:null})},di=((o={}).loading="loading",o.fileReadError="fileReadError",o.fileParseError="fileParseError",o.success="success",o),da=function(){return(0,g.jsx)(A.View,{css:[eT.rcss.display.flex,eT.rcss.width("100%"),eT.rcss.height("100%")],justify:"center",align:"center",children:(0,g.jsx)(oL.default,{})})},ds=e.i(837399);function dl(e){var n=e.children;return(0,g.jsx)(A.View,{gap:12,p:16,children:(0,g.jsx)(E.Surface,{elevated:!0,css:[eT.rcss.borderRadius(8),eT.rcss.colWithGap(8)],p:16,children:n})})}var du=e.i(959406),dc=e.i(442060),dd=function(e){var n=e.error,t=e.performPaneOperation,r=e.manifestPath;return(0,g.jsx)(dl,{children:(0,g.jsxs)(A.View,{gap:16,p:8,children:[(0,g.jsxs)(A.View,{row:!0,gap:8,css:[eT.rcss.display.flex,eT.rcss.align.center],children:[(0,g.jsx)(av.default,{}),(0,g.jsx)(ez.Text,{variant:"headerDefault",children:"Error parsing extension.json"})]}),(0,g.jsx)(ez.Text,{variant:"subheadDefault",children:"Details:"}),(0,g.jsx)(A.View,{gap:8,children:(0,nr._)(n,ds.TypeboxError)?n.issues.map(function(e,n){var t=e.path,r=e.message;return(0,g.jsxs)(A.View,{css:[eT.rcss.display.flex,eT.rcss.flex.row,eT.rcss.rowWithGap(4)],children:[(0,g.jsx)(ez.Text,{css:[eT.rcss.font.code,eT.rcss.color.orangeStrongest,eT.rcss.backgroundColor.orangeDimmest],children:t}),(0,g.jsx)(ez.Text,{children:r})]},n)}):(0,g.jsx)(A.View,{tag:"pre",children:n.message})}),(0,g.jsxs)(A.View,{row:!0,gap:8,children:[(0,g.jsx)(eW.Button,{colorway:"primary",text:"Open extension.json",onClick:function(){t({operation:"open",secondary:!0,pane:(0,du.getPaneForFile)(r)})}}),(0,g.jsx)(eW.Button,{iconLeft:(0,g.jsx)(dc.default,{}),text:"Read extension.json docs",onClick:function(){window.open("https://docs.replit.com/extensions/api/manifest","_blank")}})]})]})})},dp=function(e){var n=e.message,t=dr(),r=t.createExtensionJson,i=t.creatingExtensionJson,o=t.retry,a=t.setCreatingExtensionJson;return(0,g.jsxs)(dl,{children:[(0,g.jsxs)(A.View,{row:!0,gap:8,css:[eT.rcss.display.flex,eT.rcss.align.center],children:[(0,g.jsx)(av.default,{}),(0,g.jsx)(ez.Text,{variant:"subheadDefault",children:n})]}),(0,g.jsxs)(A.View,{row:!0,gap:8,children:[(0,g.jsx)(eW.Button,{colorway:"primary",text:"Create extension.json",loading:i,iconLeft:i?(0,g.jsx)(oL.default,{}):(0,g.jsx)(tS.default,{}),onClick:function(){return(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:return a(!0),[4,r()];case 1:return e.sent(),o(),a(!1),[2]}})})()}}),(0,g.jsx)(eW.Button,{text:"Retry",iconLeft:(0,g.jsx)(r0.default,{}),onClick:function(){o()}})]})]})},df=e.i(734882),dg=e.i(818660),dh=e.i(964269),dm=e.i(757390),dv=e.i(641536),dx=e.i(783437),dy=e.i(545124),db=(0,eI.cssRecord)({iconContainer:[eT.rcss.position.relative,eT.rcss.width(64),eT.rcss.height(64),{"&:hover .edit-overlay":{opacity:1}}],iconWrapper:[eT.rcss.flex.column,eT.rcss.position.absolute,eT.rcss.top(0),eT.rcss.left(0)],iconOverlay:[eT.rcss.flex.column,eT.rcss.colWithGap(4),eT.rcss.center,eT.rcss.position.absolute,eT.rcss.top(0),eT.rcss.left(0),eT.rcss.width("100%"),eT.rcss.height("100%"),eT.rcss.backgroundColor.backgroundOverlay,eT.rcss.borderRadius(12),{transition:"0.25s",opacity:0,cursor:"pointer"}]});function dw(e){var n=e.performPaneOperation,t=e.setSelectedTab,r=(0,e8.useCurrentReplExtension)(),i=(0,e8.useInstallCurrentReplAsExtension)(),o=(0,e8.useReloadExtension)(),a=(0,e8.useUnloadExtension)(),s=(0,tw.useReplExtensionId)(),l=(0,U._)((0,B.useState)(!1),2),u=l[0],c=l[1],d=(0,U._)((0,B.useState)(!1),2),p=d[0],f=d[1];return(0,g.jsx)(A.View,{css:[eT.rcss.flex.wrap,{rowGap:8}],row:!0,gap:8,children:(0,g.jsxs)(A.View,{row:!0,gap:8,children:[r||p?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(eW.Button,{size:"small",text:"Reload",iconLeft:p?(0,g.jsx)(oL.default,{}):(0,g.jsx)(r0.default,{}),disabled:p,onClick:function(){return(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:if(!r)return[2];return f(!0),[4,o(r.installationId)];case 1:return e.sent(),f(!1),[2]}})})()}}),(0,g.jsx)(eW.Button,{size:"small",text:"Unload",iconLeft:(0,g.jsx)(dx.default,{}),disabled:!r,onClick:function(){r&&a(r.installationId)}})]}):(0,g.jsx)(eW.Button,{size:"small",text:"Load locally",colorway:"primary",iconLeft:u?(0,g.jsx)(oL.default,{}):(0,g.jsx)(dm.default,{}),loading:u,onClick:function(){return(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:return c(!0),[4,i()];case 1:return e.sent(),c(!1),[2]}})})()}}),s?(0,g.jsx)(eW.Button,{size:"small",text:"View on Store",iconLeft:(0,g.jsx)(dy.default,{}),onClick:function(){return n({operation:"open",pane:{type:"extensionStore",data:{page:"cover",coverPageExtensionId:s}}})}}):null,(0,g.jsx)(eW.Button,{size:"small",text:"Edit Store Listing",onClick:function(){t("releases")},iconLeft:(0,g.jsx)(c0.default,{})})]})})}function dj(e){var n=e.performPaneOperation,t=e.setSelectedTab,r=(0,e2.default)().container,i=(0,e1.default)(r).url,o=dr(),a=o.parsed,s=o.state,l=o.__status;if(l===di.loading)return(0,g.jsx)(da,{});if(l===di.fileReadError)return(0,g.jsx)(dp,{message:s.fileReadError});var u=a.manifest,c=a.error;return c?(0,g.jsx)(dd,{performPaneOperation:n,manifestPath:s.manifestPath,error:c}):(0,g.jsx)(A.View,{gap:16,css:[eT.rcss.width("100%")],children:(0,g.jsxs)(E.Surface,{elevated:!0,css:[eT.rcss.borderRadius(8),eT.rcss.colWithGap(8)],p:12,children:[(0,g.jsxs)(A.View,{row:!0,gap:16,align:"center",children:[(0,g.jsx)(A.View,{css:[eT.rcss.display.flex,eT.rcss.flex.row],grow:0,children:(0,g.jsx)(dg.ExtensionIcon,{size:64,baseUrl:null!=i?i:null,icon:u.icon})}),(0,g.jsxs)(A.View,{grow:!0,shrink:!0,children:[(0,g.jsx)(dh.HStack,{align:"center",justify:"space-between",children:(0,g.jsx)(ez.Text,{variant:"subheadDefault",children:u.name})}),(0,g.jsx)(ez.Text,{variant:"text",color:"dimmest",children:u.description})]})]}),(0,g.jsx)(dw,{setSelectedTab:t,performPaneOperation:n})]})})}function d_(e){var n,t,r,i,o,a,s,l,u,c,d=e.manifest,p=e.onSubmit,f=e.updateManifest,h=(0,tw.useReplExtensionId)(),v=(0,eB.useCurrentUserId)(),x=(0,cW.useIdSeed)(),b=(0,U._)((0,B.useState)(null!=(s=d.name)?s:""),2),w=b[0],j=b[1],_=(0,U._)((0,B.useState)(null!=(l=d.description)?l:""),2),S=_[0],C=_[1],k=(0,U._)((0,B.useState)(null!=(u=d.longDescription)?u:void 0),2),I=k[0],T=k[1],R=(0,U._)((0,B.useState)(!1),2),P=R[0],E=R[1],D=(0,e2.default)().container,V=(0,e1.default)(D).url,O=(n={variables:{id:h||""},skip:!h},t=(0,m._)({},cU,n),y.useQuery(cB,t)),F=O.data,M=O.loading,L=O.refetch,N=(0,U._)((0,cF.useSetExtensionListedMutation)(),2),G=N[0],W=N[1].loading,z=(null==F||null==(r=F.extension)?void 0:r.__typename)==="Extension"&&(null==F||null==(i=F.extension)?void 0:i.user.id)===v,H=(null==F||null==(o=F.extension)?void 0:o.__typename)==="Extension"&&(null==F||null==(a=F.extension)?void 0:a.isListed);return(0,g.jsxs)(A.View,{tag:"form",gap:16,onSubmit:function(e){e.preventDefault(),p({name:w,description:S,longDescription:I})},children:[(0,g.jsxs)(A.View,{grow:!0,shrink:!0,gap:4,children:[(0,g.jsx)(ez.Text,{css:[eT.rcss.fontWeight.medium],children:"Do you want to publish your extension on the store?"}),M||W?(0,g.jsx)(oL.default,{}):(0,g.jsxs)(df.RadioGroup,{css:eT.rcss.colWithGap(8),name:"extensionListingStatus",value:H?"listed":"unlisted",disabled:!z,onChange:function(e){G({variables:{extensionId:h||"",isListed:"listed"===e.target.value}}).then(function(){return L()})},children:[z?null:(0,g.jsx)(A.View,{css:[eT.rcss.width("fit-content")],children:(0,g.jsx)(s5.StatusBanner,{text:"You need to release this extension before listing it.",icon:(0,g.jsx)(cH.default,{}),colorway:"yellow"})}),(0,g.jsxs)(A.View,{row:!0,gap:8,children:[(0,g.jsx)(df.Radio,{id:x("listed"),value:"listed"}),(0,g.jsx)("label",{htmlFor:x("listed"),children:"Yes, list my extension publicly on the Store"})]},"listed"),(0,g.jsxs)(A.View,{row:!0,gap:8,children:[(0,g.jsx)(df.Radio,{id:x("unlisted"),value:"unlisted"}),(0,g.jsx)("label",{htmlFor:x("unlisted"),children:"No, I want to keep my listing page private"})]},"unlisted")]})]}),(0,g.jsx)(a7.DividerH,{}),(0,g.jsxs)(A.View,{grow:!0,shrink:!0,gap:4,tag:"label",htmlFor:x("name"),children:[(0,g.jsx)(ez.Text,{children:"Extension Name"}),(0,g.jsx)(cz.Input,{id:x("name"),placeholder:"Give your extension a name",value:w,onChange:function(e){j(e.currentTarget.value)},required:!0})]}),(0,g.jsxs)(A.View,{grow:!0,shrink:!0,gap:4,children:[(0,g.jsx)(ez.Text,{children:"Extension Icon"}),(0,g.jsxs)(A.View,{row:!0,gap:12,align:"center",children:[(0,g.jsxs)(A.View,{css:db.iconContainer,children:[(0,g.jsx)(A.View,{css:db.iconWrapper,children:(0,g.jsx)(dg.ExtensionIcon,{size:64,baseUrl:null!=V?V:null,icon:d.icon})}),(0,g.jsxs)(A.View,{css:db.iconOverlay,className:"edit-overlay",tag:"label",onClick:function(){return E(!0)},children:[(0,g.jsx)(c0.default,{}),(0,g.jsx)(ez.Text,{variant:"small",children:"Edit"})]})]}),(0,g.jsx)(eW.Button,{text:"Choose from file system",iconLeft:(0,g.jsx)(dv.default,{}),onClick:function(){return E(!0)}})]})]}),(0,g.jsxs)(A.View,{grow:!0,shrink:!0,gap:4,tag:"label",htmlFor:x("tagline"),children:[(0,g.jsxs)(A.View,{gap:0,children:[(0,g.jsx)(ez.Text,{children:"Tagline"}),(0,g.jsx)(ez.Text,{color:"dimmer",variant:"small",multiline:!0,children:"Provide a short description of what your Extension is for."})]}),(0,g.jsx)(cz.Input,{id:x("tagline"),placeholder:"Give your extension a short tagline",value:S,onChange:function(e){C(e.currentTarget.value)},required:!0})]}),(0,g.jsxs)(A.View,{grow:!0,shrink:!0,gap:4,tag:"label",htmlFor:x("longDescription"),children:[(0,g.jsxs)(A.View,{gap:0,children:[(0,g.jsx)(ez.Text,{children:"Description"}),(0,g.jsx)(ez.Text,{color:"dimmer",variant:"small",multiline:!0,children:"Add more detail about the usage of your extension."})]}),(0,g.jsx)(cz.MultiLineInput,{id:x("longDescription"),placeholder:"Give your extension a long description, markdown formatting is supported",value:null!=I?I:"",onChange:function(e){T(e.currentTarget.value||void 0)},css:{resize:"vertical"},autoSize:!0})]}),(0,g.jsx)(a7.DividerH,{}),(0,g.jsx)(c8,{features:null!=(c=d.features)?c:[],onDelete:function(e){if((null==(n=d.features)?void 0:n.length)===1&&0===e){var n,t,r=(0,m._)({},d);delete r.features,f(r)}else f((0,e9._)((0,m._)({},d),{features:null==(t=d.features)?void 0:t.filter(function(n,t){return t!==e})}))},onUpdate:function(e,n){var t,r,i,o;f((0,e9._)((0,m._)({},d),{features:(0,Z._)(null!=(i=null==(t=d.features)?void 0:t.slice(0,n))?i:[]).concat([e],(0,Z._)(null!=(o=null==(r=d.features)?void 0:r.slice(n+1))?o:[]))}))},onCreate:function(e){var n;f((0,e9._)((0,m._)({},d),{features:(0,Z._)(null!=(n=d.features)?n:[]).concat([e])}))}}),(0,g.jsx)(A.View,{row:!0,gap:12,css:[{alignSelf:"end"},eT.rcss.pt(8)],children:(0,g.jsx)(eW.Button,{text:"Continue",iconRight:(0,g.jsx)(ry.default,{}),colorway:"primary",type:"submit",disabled:!w||!S||!I})}),(0,g.jsx)(cZ,{isOpen:P,close:function(){return E(!1)},onSubmit:function(e){f((0,e9._)((0,m._)({},d),{icon:e}))}})]})}function dS(e){var n=e.fileHandlers,t=e.onCreate,r=e.onUpdate,i=e.onOpen,o=e.onDelete,a=(0,U._)((0,B.useState)([]),2),s=a[0],l=a[1],u=(0,U._)((0,B.useState)(!1),2),c=u[0],d=u[1];return(0,g.jsxs)(A.View,{children:[(0,g.jsxs)(A.View,{pb:12,children:[(0,g.jsxs)(A.View,{row:!0,gap:8,align:"center",children:[(0,g.jsxs)(A.View,{row:!0,gap:8,align:"center",children:[(0,g.jsx)(tR.default,{}),(0,g.jsx)(ez.Text,{variant:"subheadDefault",multiline:!1,children:"File Handlers"})]}),(0,g.jsx)(ot.IconButton,{onClick:function(){return d(!c)},alt:"Add a new File Handler",tooltipBehavior:c?"hidden":"default",disabled:c,children:(0,g.jsx)(tS.default,{})})]}),(0,g.jsx)(ez.Text,{color:"dimmer",variant:"small",multiline:!1,children:"Custom file viewers and editors"})]}),(0,g.jsxs)(A.View,{gap:8,children:[c?(0,g.jsx)(dC,{onSubmit:function(e){t(e),d(!1)},onCancel:function(){d(!1)}}):null,n.length?n.map(function(e,n){var t;return s.includes(n)?(0,g.jsx)(dC,{initialFileHandler:e,onSubmit:function(e){r(e,n),l(function(e){return e.filter(function(e){return e!==n})})},onCancel:function(){l(function(e){return e.filter(function(e){return e!==n})})}},n):(0,g.jsxs)(E.Surface,{css:[eT.rcss.borderRadius(8),eT.rcss.flex.wrap,{rowGap:8}],p:8,row:!0,justify:"space-between",align:"center",elevated:!0,children:[(0,g.jsx)(ez.Text,{multiline:!1,children:null!=(t=e.name)?t:"Unnamed"}),(0,g.jsxs)(A.View,{row:!0,gap:12,align:"center",children:[(0,g.jsx)(ot.IconButton,{alt:"Remove ".concat(e.name||"this file handler"),colorway:"red",onClick:function(){o(n)},children:(0,g.jsx)(c2.default,{})}),(0,g.jsx)(ot.IconButton,{alt:"Edit ".concat(e.name||"this file handler"),onClick:function(){l(function(e){return(0,Z._)(e).concat([n])})},children:(0,g.jsx)(c0.default,{})}),(0,g.jsx)(eW.Button,{iconLeft:(0,g.jsx)(dv.default,{}),variant:"outlined",text:"Preview",onClick:function(){i(e)}})]})]},n)}):(0,g.jsx)(g.Fragment,{children:c?null:(0,g.jsxs)(A.View,{css:[eT.rcss.border({style:"dashed"}),eT.rcss.borderRadius(8),eT.rcss.p(16),eT.rcss.colWithGap(8),eT.rcss.center],children:[(0,g.jsx)(ez.Text,{color:"dimmest",children:"You haven't added a file handler yet"}),(0,g.jsx)(eW.Button,{variant:"outlined",text:"New File Handler",iconLeft:(0,g.jsx)(tS.default,{}),onClick:function(){return d(!0)}})]})})]})]})}function dC(e){var n,t,r,i,o=e.onSubmit,a=e.onCancel,s=e.initialFileHandler,l=(0,U._)((0,B.useState)(null!=(n=null==s?void 0:s.name)?n:""),2),u=l[0],c=l[1],d=(0,U._)((0,B.useState)(null!=(t=null==s?void 0:s.icon)?t:""),2),p=d[0],f=d[1],h=(0,U._)((0,B.useState)(null!=(r=null==s?void 0:s.handler)?r:""),2),m=h[0],v=h[1],x=(0,U._)((0,B.useState)(null!=(i=null==s?void 0:s.glob)?i:""),2),y=x[0],b=x[1],w=(0,cW.useIdSeed)();return(0,g.jsxs)(E.Surface,{css:[eT.rcss.borderRadius(8),eT.rcss.border({color:R.tokens.outlineDimmest}),eT.rcss.p(8),eT.rcss.colWithGap(8)],tag:"form",onSubmit:function(e){e.preventDefault(),o({name:u,icon:p,handler:m,glob:y})},elevated:!0,children:[(0,g.jsxs)(A.View,{css:[eT.rcss.border({color:R.tokens.outlineDimmest,direction:"bottom"}),eT.rcss.align.center,eT.rcss.flex.wrap,{rowGap:8}],row:!0,gap:2,justify:"space-between",children:[(0,g.jsx)(ez.Text,{multiline:!1,children:u||"New File Viewer"}),(0,g.jsxs)(A.View,{row:!0,gap:8,children:[(0,g.jsx)(eW.Button,{text:"Cancel",onClick:function(){a()}}),(0,g.jsx)(eW.Button,{colorway:"primary",iconLeft:(0,g.jsx)(ss.default,{}),text:"Save Changes",type:"submit"})]})]}),(0,g.jsxs)(A.View,{gap:8,children:[(0,g.jsxs)(A.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:w("name"),children:[(0,g.jsx)(ez.Text,{color:"dimmer",multiline:!1,children:"Name"}),(0,g.jsx)(cz.Input,{id:w("name"),placeholder:"SVG Editor",value:u,onChange:function(e){c(e.currentTarget.value)},required:!0})]}),(0,g.jsxs)(A.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:w("handler"),children:[(0,g.jsx)(ez.Text,{color:"dimmer",multiline:!1,children:"URL Path"}),(0,g.jsx)(cz.Input,{id:w("handler"),placeholder:"/svg-editor",value:m,onChange:function(e){v(e.currentTarget.value)},required:!0})]}),(0,g.jsxs)(A.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:w("glob"),children:[(0,g.jsx)(ez.Text,{color:"dimmer",multiline:!1,children:"Glob Pattern"}),(0,g.jsx)(cz.Input,{id:w("glob"),placeholder:"*.svg",value:y,onChange:function(e){b(e.currentTarget.value)},required:!0})]}),(0,g.jsxs)(A.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:w("icon"),children:[(0,g.jsx)(ez.Text,{color:"dimmer",multiline:!1,children:"Icon (path)"}),(0,g.jsx)(cz.Input,{id:w("icon"),placeholder:"/svg-editor-logo.png",value:p,onChange:function(e){f(e.currentTarget.value)},required:!0})]})]})]})}function dk(e){var n=e.tools,t=e.onCreate,r=e.onUpdate,i=e.onOpen,o=e.onDelete,a=(0,U._)((0,B.useState)([]),2),s=a[0],l=a[1],u=(0,U._)((0,B.useState)(!1),2),c=u[0],d=u[1];return(0,g.jsxs)(A.View,{children:[(0,g.jsxs)(A.View,{pb:12,children:[(0,g.jsxs)(A.View,{row:!0,gap:8,align:"center",children:[(0,g.jsxs)(A.View,{row:!0,gap:8,align:"center",children:[(0,g.jsx)(e_.default,{}),(0,g.jsx)(ez.Text,{variant:"subheadDefault",multiline:!1,children:"Tools"})]}),(0,g.jsx)(ot.IconButton,{onClick:function(){return d(!c)},alt:"Add a new tool",disabled:c,tooltipBehavior:c?"hidden":"default",children:(0,g.jsx)(tS.default,{})})]}),(0,g.jsx)(ez.Text,{color:"dimmer",variant:"small",multiline:!1,children:"Custom user interfaces as a Pane"})]}),(0,g.jsxs)(A.View,{gap:8,children:[c?(0,g.jsx)(dI,{onSubmit:function(e){t(e),d(!1)},onCancel:function(){d(!1)}}):null,n.length?n.map(function(e,n){var t;return s.includes(n)?(0,g.jsx)(dI,{initialTool:e,onSubmit:function(e){r(e,n),l(function(e){return e.filter(function(e){return e!==n})})},onCancel:function(){l(function(e){return e.filter(function(e){return e!==n})})}},n):(0,g.jsxs)(E.Surface,{css:[eT.rcss.borderRadius(8),eT.rcss.flex.wrap,{rowGap:8}],p:8,row:!0,justify:"space-between",align:"center",elevated:!0,children:[(0,g.jsx)(ez.Text,{multiline:!1,children:null!=(t=e.name)?t:"Unnamed"}),(0,g.jsxs)(A.View,{row:!0,gap:12,align:"center",children:[(0,g.jsx)(ot.IconButton,{alt:"Remove ".concat(e.name||"this tool"),colorway:"red",onClick:function(){o(n)},children:(0,g.jsx)(c2.default,{})}),(0,g.jsx)(ot.IconButton,{alt:"Remove ".concat(e.name||"this tool"),onClick:function(){l(function(e){return(0,Z._)(e).concat([n])})},children:(0,g.jsx)(c0.default,{})}),(0,g.jsx)(eW.Button,{iconLeft:(0,g.jsx)(iw.default,{}),variant:"outlined",text:"Preview",onClick:function(){i(e)}})]})]},n)}):(0,g.jsx)(g.Fragment,{children:c?null:(0,g.jsxs)(A.View,{css:[eT.rcss.border({style:"dashed"}),eT.rcss.borderRadius(8),eT.rcss.p(16),eT.rcss.colWithGap(8),eT.rcss.center],children:[(0,g.jsx)(ez.Text,{color:"dimmest",children:"You haven't added any tools"}),(0,g.jsx)(eW.Button,{variant:"outlined",text:"New Tool",iconLeft:(0,g.jsx)(tS.default,{}),onClick:function(){return d(!0)}})]})})]})]})}function dI(e){var n,t,r,i=e.onSubmit,o=e.onCancel,a=e.initialTool,s=(0,U._)((0,B.useState)(null!=(n=null==a?void 0:a.name)?n:""),2),l=s[0],u=s[1],c=(0,U._)((0,B.useState)(null!=(t=null==a?void 0:a.icon)?t:null),2),d=c[0],p=c[1],f=(0,U._)((0,B.useState)(null!=(r=null==a?void 0:a.handler)?r:""),2),h=f[0],m=f[1],v=(0,cW.useIdSeed)();return(0,g.jsxs)(E.Surface,{tag:"form",css:[eT.rcss.borderRadius(8),eT.rcss.border({color:R.tokens.outlineDimmest}),eT.rcss.p(8)],elevated:!0,onSubmit:function(e){e.preventDefault(),i({name:l,icon:d,handler:h})},children:[(0,g.jsxs)(A.View,{css:[eT.rcss.border({color:R.tokens.outlineDimmest,direction:"bottom"}),eT.rcss.align.center,eT.rcss.flex.wrap,{rowGap:8}],row:!0,gap:2,justify:"space-between",children:[(0,g.jsx)(ez.Text,{multiline:!1,children:l||"New Tool"}),(0,g.jsxs)(A.View,{row:!0,gap:8,children:[(0,g.jsx)(eW.Button,{text:"Cancel",onClick:function(){o()}}),(0,g.jsx)(eW.Button,{colorway:"primary",iconLeft:(0,g.jsx)(ss.default,{}),text:"Save Changes",type:"submit"})]})]}),(0,g.jsxs)(A.View,{gap:8,children:[(0,g.jsxs)(A.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:v("name"),children:[(0,g.jsx)(ez.Text,{color:"dimmer",multiline:!1,children:"Name"}),(0,g.jsx)(cz.Input,{id:v("name"),placeholder:"SQL Viewer",value:l,onChange:function(e){u(e.currentTarget.value)},required:!0})]}),(0,g.jsxs)(A.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:v("handler"),children:[(0,g.jsx)(ez.Text,{color:"dimmer",multiline:!1,children:"URL Path"}),(0,g.jsx)(cz.Input,{id:v("handler"),placeholder:"/sql",value:h,onChange:function(e){m(e.currentTarget.value)},required:!0})]}),(0,g.jsxs)(A.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:v("icon"),children:[(0,g.jsx)(ez.Text,{color:"dimmer",multiline:!1,children:"Icon (path)"}),(0,g.jsx)(cz.Input,{id:v("icon"),placeholder:"/sql-logo.png",value:null!=d?d:"",onChange:function(e){p(e.currentTarget.value||null)},required:!0})]})]})]})}function dT(e){var n,t,r=e.manifest,i=e.performPaneOperation,o=e.update,a=(0,e8.useCurrentReplExtension)(),s=(0,e8.useInstallCurrentReplAsExtension)(),l=(0,U._)((0,B.useState)(null),2),u=l[0],c=l[1];return(0,g.jsxs)(A.View,{gap:24,css:[eT.rcss.width("100%")],children:[(0,g.jsx)(dS,{onOpen:function(e){return(0,ee._)(function(){return(0,en._)(this,function(n){return c(e),[2]})})()},onDelete:function(e){var n;o((0,e9._)((0,m._)({},r),{fileHandlers:null==(n=r.fileHandlers)?void 0:n.filter(function(n,t){return t!==e})}))},onUpdate:function(e,n){var t,i,a,s;o((0,e9._)((0,m._)({},r),{fileHandlers:(0,Z._)(null!=(a=null==(t=r.fileHandlers)?void 0:t.slice(0,n))?a:[]).concat([e],(0,Z._)(null!=(s=null==(i=r.fileHandlers)?void 0:i.slice(n+1))?s:[]))}))},onCreate:function(e){var n;o((0,e9._)((0,m._)({},r),{fileHandlers:(0,Z._)(null!=(n=r.fileHandlers)?n:[]).concat([e])}))},fileHandlers:null!=(n=r.fileHandlers)?n:[]}),(0,g.jsx)(dk,{onOpen:function(e){return(0,ee._)(function(){var n,t;return(0,en._)(this,function(r){switch(r.label){case 0:if(n=a)return[3,2];return[4,s()];case 1:n=r.sent(),r.label=2;case 2:if(!n)throw Error("Expected current repl to be installed as an extension");return i({operation:"open",pane:{type:"extension",data:{extensionId:n.extensionId,installationId:n.installationId,name:null!=(t=e.name)?t:n.manifest.name,baseUrl:n.baseUrl,icon:e.icon,path:e.handler}}}),[2]}})})()},onDelete:function(e){var n;o((0,e9._)((0,m._)({},r),{tools:null==(n=r.tools)?void 0:n.filter(function(n,t){return t!==e})}))},onUpdate:function(e,n){var t,i,a,s;o((0,e9._)((0,m._)({},r),{tools:(0,Z._)(null!=(a=null==(t=r.tools)?void 0:t.slice(0,n))?a:[]).concat([e],(0,Z._)(null!=(s=null==(i=r.tools)?void 0:i.slice(n+1))?s:[]))}))},onCreate:function(e){var n;o((0,e9._)((0,m._)({},r),{tools:(0,Z._)(null!=(n=r.tools)?n:[]).concat([e])}))},tools:null!=(t=r.tools)?t:[]}),(0,g.jsx)(eR.Modal,{isOpen:!!u,onRequestClose:function(){return c(null)},children:u?(0,g.jsx)(c$,{glob:u.glob,openFile:function(e){return(0,ee._)(function(){var n,t;return(0,en._)(this,function(r){switch(r.label){case 0:if(!u)throw Error("Expected pending file handler");if(n=a)return[3,2];return[4,s()];case 1:n=r.sent(),r.label=2;case 2:if(!n)throw Error("Expected current repl to be installed as an extension");return i({operation:"open",pane:{type:"extension",data:{extensionId:n.extensionId,installationId:n.installationId,name:null!=(t=u.name)?t:n.manifest.name,baseUrl:n.baseUrl,path:(0,e6.getAssetUrl)(n.baseUrl,u.handler),filePath:e}}}),c(null),[2]}})})()}}):null})]})}var dR=e.i(952521),dP=e.i(903283),dE=e.i(452814),dA=(0,it.css)(ar.interactive.filled,eT.rcss.position.relative,eT.rcss.p(4),eT.rcss.border({color:R.tokens.outlineDimmer}),eT.rcss.backgroundColor.backgroundHigher,{"&[data-complete]":[eT.rcss.backgroundColor.backgroundDefault,{pointerEvents:"none"}],button:{overflow:"hidden",margin:-1,borderWidth:0,padding:0,width:1,height:1,background:"none",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",cursor:"pointer","&::after":{content:'""',position:"absolute",top:0,right:0,bottom:0,left:0,display:"block",cursor:"pointer",zIndex:1}}}),dD=function(e){var n=e.complete,t=e.onClick,r=e.description,i=e.title,o=e.icon;return(0,g.jsx)(A.View,{tag:"li",css:dA,"data-complete":n,children:(0,g.jsxs)(A.View,{p:4,children:[(0,g.jsxs)(A.View,{row:!0,gap:6,align:"center",children:[n?(0,g.jsx)(ss.default,{color:R.tokens.accentPositiveStrongest,size:16,css:[eT.rcss.mr(4)]}):null!=o?o:null,(0,g.jsx)(ez.Text,{variant:"small",color:n?"dimmer":"default",css:[eT.rcss.fontWeight.medium],children:i})]}),r?(0,g.jsx)(ez.Text,{color:"dimmer",variant:"small",children:r}):null,(0,g.jsx)(A.View,{children:(0,g.jsx)("button",{onClick:function(){t&&"function"==typeof t&&t()},type:"button",children:"Start"})})]})})};let dV=function(e){var n=e.setSelectedTab,t=(0,dR.useDismissibleElement)("extensions-onboarding-checklist"),r=t.isDone,i=t.setAsDone,o=(0,dR.useDismissibleElement)("extensions-onboarding-checklist-create"),a=o.isDone,s=o.setAsDone,l=(0,dR.useDismissibleElement)("extensions-onboarding-checklist-concepts"),u=l.isDone,c=l.setAsDone,d=(0,dR.useDismissibleElement)("extensions-onboarding-checklist-api"),p=d.isDone,f=d.setAsDone,h=(0,dR.useDismissibleElement)("extensions-onboarding-checklist-publish").isDone;if((0,B.useEffect)(function(){s()},[]),void 0===r||!0===r)return null;var v=[a,u,p,h].filter(Boolean).length,x=[{name:"create",title:"Create an Extension",complete:!!a,icon:(0,g.jsx)(tC.default,{})},{name:"concepts",title:"Learn key concepts",complete:!!u,onClick:function(){window.open(eL.LINKS_DOCS.EXTENSIONS,"_blank","noopener"),(0,ei.track)(eo.events.EXTENSION_USED,{action:"developer_onboarding_completed",step:"concepts"}),c()},icon:(0,g.jsx)(dP.default,{})},{name:"learn",title:"Use the API",complete:!!p,onClick:function(){window.open(eL.LINKS_DOCS.EXTENSIONS,"_blank","noopener"),(0,ei.track)(eo.events.EXTENSION_USED,{action:"developer_onboarding_completed",step:"learn"}),f()},icon:(0,g.jsx)(rP.default,{})},{name:"publish",title:"Publish your Extension",complete:!!h,onClick:function(){n("releases")},icon:(0,g.jsx)(dE.default,{})}];return(0,g.jsx)("section",{css:[eT.rcss.width("100%")],children:(0,g.jsxs)(A.View,{gap:12,children:[(0,g.jsx)(A.View,{gap:2,children:(0,g.jsxs)(A.View,{row:!0,gap:12,css:[eT.rcss.flex.wrap],align:"center",children:[(0,g.jsx)(ez.Text,{variant:"subheadDefault",children:"Get started with Extensions"}),(0,g.jsxs)(A.View,{row:!0,gap:12,align:"center",children:[(0,g.jsx)(A.View,{row:!0,gap:2,align:"center",justify:"center",children:Array.from({length:x.length}).map(function(e,n){return(0,g.jsx)(A.View,{css:[eT.rcss.borderRadius(8),eT.rcss.width(12),eT.rcss.height(4),n<v?eT.rcss.backgroundColor.accentPositiveDefault:eT.rcss.backgroundColor.backgroundHighest]},n)})}),(0,g.jsx)(ez.Text,{multiline:!1,variant:"small",color:"dimmer",children:"".concat(v,"/").concat(x.length)}),(0,g.jsx)(ot.IconButton,{alt:"Hide section",onClick:i,children:(0,g.jsx)(ic.default,{})})]})]})}),(0,g.jsx)(A.View,{tag:"ul",css:[eT.rcss.flex.wrap,{listStyleType:"none",gap:R.tokens.space8}],row:!0,children:x.map(function(e,n){return(0,g.jsx)(dD,(0,m._)({},e),n)})})]})})};var dO=e.i(530310);function dF(e){var n=e.performPaneOperation,t=e.setSelectedTab,r=dr(),i=r.__status,o=r.parsed,a=r.state,s=r.updateString;if("loading"===i)return(0,g.jsx)(da,{});if("fileReadError"===i)return(0,g.jsx)(dp,{message:(null==a?void 0:a.fileReadError)||"Unknown error"});if("fileParseError"===i){var l=o.error;return(0,g.jsx)(dd,{performPaneOperation:n,manifestPath:a.manifestPath,error:l})}var u=o.manifest;return"success"===i&&u?(0,g.jsxs)(A.View,{css:[eT.rcss.width("100%")],pt:12,gap:24,align:"center",children:[(0,g.jsx)(dj,{performPaneOperation:n,setSelectedTab:t}),(0,g.jsx)(dV,{setSelectedTab:t}),(0,g.jsx)(A.View,{css:[eT.rcss.border({direction:"bottom",width:4,color:R.tokens.outlineDimmest}),eT.rcss.width("100%")]}),(0,g.jsxs)(A.View,{gap:8,css:[eT.rcss.width("100%")],children:[(0,g.jsxs)(A.View,{gap:2,children:[(0,g.jsxs)(A.View,{row:!0,gap:8,align:"center",children:[(0,g.jsx)(dO.default,{}),(0,g.jsx)(ez.Text,{variant:"subheadDefault",multiline:!1,children:"Permission Scopes"})]}),(0,g.jsxs)(ez.Text,{variant:"small",color:"dimmer",children:["Let users know what your Extension can do with their data. For more information,"," ",(0,g.jsx)("a",{href:eL.LINKS_DOCS.EXTENSIONS+"/api/manifest#scopetype",target:"_blank",rel:"noopener",children:"read the docs"}),"."]})]}),(0,g.jsx)(A.View,{css:[eT.rcss.borderRadius(4),eT.rcss.border({color:R.tokens.outlineDimmest,width:1}),eT.rcss.flex.row,eT.rcss.align.center,eT.rcss.p(8),eT.rcss.flex.wrap,{gap:12},eT.rcss.width("fit-content")],children:cO.scopes.map(function(e){var n;return(0,g.jsxs)(A.View,{row:!0,gap:6,align:"center",children:[(0,g.jsx)(tI.Checkbox,{id:e.key,checked:null==(n=u.scopes)?void 0:n.some(function(n){return n.name===e.key}),onChange:function(n){var t,r,i,o=(null==(t=u.scopes)?void 0:t.some(function(n){return n.name===e.key}))&&!n?cD.patch(a.manifestStr,(0,e9._)((0,m._)({},u),{scopes:null==(r=u.scopes)?void 0:r.filter(function(n){return n.name!==e.key})})):cD.patch(a.manifestStr,(0,e9._)((0,m._)({},u),{scopes:(0,Z._)(null!=(i=u.scopes)?i:[]).concat([{name:e.key,reason:e.description}])}));a.writeChange((0,cV.changeSetFromDiff)(a.manifestStr,o)),s(o)}}),(0,g.jsx)("label",{htmlFor:e.key,css:[eT.rcss.fontSize(12),eT.rcss.cursor.pointer],children:(0,g.jsx)("abbr",{title:e.description,css:[{textDecorationColor:R.tokens.foregroundDimmest}],children:e.friendlyName})})]},e.key)})})]}),(0,g.jsx)(dT,{performPaneOperation:n,manifest:u,update:function(e){var n=cD.patch(a.manifestStr,e);a.writeChange((0,cV.changeSetFromDiff)(a.manifestStr,n)),s(n)}})]}):(0,g.jsx)("div",{children:"unknown state"})}var dM=e.i(221250),dL=e.i(542101),dU=e.i(109853),dB=e.i(410793),dN=e.i(598160),dG=(0,eI.cssRecord)({logViewerTopLevel:[eT.rcss.height("100%")],logsContainer:[eT.rcss.scrollbar.thin,eT.rcss.backgroundColor.backgroundDefault,eT.rcss.overflowY("scroll"),eT.rcss.flex.growAndShrink(1)],logViewerHeader:[eT.rcss.border({direction:"bottom",width:R.tokens.borderWidthDefault}),eT.rcss.display.flex,eT.rcss.flex.row,eT.rcss.rowWithGap(8),eT.rcss.align.center],logViewerHeaderControl:[eT.rcss.flex.row,eT.rcss.rowWithGap(4),eT.rcss.align.center],logLine:[eT.rcss.font.code,ar.interactive.listItem,eT.rcss.rowWithGap(2),eT.rcss.align.center],logLineIcon:[{alignSelf:"flex-start"}],logMessage:{flex:"1 1 0"}});function dW(e){var n=e.log,t=e.prevLevel,r=e.isLast,i=e.isFirst,o=(0,U._)((0,B.useState)(!1),2),a=o[0],s=o[1],l=(0,dL.default)().ref;return(0,g.jsxs)(A.View,{css:[eT.rcss.flex.column,function(e){if(e===dB.LogLevel.warn)return{color:R.tokens.yellowStronger,background:"rgba(150, 125, 0, 0.2)",borderTop:i?void 0:"1px solid rgba(150, 125, 0, 0.5)",borderBottom:r?"1px solid rgba(150, 125, 0, 0.5)":void 0,"& .cm-gutter":{backgroundColor:"rgba(150, 125, 0, 0.2)"}};if(e===dB.LogLevel.error)return{color:R.tokens.accentNegativeStronger,backgroundColor:"rgba(229, 34, 34, 0.2)",borderTop:i?void 0:"1px solid rgba(229, 34, 34, 0.5)",borderBottom:r?"1px solid rgba(229, 34, 34, 0.5)":void 0,"& .cm-gutter":{backgroundColor:"rgba(229, 34, 34, 0.2)"}};var n=R.tokens.backgroundHigher;return t===dB.LogLevel.warn?n="rgba(150, 125, 0, 0.5)":t===dB.LogLevel.error&&(n="rgba(229, 34, 34, 0.5)"),{color:R.tokens.foregroundDefault,borderTop:i?void 0:"1px solid ".concat(n),borderBottom:r?"1px solid ".concat(n):void 0}}(n.logLevel)],children:[(0,g.jsxs)(A.View,{css:dG.logLine,p:2,onClick:function(){return s(function(e){return!e})},children:[(0,g.jsx)(A.View,{css:dG.logLineIcon,p:4,children:(0,g.jsx)(function(){return n.logLevel===dB.LogLevel.warn?(0,g.jsx)(av.default,{size:16}):n.logLevel===dB.LogLevel.error?(0,g.jsx)(dN.default,{size:16}):(0,g.jsx)(cH.default,{size:16,css:{opacity:0}})},{})}),(0,g.jsx)(ez.Text,{maxLines:10,css:dG.logMessage,variant:"small",children:n.message}),a?(0,g.jsx)(s7.default,{size:16}):(0,g.jsx)(sp.default,{size:16})]}),a?(0,g.jsx)(A.View,{children:(0,g.jsx)(dM.default,{ref:l,css:dU.CodeMirrorEditorStyleEditorContainer,noHistory:!0,readOnly:!0,lineWrapping:!0,language:"json",fontSize:12,initialDoc:JSON.stringify(n,null,2)})}):null]})}let dz=function(){var e=(0,tv.useExtAtomValue)(e4.filteredLogsAtom),n=(0,tv.useSetExtAtom)(e4.clearLogsAtom),t=(0,U._)((0,tv.useExtAtom)(e4.logFilterQueryAtom),2),r=t[0],i=t[1],o=(0,B.useRef)(null);return(0,B.useEffect)(function(){var e,n=o.current;n&&(null==(e=n.children[n.children.length-1])||e.scrollIntoView({behavior:"smooth"}))},[e]),(0,g.jsxs)(A.View,{css:dG.logViewerTopLevel,children:[(0,g.jsxs)(A.View,{className:"log-viewer-header",css:dG.logViewerHeader,p:8,children:[(0,g.jsx)(A.View,{css:dG.logViewerHeaderControl,style:{flexGrow:1},children:(0,g.jsx)(cz.Input,{type:"search",placeholder:"Filter logs",value:null!=r?r:"",onChange:function(e){return i(e.target.value)}})}),(0,g.jsxs)(A.View,{css:dG.logViewerHeaderControl,children:[(0,g.jsx)(ot.IconButton,{alt:"Clear logs",onClick:function(){return n()},children:(0,g.jsx)(ic.default,{id:"clear-logs"})}),(0,g.jsx)("label",{htmlFor:"clear-logs",children:"Clear logs"})]})]}),(0,g.jsx)(A.View,{css:dG.logsContainer,innerRef:o,children:e.map(function(n,t){var r;return(0,g.jsx)(dW,{log:n,prevLevel:null==(r=e[t-1])?void 0:r.logLevel,isFirst:0===t,isLast:t===e.length-1},n.index)})})]})};var dH=e.i(613141);function dq(){var e=(0,v._)(["\n  subscription ExtensionBuildLogs($extensionId: String!) {\n    extensionBuildDeployActionUpdates(input: { extensionId: $extensionId }) {\n      ... on ExtensionBuildDeployLogAction {\n        log\n      }\n      ... on ExtensionBuildDeployStatusAction {\n        status\n        message\n        build {\n          id\n        }\n      }\n    }\n  }\n"]);return dq=function(){return e},e}function dK(){var e=(0,v._)(["\n  mutation DeployExtension2(\n    $extensionId: String!\n    $replId: String!\n    $outputDirectory: String!\n    $buildCommand: String!\n  ) {\n    deployExtension2(\n      extensionId: $extensionId\n      replId: $replId\n      outputDirectory: $outputDirectory\n      buildCommand: $buildCommand\n    ) {\n      ... on Extension {\n        ...TopLevelExtension\n      }\n      ... on TooManyRequestsError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return dK=function(){return e},e}function d$(){var e=(0,v._)(["\n  query Publish2Extension($extensionId: String!) {\n    extension(id: $extensionId) {\n      ... on Extension {\n        id\n        user {\n          id\n          username\n        }\n        name\n        description\n        canDeployExtension\n      }\n      ... on NotFoundError {\n        message\n      }\n    }\n  }\n"]);return d$=function(){return e},e}function dQ(){var e=(0,v._)(["\n  mutation CreateExtension($name: String!, $description: String!) {\n    createExtension(name: $name, description: $description) {\n      ... on Extension {\n        id\n        url\n      }\n      ... on UserError {\n        message\n      }\n      ... on TooManyRequestsError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return dQ=function(){return e},e}function dY(){var e=(0,v._)(["\n  mutation UpdateExtension(\n    $extensionId: String!\n    $name: String\n    $description: String\n  ) {\n    updateExtension(\n      extensionId: $extensionId\n      name: $name\n      description: $description\n    ) {\n      ... on Extension {\n        id\n        name\n        description\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return dY=function(){return e},e}var dJ={},dX=(0,x.gql)(dq()),dZ=(0,x.gql)(dK(),eO.TopLevelExtensionFragmentDoc),d0=(0,x.gql)(d$()),d1=(0,x.gql)(dQ()),d2=(0,x.gql)(dY()),d4=e.i(322823);e.i(713984);var d8=e.i(966036),d3=e.i(883021),d6=A.SpecializedView.button,d9=((a={}).Pending="pending",a.Active="active",a.Complete="complete",a.Error="error",a),d5=function(){return(0,g.jsx)(A.View,{css:[eT.rcss.border({color:R.tokens.outlineDimmest,direction:"top"})],grow:!0,row:!0})},d7=function(e){var n=e.text,t=e.size,r=void 0===t?"default":t,i=e.state,o=e.onClick,a=e.disabled,s=e.hideLoadingIcon,l=(0,eW.getTextVariant)(r),u=(0,eW.getIconSize)(r);return(0,g.jsx)(d6,{type:"button",css:[eT.rcss.reset.button,eT.rcss.position.relative,o&&ar.interactive.nofill,eT.rcss.px(8),eT.rcss.py(2),eT.rcss.borderRadius(4),eT.rcss.rowWithGap(4),eT.rcss.align.center,{borderRadius:R.tokens.borderRadiusRound}].concat((0,Z._)("error"===i?[eT.rcss.color.accentNegativeStronger]:"active"===i?[eT.rcss.backgroundColor.accentPrimaryDimmer,eT.rcss.color.accentPrimaryStrongest]:"complete"===i?[eT.rcss.color.accentPositiveStronger]:[eT.rcss.color.foregroundDimmest])),onClick:o,disabled:a,children:(0,g.jsx)(eW.ButtonContent,{text:n,iconSize:u,textVariant:l,iconRight:function(){if("error"===i)return(0,g.jsx)(av.default,{});if("active"===i){if(s)return;return(0,g.jsx)(oL.default,{})}return"complete"===i?(0,g.jsx)(ss.default,{}):(0,g.jsx)(dO.default,{})}()})})},pe=e.i(210481),pn=e.i(818976),pt=e.i(972882),pr=e.i(525212),pi=((s=pi||{}).Details="Details",s.Init="Init",s.CreatingExtension="CreatingExtension",s.CreatingExtensionError="CreatingExtensionError",s.Queued="Queued",s.Deploying="Deploying",s.DeployError="DeployError",s.Success="Success",s),po=["CreatingExtension","Deploying"],pa=((l=pa||{}).Details="Details",l.Init="Configure",l.Create="Create",l.Deploy="Deploy",l),ps=["Details","Configure","Deploy"];function pl(e){var n,t,r,i,o,a=e.performPaneOperation,s=(0,e2.default)(),l=s.container,u=s.fs,c=s.dotReplit,d=(0,U._)((n=(0,m._)({},dJ,void 0),b.useLazyQuery(d0,n)),1)[0],p=(0,dR.useDismissibleElement)("extensions-onboarding-checklist-".concat("publish")).setAsDone,f=(0,U._)((0,B.useState)(null),2),h=f[0],v=f[1],x=(0,U._)((0,B.useState)("Details"),2),y=x[0],w=x[1],j=(0,U._)((0,B.useState)(null),2),_=j[0],S=j[1],C=dr(),k=C.__status,I=C.parsed,T=C.state,P=C.updateManifest,D=(0,d4.useFormField)("",function(e){return e?e.startsWith("/")?{message:'Folder must be relative to the root of your project (e.g. "extension" or "./extension")',severity:"error"}:null:{message:"Output folder is required",severity:"error"}}),V=D.value,O=D.setValue,F=D.error,M=D.validate,L=(0,U._)((0,B.useState)([]),2),N=L[0],G=L[1],W=(0,B.useCallback)(function(e){return a({operation:"open",secondary:!0,pane:{type:(0,ec.getPaneTypeForFile)(e),data:e}})},[a]),z=(0,U._)((0,pe.default)({openFile:W,listFiles:u.listFiles}),2),H=z[0],q=z[1],K=(0,pn.useTerminalTheme)();t=(0,m._)({},dJ,{variables:{extensionId:null!=h?h:""},onData:function(e){var n=e.data;if(n.data&&!n.error){var t=n.data.extensionBuildDeployActionUpdates;"ExtensionBuildDeployLogAction"===t.__typename&&G(function(e){return(0,Z._)(e).concat((0,Z._)(t.log))}),"ExtensionBuildDeployStatusAction"===t.__typename&&(t.status===rq.HostingBuildStatus.Success?w("Success"):t.status===rq.HostingBuildStatus.Failed&&w("DeployError"))}},skip:"Deploying"!==y||!h}),dH.useSubscription(dX,t),(0,B.useEffect)(function(){H&&(H.clear(),N.forEach(function(e){H.write(e.replaceAll("\n","\r\n"))}))},[N,H]);var $=(0,B.useCallback)(function(e){if(null==e?void 0:e.config){var n=e.config.extension;if(!n||!1===n.isExtension){v(null),S(null),O(null);return}n.buildCommand&&S(n.buildCommand),n.outputDirectory&&O(n.outputDirectory),n.extensionID&&v(n.extensionID)}},[O]);(0,B.useEffect)(function(){var e=!1;return(0,ee._)(function(){var n;return(0,en._)(this,function(t){switch(t.label){case 0:return[4,c.getConfig()];case 1:if(n=t.sent(),e)return[2];return $(n),[2]}})})(),function(){e=!0}},[c,$]);var Q=(0,B.useCallback)(function(e){return(0,ee._)(function(){return(0,en._)(this,function(n){switch(n.label){case 0:return v(e),[4,c.updateDotReplit([{op:"add",path:"extension/extensionID",value:JSON.stringify(e)},{op:"add",path:"extension/isExtension",value:JSON.stringify(!0)}])];case 1:return n.sent(),[2]}})})()},[c]),Y=(0,B.useCallback)(function(e){return(0,ee._)(function(){return(0,en._)(this,function(n){switch(n.label){case 0:return S(e),[4,c.updateDotReplit([{op:"add",path:"extension/buildCommand",value:JSON.stringify(e)},{op:"add",path:"extension/isExtension",value:JSON.stringify(!0)}])];case 1:return n.sent(),[2]}})})()},[c]),J=(0,U._)((0,B.useState)(null),2),X=J[0],et=J[1],er=(0,U._)((0,B.useState)(null),2),ea=er[0],es=er[1],el=(0,U._)((0,B.useState)(null),2),eu=el[0],ed=el[1],ep=(0,U._)((0,B.useState)(null),2),ef=ep[0],eg=ep[1],eh=(0,U._)((0,B.useState)(null),2),em=eh[0],ev=eh[1],ex=(0,U._)((r=(0,m._)({},dJ,void 0),sL.useMutation(dZ,r)),1)[0],ey=(0,eN.default)(),eb=(0,U._)((i=(0,m._)({},dJ,void 0),sL.useMutation(d1,i)),1)[0],ew=(0,U._)((0,B.useState)(null),2),ej=ew[0],e_=ew[1],eS=(0,B.useCallback)(function(e){var n=e.name,t=e.description;return(0,ee._)(function(){var e,r,i;return(0,en._)(this,function(o){switch(o.label){case 0:return[4,eb({variables:{name:n,description:t}})];case 1:if((r=o.sent()).errors)return[2,{error:r.errors.map(function(e){return e.message}).join(", "),result:null}];if(!(i=null==(e=r.data)?void 0:e.createExtension))return[2,{error:"Failed to create extension",result:null}];if("TooManyRequestsError"===i.__typename||"UserError"===i.__typename||"UnauthorizedError"===i.__typename)return[2,{error:"Failed to create extension: "+i.message,result:null}];if("Extension"===i.__typename)return[2,{error:null,result:i}];throw Error("Unexpected response from createExtension mutation")}})})()},[eb]),eC=(0,U._)((o=(0,m._)({},dJ,void 0),sL.useMutation(d2,o)),1)[0],ek=(0,B.useCallback)(function(){return(0,ee._)(function(){var e,n,t,r,i,o,a,s,c,f,g,m,v,x,y,b,j,S;return(0,en._)(this,function(C){switch(C.label){case 0:return e=h,[4,M()];case 1:if(null==(n=C.sent())?void 0:n.message)return ed(null==n?void 0:n.message),[2];if(!V)throw Error("expected output folder");return t=(0,tc.normalizePath)(V),(r=function(){w("Init"),G([]),ev(null),ed(null),es(null),et(null)})(),[4,u.flush()];case 2:if(C.sent(),!e)return[3,11];return[4,d({variables:{extensionId:e}})];case 3:if((i=C.sent()).error||!i.data)throw Error("Encountered an unknown error. Please contact support.");if((null==(o=i.data.extension)?void 0:o.__typename)!=="NotFoundError")return[3,5];return[4,new Promise(function(n){e_({message:"The extension referenced in .replit (".concat(e,") does not exist. Would you like to create a new extension?"),callback:function(e){e_(null),n(e)}})})];case 4:case 6:if(!C.sent())return r(),[2];return e=null,[3,11];case 5:if(!((null==o?void 0:o.__typename)==="Extension"&&!o.canDeployExtension))return[3,7];return[4,new Promise(function(n){e_({message:"You do not have the permissions to deploy the extension referenced in .replit (".concat(e,"). Would you like to create a new extension?"),callback:function(e){e_(null),n(e)}})})];case 7:if(!((null==o?void 0:o.__typename)==="Extension"&&o.canDeployExtension))return[3,10];if(c=null==I||null==(a=I.manifest)?void 0:a.name,f=null==I||null==(s=I.manifest)?void 0:s.description,!(c&&c!==o.name||f&&f!==o.description))return[3,9];return[4,eC({variables:{extensionId:e,description:null!=f?f:void 0,name:null!=c?c:void 0}})];case 8:C.sent(),C.label=9;case 9:return[3,11];case 10:throw Error("Encountered an unknown error. Please contact support.");case 11:if(e)return[3,13];return w("CreatingExtension"),[4,eS({name:null!=(v=null==I||null==(g=I.manifest)?void 0:g.name)?v:"My extension",description:null!=(x=null==I||null==(m=I.manifest)?void 0:m.description)?x:"My extension's description"})];case 12:if(null!==(y=C.sent()).error)return w("CreatingExtensionError"),eg(y.error),[2];Q(e=y.result.id),C.label=13;case 13:var k;if(!e)throw Error("expected extension id to be set");return[4,(k=t,new Promise(function(e){var n=l.openChannel({service:"gcsfiles"},function(t){return t.channel.request({persistMirror:{path:k}}).then(function(t){t.ok,n(),e()}),function(e){e.willReconnect&&n()}})}))];case 14:C.sent(),w("Queued"),C.label=15;case 15:return C.trys.push([15,17,,18]),[4,ex({variables:{extensionId:e,replId:ey,outputDirectory:t,buildCommand:null!=_?_:""}})];case 16:return b=C.sent(),[3,18];case 17:if(j=C.sent(),w("DeployError"),j.message.includes("received message larger than max"))return ev("Your extension's size is too large. Please compress assets or remove files, and try again."),[2];return ev(j.message),[2];case 18:if(b.errors)return w("DeployError"),ev("Internal error. Please contact support: "+b.errors.map(function(e){return e.message}).join(", ")),[2];if(!b.data)return w("DeployError"),ev("Encountered an unknown error. Please contact support."),[2];if("Extension"===(S=b.data.deployExtension2).__typename)return w("Deploying"),p(),(0,ei.track)(eo.events.EXTENSION_USED,{action:"developer_onboarding_completed",step:"publish"}),et(S),[2];if("message"in S)return w("DeployError"),ev(S.message),[2];return w("DeployError"),ev("Encountered an unknown error. Please contact support."),[2]}})})()},[_,l,V,M,ey,u,w,ex,d,eC,h,eS,Q,p,I]),eI=function(e){switch(e){case"Details":default:return"Details";case"Init":return"Configure";case"CreatingExtension":case"CreatingExtensionError":return"Create";case"Queued":case"Deploying":case"DeployError":return"Deploy"}}(y),eR=ps.indexOf(eI);function eP(){return ea?"Build error: ".concat(ea):eu?"Validation error: ".concat(eu):eu?"Create extension error: ".concat(ef):em?"Deploy error: ".concat(em):void 0}var eE=(0,e4.useExtensions)().find(function(e){return e.extensionId===h}),eA=(0,U._)((0,B.useState)(!1),2),eD=eA[0],eV=eA[1],eO=(0,e8.useInstallExtension)(),eF=(0,B.useMemo)(function(){return eD?(0,g.jsx)(oL.default,{}):eE?(0,g.jsx)(ss.default,{}):(0,g.jsx)(dm.default,{})},[eD,eE]),eM=(0,tx.useTheme)().values.global,eB=(0,d3.useConfetti)().fireBurst,eG=(0,U._)((0,B.useState)(!1),2),eH=eG[0],eq=eG[1],eK=(0,B.useRef)(null);if((0,B.useEffect)(function(){eK.current&&!eH&&"Success"===y&&(eB({x:eK.current.getBoundingClientRect().left,y:eK.current.getBoundingClientRect().top,heading:-45,numParticles:160,lifetime:1,spread:80,velocity:function(){return(0,d8.randNum)(300,5e3)},size:function(){return{width:(0,d8.randNum)(8,16),height:(0,d8.randNum)(8,16)}},color:[eM.tealStronger,eM.blurpleStronger,eM.yellowStronger]}),eB({x:eK.current.getBoundingClientRect().right,y:eK.current.getBoundingClientRect().top,heading:225,numParticles:160,lifetime:1,velocity:function(){return(0,d8.randNum)(300,5e3)},size:function(){return{width:(0,d8.randNum)(8,16),height:(0,d8.randNum)(8,16)}},color:[eM.blueStronger,eM.greenStronger,eM.pinkStronger]}),eq(!0))},[y,eM,eB,eH]),k===di.loading)return(0,g.jsx)(da,{});if(k===di.fileReadError)return(0,g.jsx)(dp,{message:T.fileReadError});var e$=I.manifest,eQ=I.error;return eQ?(0,g.jsx)(dd,{performPaneOperation:a,manifestPath:T.manifestPath,error:eQ}):(0,g.jsxs)(A.View,{css:[eT.rcss.flex.column,eT.rcss.display.flex,eT.rcss.height("100%"),eT.rcss.justify.center,eT.rcss.align.center,eT.rcss.position.relative],children:[(0,g.jsx)(A.View,{css:[eT.rcss.position.absolute,eT.rcss.top(0),eT.rcss.left(0),eT.rcss.right(0)],className:"Confetti",innerRef:eK}),(0,g.jsxs)(A.View,{css:[eT.rcss.width("100%"),eT.rcss.maxWidth(cA.PANE_CONTENT_MAX_WIDTH)],grow:!0,shrink:!0,p:12,pt:16,gap:24,children:["Success"!==y?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(A.View,{gap:16,children:[(0,g.jsx)(ez.Text,{variant:"subheadBig",multiline:!0,children:"Create a new release"}),(0,g.jsx)(A.View,{row:!0,gap:4,align:"center",children:ps.map(function(e,n){var t;return(0,g.jsxs)(B.Fragment,{children:[0!==n&&(0,g.jsx)(d5,{}),(0,g.jsx)(d7,{state:(t=n)<eR?d9.Complete:t!==eR?d9.Pending:["CreatingExtensionError","DeployError"].includes(y)?d9.Error:d9.Active,text:e,hideLoadingIcon:"Configure"===e||"Details"===e})]},e)})})]}),"Details"===y?(0,g.jsx)(A.View,{css:[eT.rcss.flex.column,eT.rcss.colWithGap(8),eT.rcss.width("100%")],children:(0,g.jsx)(d_,{manifest:e$,updateManifest:P,onSubmit:function(e){P((0,m._)({},e$,e)),w("Init")}})}):null,"Details"!==y?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(A.View,{gap:16,children:[(0,g.jsxs)(A.View,{row:!0,gap:8,align:"center",children:[(0,g.jsx)(aB.default,{}),(0,g.jsx)(ez.Text,{variant:"subheadDefault",children:"Build settings"}),(0,g.jsx)(A.View,{css:[eT.rcss.border({color:R.tokens.backgroundHighest,direction:"y"})],grow:!0})]}),(0,g.jsxs)(A.View,{gap:4,children:[(0,g.jsxs)("label",{htmlFor:"buildCommand",css:[eT.rcss.display.flex,eT.rcss.rowWithGap(4),eT.rcss.align.center],children:[(0,g.jsx)(ez.Text,{color:"dimmer",variant:"small",children:"Build command (optional)"}),(0,g.jsx)(o5.Tooltip,{tooltip:"This is the command that compiles your app at build time. Leave it blank if you don't need to build your app.",children:(0,g.jsx)(cH.default,{size:12})})]}),(0,g.jsx)(cz.Input,{value:null!=_?_:"",onChange:function(e){return Y(e.target.value)},placeholder:"Example: npm run build",disabled:"Init"!==y&&po.includes(y)})]}),(0,g.jsxs)(A.View,{gap:4,children:[(0,g.jsxs)("label",{htmlFor:"outputFolder",css:[eT.rcss.display.flex,eT.rcss.rowWithGap(4),eT.rcss.align.center],children:[(0,g.jsx)(ez.Text,{color:"dimmer",variant:"small",children:"Output folder"}),(0,g.jsx)(o5.Tooltip,{tooltip:"This is where your build will live. There must be an extension.json file in this folder.",children:(0,g.jsx)(cH.default,{size:12})})]}),(0,g.jsx)(cz.Input,{id:"outputFolder",value:null!=V?V:"",disabled:"Init"!==y&&po.includes(y),onChange:function(e){O(e.currentTarget.value),c.updateDotReplit([{op:"add",path:"extension/outputDirectory",value:JSON.stringify(e.currentTarget.value)},{op:"add",path:"extension/isExtension",value:JSON.stringify(!0)}])},placeholder:"./extension"}),F?(0,g.jsx)(ez.Text,{css:[eT.rcss.color.accentNegativeStronger],children:F.message}):null]}),(0,g.jsx)(eW.Button,{text:"Init"===y||y.endsWith("Error")?"Deploy and Release":"Deployingâ€¦",iconLeft:"Init"===y||y.endsWith("Error")?(0,g.jsx)(aU.default,{}):(0,g.jsx)(oL.default,{}),onClick:ek,disabled:"Init"!==y&&po.includes(y),colorway:"primary"}),(0,g.jsxs)(ez.Text,{multiline:!0,variant:"small",color:"dimmer",children:["By releasing an Extension, you agree to the"," ",(0,g.jsx)("a",{href:eL.LINKS_LEGAL.EXTENSIONS_DEVELOPER_TERMS,children:"Developer Terms"})]})]}),N.length>0?(0,g.jsxs)(A.View,{gap:8,children:[(0,g.jsxs)(A.View,{row:!0,gap:8,align:"center",children:[(0,g.jsx)(pr.default,{}),(0,g.jsx)(ez.Text,{variant:"subheadDefault",children:"Build logs"}),(0,g.jsx)(A.View,{css:[eT.rcss.border({color:R.tokens.backgroundHighest,direction:"y"})],grow:!0})]}),eP()?(0,g.jsx)(s5.StatusBanner,{text:eP(),colorway:"red",icon:(0,g.jsx)(dN.default,{})}):null,(0,g.jsx)(A.View,{css:[eT.rcss.display.flex,eT.rcss.py(12),eT.rcss.pl(16),eT.rcss.borderRadius(8),eT.rcss.overflow("hidden"),{border:"1px solid ".concat(R.tokens.outlineDimmest),backgroundColor:null==K?void 0:K.background}],children:(0,g.jsx)(A.SpecializedView.div,{css:[eT.rcss.width("100%"),eT.rcss.maxWidth("100%")],ref:q})})]}):null,ej?(0,g.jsxs)(E.Surface,{elevated:!0,css:[eT.rcss.borderRadius(8)],p:8,gap:8,children:[(0,g.jsx)(ez.Text,{variant:"text",multiline:!0,maxLines:3,children:ej.message}),(0,g.jsxs)(A.View,{row:!0,gap:4,align:"center",children:[(0,g.jsx)(eW.Button,{text:"No",css:[eT.rcss.flex.grow(1)],onClick:function(){return ej.callback(!1)}}),(0,g.jsx)(eW.Button,{text:"Yes",colorway:"primary",css:[eT.rcss.flex.grow(1)],onClick:function(){return ej.callback(!0)}})]})]}):null]}):null]}):null,X&&"Success"===y?(0,g.jsxs)(A.View,{gap:16,children:[(0,g.jsxs)(A.View,{gap:4,children:[(0,g.jsx)(ez.Text,{variant:"subheadBig",multiline:!1,children:"Congratulations!"}),(0,g.jsx)(ez.Text,{color:"dimmer",multiline:!1,children:"You just published a new release to the Extensions Store."})]}),(0,g.jsx)(A.View,{py:8,children:(0,g.jsx)(pt.ExtensionCard,{showMetadata:!1,extension:X,onClick:function(){a({operation:"open",pane:{type:"extensionStore",data:{page:"cover",coverPageExtensionId:(0,eU.asExtensionId)(X.id)}}})}})}),(0,g.jsxs)(A.View,{row:!0,gap:8,align:"center",children:[(0,g.jsx)(dP.default,{}),(0,g.jsx)(ez.Text,{variant:"subheadDefault",multiline:!1,children:"Next steps"}),(0,g.jsx)(A.View,{css:[eT.rcss.border({color:R.tokens.backgroundHighest,direction:"y"})],grow:!0})]}),(0,g.jsxs)(A.View,{css:[eT.rcss.border({color:R.tokens.outlineDimmest}),eT.rcss.borderRadius(8)],p:12,gap:8,children:[(0,g.jsx)(ez.Text,{variant:"subheadDefault",children:"Install your Extension"}),(0,g.jsx)(ez.Text,{color:"dimmer",children:"Once installed, you can use the extension in any of your Apps."}),(0,g.jsx)(eW.Button,{text:eE?"Already installed":"Install Extension",colorway:eE?"green":"primary",disabled:eD||!!eE,iconLeft:eF,loading:eD,onClick:function(){return(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:return eV(!0),[4,eO({extensionId:(0,eU.asExtensionId)(X.id),replId:null})];case 1:return e.sent(),eV(!1),[2]}})})()}})]})]}):null]})]})}var pu=e.i(628796),pc=e.i(618497);function pd(e){var n=e.performPaneOperation,t=(0,U._)((0,B.useState)("home"),2),r=t[0],i=t[1];return(0,g.jsx)(A.View,{css:[eT.rcss.flex.column,eT.rcss.height("100%"),eT.rcss.position.relative],children:(0,g.jsx)("div",{css:[eT.rcss.flex.grow(1),eT.rcss.flex.column,eT.rcss.align.center,eT.rcss.display.flex,eT.rcss.overflow("hidden")],children:(0,g.jsxs)(pu.Tabs,{selectedKey:r,onSelectionChange:function(e){return i(e)},children:[(0,g.jsx)(E.Surface,{css:[eT.rcss.top(0),eT.rcss.width("100%"),eT.rcss.zIndex(1)],align:"center",children:(0,g.jsxs)(pu.TabList,{css:[eT.rcss.align.center,eT.rcss.width("100%"),eT.rcss.pb(0),eT.rcss.maxWidth(cA.PANE_CONTENT_MAX_WIDTH)],children:[(0,g.jsx)(pu.Tab,{id:"home",css:[eT.rcss.p(12),eT.rcss.height("100%"),eT.rcss.borderRadius(0)],iconLeft:(0,g.jsx)(ln.default,{}),children:"Home"}),(0,g.jsx)(pu.Tab,{id:"releases",css:[eT.rcss.p(12),eT.rcss.height("100%"),eT.rcss.borderRadius(0)],iconLeft:(0,g.jsx)(pc.default,{}),children:"Releases"}),(0,g.jsx)(pu.Tab,{id:"logs",css:[eT.rcss.p(12),eT.rcss.height("100%"),eT.rcss.borderRadius(0)],iconLeft:(0,g.jsx)(dN.default,{}),children:"Logs"}),(0,g.jsx)(A.View,{grow:!0}),(0,g.jsx)(E.Surface,{css:[{boxShadow:"inset 0 -1px 0 ".concat(R.tokens.outlineDimmest)}],p:8,children:(0,g.jsx)(a5.ButtonLink,{text:"Docs",href:eL.LINKS_DOCS.EXTENSIONS,target:"_blank",rel:"noopener",variant:"outlined",size:"small",iconLeft:(0,g.jsx)(dc.default,{}),css:[eT.rcss.display.inlineFlex]})})]})}),(0,g.jsx)("div",{css:[eT.rcss.flex.grow(1),eT.rcss.align.center,eT.rcss.justify.center,eT.rcss.width("100%"),eT.rcss.display.flex,eT.rcss.overflow("hidden")],children:(0,g.jsxs)(pu.TabPanels,{children:[(0,g.jsx)(pu.TabPanel,{id:"home",css:[eT.rcss.height("100%"),eT.rcss.p(12),eT.rcss.maxWidth(cA.PANE_CONTENT_MAX_WIDTH),eT.rcss.display.flex,eT.rcss.width("100%"),eT.rcss.justify.center,eT.rcss.overflowY("scroll")],children:(0,g.jsx)(dF,{performPaneOperation:n,setSelectedTab:i})}),(0,g.jsx)(pu.TabPanel,{id:"releases",css:[eT.rcss.height("100%"),eT.rcss.width("100%"),eT.rcss.overflowY("scroll")],children:(0,g.jsx)(pl,{performPaneOperation:n})}),(0,g.jsx)(pu.TabPanel,{id:"logs",css:[eT.rcss.height("100%"),eT.rcss.width("100%")],children:(0,g.jsx)(dz,{})})]})})]})})})}var pp=n5.Type.Object({type:n5.Type.Literal("extensionDevtools")}),pf={Content:function(e){var n=e.options.performPaneOperation;return(0,g.jsx)(pd,{performPaneOperation:n})},Icon:function(e){var n=e.size;return(0,g.jsx)(tC.default,{size:n})},getTitle:function(){return"Extensions Devtools"},description:"Manage and debug workspace extensions",category:ch.PaneCategory.WorkspaceExtensions,decode:function(e){return n7.Value.Decode(pp,e)}},pg=e.i(678486),ph=e.i(495954);function pm(e){var n=(0,es.useUpdatePane)(),t=(0,e8.useInstallExtension)(),r=(0,e8.useUninstallExtension)(),i=(0,e4.useExtensions)(),o=(0,B.useCallback)(function(t,r){if("cover"===t){if(null===r)return void o("store",null);n({paneId:e.paneId,pane:{type:"extensionStore",data:{coverPageExtensionId:null!=r?r:null,page:"cover"}}})}else n({paneId:e.paneId,pane:{type:"extensionStore",data:{page:t}}})},[n,e.paneId]);if("cover"===e.page){var a,s,l=null!=(s=null==(a=i.find(function(n){return n.extensionId===e.coverPageExtensionId}))?void 0:a.installationId)?s:null;return(0,g.jsx)(pg.ExtensionCoverPage,{existingInstallationId:l,extensionId:e.coverPageExtensionId,goBackToStore:function(){return o("store",null)},installExtension:function(){return(0,ee._)(function(){var n;return(0,en._)(this,function(r){switch(r.label){case 0:return[4,t({extensionId:e.coverPageExtensionId,replId:null})];case 1:if(!(n=r.sent()))throw Error("Failed to install extension");return[2,(0,eU.asInstallationId)(n.id)]}})})()},uninstallExtension:function(e){return(0,ee._)(function(){return(0,en._)(this,function(n){switch(n.label){case 0:return[4,r({installationId:e,replId:null})];case 1:return n.sent(),[2]}})})()}})}return(0,g.jsx)(ph.default,{storeMode:"pane",openExtensionCover:function(e){return o("cover",e)},setPage:function(e){return o(e,null)},page:e.page})}var pv=n5.Type.Union([n5.Type.Object({page:n5.Type.Union([n5.Type.Literal("store"),n5.Type.Literal("manage")])}),n5.Type.Object({page:n5.Type.Literal("cover"),coverPageExtensionId:n5.Type.Unsafe(n5.Type.String())})]),px=n5.Type.Object({type:n5.Type.Literal("extensionStore"),data:pv}),py={Content:function(e){return(0,g.jsx)(pm,(0,e9._)((0,m._)({},e.pane.data),{paneId:e.options.paneId}))},Icon:function(e){var n=e.size;return(0,g.jsx)(sl.IconContext.Provider,{value:{color:R.tokens.yellowStronger,size:n},children:(0,g.jsx)(tC.default,{})})},getTitle:function(){return"Extension Store"},description:"Find and install workspace extensions",category:ch.PaneCategory.WorkspaceExtensions,decode:function(e){return n7.Value.Decode(px,e)}},pb=e.i(257042),pw=n5.Type.Object({type:n5.Type.Literal("replAuth")}),pj=e.i(353384),p_={Content:pb.default,Icon:function(e){var n=e.size;return(0,g.jsx)(sl.IconContext.Provider,{value:{color:R.tokens.orangeStrongest,size:n},children:(0,g.jsx)(pj.default,{})})},getTitle:function(){return"Authentication"},description:"Let users log in to your App using a prebuilt login page or customize your own button",category:ch.PaneCategory.CloudServices,decode:function(e){return n7.Value.Decode(pw,e)}},pS=function(e){var n;null==(n=e.focus)||n.call(e)};function pC(e){var n=e.isValid,t=e.move,r=e.focus,i=void 0===r?pS:r,o=e.wrap,a=void 0!==o&&o,s=e.selector,l=e.boundary,u=(0,B.useRef)(null);return(0,B.useEffect)(function(){if(u.current){var e=u.current,r=function(r){if(!n(r))return;if(s)p=(0,Z._)(e.querySelectorAll(s));else{var o;o=e.querySelectorAll('a[href],button,input,textarea,select,details,[tabindex]:not([tabindex="-1"])'),p=(0,Z._)(o)}if(0!==p.length){var u=document.activeElement;if(e.contains(u)){if(s)if(l){var c=null==u?void 0:u.closest(l),d=null==u?void 0:u.closest(s);u=d||(null==c?void 0:c.querySelector(s))}else u=null==u?void 0:u.closest(s);if(s&&(!u||!e.contains(document.activeElement))){r.preventDefault(),r.stopPropagation();var p,f,g=null==(f=document.activeElement)?void 0:f.querySelector(s);g?i(g):i(p[0]);return}if(!u){r.preventDefault(),r.stopPropagation(),i(p[0]);return}var h=p.findIndex(function(e){return e===u});if(-1===h){r.preventDefault(),r.stopPropagation(),i(p[0]);return}var m=t({event:r,children:p,activeIndex:h,activeElement:u});!a&&(m<0||m>p.length-1)||(i(m<0?p[p.length-1]:m>p.length-1?p[0]:p[m]),r.stopPropagation(),r.preventDefault())}}};return e.addEventListener("keydown",r),function(){e.removeEventListener("keydown",r)}}},[l,n,t,i,u,s,a]),u}var pk=e.i(712516),pI=e.i(624782),pT=e.i(752723),pR=(0,eI.cssRecord)({queryPill:[eT.rcss.display.inline,eT.rcss.fontSize(R.tokens.fontSizeDefault)],popover:[{"& > .popover-control-container":eT.rcss.mr(0)}]});function pP(e){var n=e.text;return(0,g.jsx)(pI.Pill,{css:pR.queryPill,text:0===n.length?"âŽµ":n})}function pE(e){var n=e.query,t=e.replacement,r=e.numMatches,i=e.onCancel,o=e.onConfirm;return(0,g.jsxs)(A.View,{gap:8,p:12,children:[(0,g.jsxs)(A.View,{children:[(0,g.jsxs)(ez.Text,{children:["Replace ",(0,g.jsx)(pP,{text:n})," with"," ",(0,g.jsx)(pP,{text:t})," in"," ",(0,iV.default)("match",r,!0),"?"]}),(0,g.jsx)(ez.Text,{children:"This operation cannot be undone!"})]}),(0,g.jsxs)(A.View,{row:!0,gap:12,justify:"end",children:[(0,g.jsx)(eW.Button,{onClick:function(){return i()},text:"Cancel"}),(0,g.jsx)(eW.Button,{colorway:"negative",onClick:function(){return o()},text:"Yes, replace ".concat((0,iV.default)("match",r,!0)),iconLeft:(0,g.jsx)(pT.default,{})})]})]})}function pA(e){var n=e.disabled,t=e.loading,r=e.query,i=e.replacement,o=e.results,a=e.replace,s=e.onReplace,l=e.buttonProps,u=(0,U._)((0,B.useState)(!1),2),c=u[0],d=u[1],p=(0,B.useMemo)(function(){return o.reduce(function(e,n){return e+n.lines.reduce(function(e,n){return e+n.matches.length},0)},0)},[o]);return(0,g.jsx)(A.View,{css:pR.popover,children:(0,g.jsxs)(ai.PopoverTrigger,{onOpenChange:d,label:"Confirm replace all",isOpen:c,children:[(0,g.jsx)(eW.Button,(0,e9._)((0,m._)({},l),{text:"Replace all",disabled:n||t,onClick:function(){d(function(e){return!e})}})),(0,g.jsx)(pE,{query:r,replacement:i,numMatches:p,onCancel:function(){return d(!1)},onConfirm:function(){return(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:return d(!1),(0,ei.track)(eo.events.SEARCH_PANE_USED,{action:"replace"}),[4,a()];case 1:return e.sent().success&&s(),[2]}})})()}})]})})}var pD=e.i(551959),pV=(0,eI.cssRecord)({self:[eT.rcss.position.relative,eT.rcss.flex.shrink(1),eT.rcss.width("100%")],iconWrapper:[eT.rcss.position.absolute,eT.rcss.top(0),eT.rcss.right(0),eT.rcss.height("100%"),eT.rcss.p(4)]}),pO=(0,B.forwardRef)(function(e,n){var t,r=e.onClear,i=(0,iu._)(e,["onClear"]);return(0,g.jsxs)(A.View,{css:pV.self,children:[(0,g.jsx)(pD.MultiLineInputWithHistory,(0,m._)({ref:n},i)),((null==(t=i.value)?void 0:t.length)||0)>0?(0,g.jsx)(A.View,{css:pV.iconWrapper,children:(0,g.jsx)(ot.IconButton,{alt:"Clear search query",tooltipBehavior:"hidden",onClick:r,css:{"&:hover":{backgroundColor:"".concat(R.tokens.backgroundHighest," !important")}},children:(0,g.jsx)(ic.default,{})})}):null]})});pO.displayName="SearchInput";var pF=e.i(294751),pM=e.i(163793),pL=e.i(790486),pU=(0,eI.cssRecord)({self:[eT.rcss.width("fit-content"),eT.rcss.display.inlineBlock,eT.rcss.color.accentNegativeDefault,eT.rcss.fontWeight.bold]});function pB(e){var n=e.content;return(0,g.jsx)(g.Fragment,{children:n.split("\n").reduce(function(e,n,t){return null===e?[n]:(0,Z._)(e).concat([(0,g.jsx)(A.SpecializedView.span,{css:pU.self,children:"\\n"},"".concat(n,"-").concat(t)),n])},null)})}var pN=e.i(352701),pG=A.SpecializedView.span,pW="SearchMatch",pz=((u=pz||{}).HIGHLIGHT="highlight",u.REMOVE="remove",u.ADD="add",u.TEXT="text",u);function pH(e){return{outlineColor:e,outlineWidth:"1px",outlineStyle:"solid"}}var pq=(0,eI.cssRecord)((f={self:[eT.rcss.width("fit-content"),eT.rcss.display.inline,eT.rcss.cursor.pointer,{"&:focus-visible":[eT.rcss.focusRing]},eT.rcss.mx(1),eT.rcss.px(2),eT.rcss.borderRadius(4)]},(0,I._)(f,"highlight",[eT.rcss.backgroundColor.accentPrimaryDimmest,pH(R.tokens.accentPrimaryDimmer)]),(0,I._)(f,"remove",[eT.rcss.backgroundColor.accentNegativeDimmest,pH(R.tokens.accentNegativeDimmer),{textDecoration:"line-through"}]),(0,I._)(f,"add",[eT.rcss.backgroundColor.accentPositiveDimmest,pH(R.tokens.accentPositiveDimmer)]),(0,I._)(f,"hiddenTextWrapper",[eT.rcss.display.inlineBlock,eT.rcss.mx(2),{"& > div":[eT.rcss.display.inlineBlock],transform:"translateY(12.5%)"}]),(0,I._)(f,"firstHiddenTextWrapper",[eT.rcss.ml(0)]),(0,I._)(f,"lastHiddenTextWrapper",[eT.rcss.mr(0)]),f));function pK(e){var n=e.content,t=e.matches,r=e.dedentBy,i=e.replacement,o=e.isRegex,a=e.query,s=e.onOpenAtPosition;return(0,g.jsx)(g.Fragment,{children:(function(e){for(var n=e.content,t=e.matches,r=e.dedentBy,i=e.replacement,o=[],a=r,s=0;s<t.length;s++){var l=t[s],u=l.start+l.length;o.push({start:a,end:l.start,type:"text"});var c=n.substring(l.start,u);i.length>0&&i!==c?(o.push({start:l.start,end:u,type:"remove"}),o.push({start:-1,end:u,type:"add"})):o.push({start:l.start,end:u,type:"highlight",matchIndex:s}),a=u}return o.push({start:a,end:n.length,type:"text"}),o})({content:n,matches:t,dedentBy:r,replacement:i}).map(function(e,t,r){var l=e.start,u=e.end,c=e.type,d="".concat(l,"-").concat(u),p=u-l;if("text"===c){var f=r[t+1];if(0===t&&p>50)return(0,g.jsxs)(B.Fragment,{children:[(0,g.jsx)(pG,{css:[pq.hiddenTextWrapper,pq.firstHiddenTextWrapper],children:(0,g.jsx)(ot.IconButton,{size:18,alt:"Jump to hidden text",onClick:function(){s(u-50)},children:(0,g.jsx)(pN.default,{})})},d),(0,g.jsx)("span",{children:n.substring(u-50,u)})]},d);if(t===r.length-1&&p>50)return(0,g.jsxs)(B.Fragment,{children:[(0,g.jsx)("span",{children:n.substring(l,l+50)}),(0,g.jsx)(pG,{css:[pq.hiddenTextWrapper,pq.lastHiddenTextWrapper],children:(0,g.jsx)(ot.IconButton,{size:18,alt:"Jump to hidden text",onClick:function(){s(l+50)},children:(0,g.jsx)(pN.default,{})})},d)]},d);if(f&&p>100)return(0,g.jsxs)(B.Fragment,{children:[(0,g.jsx)("span",{children:n.substring(l,l+50)}),(0,g.jsx)(pG,{css:pq.hiddenTextWrapper,children:(0,g.jsx)(ot.IconButton,{size:18,alt:"Jump to hidden text",onClick:function(){s(l+50)},children:(0,g.jsx)(pN.default,{})})},d),(0,g.jsx)("span",{children:n.substring(u-50,u)})]},d)}var h=-1===l?i:n.substring(l,u);if("text"===c)return(0,g.jsx)(B.Fragment,{children:h},d);var m=null,v=r[t-1];return"add"===c&&(null==v?void 0:v.type)==="remove"&&(m=n.substring(v.start,v.end)),(0,g.jsx)(p$,{content:h,type:c,isRegex:o,query:a,replacement:i,removedText:m,onClick:function(e){e.stopPropagation(),s(u)}},d)})})}function p$(e){var n=e.content,t=e.type,r=e.isRegex,i=e.replacement,o=e.query,a=e.removedText,s=(0,iu._)(e,["content","type","isRegex","replacement","query","removedText"]),l=n,u=void 0;switch(t){case"highlight":u="Matched text ".concat(l);break;case"remove":u="Removed text ".concat(l);break;case"add":if(u="Added text ".concat(l),r&&null!==a)try{l=a.replace(new RegExp(o),i.replaceAll(/\$[&`']/g,"$$$&"))}catch(e){}}return(0,g.jsx)(A.SpecializedView.span,(0,e9._)((0,m._)({css:[pq.self,pq[t]],tabIndex:0,"aria-label":u,role:"button","data-nav":pW},s),{children:"add"===t?(0,g.jsx)(pB,{content:l}):l}))}var pQ=(0,eI.cssRecord)({self:[eT.rcss.width("100%"),eT.rcss.flex.wrap],text:[eT.rcss.display.block,eT.rcss.textAlign.center,{overflow:"visible",whiteSpace:"normal"}]});function pY(e){var n=e.error;return(0,g.jsxs)(A.View,{css:pQ.self,pt:8,pb:8,row:!0,gap:4,align:"center",justify:"center",children:[(0,g.jsx)(av.default,{}),(0,g.jsx)(ez.Text,{css:pQ.text,multiline:!1,children:n})]})}var pJ=e.i(8412),pX=e.i(717639),pZ="SearchLine",p0="--search-line-number-width",p1=(0,eI.cssRecord)({self:[eT.rcss.overflow("hidden"),eT.rcss.cursor.pointer,eT.rcss.borderRadius(4),{"&:focus-visible":[eT.rcss.focusRing],"&:hover, &:focus-visible":[eT.rcss.backgroundColor.backgroundHighest]}],content:[eT.rcss.font.code,eT.rcss.maxWidth("100%"),eT.rcss.width("fit-content"),{whiteSpace:"pre-wrap",overflowWrap:"break-word"}],lineNumberWrapper:[eT.rcss.display.inlineBlock,eT.rcss.color.foregroundDimmest,eT.rcss.mr(8),eT.rcss.pl(8)],lineNumber:[eT.rcss.display.inlineBlock,eT.rcss.textAlign.right,{width:"var(".concat(p0,")")}]});function p2(e){var n=e.lineNumber,t=e.content,r=e.matches,i=e.path,o=e.dedentBy,a=e.onFileLineClicked,s=(0,iu._)(e,["lineNumber","content","matches","path","dedentBy","onFileLineClicked"]),l=(0,$.default)(function(){return function(e){(0,ei.track)(eo.events.SEARCH_PANE_USED,(0,m._)({action:"result_clicked"},s)),a({path:i,lineNumber:n,columnNumber:e})}},[n,s,i,a]),u=(0,$.default)(function(){return function(){var e=r.length>0?r[0]:null;l(e?e.start+e.length:0)}},[r,l]);return(0,g.jsxs)(A.View,{tabIndex:0,css:p1.self,row:!0,gap:8,align:"stretch","data-nav":pZ,onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),u())},onClick:u,children:[(0,g.jsx)(A.View,{css:p1.lineNumberWrapper,children:(0,g.jsx)(A.View,{tag:"span",css:p1.lineNumber,"aria-label":"Line ".concat(n),children:n})}),(0,g.jsx)("pre",{css:p1.content,children:(0,g.jsx)(pK,{isRegex:s.isRegex,content:t,matches:r,dedentBy:o,query:s.query,replacement:s.replacement,onOpenAtPosition:l})})]})}var p4=e.i(965153),p8="SearchFileNav",p3="SearchFileHeaderNav",p6="SearchQueryNav",p9="SearchQueryTogglesNav",p5=parseInt(R.values.space24,10)+10,p7=(0,eI.cssRecord)({header:[eT.rcss.rowWithGap(4),eT.rcss.align.center,eT.rcss.rowWithGap(6),eT.rcss.flex.growAndShrink(1),eT.rcss.overflow("hidden")],headerParentPathText:[eT.rcss.flex.shrink(1e7)],headerFileNameText:[eT.rcss.flex.shrink(1)],headerMatchesCountPill:[eT.rcss.height(20),eT.rcss.flex.shrink(0)],accordionWrapper:[eT.rcss.mx(4),eT.rcss.border({direction:"top",color:R.tokens.outlineDimmest})],accordionChildren:[eT.rcss.p(4)],linesWrapper:[eT.rcss.overflow("hidden"),eT.rcss.borderRadius(4),eT.rcss.font.code]});function fe(e){var n=e.path,t=e.lines,r=e.dedentBy,i=e.isFirst,o=e.expanded,a=e.onClick,s=e.scrollOffset,l=e.onFileLineClicked,u=e.searchResultBackgroundColor,c=(0,iu._)(e,["path","lines","dedentBy","isFirst","expanded","onClick","scrollOffset","onFileLineClicked","searchResultBackgroundColor"]),d=(0,rv.usePreferences)("fontSize").preferences.fontSize,p=(0,B.useRef)(null),f=(0,$.default)(function(){return t.reduce(function(e,n){return e+n.matches.length},0)},[t]),h=(0,$.default)(function(){var e=t[t.length-1];if(!e)return{};var n=(0,pX.getDigits)(e.lineNumber),r=(0,pJ.lineHeightFromFontSize)(d);return(0,I._)({fontSize:d,lineHeight:r},p0,"".concat(n,"ch"))},[t,d]);return(0,g.jsx)(E.Surface,{css:p7.accordionWrapper,style:h,"data-nav":p8,innerRef:p,children:(0,g.jsx)(p4.AccordionItem,{expanded:void 0===o||o,onClick:function(){a(p.current)},headerProps:{"data-nav":"".concat(p3," ").concat(pZ," ").concat(i?"".concat(p6," ").concat(p9):""),style:{position:"sticky",zIndex:1,insetBlockStart:"-".concat(void 0===s?0:s,"px"),borderRadius:0,backgroundColor:u}},headerContent:(0,g.jsxs)(A.View,{css:p7.header,children:[(0,g.jsx)(rB.default,{path:n,size:16}),(0,g.jsx)(ez.Text,{css:p7.headerFileNameText,multiline:!1,children:(0,tu.getFileName)(n)}),(0,g.jsx)(ez.Text,{color:"dimmest",css:p7.headerParentPathText,multiline:!1,children:(0,tu.getParentPath)(n).replace(/^\.\//,"")}),(0,g.jsx)(pI.Pill,{variant:"muted",text:"".concat(f," ").concat((0,iV.default)("match",f)),css:p7.headerMatchesCountPill})]}),children:(0,g.jsx)(A.View,{css:p7.accordionChildren,children:(0,g.jsx)(A.View,{css:p7.linesWrapper,children:t.map(function(e){return(0,g.jsx)(p2,(0,e9._)((0,m._)({},e,c),{path:n,dedentBy:r,onFileLineClicked:l}),e.lineNumber)})})})})})}var fn=e.i(254806),ft=e.i(15260),fr=e.i(419735),fi=(0,eI.cssRecord)({container:[eT.rcss.border({direction:"bottom",color:R.tokens.outlineDimmest})],actions:[eT.rcss.display.flex,eT.rcss.rowWithGap(4)]});function fo(e){var n="collapse"===e.collapseExpandAllState;return(0,g.jsxs)(A.View,{css:fi.container,p:4,row:!0,align:"center",justify:"space-between",children:[(0,g.jsxs)(ez.Text,{color:"dimmer",children:[e.totalCount," results in ",(0,iV.default)("file",e.fileCount,!0)]}),(0,g.jsxs)(A.View,{css:fi.actions,children:[(0,g.jsx)(ot.IconButton,{alt:"Open New Search",onClick:e.onStartNewSearch,children:(0,g.jsx)(fr.default,{})}),(0,g.jsx)(ot.IconButton,{alt:n?"Collapse All":"Expand All",onClick:e.onToggleCollapseExpandAll,children:n?(0,g.jsx)(fn.default,{}):(0,g.jsx)(ft.default,{})})]})]})}var fa=e.i(189920),fs=(0,it.keyframes)({from:{opacity:0},to:{opacity:1}}),fl=(0,eI.cssRecord)({listWrapper:[eT.rcss.overflowY("auto"),eT.rcss.flex.grow(1),{contain:"strict"}],list:[eT.rcss.width("100%"),eT.rcss.position.relative],listItem:[eT.rcss.position.absolute,eT.rcss.top(0),eT.rcss.left(0),eT.rcss.width("100%")],resultRow:[{animation:"".concat(fs," 120ms linear forwards")}]});function fu(e){var n,t,r,i,o,a,s,l,u,c,d=e.results,p=e.error,f=e.paneRef,h=e.onFileLineClicked,v=e.onOpenSearchPane,x=e.searchResultBackgroundColor,y=(0,iu._)(e,["results","error","paneRef","onFileLineClicked","onOpenSearchPane","searchResultBackgroundColor"]),b=(0,$.default)(function(){return d.filter(function(e){return e.lines.length>0})},[d]),w=(0,$.default)(function(){return b.reduce(function(e,n){return e+n.lines.reduce(function(e,n){return e+n.matches.length},0)},0)},[b]),j=(0,U._)((0,B.useState)({}),2),_=j[0],S=j[1],C=(0,B.useRef)(null),k=(0,pL.useVirtualizer)({count:b.length,getScrollElement:function(){return C.current},estimateSize:function(e){var n;return function(e,n){var t=e.length;if(n)for(var r=n-24,i=0;i<e.length;i++){var o=e[i],a=9*(0,pX.getDigits)(i)+9*o.content.length+4*o.matches.length;a>r&&(t+=Math.floor(r/a)+1)}return p5+20+24.39*t+2*t}(b[e].lines,null==f||null==(n=f.current)?void 0:n.offsetWidth)},overscan:3}),T=k.getVirtualItems(),R=(0,B.useRef)(null),P=(0,B.useCallback)(function(e){var n=C.current;if(n&&R.current!==e){if(e.matches('[data-nav*="'.concat(p3,'"]')))return void e.focus();var t=e.closest('[data-nav="'.concat(p8,'"]')),r=null==t?void 0:t.querySelector('[data-nav*="'.concat(p3,'"]'));if(!r)return void e.focus();var i=r.getBoundingClientRect();if(r.offsetTop+i.height>e.offsetTop){var o=e.offsetTop-i.height;R.current=e;var a=function(){n.scrollTop===o&&(n.removeEventListener("scroll",a),R.current===e&&(e.focus(),R.current=null))};n.addEventListener("scroll",a),n.scrollTo({top:o})}else e.focus()}},[]),E=(n={selector:'[data-nav*="'.concat(p3,'"]'),boundary:'[data-nav*="'.concat(p8,'"]')},t=(0,B.useCallback)(function(e){return"Tab"===e.key},[]),r=(0,B.useCallback)(function(e){var n=e.event,t=e.activeIndex;return n.shiftKey?t-1:t+1},[]),pC((0,e9._)((0,m._)({},n),{isValid:t,move:r}))),D=(i={selector:'[data-nav*="'.concat(pZ,'"]'),focus:P},o=(0,B.useCallback)(function(e){return"ArrowUp"===e.key||"ArrowDown"===e.key},[]),a=(0,B.useCallback)(function(e){var n=e.event,t=e.activeIndex;return"ArrowUp"===n.key?t-1:t+1},[]),pC((0,e9._)((0,m._)({},i),{isValid:o,move:a}))),V=(s={selector:'[data-nav*="'.concat(pW,'"]'),focus:P},l=(0,B.useCallback)(function(e){return"ArrowLeft"===e.key||"ArrowRight"===e.key},[]),u=(0,B.useCallback)(function(e){var n=e.event,t=e.activeIndex;return"ArrowLeft"===n.key?t-1:t+1},[]),pC((0,e9._)((0,m._)({},s),{isValid:l,move:u}))),O=(0,pM.mergeRefs)(E,D,V),F=(0,$.default)(function(){return b.length===Object.keys(_).length&&Object.values(_).every(Boolean)},[_,b.length]),M=null;return b.length>0?M=(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(fo,{fileCount:b.length,totalCount:w,collapseExpandAllState:F?"expand":"collapse",onToggleCollapseExpandAll:function(){F?S({}):S(b.reduce(function(e,n){return(0,e9._)((0,m._)({},e),(0,I._)({},n.path,!0))},{}))},onStartNewSearch:v}),(0,g.jsx)(A.SpecializedView.div,{ref:C,css:fl.listWrapper,children:(0,g.jsx)(A.View,{css:fl.list,style:{height:k.getTotalSize()},children:(0,g.jsx)(A.View,{css:fl.listItem,style:{transform:"translateY(".concat(null==(c=T[0])?void 0:c.start,"px)")},innerRef:O,children:T.map(function(e){var n,t=b[e.index],r=t.path;return(0,g.jsx)(A.SpecializedView.div,{"data-index":e.index,ref:k.measureElement,css:fl.resultRow,children:(0,g.jsx)(fe,(0,e9._)((0,m._)({},t,y),{scrollOffset:null==(n=T[0])?void 0:n.start,onFileLineClicked:h,isFirst:0===e.index,expanded:!0!==_[r],searchResultBackgroundColor:x,onClick:function(e){if(S(function(e){return(0,e9._)((0,m._)({},e),(0,I._)({},r,!(r in e)||!e[r]))}),C.current&&e){var n,t,i=Math.floor(null!=(t=null==(n=T[0])?void 0:n.start)?t:0),o=Math.floor(C.current.scrollTop),a=e.offsetTop+i;a>o||C.current.scrollTo({top:a-1})}}}))},e.key.toString())})})})})]}):p===fa.SearchError.EMPTY_RESULTS&&(M=(0,g.jsx)(pk.default,{pane:{type:"searchReplace"},headerText:p})),(0,g.jsxs)(g.Fragment,{children:[p&&p!==fa.SearchError.EMPTY_RESULTS?(0,g.jsx)(pY,{error:p}):null,M]})}var fc=e.i(316346);function fd(e){return(0,B.useMemo)(function(){return(0,Z._)((0,fc.splitGlobAware)(e,",")).map(function(e){return e.trim()}).filter(function(e){return e.length>0})},[e])}var fp=((c={}).QUERY_EMPTY="The query is empty",c.QUERY_SAME="The query is the same as replacement",c.NO_MATCHES="No matches were found to replace",c.RG_EMPTY="Ripgrep didn't return a response",c.NOT_MOUNTED="Component wasn't mounted",c),ff=e.i(431544);e.i(694906);var fg=e.i(55449),fh=e.i(406393),fm=e.i(606296),fv=e.i(542932),fx=e.i(597512),fy=e.i(874721),fb="SearchQueryControlsNav",fw="SearchQueryExcludeNav",fj="SearchQueryControlsColumnNav",f_=(0,it.keyframes)({from:{transform:"scaleX(0)"},to:{transform:"scaleX(0.9)"}}),fS=eT.container.min(360),fC=(0,eI.cssRecord)({self:[eT.rcss.height("100%"),eT.rcss.width("100%"),eT.rcss.overflow("hidden"),eT.rcss.px(4),eT.rcss.container()],filesIncludeExcludeWrapper:[eT.rcss.mt(6),eT.rcss.border({direction:"top",color:R.tokens.outlineDimmest}),(0,I._)({},fS,[eT.rcss.rowWithGap(6),eT.rcss.align.start,eT.rcss.mt(0),{border:"none"}])],inputWithLabel:[eT.rcss.flex.growAndShrink(1),eT.rcss.colWithGap(1)],inputLabelText:[{userSelect:"none"},eT.rcss.color.foregroundDimmest,eT.rcss.truncate,{fontSize:R.tokens.fontSizeSmall}],inputLabel:[eT.rcss.flex.shrink(1),eT.rcss.m(0),{lineHeight:1}],input:[eT.rcss.viewStyle,eT.rcss.border(),{blockSize:R.tokens.space32,"::placeholder":{color:R.tokens.foregroundDimmest},"&:hover::placeholder":{color:R.tokens.foregroundDimmer},"&:focus::placeholder, &:hover:focus::placeholder":{color:R.tokens.foregroundDimmest},":not([disabled])":{cursor:"text",":focus":{boxShadow:"none"}}}],optionsWrapper:[eT.rcss.rowWithGap(2),eT.rcss.align.center,(0,I._)({order:2},fS,[{order:1," > *":eT.rcss.height("100%")}])],closeWrapper:[(0,I._)({order:1},fS,{order:2," > *":eT.rcss.height("100%")})],results:[eT.rcss.position.relative,{flex:"1 1 auto"}],searchWrapper:[{flex:"0 1 auto"}],expandCollapseButton:[eT.rcss.height(32)],searchInputAndOptionsWrapper:(0,I._)({flex:1,display:"grid",gap:4,gridTemplateColumns:"1fr max-content"},fS,{gridTemplateColumns:"1fr max-content max-content"}),replacementWrapper:[eT.rcss.ml(24),eT.rcss.pl(4),eT.rcss.pb(6)],replaceInputWrapper:[eT.rcss.border({direction:"top",color:R.tokens.outlineDimmest}),(0,I._)({},fS,[eT.rcss.rowWithGap(4),eT.rcss.pt(0),eT.rcss.align.center,{border:"none"}])],loadingBar:[eT.rcss.position.absolute,eT.rcss.mt(2),eT.rcss.height(1),eT.rcss.borderRadius(2),eT.rcss.width("100%"),eT.rcss.backgroundColor.accentPrimaryDimmer,{animation:"".concat(f_," 20s 1s ease forwards"),transformOrigin:"center left",transform:"scaleX(0)"}]});function fk(e){var n=e.updateData,t=e.query,r=e.setQuery,i=e.isRegex,o=e.setIsRegex,a=e.isCaseSensitive,s=e.setIsCaseSensitive,l=e.isMatchingWholeWords,u=e.setIsMatchingWholeWords,c=e.isCollapsed,d=e.setIsCollapsed,p=e.executeSearch,f=e.searchInputRef,h=e.onCloseRequested;return(0,g.jsxs)(A.View,{css:fC.searchWrapper,pb:4,row:!0,gap:4,children:[(0,g.jsx)(ot.IconButton,{onClick:function(){return d(function(e){return!e})},alt:c?"Show replacement options":"Hide replacement options",css:fC.expandCollapseButton,children:c?(0,g.jsx)(sp.default,{}):(0,g.jsx)(s7.default,{})}),(0,g.jsxs)(A.View,{css:fC.searchInputAndOptionsWrapper,children:[(0,g.jsx)(pO,{"data-nav":"".concat(p6," ").concat(fb),ref:f,autoSize:!0,placeholder:"Search",value:t,css:fC.input,onChange:function(e){r(e),n({initialQuery:e})},onClear:function(){r(""),n({initialQuery:""})},onKeyDown:function(e){"Enter"!==e.key||(0,r5.getCmdOrCtrl)(e)||e.shiftKey||(e.preventDefault(),e.stopPropagation(),p())}}),(0,g.jsxs)(A.View,{css:fC.optionsWrapper,children:[(0,g.jsx)(pF.default,{alt:"case sensitive","data-nav":"".concat(fb," ").concat(fj),icon:(0,g.jsx)(fv.default,{}),checked:a,onClick:function(){return s(function(e){return!e})}}),(0,g.jsx)(pF.default,{alt:"regular expressions","data-nav":"".concat(fb," ").concat(fj),icon:(0,g.jsx)(fx.default,{}),checked:i,onClick:function(){return o(function(e){return!e})}}),(0,g.jsx)(pF.default,{alt:"whole words","data-nav":"".concat(fb," ").concat(fj),icon:(0,g.jsx)(fy.default,{}),checked:l,onClick:function(){return u(function(e){return!e})}})]}),(0,g.jsx)(A.View,{css:fC.closeWrapper,row:!0,gap:2,align:"center",children:h?(0,g.jsx)(ot.IconButton,{onClick:h,alt:"Close",children:(0,g.jsx)(ic.default,{})}):null})]})]})}function fI(e){var n=e.updateData,t=e.replacement,r=e.setReplacement,i=e.query,o=e.replaceLoading,a=e.search,s=e.includeGlob,l=e.setIncludeGlob,u=e.excludeGlob,c=e.setExcludeGlob,d=e.replace,p=e.results;return(0,g.jsxs)(A.View,{css:fC.replacementWrapper,children:[(0,g.jsxs)(A.View,{css:fC.replaceInputWrapper,pt:8,gap:6,children:[(0,g.jsx)(pO,{"data-nav":"".concat(p6," ").concat(fb," ").concat(fw),autoSize:!0,placeholder:"Replacement",value:t,css:fC.input,onChange:function(e){r(e),n({initialReplacement:e})},onClear:function(){r(""),n({initialReplacement:""})}}),(0,g.jsx)(A.View,{css:fC.optionsWrapper,children:(0,g.jsx)(pA,{query:i,replacement:t,results:p,disabled:0===i.length,loading:o,replace:d,onReplace:a,buttonProps:{"data-nav":"".concat(fb," ").concat(p9," ").concat(fj)}})})]}),(0,g.jsxs)(A.View,{css:fC.filesIncludeExcludeWrapper,pt:8,gap:8,children:[(0,g.jsxs)(A.View,{css:fC.inputWithLabel,id:"filesToInclude",children:[(0,g.jsx)("label",{htmlFor:"filesToIncludeInput",css:fC.inputLabel,children:(0,g.jsx)(ez.Text,{css:fC.inputLabelText,color:"dimmer",multiline:!1,children:"Files to include"})}),(0,g.jsx)(pO,{id:"filesToIncludeInput","data-nav":"".concat(p6," ").concat(fb),autoSize:!0,value:s,css:fC.input,placeholder:"e.g. **.js, src/**, app/",onChange:function(e){l(e),n({initialIncludeGlob:e})},onClear:function(){l(""),n({initialIncludeGlob:""})}})]}),(0,g.jsxs)(A.View,{css:fC.inputWithLabel,id:"filesToExclude",children:[(0,g.jsx)("label",{htmlFor:"filesToExcludeInput",css:fC.inputLabel,children:(0,g.jsx)(ez.Text,{css:fC.inputLabelText,color:"dimmer",multiline:!1,children:"Files to exclude"})}),(0,g.jsx)(pO,{id:"filesToExcludeInput","data-nav":"".concat(fb," ").concat(fw),autoSize:!0,value:u,css:fC.input,onChange:function(e){c(e),n({initialExcludeGlob:e})},onClear:function(){c(""),n({initialExcludeGlob:""})}})]})]})]})}function fT(e){var n,t,r,i,o,a,s,l,u,c,d,p,f,h,v,x,y,b,w,j,_,S,C,k,I,T,R,P,E,D,V,O,F,M,L,N,G,W,z,H,q,Q=e.isActive,Y=e.initialQuery,J=void 0===Y?"":Y,X=e.initialReplacement,et=void 0===X?"":X,er=e.initialIncludeGlob,ea=void 0===er?"":er,es=e.initialExcludeGlob,el=void 0===es?"":es,eu=e.searchInputRef,ec=e.onDataChanged,ed=e.onFileLineClicked,ep=e.onOpenSearchPane,ef=e.onCloseRequested,eg=e.searchResultBackgroundColor,eh=(0,U._)((0,B.useState)(J),2),em=eh[0],ev=eh[1],ex=(0,U._)((0,B.useState)(et),2),ey=ex[0],eb=ex[1],ew=(0,U._)((0,B.useState)(!1),2),ej=ew[0],e_=ew[1],eS=(0,U._)((0,B.useState)(!1),2),eC=eS[0],ek=eS[1],eI=(0,U._)((0,B.useState)(!1),2),eT=eI[0],eR=eI[1],eP=(0,U._)((0,B.useState)(!0),2),eE=eP[0],eA=eP[1],eD=(0,U._)((0,B.useState)(el),2),eV=eD[0],eO=eD[1],eF=(0,U._)((0,B.useState)(ea),2),eM=eF[0],eL=eF[1],eU=fd(eV),eB=fd(eM),eN=(0,B.useRef)(null),eG=(t=(n={query:em,isRegex:ej,isCaseSensitive:eC,isMatchingWholeWords:eT,excludeGlobs:eU,includeGlobs:eB}).query,r=n.isRegex,i=n.isCaseSensitive,o=n.isMatchingWholeWords,s=void 0===(a=n.includeGlobs)?[]:a,u=void 0===(l=n.excludeGlobs)?[]:l,d=(c=(0,e2.default)()).container,p=c.dotReplit,f=(0,fh.useHiddenFilesGlobPatterns)(p),h=(0,K.useFlag)({controlName:"flag-code-search-latency-metrics",logFlagToAnalytics:!1}),x=(v=(0,U._)((0,B.useState)([]),2))[0],y=v[1],w=(b=(0,U._)((0,B.useState)(null),2))[0],j=b[1],S=(_=(0,U._)((0,B.useState)(t.length>0),2))[0],C=_[1],k=(0,$.default)(function(){return(0,Z._)(u).concat((0,Z._)(f||[]),(0,Z._)(fg.ignoredDirs))},[u,f]),I=d.getConnectionState(),T=(0,B.useMemo)(function(){return(0,fm.default)({container:d,onError:function(e){return j(e)},onUpdate:function(e){return y(e)},onLoadingStateChange:function(e){return C(e)},isStreaming:!0,trackLatency:h})},[]),(0,B.useEffect)(function(){I===e5.ConnectionState.CONNECTED&&T({query:t,isRegex:r,isCaseSensitive:i,isMatchingWholeWords:o,includeGlobs:s,excludeGlobs:k})},[I,T,t,r,i,o,s,k,f]),{loading:S,error:w,data:x,search:function(){return T({query:t,isRegex:r,isCaseSensitive:i,isMatchingWholeWords:o,includeGlobs:s,excludeGlobs:k})}}),eW=eG.loading,ez=eG.error,eH=eG.data,eq=eG.search;(0,a4.default)(function(){""!==em&&(0,ei.track)(eo.events.SEARCH_PANE_USED,{action:"search",isRegex:ej,isCaseSensitive:eC,hasIncludes:eB.length>0,hasExcludes:eU.length>0})},[em,eB,eU,ej,eC],1e3);var eK=(P=(R={replacement:ey,query:em,isRegex:ej,isCaseSensitive:eC,isMatchingWholeWords:eT,excludeGlobs:eU,includeGlobs:eB,fileList:ez?void 0:eH}).query,E=R.replacement,D=R.fileList,V=(0,iu._)(R,["query","replacement","fileList"]),O=(0,e2.default)().container,M=(F=(0,U._)((0,B.useState)(!1),2))[0],L=F[1],G=(N=(0,U._)((0,B.useState)(null),2))[0],W=N[1],H=(z=(0,U._)((0,B.useState)(!1),2))[0],q=z[1],{replace:(0,B.useCallback)(function(){return(0,ee._)(function(){var e;return(0,en._)(this,function(n){switch(n.label){case 0:var t;return q(!0),W(null),[4,(t=(0,m._)({container:O,query:P,replacement:E,fileList:null==D?void 0:D.map(function(e){return e.path})},V),(0,ee._)(function(){var e,n,r,i,o,a,s,l,u;return(0,en._)(this,function(c){switch(c.label){case 0:if(n=t.container,r=t.fileList,0===(i=(0,iu._)(t,["container","fileList"])).query.length)return[2,{success:!1,errorOn:"exit",errorMessage:fp.QUERY_EMPTY}];if(i.query===i.replacement)return[2,{success:!1,errorOn:"exit",errorMessage:fp.QUERY_SAME}];if(!(r&&r.length>0))return[3,1];return o=r,[3,3];case 1:return[4,(a=n).exec.apply(a,(0,Z._)((0,ff.createSearchCommand)((0,e9._)((0,m._)({},i),{context:1,mode:"files"}))))];case 2:if((l=c.sent()).error)return[2,{success:!1,errorOn:"rg",errorMessage:"exit status 1"===l.error?fp.NO_MATCHES:l.error}];o=(null==(s=l.output)?void 0:s.split("\n").filter(function(e){return e.trim().length>0}))||[],c.label=3;case 3:var d,p,f,g,h,v,x,y;if(0===o.length)return[2,{success:!1,errorOn:"rg",errorMessage:fp.NO_MATCHES}];return[4,(e=n).exec.apply(e,(0,Z._)((p=(d=i).replacement,f=d.query,g=d.isRegex,h=d.isCaseSensitive,v=d.isMatchingWholeWords,x=["sd"],y=[f.indexOf("\n")>=0?"m":"e",h?"c":"i"],v&&y.push("w"),x.push("--flags",y.join("")),!g&&x.push("--string-mode"),f.startsWith("-")&&(f="\\"+f),x.push(f,p),x)).concat((0,Z._)(o)))];case 4:if((u=c.sent()).error)return[2,{success:!1,errorOn:"sd",errorMessage:u.error}];return[2,{success:!0}]}})})())];case 1:return(e=n.sent()).success||W(e.errorMessage),q(!1),L(e.success),[2,e]}})})()},[O,P,E,D,V]),loading:H,error:G,data:M}),e$=eK.loading,eQ=eK.replace,eY=(0,B.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};null==ec||ec({initialQuery:em,initialReplacement:ey,initialIncludeGlob:eM,initialExcludeGlob:eV},e)},[ec,em,ey,eV,eM]);(0,B.useLayoutEffect)(function(){ev(J),eb(et),eL(ea),eO(el)},[J,et,ea,el]);var eJ=pC({selector:'[data-nav*="'.concat(p6,'"]'),isValid:function(e){var n="ArrowUp"===e.key||"ArrowDown"===e.key,t=e.target.matches('[data-nav*="'.concat(p6,'"]')),r=e.target.matches("[data-nav*=".concat(p3,"]"));return n&&t&&(e.altKey||r)},move:function(e){var n=e.event,t=e.activeIndex;return n.preventDefault(),n.stopPropagation(),"ArrowUp"===n.key?t-1:t+1}}),eX=pC({selector:'[data-nav*="'.concat(p9,'"]'),isValid:function(e){var n="ArrowUp"===e.key||"ArrowDown"===e.key,t=e.target.matches('[data-nav*="'.concat(p9,'"]')),r=e.target.matches("[data-nav*=".concat(p3,"]"));return n&&t&&!r},move:function(e){var n=e.event,t=e.activeIndex;return n.preventDefault(),n.stopPropagation(),"ArrowUp"===n.key?t-1:t+1}}),eZ=pC({selector:'[data-nav*="'.concat(fj,'"]'),isValid:function(e){var n="ArrowUp"===e.key||"ArrowDown"===e.key;if(e.target.matches('[data-nav*="'.concat(p9,'"]'))&&"ArrowDown"===e.key)return!1;var t=e.target.matches('[data-nav*="'.concat(fj,'"]'));return n&&t},move:function(e){var n=e.event,t=e.activeIndex,r=e.children,i=n.target.matches('[data-nav*="'.concat(p9,'"]'));return(n.preventDefault(),n.stopPropagation(),i)?0:0===t&&"ArrowUp"===n.key?-1:r.length-1}}),e0=pC({selector:'[data-nav*="'.concat(fw,'"]'),isValid:function(e){var n="ArrowUp"===e.key||"ArrowDown"===e.key,t=e.target.matches('[data-nav*="'.concat(fw,'"]')),r=e.target.matches("[data-nav*=".concat(p6,"]"));return n&&e.altKey&&t&&!r},move:function(e){var n=e.event,t=e.activeIndex;return n.preventDefault(),n.stopPropagation(),"ArrowUp"===n.key?t-1:t+1}}),e1=pC({selector:'[data-nav*="'.concat(fb,'"]'),isValid:function(e){var n="ArrowLeft"===e.key||"ArrowRight"===e.key,t=e.target.matches('[data-nav*="'.concat(fj,'"]'));return n&&(e.altKey||t)},move:function(e){var n=e.event,t=e.activeIndex;return n.preventDefault(),n.stopPropagation(),"ArrowLeft"===n.key?t-1:t+1}}),e4=(0,ne.useMergeRefs)([eJ,eX,eZ,e0,e1],{breadcrumb:"client/workspace/components/SearchReplace/index.tsx:661"}),e8=(0,B.useCallback)(function(e){"Escape"===e.key&&(null==ef||ef())},[ef]);return(0,g.jsxs)(A.View,{css:fC.self,innerRef:e4,onKeyDown:e8,children:[(0,g.jsx)(fk,{isActive:Q,query:em,setQuery:ev,updateData:eY,isRegex:ej,isCaseSensitive:eC,isMatchingWholeWords:eT,setIsRegex:e_,setIsCaseSensitive:ek,setIsMatchingWholeWords:eR,isCollapsed:eE,setIsCollapsed:eA,executeSearch:eq,searchInputRef:eu,onCloseRequested:ef}),eE?null:(0,g.jsx)(fI,{replacement:ey,setReplacement:eb,updateData:eY,query:em,replaceLoading:e$,search:eq,includeGlob:eM,setIncludeGlob:eL,excludeGlob:eV,setExcludeGlob:eO,replace:eQ,results:eH}),(0,g.jsxs)(A.View,{css:fC.results,children:[eW?(0,g.jsx)(A.View,{css:fC.loadingBar},em):null,0===em.length&&0===eH.length?(0,g.jsx)(pk.default,{pane:{type:"searchReplace"},bodyText:"Enter a search query above to see results."}):(0,g.jsx)(fu,{isRegex:ej,query:em,replacement:ey,include:eM,exclude:eV,results:eH,error:ez,paneRef:eN,onOpenSearchPane:ep,onFileLineClicked:ed,searchResultBackgroundColor:eg})]})]})}var fR=n5.Type.Object({type:n5.Type.Literal("searchReplace"),data:n5.Type.Optional(n5.Type.Object({initialQuery:n5.Type.Optional(n5.Type.String()),initialReplacement:n5.Type.Optional(n5.Type.String()),initialIncludeGlob:n5.Type.Optional(n5.Type.String()),initialExcludeGlob:n5.Type.Optional(n5.Type.String())}))}),fP={Content:function(e){var n=e.pane,t=e.options;return(0,g.jsx)(fA,{paneData:(null==n?void 0:n.data)||{},isActive:t.isActive,performPaneOperation:t.performPaneOperation})},Icon:function(e){var n=e.size;return(0,g.jsx)(t0.default,{size:n})},getTitle:function(e){var n,t=null==e||null==(n=e.data)?void 0:n.initialQuery;return t&&t.length>0?"Code Search: ".concat(t):"Code Search"},description:"Search through the text contents of your App",category:ch.PaneCategory.WorkspaceFeatures,decode:function(e){return n7.Value.Decode(fR,e)}},fE=(0,eI.cssRecord)({wrapper:[eT.rcss.height("100%"),eT.rcss.width("100%")]});function fA(e){var n=e.paneData,t=e.isActive,r=e.performPaneOperation,i=(0,B.useRef)(null),o=(0,B.useCallback)(function(){var e,n;null==(e=i.current)||e.select(),null==(n=i.current)||n.focus()},[]);(0,ep.useSetPaneBindings)(function(){return{type:"searchReplace",focusSearchInput:o}},[o]),(0,ep.useSetFocusTarget)(function(){return{focus:o}},[o]);var a=(0,B.useCallback)(function(e){r({operation:"open",pane:{type:"codeEditor",data:{path:e.path,line:e.lineNumber,col:e.columnNumber}},secondary:!0})},[r]),s=(0,B.useCallback)(function(){r({operation:"commit"}),r({operation:"open",pane:{type:"searchReplace"}})},[r]),l=(0,B.useCallback)(function(e,n){r({operation:"replace",pane:{type:"searchReplace",data:(0,m._)({},e,n)}})},[r]);return(0,g.jsx)(A.View,{css:fE.wrapper,pt:6,children:(0,g.jsx)(fT,(0,e9._)((0,m._)({},n),{isActive:t,searchInputRef:i,onFileLineClicked:a,onOpenSearchPane:s,onDataChanged:l,searchResultBackgroundColor:R.tokens.backgroundDefault}))})}var fD=e.i(446692),fV=e.i(180703),fO=e.i(917375),fF=e.i(411928),fM=e.i(952685),fL=e.i(49416),fU=e.i(91442),fB=(0,Z._)(["workspace-guided-tour-data-app","workspace-guided-tour-portfolio-website"]).concat(["100-days-of-python","100-days-of-python-promo","add-guest-new-user","agent-banner","agent-disclaimer","ai-image-generation-banner","apps-announcement","appsOnboardingForkRepl","appsOnboardingRunRepl","appsOnboardingSelectRepl","april_2019_hiring","archive-cta","assignment_markdown","boosts-modal","bounties-home-module","bounties-services-tab","changelog-banner","classroom-repl-talk-ask-on-error","cleanup-popover-dismissed","codemirror-explorers-banner","create-model-solution","credit-packs-banner","credit-packs-promo-dec-2025","createWebsite","curriculum-launch-modal","custom-themes-banner","custom-domain-purchase-announcement","cycles-release","cycles-survey","dashboard_new_folder","dashboard_search","dashboard_templates","debugger_start","dec172020maintenance","deployment-analytics-dot","deployments-banner","deployments-mobile-download","deployments-synced-secrets","desktop-app-banner","desktop-app-nav-menu","devtools-intro","discount_hacker_18","discount_holiday_19","discount_newyear_19","downtime-073118","draw-new-user-cta","edfest-announcement","enveditorintro","expo-qr-preview-pane","expo-go-mobile-preview-nudge","file_tree","flexible-spend-announcement","follow-cursor-avatar-click","ghostwriter-banner","ghostwriter-chat-banner","ghostwriter-repl-resources-cta","ghostwriter-trial-repl-resources-cta","ghostwriter-trial-3-day-left-modal","ghostwriter-trial-banner","ghostwriter-trial-expired-modal","ghostwriter-post-purchase-tour","ghostwriter-existing-user-chat-beta-tour","grid_click","hacker_upgrade","hacker-gift","header-layout-tooltip","home","home-feed","home-onboarding-checklist","home-onboarding-checklist-apps","home-onboarding-checklist-learn","home-onboarding-checklist-repl","home-page-modules-tooltip","home-page-demo-repl-tour-suggestion","hosting_url","introduceYourself","js-4-day-challenge-day-1","js-4-day-challenge-day-2","js-4-day-challenge-day-3","js-4-day-challenge-day-4","js-4-day-challenge-day-end","july_2019_music_jam","july18_irl","landing","languagesInterestedIn","launch-modal","learn-onboarding","legacy-cycles-grant-notice","make_website","march_2019_game_jam","migrate-to-deployments-banner","migrated_unnamed_repls","mobile-app-banner","mobile-app-banner-web-update","mobile-announcement","mobile-new-workspace-banner","mobile-survey-banner-11042021","move_unnamed_repls","repricing-announcement","multiplayer","multiplayer_invite","multiplayer_welcome","new_in_repls","new_share","nft-world-2022","onboarding_connection_toast","onboarding_run","onboarding-simplify-experiment","onboarding-upsell-seen","packager-shell-hint","packman","prettier-formatter","product_hunt","profile-refresh-beta","profile2","projects-overview-cta","projects-overview-tests-disclaimer","publish-guidelines","repl_stars","repl-con-2022","repl-talk-update-2021","repl-talk-update-2022","replit-teams-onboarding-tour","resources-upgrade-modal","revisions_history","run_on_replit","saw_unnamed_folders","search","self-grouping-projects-cta","series-b-announcement","share_classroom","share_repl_to_talk","show_packager_about_tooltip","show_packager_import_tooltip","show_test_update_tooltip","stack-create-cta","stack-migration-cta","summer_hacker","summer-2021-pd-survey","teams_pro_module","teams-grading-survey","teams-pro-2022","template-jam-announcement","threads-2-announcement","upgrade_module","usage-migration-reserved-vms","usage-migration-power-ups-free-user","usage-migration-power-ups-core-user","workspace-always-on-user-reserved-deployments-announcement","workspace-assistant-auto-apply-changes","workspace-assistant-auto-restart-repl","workspace-assistant-intro-video","workspace-deployments-webview-banner","workspace-desktop-tour","workspace-desktop-tour19","workspace-experience-task-completion-survey-06022022","workspace-experience-task-completion-survey-nudge-06022022","workspace-guided-tour-data-app","workspace-guided-tour-portfolio-website","workspace-history-announcement","workspace-ssh-connect-to-vscode-config-tour","workspace-tools-databases-postgres-tour","workspace-repo-projects-tour","youtube-in-the-ws","themes-announcement","extensions-onboarding-checklist","extensions-onboarding-checklist-create","extensions-onboarding-checklist-concepts","extensions-onboarding-checklist-api","extensions-onboarding-checklist-publish","extensions-store-info","external-claim-privacy-warning","gcp-docs-landing-screen","trending-home-module","following-home-module","storage-announcement","pro-onboarding-tour","pro-trial-expired","pro-trial-hcaptcha-fail","pro-trial-enrollment","ai-code-completion","replit-ai-chat-onbording-10-2023","workspace-desktop-new-user-tour","workspace-desktop-tour-2024","workspace-desktop-tour-2025","workspace-bonsai-tour-2025","workspace-desktop-sidebar-tour","replit-core-banner","hosting-deployments-announcement-7-2023","teams-for-education-deprecation-12-2023","teams-for-education-verification-prompt","usage-based-billing-announcement-1-2024","port-nudges","mobileApp-themes-announcement","mobileApp-server-change-CTA","mobileApp-purchase-subscription-announcement","mobileApp-onboarding-education-announcement","mobileApp-teams-coming-soon-announcement","incident-20240219-action-required-banner","incident-20250711-refund-banner","scheduled-deployments-banner","quick-start-guides","teams-projects-onboarding-card","onboarding-purchase-seen","replit-teams-banner","integrations-toast","starter-changes-announcement-aug-2024","private-deployments-banner","editors-have-secret-access-warning","workspace-right-sidebar-cta","assistant-now-defaulting-to-claude-3-5","org-roles-and-permissions-info-banner","onboarding-seen","teams-sponsorships-onboarding-card","agent-billing-notification-usage-page","agent-billing-notification-creation-entrypoint","agent-billing-creation-disclaimer","agent-billing-workspace-disclaimer","agent-billing-threshold-reached-warning","agent-billing-workspace-flex-credits-almost-reached","agent-billing-announcement","agent-billing-announcement-banner","drizzle-studio-announcement","freemium-agent-access-announcement","referral-program-banner","referral-pending-banner","post-verification-educational-upsell","invoice-threshold-change-announcement","agent-v2-welcome-modal","agent-v2-homepage-modal","agent-mobile-notification-nudge","visual-editor-callout","deterministic-edits-callout","image-gen-awareness-callout","bonsai-ws-agent-onboarding","queue-drawer-callout","viewer-seats-announcement","apps-private-by-default-announcement","agent-billing-v2-announcement","agent-billing-v2-home-banner","agent-chat-mode-intro-callout","effort-based-pricing-announcement","dynamic-intelligence-modal","expert-mode-acknowledged","agent-3-announcement-banner","workspace-deployment-pane-production-database-banner","workspace-database-pane-toggle-tour","max-autonomy-warning-acknowledged","design-mode-announcement-banner","free-fast-mode-announcement-banner","connectors-announcement-banner","agent-quick-edit-chat-footer-banner","agent-quick-edit-settings-banner","agent-chat-upsell-with-free-quick-edits-option","promo-high-power-model-announcement-tour","fast-promo-ended-tour","agent-high-power-model-toggle-info","agent-home-chat-mode-tour","agent-starter-fast-mode-enabled-banner"]),fN=function(e,n){var t,r=JSON.parse(tU.default.get("".concat(e,"-tutorialChallenge-").concat(n),"string")||"{}");if("string"==typeof r.tourName&&"string"==typeof r.url&&(t=r.tourName,fB.includes(t)))return r},fG=function(e){var n=e.challenge,t=fB.find(function(e){return e.toString()===n.tourName})||"js-4-day-challenge-day-1",r=(0,dR.useDismissibleElement)(t),i=r.isDone,o=r.isLoading,a=r.setAsDone,s=(0,h.useRouter)();return o?null:(0,g.jsx)(eW.Button,{colorway:i?"primary":"positive",onClick:function(){a(),(0,ei.track)(eo.events.TUTORIAL_DONE_BUTTON_COMPLETED),s.push("/~")},disabled:i,iconLeft:(0,g.jsx)(ss.default,{}),size:"big",text:i?"Challenge completed!":"Complete Challenge"})},fW=((d=fW||{}).Ready="READY",d.Loading="LOADING",d.Error="ERROR",d),fz=function(e){var n=e.progress;return(0,g.jsx)(o5.Tooltip,{tooltip:"Progress: ".concat(Math.round(100*n*10)/10,"%"),children:(0,g.jsx)(A.View,{css:[eT.rcss.width("100%"),eT.rcss.height(4),eT.rcss.backgroundColor.backgroundHigher],children:(0,g.jsx)(A.View,{css:[eT.rcss.width("".concat(100*n,"%")),eT.rcss.height("100%"),eT.rcss.backgroundColor.purpleDefault]})})})},fH=n5.Type.Object({type:n5.Type.Literal("tutorial")}),fq={Content:function(){var e,n=(0,e2.default)().fs,t=(0,es.useShowTutorialVideo)(),r=(0,aD.useSetTourStepTarget)(fO.newUserTour.id,fO.TourStepIds.Sidepane),i=(0,U._)((0,B.useState)([]),2),o=i[0],a=i[1],s=(0,U._)((0,B.useState)("LOADING"),2),l=s[0],u=s[1],c=(0,eN.default)(),d=(0,U._)((0,fV.default)("tutorialProgress--".concat(c),0),2),p=d[0],f=d[1],h=(0,U._)((0,B.useState)(!1),2),m=h[0],v=h[1],x=(0,B.useRef)(null),y=(0,eB.useCurrentUserId)(),b=y?y.toString():"",w=(0,fU.useGetCursorState)(),j=(0,fU.useCursorFilepath)(),_=(0,fM.default)(j),S=(0,$.default)(function(){return _?function(e){var n,t;return _({code:e,insertAt:null!=(t=null==(n=w())?void 0:n.position.offset)?t:"end"})}:void 0},[_,w]),C=fN(b,c),k=C?(0,g.jsx)(fG,{challenge:C}):null,I=(0,B.useCallback)(function(){x.current&&(x.current.scrollTop=0)},[x]);return((0,B.useEffect)(function(){var e=!1;return(0,ee._)(function(){var t,r,i,o,s,l,c,d,p,f,g,h,m,v;return(0,en._)(this,function(x){switch(x.label){case 0:return u("LOADING"),[4,n.readDir(fL.TUTORIAL_DIR)];case 1:if(t=x.sent(),e)return[2];if(t.error)return u("ERROR"),[2];return r=[],[4,Promise.all(t.children.filter(function(e){var n;return e.type===td.FileType.File&&(null==(n=fD.FileTypeRepository.from(e.filename))?void 0:n.id)==="markdown"}).map(function(e){var t="".concat(fL.TUTORIAL_DIR,"/").concat(e.filename);return Promise.all([t,n.readFile(t)])}))];case 2:if(i=x.sent(),e)return[2];o=!0,s=!1,l=void 0;try{for(c=i[Symbol.iterator]();!(o=(d=c.next()).done);o=!0)f=(p=(0,U._)(d.value,2))[0],(g=p[1]).error?u("ERROR"):(m=g.content.toString(),v=RegExp("^#\\s(?<title>.*)").exec(m),r.push({title:null==v||null==(h=v.groups)?void 0:h.title,content:m,path:f}))}catch(e){s=!0,l=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw l}}return a(r),u("READY"),[2]}})})(),function(){e=!0}},[n]),(0,B.useEffect)(function(){o[p]||f(0)},[p,f,o]),"LOADING"===l)?(0,g.jsx)(A.View,{css:[eT.rcss.center],grow:!0,shrink:!0,children:(0,g.jsx)(oL.default,{})}):"ERROR"===l?(0,g.jsx)(A.View,{css:[eT.rcss.center],grow:!0,shrink:!0,children:(0,g.jsxs)(A.View,{css:[eT.rcss.center,eT.rcss.colWithGap(4)],children:[(0,g.jsx)(ic.default,{color:R.tokens.accentNegativeDefault}),(0,g.jsx)(ez.Text,{color:"dimmer",multiline:!1,children:"Failed to load tutorial"})]})}):0===o.length?(0,g.jsx)(A.View,{css:[eT.rcss.center],grow:!0,shrink:!0,children:(0,g.jsxs)(A.View,{css:[eT.rcss.center,eT.rcss.colWithGap(4)],children:[(0,g.jsx)(ic.default,{color:R.tokens.accentNegativeDefault}),(0,g.jsx)(ez.Text,{color:"dimmer",multiline:!1,children:"No tutorials found!"})]})}):m?(0,g.jsxs)(A.View,{css:[eT.rcss.overflowY("scroll"),eT.rcss.flex.growAndShrink(1),eT.rcss.p(8),eT.rcss.colWithGap(16)],children:[(0,g.jsx)(ez.Text,{variant:"headerDefault",multiline:!1,children:"Table of Contents"}),(0,g.jsx)(A.View,{grow:!0,shrink:!0,gap:8,children:o.map(function(e,n){return(0,g.jsxs)(A.View,{css:[p===n?eT.rcss.backgroundColor.backgroundHighest:eT.rcss.backgroundColor.backgroundHigher,eT.rcss.borderRadius(4),eT.rcss.rowWithGap(8),eT.rcss.align.center,eT.rcss.cursor.pointer,p===n?{outline:"solid 2px ".concat(R.tokens.outlineDimmest)}:{},{":hover":{outline:"solid 2px ".concat(R.tokens.outlineDimmest)}}],p:8,onClick:function(){f(n),v(!1)},children:[(0,g.jsx)(A.View,{css:[eT.rcss.backgroundColor.backgroundHighest,eT.rcss.width(20),eT.rcss.height(20),eT.rcss.borderRadius("full"),eT.rcss.center,{outline:"solid 1px ".concat(R.tokens.outlineDimmest)}],children:(0,g.jsx)(ez.Text,{variant:"small",color:"dimmest",multiline:!1,children:n+1})}),(0,g.jsx)(ez.Text,{css:[eT.rcss.maxWidth("80%")],multiline:!1,children:e.title})]},e.title)})})]}):(0,g.jsx)(A.View,{innerRef:r,css:[eT.rcss.height("100%")],children:(0,g.jsxs)(A.View,{dataCy:"tutorial-viewer-content",innerRef:x,css:[eT.rcss.overflowY("scroll"),eT.rcss.flex.growAndShrink(1),eT.rcss.p(16),eT.rcss.pb(48),eT.rcss.colWithGap(16)],children:[t?(0,g.jsx)(eW.Button,{text:"Show tutorial video",iconLeft:(0,g.jsx)(rZ.default,{}),onClick:function(){return t()}}):null,k,o.length>1&&(0,g.jsx)(eW.Button,{text:"Table of Contents",iconLeft:(0,g.jsx)(pr.default,{}),onClick:function(){return v(!0)}}),(0,g.jsx)(fF.default,{fs:n,path:o[p].path,source:o[p].content,sourcePos:!1,onCodeInsert:S}),o.length>1&&(0,g.jsxs)(A.View,{css:[eT.rcss.position.absolute,eT.rcss.width("100%"),eT.rcss.left(0),eT.rcss.bottom(0),eT.rcss.overflow("hidden")],children:[(0,g.jsx)(fz,{progress:(p+1)/o.length}),(0,g.jsxs)(A.View,{css:[eT.rcss.width("100%"),eT.rcss.height(40),eT.rcss.align.center,eT.rcss.flex.row],children:[(0,g.jsx)(A.View,{tag:"button",css:[eT.rcss.backgroundColor.backgroundHigher,eT.rcss.cursor.pointer,eT.rcss.width(40),eT.rcss.height("100%")],p:8,justify:"center",onClick:function(){p>0&&(f(function(e){return e-1}),I())},children:p>0&&(0,g.jsx)(cQ.default,{size:24})}),(0,g.jsx)(A.View,{tag:"button",css:[eT.rcss.height("100%"),eT.rcss.justify.spaceBetween,eT.rcss.backgroundColor.backgroundHighest,eT.rcss.align.center,eT.rcss.p(8),eT.rcss.cursor.pointer,{userSelect:"none"}],grow:!0,shrink:!0,row:!0,gap:8,onClick:function(){p<o.length-1&&(f(function(e){return e+1}),I())},children:p<o.length-1&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(ez.Text,{multiline:!1,css:[eT.rcss.flex.growAndShrink(1),eT.rcss.textAlign.left,eT.rcss.fontSize(R.tokens.fontSizeSubheadDefault)],children:[(0,g.jsxs)("span",{css:[eT.rcss.color.foregroundDimmer],children:["Next",o[p+1].title?": ":" page"]}),(0,g.jsx)("b",{children:null!=(e=o[p+1].title)?e:""})]}),(0,g.jsx)(sp.default,{size:24})]})})]})]})]})})},Icon:function(e){var n=e.size;return(0,g.jsx)(dc.default,{size:n})},getTitle:function(){return"Tutorial"},category:ch.PaneCategory.Other,decode:function(e){return n7.Value.Decode(fH,e)}},fK=e.i(909478),f$=e.i(561132),fQ=e.i(137218),fY=e.i(134405),fJ=e.i(417120),fX=e.i(378042),fZ=e.i(401135),f0=e.i(813453),f1=e.i(942314),f2=e.i(548364),f4=e.i(236906),f8=e.i(759967),f3={Content:function(e){var n,t,r=e.pane.data,i=e.options,o=i.performPaneOperation,a=i.paneId,s=(0,B.useRef)(null),l=(0,G.useSupportsAgent)(),u=(0,f8.useIsExpertMode)(),c=(0,oX.useIsAgentStackRepl)().isAgentStackRepl,d=(0,e2.default)(),p=d.ports,f=d.container,h=(0,fK.useOpenedAndForwardedPorts)(p),v=(0,B.useMemo)(function(){var e;return null!=(e=(0,fX.getInitialPort)(r,h))?e:80},[r,h]),x=(0,fZ.useShowEmptyState)(v),y=(0,o9.default)(),b=y.didConnectOnce,w=y.didDisconnect,j=(0,B.useCallback)(function(e){o({operation:"open",secondary:!1,pane:e})},[o]),_=(0,B.useCallback)(function(){return j({type:"developer",data:{tab:["networking"]}})},[j]),S=(0,B.useCallback)(function(){return j({type:"deployments"})},[j]),C=null==r?void 0:r.previewScreenSize,k=(0,B.useCallback)(function(e){o({operation:"replace",pane:{type:"webview",data:(0,e9._)((0,m._)({},null!=r?r:{}),{previewScreenSize:e})}})},[r,o]),I=null==r||!r.expoPreviewGuide||r.expoPreviewGuide.shown,T=(0,B.useCallback)(function(e){o({operation:"replace",pane:{type:"webview",data:(0,e9._)((0,m._)({},null!=r?r:{}),{expoPreviewGuide:{shown:e}})}})},[r,o]),R=(0,f2.useDeploymentCommands)({openDeploymentsPane:S,includeSharing:!0}).getCommandGroups;return((0,ep.useSetPaneBindings)(function(){var e={type:"webview",refresh:function(){var e;null==(e=s.current)||e.refresh()},navigate:function(e,n){var t;null==(t=s.current)||t.navigateTo(e,n)}},n=R();return n.length>0?(0,e9._)((0,m._)({},e),{commands:n}):e},[R]),c)?(0,g.jsx)(f0.WebviewDisabledForAgentStack,{openPane:j}):!l||u||c?x?(0,g.jsx)(f1.default,{openNetworkingTool:_,didConnectOnce:b,didDisconnect:w}):(0,g.jsx)(fX.WebviewBrowser,{ref:s,initialPort:v,initialPath:null==r||null==(n=r.ports)?void 0:n.path,openPane:j,ports:p,container:f,previewScreenSize:C,setPreviewScreenSize:k,expoPreviewGuideShown:I,setExpoPreviewGuideShown:T,paneId:a}):(0,g.jsx)(f6,{ref:s,initialPort:v,initialPath:null==r||null==(t=r.ports)?void 0:t.path,openPane:j,previewScreenSize:C,setPreviewScreenSize:k,expoPreviewGuideShown:I,setExpoPreviewGuideShown:T,paneId:a})},Icon:function(e){var n=e.size;return(0,g.jsx)(sl.IconContext.Provider,{value:{size:n},children:(0,g.jsx)(rJ.default,{})})},getTitle:function(){return"Preview"},description:"Preview your App",category:ch.PaneCategory.WorkspaceFeatures,decode:f4.decode},f6=(0,B.forwardRef)(function(e,n){var t=e.initialPort,r=e.initialPath,i=e.openPane,o=e.previewScreenSize,a=e.setPreviewScreenSize,s=e.expoPreviewGuideShown,l=e.setExpoPreviewGuideShown,u=e.paneId,c=(0,fY.useAgentAwareWebviewState)(),d=(0,e2.default)(),p=d.ports,f=d.container,h=(0,K.useFlag)({controlName:"flag-free-plan",default:!1}),m=(0,al.useIsFreemiumStarterPlanUsersOwnRepl)().isFreemiumStarterPlanUsersOwnRepl,v=(0,aw.useGetAgentFreeUsage)(),x=v.agentUsage,y=v.agentUsageV2,b=v.loading,w=v.error,j=y?y.isUnderQuota:null==x?void 0:x.isUnderQuota,_=h&&!b&&!w&&m&&!1===j,S=c.state===fY.WebviewState.READY||c.state===fY.WebviewState.LAST_RESORT_READY,C=(0,as.useIsAgentWebDesignMockup)().isWebDesignMockup,k=(0,U._)((0,B.useState)(!1),2),I=k[0],T=k[1],R=(0,fJ.useIsAgentOptimisticallyWorking)(),P=I&&(C||_);if(!S)return(0,g.jsx)(fQ.AgentAwareWebviewNonReadyStates,{webviewState:c,openPane:i,isFreemiumUserOutOfAgentCredits:_});var E=c.state===fY.WebviewState.READY?c.presentPort:c.externalPort,A=c.state===fY.WebviewState.READY?c.presentRoute:r,D=function(){return T(!1)};return(0,g.jsxs)(g.Fragment,{children:[P&&R&&(0,g.jsx)(f$.AgentAwareWebviewPreviewSoonEmptyStateV2,{canDismiss:!0,onDismiss:D,isFreemiumUserOutOfAgentCredits:_}),P&&!R&&(0,g.jsx)(f$.AgentAwareWebviewRuntimeErrorCrashedEmptyState,{openPane:i,canDismiss:!0,onDismiss:D,isFreemiumUserOutOfAgentCredits:_}),(0,g.jsx)(fX.WebviewBrowser,{ref:n,initialPort:null!=E?E:t,initialPath:null!=A?A:r,ports:p,container:f,openPane:i,previewScreenSize:o,setPreviewScreenSize:a,expoPreviewGuideShown:s,setExpoPreviewGuideShown:l,paneId:u,onUnhandledExceptionChange:T})]})}),f9=e.i(835109),f5=e.i(676702),f7=e.i(544880),ge=e.i(637972),gn=e.i(643041);function gt(){var e=(0,v._)(["\n  query NotificationModalCheckMultiplayers($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        multiplayers {\n          id\n        }\n      }\n    }\n  }\n"]);return gt=function(){return e},e}var gr={},gi=(0,x.gql)(gt());function go(){var e=(0,v._)(["\n  query BrowserNotifications($username: String!) {\n    user: userByUsername(username: $username) {\n      id\n      image\n    }\n  }\n"]);return go=function(){return e},e}var ga=(0,x.gql)(go()),gs=!1;function gl(){return"Notification"in window?"true"===tU.default.get(gu,"string")?"dismissed":window.Notification.permission:"denied"}var gu="notifications/dismissedModal";function gc(e){tU.default.set(gu,String(e))}var gd={};function gp(e){return(0,ee._)(function(e){var n,t,r,i,o,a,s,l,u,c,d;return(0,en._)(this,function(p){switch(p.label){case 0:if(n=e.title,t=e.body,r=e.badge,i=e.icon,o=e.iconByUsername,a=e.tag,s=e.onClick,u=void 0===(l=e.cacheDuration)?0:l,!document.hidden&&document.hasFocus()||"granted"!==gl()||(c=Date.now(),a in gd&&gd[a]+u>c))return[2];if(!o)return[3,2];return[4,(0,ee._)(function(){var e,n;return(0,en._)(this,function(t){switch(t.label){case 0:if(null===eG.apolloClient)return[2];return[4,eG.apolloClient.query({query:ga,variables:{username:o}})];case 1:return[2,null==(n=t.sent().data)||null==(e=n.user)?void 0:e.image]}})})()];case 1:i=p.sent(),p.label=2;case 2:return d=new window.Notification(n,{body:t,badge:r||"/public/images/logo-grayscale.png",icon:i||"/public/images/icon-square.png",tag:a}),setTimeout(function(){d.close()},1e4),d.addEventListener("click",function(){window.focus(),d.close()}),s&&d.addEventListener("click",s),gd[a]=c,[2]}})}).apply(this,arguments)}function gf(e){try{new Audio(e).play().catch(function(){})}catch(e){}}function gg(e){var n,t,r,i=e.replId,o=(0,U._)((0,B.useState)(!1),2),a=o[0],s=o[1],l=(0,aD.useIsTouring)(),u=(n={variables:{replId:i}},t=(0,m._)({},gr,n),y.useQuery(gi,t)).data,c=(null==u||null==(r=u.getRepl)?void 0:r.__typename)==="Repl"&&u.getRepl.multiplayers.length>0;(0,B.useEffect)(function(){l||!c||"default"===gl()&&s(!0)},[c,l]);var d=(0,B.useCallback)(function(){gc(!0),s(!1)},[]),p=(0,B.useCallback)(function(){return(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:return[4,(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:return[4,(0,ee._)(function(){return(0,en._)(this,function(e){try{window.Notification.requestPermission().then()}catch(e){return[2,new Promise(function(e){window.Notification.requestPermission(function(n){e(n)})})]}return[2,window.Notification.requestPermission()]})})()];case 1:return e.sent(),gc(!1),[2]}})})()];case 1:return e.sent(),s(!1),[2]}})})()},[]);return a?(0,g.jsx)(eR.Modal,{preventClose:!0,isOpen:!0,onRequestClose:d,children:(0,g.jsxs)(A.View,{gap:24,children:[(0,g.jsx)(ez.Header,{variant:"headerDefault",level:2,children:"Replit needs your permission to enable notifications."}),(0,g.jsx)(ez.Text,{children:"Never miss messages from your collaborators if you're in another tab or window."}),(0,g.jsxs)(A.View,{row:!0,gap:12,justify:"end",children:[(0,g.jsx)(eW.Button,{onClick:d,text:"Deny",iconLeft:(0,g.jsx)(ic.default,{})}),(0,g.jsx)(eW.Button,{text:"Allow notifications",colorway:"positive",iconLeft:(0,g.jsx)(ss.default,{}),onClick:p})]})]})}):null}var gh=e.i(644826),gm=e.i(357210),gv=(0,R.cvarsFrom)("ResizeHandle.module.css",["--width","--height","--transform-x","--transform-y","--rotation","--z-index","--cursor"]),gx=(0,B.memo)(function(e){var n,t=e.handleId,r=(0,es.useHandleView)(t),i=(n=(0,B.useRef)(null),(0,uI.useStyleSet)(n,r.size,function(e){var n,t=e.width,r=e.height;return n={},(0,I._)(n,gv.width,t+"px"),(0,I._)(n,gv.height,r+"px"),n}),(0,uI.useStyleSet)(n,r.position,function(e){var n,t=e.x,r=e.y;return n={},(0,I._)(n,gv.transformX,Math.round(t)+"px"),(0,I._)(n,gv.transformY,Math.round(r)+"px"),n}),(0,uI.useStyleSet)(n,r.isStacked,function(e){return(0,I._)({},gv.cursor,e?"row-resize":"col-resize")}),(0,uI.useStyleSet)(n,r.isActive,function(e){return(0,I._)({},gv.zIndex,(e?ie.zIndexLevels.gutterActive:ie.zIndexLevels.gutter).toString())}),n),o=(0,es.useResizeTiling)(),a=(0,es.useTogglingSnap)(),s=(0,B.useRef)(null),l=(0,ix.default)(r.isSnapped),u=(0,ix.default)(r.isStacked);return(0,g.jsx)(A.View,{align:"center",justify:"center",innerRef:i,clsx:[gm.default.root,(0,I._)({},gm.default.stacked,u)],onDoubleClick:function(){a(r.handle.current)},onPointerDown:function(e){(0,uV.measureMouseMove)(e,{start:function(){var e=r.handle.current;s.current=document.activeElement,o({type:"start",leftPath:e.leftPath,stacked:e.stacked})},move:function(e){o({type:"update",moveDelta:e.delta})},end:function(){var e,n;o({type:"end"}),null==(n=s.current)||null==(e=n.focus)||e.call(n)}})},onContextMenu:function(e){e.preventDefault(),e.stopPropagation()},children:l?(0,g.jsx)(gh.default,{className:"icon"}):(0,g.jsx)(A.View,{clsx:gm.default.grip})})}),gy=e.i(387948),gb=e.i(123111),gw=e.i(736451),gj=e.i(94366),g_=e.i(924748),gS=e.i(825606),gC=e.i(241939),gk=e.i(145864),gI=e.i(231346),gT=e.i(916438),gR="video.json",gP=(0,gT.join)(fL.TUTORIAL_DIR,gR),gE=e.i(304969);e.i(792e3);var gA=e.i(8808),gD=e.i(223808);function gV(){var e=(0,v._)(["\n  mutation HandlePortOpenedUpdateReplConfig($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        config {\n          isVnc\n          isServer\n        }\n      }\n    }\n  }\n"]);return gV=function(){return e},e}var gO={},gF=(0,x.gql)(gV()),gM=e.i(801127),gL=e.i(37292),gU=e.i(374106),gB=e.i(986194),gN=e.i(19379),gG=e.i(584647),gW=e.i(943565),gz="/public/sounds/Achievement_Bell_Replit.wav",gH={direction:"reverse",state:{isExecutingPlan:!1},reducer:function(e,n){if(e.sender.type!==oP.UserType.AI)return!1;var t=e.contents.contents;switch(null==t?void 0:t.$kind){case"agentPlanEventContents":var r=t.agentPlanEventContents;if(!r)break;if(!0===r.requiresApproval)return n.notification={id:r.planId,text:"Plan is waiting for approval"},n.isExecutingPlan=!0,!1;if(n.isExecutingPlan&&r.step.subSteps.every(function(e){return e.status===oP.AgentPlanStepStatus.STEP_COMPLETE}))return n.notification={id:r.planId,text:"Plan has been completed!"},n.isExecutingPlan=!1,!1;break;case"agentAskUserForActionRequest":var i=t.agentAskUserForActionRequest.request;if((null==i?void 0:i.$kind)==="userSecretsRequest")return n.notification={id:e.id,text:"Agent needs secrets to proceed"},!1;return n.notification={id:e.id,text:"Agent has an update for you"},!1;case"agentTimelineEventContents":var o,a=t.agentTimelineEventContents,s=a.toolData,l=a.toolName;if((null==s?void 0:s.$kind)==="messageData"){switch(null==(o=s.messageData.agentAction.optionType)?void 0:o.$kind){case"messageButtonAction":return n.notification={id:e.id,text:"Agent has a question for you"},!1;case"secretRequestAction":return n.notification={id:e.id,text:"Agent needs secrets to proceed"},!1;case"deployRequestAction":return n.notification={id:e.id,text:"Agent needs your permission to publish the application"},!1}if("user_response"===l)return n.notification={id:e.id,text:"Agent has a question for you"},!1}}n.notification=void 0}};function gq(){var e=(0,v._)(["\n  query ReplEnvironmentNotifyUserJoin($id: String!) {\n    getRepl(id: $id) {\n      ... on Repl {\n        id\n        title\n      }\n    }\n  }\n"]);return gq=function(){return e},e}var gK=(0,x.gql)(gq()),g$=e.i(389320),gQ=e.i(803542);function gY(){var e=(0,v._)(["\n  query TrackMultiplayer($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        multiplayers {\n          id\n        }\n        owner {\n          ... on Team {\n            id\n          }\n          ... on User {\n            id\n          }\n        }\n      }\n    }\n  }\n"]);return gY=function(){return e},e}var gJ={},gX=(0,x.gql)(gY());function gZ(){var e=(0,es.useOpenTool)(),n=(0,tw.useIsExtensionRepl)(),t=(0,es.useGetPanes)(),r=(0,es.useRevealPane)();return(0,B.useCallback)(function(i){var o=!!i&&i.reveal;if(n)return void e({pane:{type:"runnerOutput"},activate:!1,commit:!0});var a=t().find(function(e){var n=(0,U._)(e,2);return"runnerOutput"===(n[0],n[1]).type});a||e({pane:{type:"runnerOutput"},activate:!1,reveal:!1}),o&&a&&r({paneId:a[0],activate:!0})},[n,t,e,r])}function g0(e,n,t){var r=(0,es.useLayoutInitType)(),i=(0,es.useInsertPane)(),o=(0,es.useRevealPane)(),a=(0,es.useGetPanes)();(0,eb.useCommandBinding)(function(){if(r)return[e,function(){var e=a().find(function(e){return(0,U._)(e,2)[1].type===n.type});e?o({paneId:e[0],activate:!0}):i((0,e9._)((0,m._)({},t),{pane:n,activate:!0,placement:{type:"secondary"}}))}]},[r,i,o])}var g1=e.i(391542),g2=e.i(984826),g4=e.i(563209),g8=e.i(708648),g3=e.i(596378),g6=e.i(143480),g9=e.i(905890),g5=e.i(681850),g7=e.i(349467),he=e.i(402434),hn=e.i(326333),ht=e.i(8812),hr=e.i(239296),hi=e.i(829960),ho=e.i(387524),ha=e.i(104375);function hs(){var e=(0,v._)(["\n  query WorkspaceShowHiddenFiles($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        templateInfo {\n          label\n        }\n      }\n    }\n  }\n"]);return hs=function(){return e},e}var hl={},hu=(0,x.gql)(hs()),hc=e.i(423111),hd=e.i(646325),hp=e.i(416406),hf=e.i(440560),hg=e.i(985430),hh=e.i(752310),hm=e.i(741740),hv=e.i(927938),hx=e.i(551544),hy=e.i(136780),hb=e.i(604026),hw=e.i(154488);function hj(e){var n,t,r,i,o,a,s,l,u,c,d,p,f,h,v,x,b,w,j,_,S,C,I,T,P,E,A,D,V,O,F,M,L,N,W,z,H,q,$,Y,J,X,Z,et,er,ea,el,eu,ec,ed,eg,eh,em,ex,ey,ew,ej,e_,eS,eC,ek,eI,eT,eR,eP,eE,eA,eD,eV,eO,eF,eM,eL,eU,eB,eW,ez,eH,eq,eQ,eY,eX,eZ,e0,e1,e4,e8,e3,e6,e9,e5,e7,ne,nn,nt,nr,no,na,ns,nl,nu,nc,nd,np,nf,ng,nh,nm,nv,nx,ny,nb,nw,nj,n_,nS,nC,nk,nI,nT,nR,nP,nE,nA,nD,nV,nO,nF,nM,nL,nU,nB,nN,nG,nW,nz,nH,nq,nK,n$,nQ,nY=e.repl,nJ=e.currentUser,nX=(0,e2.default)(),nZ=nX.replspaceApi,n0=nX.dotReplit,n1=nX.container,n2=nX.ports;n=(0,e2.default)().lspnix,t=(0,rv.usePreferences)("codeIntelligence").preferences.codeIntelligence,r=(0,ef.useOpenFiles)().length>0,(0,B.useEffect)(function(){r&&t?n.enable():n.disable()},[n,t,r]),i=(0,U._)((0,gL.useBsod)(),1)[0],o=(0,es.useSaveLayoutState)(),a=(0,aD.useIsTouring)(),s=(0,eN.default)(),l=a||i,(0,B.useEffect)(function(){var e=function(){o({replId:s,force:!1}),o.flush()};if(!l)return window.addEventListener("beforeunload",e),function(){window.removeEventListener("beforeunload",e)}},[o,s,l]),(0,B.useEffect)(function(){var e=function(){"hidden"===document.visibilityState&&o({replId:s,force:!1})};if(!l)return document.addEventListener("visibilitychange",e),function(){document.removeEventListener("visibilitychange",e)}},[o,s,l]),(0,B.useEffect)(function(){if(!l){var e=null;return function n(){e=setTimeout(function(){o({replId:s,force:!1}),n()},6e4)}(),function(){e&&clearTimeout(e)}}},[o,s,l]),(0,B.useEffect)(function(){if(!l)return function(){o({replId:s,force:!1}),o.flush()}},[o,s,l]),(0,gj.default)(),(0,hm.default)(),(0,hx.default)({workspaceType:"desktop"}),(0,B.useEffect)(function(){var e=function(e){"s"===e.key&&(0,r5.getCmdOrCtrl)(e)&&e.preventDefault()};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}},[]),(0,hh.default)(),c=(u=(0,e2.default)()).container,d=u.presence,(0,B.useEffect)(function(){var e=d.onUserJoin(function(n){var t,r=null==(t=c.getContext())?void 0:t.repl;if(r){var i,o=n.username;return(i=r.id,(0,ee._)(function(){var e;return(0,en._)(this,function(n){switch(n.label){case 0:if(!eG.apolloClient)throw Error("Expected Apollo client");return[4,eG.apolloClient.query({query:gK,variables:{id:i}})];case 1:return[2,(null==(e=n.sent().data)?void 0:e.getRepl.__typename)==="Repl"?e.getRepl.title:null]}})})()).then(function(e){e&&gp({title:"",body:"".concat(o," joined ").concat(e),tag:"".concat(r.id,"-").concat(o,"-joined"),iconByUsername:o,cacheDuration:9e5})}),function(){e()}}})},[d,c]),h=(0,rv.usePreferences)("agentAudioNotification").preferences.agentAudioNotification,v=(0,gN.usePageVisibility)(),w="control"!==(b=null!=(p=null==(x=(0,gW.useGetExperiment)("sound-on_v2")())?void 0:x.get("treatmentName"))?p:"control"),j="soundAndNoti"===b,_=(0,eN.default)(),S=(0,Q.useIsInMobileWorkspace)(),C=(0,rv.usePreferences)("agentAudioNotification").preferences.agentAudioNotification,(0,B.useEffect)(function(){var e,n;S||(e=["click","keydown","touchstart"],n=function(){if(!gs)try{new Audio("data:audio/mpeg;base64,SUQzBAAAAAABEVRYWFgAAAAtAAADY29tbWVudABCaWdTb3VuZEJhbmsuY29tIC8gTGFTb25vdGhlcXVlLm9yZwBURU5DAAAAHQAAA1N3aXRjaCBQbHVzIMKpIE5DSCBTb2Z0d2FyZQBUSVQyAAAABgAAAzIyMzUAVFNTRQAAAA8AAANMYXZmNTcuODMuMTAwAAAAAAAAAAAAAAD/80DEAAAAA0gAAAAATEFNRTMuMTAwVVVVVVVVVVVVVUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQsRbAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQMSkAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV").play().catch(function(){}),gs=!0}catch(e){}e.forEach(function(e){document.removeEventListener(e,n)})},e.forEach(function(e){document.addEventListener(e,n,{once:!0,passive:!0})}))},[S]),I=(0,B.useCallback)(function(e,n){C&&document.hidden&&!S&&gf(gz),j&&gp({title:"Replit",body:n,tag:"".concat(_,"-").concat(e),icon:"/public/icons/icon-maskable-512x512.png",cacheDuration:3e5})},[C,_,S,j]),T=(0,Q.useIsInMobileWorkspace)(),P=(0,oE.useChatter)(),E=(0,rO.useObservable)(P.sessions.agent.current),A=(0,B.useMemo)(function(){return null==E?void 0:E.reduce(gH,1)},[E]),D=null==E?void 0:E.agent.state,V=(0,B.useMemo)(function(){return D&&A?uo.Observable.combine(D,A):null},[D,A]),O=(0,B.useRef)(null),F=(0,B.useRef)(0),(0,uR.useObserver)(D,{next:function(e){if(e){var n=e.state,t=O.current;if(w&&h&&!v&&t===oP.AgentRunState.AGENT_STATE_RUNNING&&n===oP.AgentRunState.AGENT_STATE_PAUSED&&!T){var r=Date.now();r-F.current>=15e3&&(gf(gz),I("agent-paused-".concat(r),"Replit Agent finished working. Come back to check your results."),F.current=r)}O.current=n}}}),(0,uR.useObserver)(V,{next:function(e){var n=(0,U._)(e,2),t=n[0],r=n[1].notification;r&&(null==t?void 0:t.state)===oP.AgentRunState.AGENT_STATE_PAUSED&&I(r.id,r.text)}}),M=(0,gG.useCurrentAgentTestingTakeover)({sessionId:null!=(f=null==E?void 0:E.id)?f:null}),(0,B.useEffect)(function(){(null==M?void 0:M.request.status)==="pending"&&I(M.request.sessionId,"Agent needs your help with testing")},[M,I]),(0,oE.useChatHook)("received-completed-event",function(e){var n=e.event;if(w&&h&&!v&&(0,gU.isEventContentsKind)(n,"agentPlanEventContents")&&!T){var t=n.contents.contents,r=(0,gB.unkind)(t);if(n.sender.type===oP.UserType.AI&&r.requiresApproval){var i=Date.now();i-F.current>=5e3&&(gf(gz),I("agent-plan-ready-".concat(i),"Your Replit Agent needs your approval to continue."),F.current=i)}}}),(0,hr.default)(),(0,hn.useLiveViewReplConnection)(),L=(0,e2.default)().presence,(0,B.useEffect)(function(){return L.onFollowingUsersChanged(function(e){var n=e.followingUsers,t=e.type,r=n.length;"follow"===t?(0,ei.track)(eo.events.REMOTE_USER_CURSOR_FOLLOWED,{numFollowers:r}):(0,ei.track)(eo.events.REMOTE_USER_CURSOR_UNFOLLOWED,{numFollowers:r})})},[L]),(0,hy.default)(),N=(0,e2.default)().presence,W=(0,es.useActiveFile)(),(0,B.useEffect)(function(){N.updateOpenFile(W)},[N,W]),H=(z=(0,e$.default)()).showConfirm,q=z.showNotice,$=z.hideMessage,Y=z.showError,J=(0,e2.default)().container,X=(0,B.useRef)(!1),(0,B.useEffect)(function(){var e=J.onToast(function(e){e.startsWith("PANIC")||q(e,Math.max(1e4,e.length/.025+1e3))}),n=null,t=!1,r=J.onConnectionStateChanged(function(e){if(n&&($(n),n=null),e===gA.ConnectionState.CONNECTED){t&&X.current&&(n=H("Connected",1500),X.current=!1),t=!0;return}if(t){if(e===gA.ConnectionState.CONNECTING){n=q("Reconnecting");return}if(e===gA.ConnectionState.DISCONNECTED){n=Y("Disconnected"),X.current=!0;return}}});return function(){n&&$(n),e(),r()}},[J,H,q,Y,$]),Z=(0,e$.default)().showConfirm,et=(0,e2.default)().fs,(0,B.useEffect)(function(){var e=et.registerOnFlushSuccess(function(e,n){if(n===td.FlushSource.MANUAL_SAVE){var t="Saved ".concat(e);Z(t,Math.max(1e4,t.length/.025+1e3))}});return function(){e()}},[et,Z]),ea=(er=(0,e$.default)()).showNotice,el=er.showError,(0,oD.usePid2)(function(e,n){var t=n.signal;return(0,ee._)(function(){var n,r;return(0,en._)(this,function(i){switch(i.label){case 0:return[4,e.pythonMigration.detectLegacyPython.rpc({},{signal:t})];case 1:if(!(n=i.sent()).ok||!n.payload.oldVenvDetected)return[2];return[4,e.pythonMigration.migratePython.rpc({},{signal:t})];case 2:if(!(r=i.sent()).ok)return"NOP"!==r.payload.code&&el((0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{children:"Failed to migrate legacy Python configuration."}),(0,g.jsx)("div",{children:"You may need to reinstall your Python packages, or contact support."})]}),1e4),[2];return ea((0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{children:"This Repl contained legacy Python configuration"}),(0,g.jsx)("div",{children:"and has been automatically migrated."})]}),1e4),[2]}})})()},[el,ea]),eu=(0,es.useLayoutInitType)(),ec=gZ(),ed=(0,aD.useTourStep)(fO.newUserTour.id,fO.TourStepIds.Output),(0,B.useEffect)(function(){if(eu&&(null==ed?void 0:ed.isActive)){var e=setInterval(function(){ec()},200);return function(){clearInterval(e)}}},[null==ed?void 0:ed.isActive,ec,eu]),g0(rK.showShell.id,{type:"shell"}),g0(rK.showGit.id,{type:"git"}),g0(rK.showSettings.id,{type:"preferences"}),g0(rK.showConsole.id,{type:"runnerOutput"}),g0(rK.showReplitAi.id,{type:"ghostwriterChat"},{commit:!0}),(0,g2.default)(),eg=(0,e2.default)().presence,eh=(0,es.useOpenFile)(),(0,B.useEffect)(function(){return eg.onUserOpenedFile(function(e){var n=e.user,t=e.file,r=eg.getFollowedUser();!r||r.id!==n.id||t&&eh({path:t})})},[eg,eh]),ex=(em=(0,U._)((0,B.useState)(null),2))[0],ey=em[1],(0,B.useEffect)(function(){return eg.onFollowedUserChanged(ey)},[eg]),(0,B.useEffect)(function(){if(ex){var e=setTimeout(function(){document.addEventListener("click",n)},0);return function(){clearTimeout(e),document.removeEventListener("click",n)}}function n(){eg.unfollowUser()}},[ex]),ew=(0,hc.useSetAreHiddenFilesVisible)(),eC=(null==(eS=(ej={variables:{replId:(0,eN.default)()}},e_=(0,m._)({},hl,ej),y.useQuery(hu,e_)).data)?void 0:eS.getRepl.__typename)==="Repl"?eS.getRepl:null,(0,B.useEffect)(function(){var e;!eC||(null==(e=eC.templateInfo)?void 0:e.label.includes("Blank Repl"))&&ew(!0)},[ew,eC]),ek=(0,es.useToggleTutorialVideo)(),eI=(0,e2.default)().fs,eT=(0,fL.default)().isTutorial,eR=(0,eK.default)(ek),(0,B.useEffect)(function(){if(eT){var e=!1,n=eI.watchDir(fL.TUTORIAL_DIR,{onChange:function(n){(0,ee._)(function(){var e;return(0,en._)(this,function(t){switch(t.label){case 0:if(!n.find(function(e){return e.type===td.FileType.File&&e.filename===gR}))return[2,null];return[4,eI.readFile(gP)];case 1:if((e=t.sent()).error)return[2,null];return[2,e.content.toString()]}})})().then(function(n){if(!e){if(!n)return void eR.current(null);var t=null;try{t=cD.evaluate(n)}catch(e){}var r=(void 0===t?"undefined":(0,ni._)(t))==="object"&&"string"==typeof t.embedUrl?t.embedUrl:null;eR.current(r?{embedUrl:r}:null)}})},onMoveOrDelete:function(){eR.current(null)},onError:function(){eR.current(null)}});return function(){e=!0,n()}}},[eI,eT,eR]),eP=(0,fL.default)().isTutorial,eE=(0,es.useShowTutorialPane)(),(0,B.useEffect)(function(){eP&&eE()},[eE,eP]),eA=(0,g$.default)(),eD=(0,gQ.useSetPaneIndicator)(),(0,B.useEffect)(function(){eD({paneType:"envEditor",indicatorType:eA?R.tokens.redStronger:void 0})},[eA,eD]),(0,ht.useMissingSecretToast)({onOpenEnvEditor:function(){n4({pane:{type:"envEditor"},activate:!0,placement:{type:"secondary"}})}}),eV=(0,es.useActivePaneId)(),eO=(0,ef.useActivatePane)(),eF=(0,ef.useClearActivePane)(),(0,B.useEffect)(function(){eV?eO(eV):eF()},[eO,eF,eV]),eM=(0,ep.useFocusPane)(),(0,gE.usePaneFocusTrigger)(eM),eL=(0,es.useIsDraggingTab)(),eU=(0,es.useClearDragState)(),(0,B.useEffect)(function(){var e=function(){eU()};if(eL)return document.addEventListener("dragend",e),function(){document.removeEventListener("dragend",e)}},[eL,eU]),(0,he.default)(),eB=(0,es.useLayoutInitType)(),eW=(0,ep.useGetPaneBindings)(),ez=(0,es.useGetVisiblePanes)(),(0,eb.useCommandBinding)(function(){if(eB)return[rK.webviewRefresh.id,function(){var e=ez().filter(function(e){return"webview"===(0,U._)(e,2)[1].type}),n=!0,t=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var a=(0,U._)(i.value,1)[0],s=eW(a);s&&"webview"===s.type&&s.refresh()}}catch(e){t=!0,r=e}finally{try{n||null==o.return||o.return()}finally{if(t)throw r}}}]},[eB,eW,ez]),(0,hi.default)(),(0,gS.useOrgReplPresenceSession)(!(null==(nK=nY.org)?void 0:nK.id));var n4=eJ(),n8=(0,G.useSupportsAgent)();(0,B.useEffect)(function(){return oT.setTag("replId",nY.id),function(){oT.setTag("replId",void 0)}},[nY.id]),(0,B.useEffect)(function(){return oT.setTag("agent",n8),(0,th.addAgentTag)(n8),function(){oT.setTag("agent",void 0),(0,th.removeAgentTag)()}},[n8]),(0,g1.default)({repl:nY,currentUser:nJ,container:n1}),eH=(0,eN.default)(),eQ=(eq=(0,e2.default)()).container,eY=eq.ports,eZ=(0,U._)((eX=(0,m._)({},gO,void 0),sL.useMutation(gF,eX)),1)[0],e0=(0,rv.usePreferences)("webviewAutoOpenOnPortOpened").preferences.webviewAutoOpenOnPortOpened,e1=(0,tw.useIsExtensionRepl)(),e4=(0,G.useSupportsAgent)(),e8=(0,es.useOpenTool)(),e3=(0,B.useCallback)(function(e){e.isForwarded&&!e4&&(e1||e8({pane:{type:"vnc"}}),eZ({variables:{input:{id:eH,isVnc:!0}}}))},[e4,e1,eZ,eH,e8]),e6=(0,B.useCallback)(function(e){var n=e.isForwarded,t=e.isOpen,r=e.data;n&&(void 0===t||t)&&!e4&&(e0&&!e1&&e8({pane:{type:"webview",data:r}}),eZ({variables:{input:{id:eH,isServer:!0}}}))},[e1,e4,eH,eZ,e0,e8]),(0,B.useEffect)(function(){return eY.portsState.subscribe((0,gD.default)(function(e){if(e){var n=!0,t=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var a=i.value,s=a.configuration,l=a.isOpen;if(s.isVnc)return void e3({isForwarded:l});var u=s.type===gM.PortConfigurationType.FORWARDED;e6({isForwarded:u,isOpen:l,data:{ports:function(e){var n=e.configuration;if(n.localPort)return{type:"local",path:"/",port:n.localPort};var t=(0,gM.getExternalPort)(n);if(t)return{type:"external",path:"/",port:t}}(a)}})}}catch(e){t=!0,r=e}finally{try{n||null==o.return||o.return()}finally{if(t)throw r}}}},500,{leading:!0}))},[eQ,eY.portsState,e6,e3]),(0,hv.default)(),(0,hd.default)(),e9=(0,K.useFlag)({controlName:"flag-open-telemetry-tracing"}),nu=(e7=(e5=(0,U._)((0,B.useState)(!1),2))[0],ne=e5[1],nt=(nn=(0,U._)((0,B.useState)(Date.now()),2))[0],nr=nn[1],na=(no=(0,U._)((0,B.useState)(Date.now()),2))[0],ns=no[1],(0,B.useEffect)(function(){var e=function(){ne(!document.hidden),document.hidden?ns(Date.now()):nr(Date.now())};return document.addEventListener("visibilitychange",e),e(),function(){document.removeEventListener("visibilitychange",e)}},[]),nl={visibility:e7,visibleTime:nt,hiddenTime:na}).visibility,nc=nl.visibleTime,nd=nl.hiddenTime,(0,B.useEffect)(function(){e9&&nu&&(nc-nd)/1e3>60&&(0,k.pruneSpans)(ha.tracerName)},[e9,nu,nd,nc]),np=(0,e2.default)().ports,nf=(0,rv.usePreferences)("forwardPortsAutomatically").preferences,(0,B.useEffect)(function(){np.setForwardPortsAutomatically(nf.forwardPortsAutomatically)},[nf.forwardPortsAutomatically,np]),(0,g_.default)(nY);var n3=(0,es.useSetAnimationsEnabled)(),n6=(0,gw.usePrefersReducedMotion)();(0,B.useEffect)(function(){n3(!n6)},[n6,n3]);var n9=(0,es.useSetIsTouchDeviceLayout)(),n5=(0,gb.default)();(0,B.useEffect)(function(){n9(n5)},[n5,n9]),nh=(0,e2.default)().presence,nm=(0,eN.default)(),nv=(0,B.useRef)(!1),nw=(nx={variables:{replId:nm}},ny=(0,m._)({},gJ,nx),nb=y.useQuery(gX,ny)).data,nj=nb.loading,n_=0,(null==nw?void 0:nw.getRepl.__typename)==="Repl"&&(n_=nw.getRepl.multiplayers.length,(null==(ng=nw.getRepl.owner)?void 0:ng.__typename)==="User"&&(n_+=1)),(0,B.useEffect)(function(){if(!nj&&!nv.current){var e=nh.onActiveUsersChange(function(){nv.current=!0,e(),(0,ei.track)(eo.events.MULTIPLAYER_REPL_OPENED,{replId:nm,participantsCount:n_,usersOnlineCount:nh.getActiveUsers().length})});return e}},[nm,nj,n_,nh]);var n7=(0,ef.useWaitForFileClose)();(0,B.useEffect)(function(){nZ.setWaitForFileClose(n7)},[nZ,n7]);var te=(0,gL.useThrowBsod)(),tn=(0,es.useLayoutBSODArgs)();(0,B.useEffect)(function(){tn&&te(tn)},[te,tn]),nC=(nS=(0,e2.default)()).packager,nk=nS.toolchain,(0,B.useEffect)(function(){var e=setTimeout(function(){(0,ee._)(function(){var e,n,t,r,i,o,a,s,l,u;return(0,en._)(this,function(c){switch(c.label){case 0:if(!nk.configs.current||!nC)return[2];e=nk.configs.current.packagers,n=!0,t=!1,r=void 0,c.label=1;case 1:c.trys.push([1,7,8,9]),i=e[Symbol.iterator](),c.label=2;case 2:if(n=(o=i.next()).done)return[3,6];return a=o.value,[4,nC.listSpecfile(a.id)];case 3:var d;return(s=c.sent()).packages&&s.packages.length>0&&(l=s.packages.map(function(e){return e.name||""})||[],th.logger.info("packager installed packages",{packagerId:a.id,language:a.language,packages:l}),(0,ei.track)(eo.events.PACKAGER_PACKAGES_INSTALLED,{packages:l})),[4,(d=(5+5*Math.random())*1e3,(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:return[4,new Promise(function(e){return setTimeout(function(){return e()},d)})];case 1:return e.sent(),[2]}})})())];case 4:c.sent(),c.label=5;case 5:return n=!0,[3,2];case 6:return[3,9];case 7:return u=c.sent(),t=!0,r=u,[3,9];case 8:try{n||null==i.return||i.return()}finally{if(t)throw r}return[7];case 9:return[2]}})})()},(10+5*Math.random())*1e3);return function(){clearTimeout(e)}},[nC,nk.configs.current]),nI=(0,ef.useGetActivePaneId)(),nT=(0,ep.useFocusPane)(),(0,B.useEffect)(function(){var e=function(){var e=nI();e&&nT(e)},n=function(){"visible"===document.visibilityState&&document.activeElement===document.body&&e()};return window.addEventListener("focus",e),document.addEventListener("visibilitychange",n),function(){window.removeEventListener("focus",e),document.removeEventListener("visibilitychange",n)}},[nT,nI]),(0,g3.default)();var tt=(0,es.useOpenMultipleFiles)(),tr=(0,es.useOpenMultipleURLs)(),ti=(0,e2.default)().fs;(0,ho.default)({fs:ti,openMultipleFiles:tt,openMultipleURLs:tr,waitForFileClose:n7,isMobileWorkspace:!1}),(0,ev.useSetToolPanes)(),(0,rD.useInitWorkflows)({dotReplit:n0}),(0,hw.useInitResouceMonitoring)();var to=(0,es.useOpenTool)();(0,aD.useTourStep)(a9.projectsTour.id,a9.StepIds.ProjectPane,{onEnter:function(){return to({pane:{type:"project"},commit:!0,activate:!0})}}),(0,hb.default)(n2),nR=gZ(),nP=(0,B.useCallback)(function(){nR({reveal:!1})},[nR]),(0,rD.useOnLocalRun)(nP,[nP]),(0,g8.useAgentTracking)(),(0,hp.useSyncAgentFreemiumUsage)(),(0,g9.useChatterSentryBreadcrumbs)(),(0,g5.useDebugPreviewStateTracking)(),(0,g4.useQueueAutoPlay)(),(0,g6.useAutoSetExpertMode)({isAgentReplInConfig:!!(null==(n$=nY.config)?void 0:n$.isAgentRepl),isExpertModeInConfig:!!(null==(nQ=nY.config)?void 0:nQ.isExpertMode)});var ta=(0,es.useOpenTool)(),ts=(0,B.useCallback)(function(e){ta({pane:{type:e},activate:!1,reveal:!1,commit:!0})},[ta]);return(0,gy.default)({handleOpenPane:ts}),(0,g7.default)(),nE=(0,es.useAgentLayout)().setAgentPosition,nA=(0,rv.usePreferences)("agentPosition").preferences.agentPosition,nD=(0,B.useRef)(nA),(0,B.useEffect)(function(){nA!==nD.current&&(nD.current=nA,nE(nA))},[nE,nA]),(0,gG.useTrackAgentTestingTakeoverRequests)(),nV=(0,es.useGetLayout)(),nO=(0,es.useOpenTool)(),nF=function(e){var n,t=nV();(null==(n=t.tiling)?void 0:n.type)==="paneGroup"&&1===t.tiling.panes.length&&nO({pane:e,activate:!1})},(0,oE.useChatHook)("received-completed-event",function(e){var n=e.event.contents.contents;if((0,gB.isKind)(n,"agentTimelineEventContents")){var t=n.agentTimelineEventContents.toolData;(null==t?void 0:t.$kind)==="createPostgresqlDatabaseData"&&nF({type:"neon"})}}),nL=(0,eN.default)(),nU=(0,es.useIsAgentCentered)(),nB=(0,es.useTransitionToAgentPresentation)(),nN=(0,gk.useAgentPlanApprovalState)(),nG=(0,gI.useIsCurrentSessionInitialAgentSession)(),nW=(0,B.useRef)(!1),nz=(0,U._)((0,gC.useUpdateReplConfigMutation)(),1)[0],nH=nY.config,nq=!!(null==(nM=nY.origin)?void 0:nM.id),(0,B.useEffect)(function(){if(nq){(null==nH?void 0:nH.isInPlanningPhase)!==!1&&nz({variables:{input:{id:nL,isInPlanningPhase:!1}}});return}(null==nH?void 0:nH.isAgentRepl)&&nG&&null!=nN&&!nW.current&&("approved"===nN?(nU&&nB("sidebar"),(null==nH?void 0:nH.isInPlanningPhase)!==!1&&nz({variables:{input:{id:nL,isInPlanningPhase:!1}}})):(nU||nB("centered"),(null==nH?void 0:nH.isInPlanningPhase)!==!0&&nz({variables:{input:{id:nL,isInPlanningPhase:!0}}})),nW.current=!0)},[nU,nL,nB,nz,nN,nG,nH,nq]),(0,hf.useSyncAgentInitialPlanningState)(),(0,hg.useSyncAgentWebDesignMockupState)(),null}var h_=e.i(425188);function hS(e){var n=e.children,t=e.tour,r=e.userId;if(!t)return(0,g.jsx)(g.Fragment,{children:n});var i="workspace-desktop-new-user-tour"===t.id||"workspace-desktop-tour-2024"===t.id;function o(e){i&&t&&(0,ei.identify)({id:r.toString(),workspaceTourId:t.id,workspaceTourStatus:e===t.steps[t.steps.length-1].id?"completed":e.toLowerCase()})}return(0,g.jsx)(h_.TourRoot,{tour:t,onStep:function(e){t&&((0,ei.track)(eo.events.WORKSPACE_TOUR_STEP_VIEWED,{tour:t.id,stepId:e.toLowerCase()}),o(e))},onDone:function(e){(0,ei.track)(eo.events.WORKSPACE_TOUR_DISMISSED,{tour:t.id,stepId:e.toLowerCase(),didComplete:e===t.steps[t.steps.length-1].id}),o(e)},children:n})}var hC=e.i(508545),hk=e.i(911489),hI=e.i(263649),hT=e.i(607824),hR=e.i(384444);function hP(){var e=(0,rO.useObservable)((0,i7.useAgentIsWorking)()),n=(0,rO.useObservable)((0,i5.useAgentIsWaitingOnUserInput)()),t=(0,U._)((0,B.useState)(!0),2),r=t[0],i=t[1],o=(0,gW.useGetExperiment)("sound-on_v2")(),a="control"!==(null==o?void 0:o.get("treatmentName","control")),s=(0,B.useRef)(!1),l=(0,U._)((0,B.useState)(!1),2),u=l[0],c=l[1],d=(0,B.useRef)(null);(0,B.useEffect)(function(){var e=function(){var e=!document.hidden;i(e),e&&(c(!1),d.current&&(document.title=d.current))};return e(),document.addEventListener("visibilitychange",e),function(){document.removeEventListener("visibilitychange",e)}},[]),(0,B.useEffect)(function(){if(a){var t=e||n;t?s.current=!0:s.current&&!t&&(r||c(!0),s.current=!1)}},[e,n,r,a]),(0,B.useEffect)(function(){return u?(null===d.current&&(d.current=document.title),document.title.startsWith("(1) ")||(document.title="(1) ".concat(document.title))):d.current&&(document.title=d.current,d.current=null),function(){d.current&&(document.title=d.current,d.current=null)}},[u]);var p=hR.favicons.prompt;return e?p=hR.favicons.agentWorking:n?p=hR.favicons.agentWaiting:a&&u&&!r&&(p=hR.favicons.agentWaiting),p?(0,g.jsx)(hT.default,{children:(0,g.jsx)("link",{rel:"shortcut icon",href:p,sizes:"192x192",type:"image/png"})}):null}var hE=e.i(169566),hA=e.i(468448),hD=e.i(748965),hV=e.i(764586),hO=e.i(968263);function hF(){var e=(0,v._)(["\n  query PublishedAs($id: String!) {\n    getRepl(id: $id) {\n      ... on Repl {\n        id\n        publishedAs\n      }\n    }\n  }\n"]);return hF=function(){return e},e}var hM={},hL=(0,x.gql)(hF()),hU=e.i(671901),hB=".replit-dynamic-template",hN=e.i(169932),hG=e.i(420309),hW=e.i(833387);function hz(){var e,n,t,r,i,o,a,s,l,u,c,d,p,f,h,v,x,b,w,j=(0,U._)((0,B.useState)(!1),2),_=j[0],S=j[1],C=(0,B.useCallback)(function(e){switch(e){case"starting":return void S(!0);case"none":return void S(!1);case"running":if(!_)throw Error("expected repl not to need dynamic template initialization")}},[S,_]),k=(0,U._)((0,B.useState)([]),2),I=k[0],T=k[1],R=(0,cW.useIdSeed)();n=(e={handleRPC:(0,B.useCallback)(function(e){switch(e.type){case"progress":case"failed":return T(function(n){return(0,Z._)(n).concat([(0,m._)({key:R(n.length)},e)])}),null;case"query":case"prompt":case"confirm":var n=(0,hO.default)();return T(function(t){return(0,Z._)(t).concat([(0,m._)({respond:n,key:R(t.length)},e)])}),n.promise;default:throw Error("unhandled request type: "+JSON.stringify(e))}},[R]),onConnStateChange:C}).handleRPC,t=e.onConnStateChange,r=(0,K.useFlag)({controlName:"octopus-smokescreen"}),s=(i={variables:{id:(0,eN.default)()}},o=(0,m._)({},hM,i),a=y.useQuery(hL,o)).loading,l=a.data,u=(0,$.default)(function(){if(s)return!1;var e=null==l?void 0:l.getRepl;return(null==e?void 0:e.__typename)==="Repl"&&e.publishedAs===rq.PublishedReplKind.Template},[s,l]),d=(c=(0,e2.default)()).container,p=c.fs,h=(f=(0,U._)((0,B.useState)(!1),2))[0],v=f[1],b=(x=uK({container:d,service:"exec",skip:!h})).channel,w=x.isConnecting,(0,B.useEffect)(function(){!r||u||s||(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:return[4,p.stat(hB)];case 1:return v(e.sent().exists),[2]}})})()},[p,r,u,s,v]),(0,B.useEffect)(function(){if(!w){if(!b)throw Error("exec channel is not open");var e=(0,hO.default)();e.promise.then(function(){return(0,ee._)(function(){var e;return(0,en._)(this,function(n){switch(n.label){case 0:return[4,b.request({input:JSON.stringify({type:"start"})+"\n"})];case 1:if(!(e=n.sent()).ok)throw Error(": "+e.error);return[2]}})})()});var r=b.onCommand(function(r){switch(r.body){case"state":r.state===hU.api.State.Running?(t("starting"),e.resolve()):t("none");return;case"output":var i,o,a=r.output;if(!a)return;try{o=JSON.parse(a)}catch(e){throw Error("failed to parse dynamic template output: ".concat(e))}null==(i=n(o))||i.then(function(e){return b.send({input:JSON.stringify(e)+"\n"})});return;case"stderr":console.warn("got dynamic template generator stderr:",r.stderr);return;case"error":console.error("got dynamic template generator error:",r.error);return;case"ok":return;default:throw Error("unhandled exec channel body: ".concat(r.body))}});return b.send({exec:{args:["sh",hB],lifecycle:hU.api.Exec.Lifecycle.STDIN}}),function(){r()}}},[b,n,w,t,h]);var P=I.map(function(e){switch(e.type){case"progress":return(0,g.jsx)(hH,(0,m._)({},e));case"failed":return(0,g.jsx)(hq,(0,m._)({},e));case"query":return(0,g.jsx)(hK,(0,m._)({},e));case"prompt":return(0,g.jsx)(h$,(0,m._)({},e));case"confirm":return(0,g.jsx)(hQ,(0,m._)({},e))}});return(0,g.jsx)(eR.Modal,{isOpen:_,onRequestClose:function(){return S(!1)},children:(0,g.jsx)(A.View,{gap:8,children:P})})}function hH(e){var n=e.progress,t=(0,iu._)(e,["progress"]);return(0,g.jsxs)(A.View,(0,e9._)((0,m._)({},t),{children:["progress: ",n]}))}function hq(e){var n=e.error,t=(0,iu._)(e,["error"]);return(0,g.jsxs)(A.View,(0,e9._)((0,m._)({},t),{children:["error: ",n]}))}function hK(e){var n=e.query,t=e.options,r=e.respond,i=(0,iu._)(e,["query","options","respond"]),o=(0,U._)((0,B.useState)(null),2),a=o[0],s=o[1],l=(0,U._)((0,B.useState)(!1),2),u=l[0],c=l[1],d=(0,cW.useIdSeed)(),p=(0,B.useCallback)(function(){null!==a&&(c(!0),r.resolve({type:"answer",answer:t[a]}))},[a,t,r]);return(0,g.jsxs)(A.View,(0,e9._)((0,m._)({},i),{children:["query: ",n,t.map(function(e,t){return(0,g.jsxs)("label",{children:[(0,g.jsx)("input",{type:"radio",name:n,value:t,checked:a===t,onChange:function(){u||s(t)}}),e]},d(t))}),(0,g.jsx)(eW.Button,{text:"submit",onClick:p})]}))}function h$(e){var n=e.prompt,t=e.respond,r=(0,iu._)(e,["prompt","respond"]),i=(0,U._)((0,B.useState)(""),2),o=i[0],a=i[1],s=(0,U._)((0,B.useState)(!1),2),l=s[0],u=s[1],c=(0,B.useCallback)(function(){u(!0),t.resolve({type:"answer",answer:o})},[o,t]);return(0,g.jsxs)(A.View,(0,e9._)((0,m._)({},r),{children:["prompt: ",n,(0,g.jsx)(cz.Input,{disabled:l,inputMode:"text",title:n,onChange:function(e){return a(e.currentTarget.value)}}),(0,g.jsx)(eW.Button,{text:"submit",onClick:c})]}))}function hQ(e){var n=e.confirm,t=e.dataConfirmation,r=e.respond,i=(0,iu._)(e,["confirm","dataConfirmation","respond"]),o=Object.keys(t),a=Object.values(t);return(0,g.jsxs)(A.View,(0,e9._)((0,m._)({},i),{children:["confirm: ",n,(0,g.jsxs)(hN.default,{"aria-label":"the data to be used to generate your App",children:[(0,g.jsx)(hW.TableHeader,{children:o.map(function(e){return(0,g.jsx)(hV.Column,{isRowHeader:!0,children:e},e)})}),(0,g.jsx)(hG.default,{children:(0,g.jsx)(hV.Row,{children:a.map(function(e,n){return(0,g.jsx)(hV.Cell,{children:e},o[n])})})})]}),(0,g.jsx)(eW.Button,{text:"yes",onClick:function(){return r.resolve({type:"answer",answer:"yes"})}}),(0,g.jsx)(eW.Button,{text:"no",onClick:function(){return r.resolve({type:"answer",answer:"no"})}})]}))}var hY=e.i(982243),hJ=e.i(376847),hX=e.i(678814),hZ=e.i(268999),h0=e.i(660081),h1=e.i(151386),h2=e.i(224373),h4=(0,R.cvarsFrom)("ResizeHandle.module.css",["--width"]),h8=(0,B.memo)(function(){var e=(0,B.useRef)(null),n=(0,es.useAgentLayout)(),t=(0,ix.default)(n.agentFiletreeOrder);return(0,g.jsx)(h3,{gutter:n.gutter,side:"filetree-agent"===t?"left":"right",onDoubleClick:function(){n.toggle("collapsed"===n.displayState.current)},onPointerDown:function(t){(0,uV.measureMouseMove)(t,{start:function(){e.current=document.activeElement,n.resizeSidebar({type:"start"})},move:function(e){var t=e.delta;n.resizeSidebar({type:"update",moveDelta:t})},end:function(){var t,r;n.resizeSidebar({type:"end"}),null==(r=e.current)||null==(t=r.focus)||t.call(r)}})}})});function h3(e){var n=e.gutter,t=e.side,r=(0,iu._)(e,["gutter","side"]),i=(0,B.useRef)(null);return(0,uI.useStyleSet)(i,n,function(e){return(0,I._)({},h4.width,e+"px")}),(0,g.jsx)(A.View,(0,e9._)((0,m._)({clsx:[h2.default.root,h2.default[t]],align:"center",justify:"center",innerRef:i},r),{children:(0,g.jsx)(A.View,{clsx:h2.default.grip})}))}var h6=e.i(861781),h9=(0,R.cvarsFrom)("index.module.css",["--x","--y","--width","--height","--z-index"]);function h5(){}function h7(){var e=(0,es.useIsAgentCentered)(),n=(0,es.useTransitionToAgentPresentation)(),t=(0,es.useIsAgentPresentationTransitionInProgress)(),r=(0,e2.default)(),i=r.secrets,o=r.fs,a=(0,es.useOpenTool)(),s=(0,B.useCallback)(function(e){(0,ei.track)(eo.events.TOOL_OPENED,{source:"Agent Sidebar",tool:e.type}),a({pane:e})},[a]),l=cp(),u=(0,cf.useCurrentSession)(),c=u.session,d=u.setSession,p=u.setSessionId,f=(0,es.useAgentLayout)(),h=(0,B.useRef)(null);(0,uI.useStyleSet)(h,uk(f.rect,f.getTransitionEnabled),function(e){var n;return n={},(0,I._)(n,h9.x,e.x+"px"),(0,I._)(n,h9.y,e.y+"px"),(0,I._)(n,h9.width,e.width+"px"),(0,I._)(n,h9.height,e.height+"px"),n});var m=(0,U._)((0,B.useState)(null),2),v=m[0],x=m[1],y=f.setChatRef,b=f.toggle;(0,B.useEffect)(function(){return v?(y({setSessionId:p,focusInput:function(){return v.focus()},setPromptValue:function(e){return v.setValue(e)},openAgent:function(e){b(!0),p(null!=e?e:null),v.focus()},openAgentWithPrompt:function(e){b(!0),v.setValue(e),v.focus()}}),function(){y(null)}):void y({setSessionId:p,focusInput:function(){},setPromptValue:function(){},openAgent:function(e){b(!0),p(null!=e?e:null)},openAgentWithPrompt:function(e){b(!0)}})},[v,y,p,b]);var w=(0,aD.useSetTourStepTarget)(aW,aG.Agent),j=(0,B.useCallback)(function(e){e&&l(e),n("sidebar")},[l,n]);return(0,g.jsxs)(E.Surface,{innerRef:h,clsx:h6.default.root,style:(0,I._)({},h9.zIndex,ie.zIndexLevels.tiledPane.toString()),children:[(0,g.jsx)(cg.AgentMain,{secrets:i,readFile:o.readFile,session:c,setSession:d,openPane:s,onPlanApproval:j,isDesktopOrTabletAgentPresentationCentered:e,isDesktopLayoutAgentPresentationTransitionInProgress:t,openPip:h5,inputRef:x,workspaceTourStepRef:w}),(0,g.jsx)(h8,{})]})}var me=(0,eI.cssRecord)({root:[eT.rcss.position.absolute,eT.rcss.borderRadius(8),eT.rcss.pt(16),eT.rcss.align.center,{border:"1px solid",borderColor:R.tokens.outlineDimmest}],content:[eT.rcss.width("100%"),eT.rcss.flex.growAndShrink(1)]});function mn(){var e,n,t,r,i=(0,es.useEmptyLayoutRect)(),o=(0,es.useIsInPopup)(),a=(0,es.useInsertPaneToEdge)(),s=(n=(e=(0,U._)((0,u_.useDrop)({accept:[td.FileType.File,u$.DragItems.NewPane],collect:function(e){return{isOver:e.isOver()}},hover:function(e){r.drag()},drop:function(e){if("nodes"===e.type){var n=(0,ec.fsNodeToPanes)(e.nodes);n.length>0&&r.drop({panes:n})}}}),2))[0].isOver,t=e[1],r=(0,es.useEmptyLayoutDragAndDrop)({isOver:n}),t),l=rG({openPane:(0,B.useCallback)(function(e){(0,ei.track)(eo.events.TOOL_OPENED,{source:"Empty Layout",tool:e.pane.type}),a({pane:e.pane,edge:"left"})},[a])});return(0,g.jsx)(A.View,{style:{width:i.width,height:i.height,transform:"translate(".concat(i.x,"px, ").concat(i.y,"px)"),zIndex:o?100:void 0},css:me.root,innerRef:s,children:(0,g.jsx)(A.View,{css:me.content,children:(0,g.jsx)(eP.CommandBar,{autoFocus:!0,command:l,showToolDescriptions:!0})})})}var mt=e.i(131141),mr=e.i(810157),mi=e.i(406035),mo=e.i(667183),ma=n5.Type.Object({width:n5.Type.Number({minimum:0})}),ms=n5.Type.Object({width:n5.Type.Number({minimum:0})}),ml=n5.Type.Object({layout:mi.LayoutRootSchema,data:n5.Type.Record(n5.Type.String(),n5.Type.Object({type:n5.Type.String()})),agent:n5.Type.Optional(ms),filetree:n5.Type.Optional(ma)});function mu(e,n,t){var r=t.hasAssistant,i=null;try{i=n7.Value.Decode(ml,e)}catch(e){}if(null===i)return null;var o={layout:i.layout,data:{},type:"saved",agent:i.agent,filetree:i.filetree},a=new Set,s=(0,mr.getPaneIds)(o.layout),l=!0,u=!1,c=void 0;try{for(var d,p=Object.entries(i.data)[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var f=(0,U._)(d.value,2),g=f[0],h=f[1];if(s.has(g)){var m=n(h.type,h);if(!m){a.add(g);continue}o.data[g]=m}}}catch(e){u=!0,c=e}finally{try{l||null==p.return||p.return()}finally{if(u)throw c}}return(0,mt.produce)(o,function(e){var n=function(n){if(s.has(n))return void(0,mo.removePane)(e.layout,n)},t=!0,i=!1,o=void 0;try{for(var l,u=a[Symbol.iterator]();!(t=(l=u.next()).done);t=!0){var c=l.value;n(c)}}catch(e){i=!0,o=e}finally{try{t||null==u.return||u.return()}finally{if(i)throw o}}var d=!0,p=!1,f=void 0;try{for(var g,h=Object.entries(e.data)[Symbol.iterator]();!(d=(g=h.next()).done);d=!0){var m=(0,U._)(g.value,2),v=m[0],x=m[1];"commands"!==x.type&&("codeEditor"!==x.type||x.data.path)&&"agentProgress"!==x.type&&"agentChat"!==x.type&&("ghostwriterChat"!==x.type||r)||(delete e.data[v],n(v))}}catch(e){p=!0,f=e}finally{try{d||null==h.return||h.return()}finally{if(p)throw f}}})}var mc=e.i(779830),md=e.i(160290),mp=e.i(710078),mf=e.i(939040),mg=e.i(491694),mh=(0,R.cvarsFrom)("Search.module.css",["--input-height"]),mm={type:"context",icon:(0,g.jsx)(t0.default,{}),label:"",description:"Search"};function mv(e){var n=(0,e2.default)().fs,t=(0,ef.useGetRecentFiles)(),r=(0,es.useOpenFile)(),i=(0,rA.useShouldHideFileInWorkspace)(),o=(0,B.useMemo)(function(){var e=(0,rI.createFindOrCreateFileCommand)({openFile:r,fs:n,shouldHideFile:i,getRecentFiles:t});return e.data=mm,delete e.match,e},[r,n,i,t]);return(0,g.jsx)(A.View,{onContextMenu:e.onContextMenu,clsx:mg.default.root,style:(0,I._)({},mh.inputHeight,"32px"),children:(0,g.jsx)(eP.CommandBar,{fullWidth:!0,command:o,openOnInput:!0,compact:!0})})}var mx=e.i(483570),my=e.i(312421),mb=e.i(714312),mw=e.i(633600),mj=e.i(780671),m_=e.i(240913),mS=e.i(133294),mC=e.i(185511),mk=e.i(274526),mI=e.i(714603),mT=e.i(90102),mR=e.i(342574);function mP(e){var n=e.size,t=e.iconUrl,r=e.name;return(0,g.jsx)(cP.default,{src:t,width:n,height:n,alt:"Icon for file opener: ".concat(r)})}var mE=/[*]{2}\/[*]\.([a-z0-9.]+)/,mA=e.i(842435),mD=e.i(943124);function mV(e){var n,t,r,i,o,a,s,l,u,c,d,p,f,h,v,x,y,b,w,j,_,S,C,k,I,T,R,P,E,D,V,O,F,M,L,N,W,z,H,q,$,Q,Y,J,X,et=e.onClose,er=(n=(0,eN.default)(),r=(t=(0,U._)((0,B.useState)(null),2))[0],i=t[1],o=(0,es.useOpenFile)(),a=(0,my.useTrackOpenFile)(),s=(0,rA.useShouldHideFileInWorkspace)(!0),l=(0,B.useCallback)(function(e){return!s(e.filename)},[s]),u=(0,e2.default)().fs,c=(0,rv.usePreferences)("multiselectModifierKey").preferences,d=(0,es.useCommitFileInWorkspace)(),p="cmdOrCtrlKey"===c.multiselectModifierKey?"cmdOrCtrlKey":"altKey",f=(0,ef.useGetRecentFiles)(),h=(0,B.useCallback)(function(e){return(0,mb.getFileExtensionSuggestions)(e,f)},[f]),v=(0,u2.useContextMenu)().onContextMenu,x=(0,eN.default)(),y=(0,e2.default)().fs,b=(0,es.useOpenFile)(),w=(0,es.useInsertPaneToEdge)(),j=(0,es.useExtensionFileHandlers)(),_=(0,e4.useExtensionCommands)(nj.ContributionType.FiletreeContextMenu),S=(0,es.useFiletypeAssociations)(),C=(0,es.useAssociateFiletype)(),k=(0,K.useFlag)({controlName:"flag-folder-downloads"}),I=(0,K.useFlag)({controlName:"flag-direct-file-downloads"}),T=(0,es.useSetFiletypeAssociationRequest)(),R=(0,B.useCallback)(function(e){var n=e.extensionId,t=e.fileExtension,r=e.fileHandlerId,i=S[t];i&&i.extensionId===n&&i.fileHandlerId===r||T(e)},[T,S]),P=(0,B.useCallback)(function(e,n){var t=e.path,r=[{data:{type:"group",key:"rename"},commands:function(){return[(0,mk.getRenameCommand)(function(){return n.rename(t)})]}}];(0,tu.isOTFile)(t)&&r.push({data:{type:"group",key:"saveFile"},commands:function(){return[(0,mk.getSaveCommand)(function(){return(0,ee._)(function(){return(0,en._)(this,function(e){switch(e.label){case 0:return[4,y.flush(new Set([t]),td.FlushSource.MANUAL_SAVE)];case 1:return e.sent(),[2]}})})()})]}}),r.push({data:{type:"group",key:"open"},commands:function(){return function(e){var n=e.path,t=e.getSelectedNodes,r=e.openFile,i=[{type:td.FileType.File,path:n}],o=!0,a=!1,s=void 0;try{for(var l,u=t()[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=(0,U._)(l.value,2),d=c[0],p=c[1];p!==td.FileType.Directory&&d!==n&&i.push({path:d,type:p})}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}var f=i.length,h=1===f?"Open":"Open ".concat(f," files");return[{label:h,icon:(0,g.jsx)(lj.default,{}),run:function(){var e=!0,n=!1,t=void 0;try{for(var o,a=i[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var s=o.value;r({path:s.path,newTab:!0})}}catch(e){n=!0,t=e}finally{try{e||null==a.return||a.return()}finally{if(n)throw t}}}},{label:h+" in split",icon:(0,g.jsx)(iC.default,{}),run:function(){var e=(0,mw._)(i),n=e[0],t=e.slice(1);r({path:n.path,newPane:!0});var o=!0,a=!1,s=void 0;try{for(var l,u=t[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;r({path:c.path,newTab:!0})}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}}}].map(function(e){var n=e.label,t=e.icon,r=e.run;return{match:el.matchLabel,data:{type:"action",label:n,icon:t,run:r}}})}({path:t,getSelectedNodes:n.getSelectedNodes,openFile:b})}});var i=function(e){var n=function(e){var n=r[e],i=(0,cG.globToRegExp)(n.glob);if(!i||!i.exec(t))return"continue";var s=mE.exec(n.glob),l=n.icon?n.icon:n.extension.manifest.icon,u=n.name?n.name:n.extension.manifest.name,d=l?(0,e6.getAssetUrl)(n.extension.baseUrl,l):null;c.push({match:el.matchLabel,data:{type:"action",icon:d?(0,g.jsx)(mP,{size:16,name:u,iconUrl:d}):(0,g.jsx)(lj.default,{}),label:"Open with "+u,run:function(){s&&a({extensionId:n.extension.extensionId,fileHandlerId:e,fileExtension:s[1]}),o({path:t,opener:{paneType:"extension",supports:function(){return!0},extensionFileHandler:n}})}}})},t=e.path,r=e.handlers,i=e.filetypeAssociations,o=e.openFile,a=e.requestAssociateFiletype,s=e.associateFiletype,l=(0,mj.getFileExtension)(t),u=l?i[l]:null,c=[];for(var d in r)n(d);return u&&l&&c.length&&c.push({match:el.matchLabel,data:{icon:(0,g.jsx)(c2.default,{}),type:"action",label:"Use default opener",run:function(){s({fileExtension:l,newAssociation:null})}}}),c}({path:t,handlers:j,filetypeAssociations:S,requestAssociateFiletype:R,associateFiletype:C,openFile:b});return i.length&&r.push({data:{type:"group",key:"extensions"},commands:function(){return i}}),r.push({data:{type:"group",key:"copy"},commands:function(){return(0,mk.getCopyCommands)(t)}}),r.push((0,mk.getDuplicateCommand)(function(){return(0,ee._)(function(){var e;return(0,en._)(this,function(r){switch(r.label){case 0:e=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,(0,mS.default)(t,y)];case 2:return e=r.sent(),[3,4];case 3:return r.sent(),[2,{type:"error",message:"Error duplicating file"}];case 4:return(0,mI.default)({replId:x,action:"duplicated",fileType:td.FileType.File}),n.rename(e),[2]}})})()})),r.push((0,mC.createDownloadCommand)(t,y,I)),r.push({data:{type:"group",key:"deleteFile"},commands:function(){return[(0,mk.getDeleteCommand)(function(){return n.deleteNodes(e)})]}}),r.push({data:{type:"group",key:"extensions"},commands:function(){return(0,ee._)(function(){var e;return(0,en._)(this,function(n){switch(n.label){case 0:return e=[{data:{filePath:t,fileType:td.FileType.File}}],[4,Promise.all(_.map(function(n){return(0,ee._)(function(){var t;return(0,en._)(this,function(r){switch(r.label){case 0:return[4,n.create({path:e})];case 1:if(!(t=r.sent()))return[2,null];return[2,(0,e3.wrapExtensionCommand)(t,{path:e})]}})})()}))];case 1:return[2,n.sent().filter(Boolean)]}})})()}}),r},[j,S,R,C,b,y,I,x,_]),E=(0,hc.useSetAreHiddenFilesVisible)(),D=(0,hc.useAreHiddenFilesVisible)(),V=(0,G.useSupportsAgent)(),F=(O=(0,rv.usePreferences)("agentPosition")).preferences.agentPosition,M=O.update,L=(0,B.useCallback)(function(e,n){var t=e.path,r=t===m_.ROOT_PATH,i=r?[]:[{data:{type:"group",key:"rename"},commands:function(){return[(0,mk.getRenameCommand)(function(){return n.rename(e.path)})]}}];if(i.push({data:{type:"group",key:"search"},commands:function(){var n;return[(n=e.path,{match:el.matchLabel,data:{type:"action",icon:(0,g.jsx)(t0.default,{}),label:"Search this directory",run:function(){w({pane:{type:"searchReplace",data:{initialIncludeGlob:"".concat(n,"/**")}},edge:"right"})}}})]}}),i.push.apply(i,(0,Z._)((0,mk.getCreateCommands)(function(t){return n.create(t,e.path)}))),i.push({data:{type:"group",key:"openShell"},commands:function(){return[{match:el.matchLabel,data:{type:"action",label:"Open shell here",icon:(0,g.jsx)(mR.default,{}),run:function(){w({pane:{type:"shell",data:{initialPwd:t}},edge:"left"})}}}]}}),r||i.push({data:{type:"group",key:"copy"},commands:function(){return(0,mk.getCopyCommands)(t)}}),n.getExpandedDirs()&&i.push({match:el.matchLabel,data:{icon:(0,g.jsx)(fn.default,{}),type:"action",label:"Collapse "+(r?"all":"child folders"),run:function(){var e=n.getExpandedDirs(t);e&&n.collapse((0,Z._)(e))}}}),!r&&k&&i.push({data:{type:"group",key:"downloadFolder"},commands:function(){return[(0,mC.createDownloadFolderCommand)(t)]}}),r||i.push({data:{type:"group",key:"deleteFile"},commands:function(){return[(0,mk.getDeleteCommand)(function(){return n.deleteNodes(e)})]}}),r&&i.push({data:{type:"group",key:"hiddenFiles"},commands:function(){return[{match:el.matchLabel,data:{type:"action",label:(D?"Hide":"Show")+" hidden files",icon:D?(0,g.jsx)(mT.default,{}):(0,g.jsx)(lj.default,{}),run:function(){E(!D)}}}]}}),i.push({data:{type:"group",key:"extensions"},commands:function(){return(0,ee._)(function(){var e;return(0,en._)(this,function(n){switch(n.label){case 0:return e=[{data:{dirPath:t,fileType:td.FileType.Directory}}],[4,Promise.all(_.map(function(n){return(0,ee._)(function(){var t;return(0,en._)(this,function(r){switch(r.label){case 0:return[4,n.create({path:e})];case 1:if(!(t=r.sent()))return[2,null];return[2,(0,e3.wrapExtensionCommand)(t,{path:e})]}})})()}))];case 1:return[2,n.sent().filter(Boolean)]}})})()}}),r&&V){var o={type:"action",label:"Move sidebar to the "+("leftSidebar"===F?"left":"right"),icon:"leftSidebar"===F?(0,g.jsx)(iC.default,{}):(0,g.jsx)(ik.default,{}),run:function(){M({agentPosition:"leftSidebar"===F?"rightSidebar":"leftSidebar"})}};i.push({data:{type:"group",key:"move"},commands:function(){return[{match:el.matchLabel,data:o}]}})}return i},[D,E,_,w,k,V,M,F]),N=(0,B.useCallback)(function(e,n){return{data:{type:"context",label:"Search actions",icon:(0,g.jsx)(t0.default,{})},commands:function(){return e.type===td.FileType.Directory?L(e,n):P(e,n)}}},[P,L]),W=(0,hc.useSetFileRenameInProgress)(),z=(0,md.useFiletree)({fs:u,filter:l,fontSize:13,onFileDoubleClick:function(e,n){d(n)},onFileSelect:function(e){var n=e.path,t=e.type,r=e.event,i="click"===t&&"altKey"===p?(0,r5.getCmdOrCtrl)(r):r.altKey;o({path:n,newTab:i}),a(n,{newTab:i})},onCreate:function(e){e.type===td.FileType.File&&o({opener:{paneType:(0,ec.getPaneTypeForFile)({path:e.path})},path:e.path})},multiselectModifierKey:p,onConflicts:function(e){return i({type:"conflicts",data:e})},onDeleteNodes:function(e){return i({type:"deleteNode",data:e})},onContextMenu:function(e,n){return v(e,{command:N(n,z)})},autocomplete:h,localCacheKey:n+":sidebar",onFileRenameStart:W,onFileRenameEnd:function(){return W(null)}}),H=(0,mx.useFileTreeGitStatus)(),(0,B.useEffect)(function(){return z.setFileStatus(H)},[z,H]),q=(0,ef.useObservableActiveFile)(),(0,B.useEffect)(function(){var e=function(e){return(0,ee._)(function(){return(0,en._)(this,function(n){switch(n.label){case 0:if(null===e)return z.select(null),[2];return[4,z.select({path:e,type:td.FileType.File})];case 1:if(n.sent(),q.current!==e)return[2];return z.scrollToPath(e),[2]}})})()};return e(q.current),q.subscribe(e)},[q,z]),$=(0,es.useSidebar)(),Q=(0,ix.default)($.activeContent),Y=(0,ef.useObservableRevealFile)(),J=(0,ef.useSetRevealFile)(),(0,B.useEffect)(function(){var e=function(e){return(0,ee._)(function(){return(0,en._)(this,function(n){switch(n.label){case 0:if(null===e)return[2];return"filetree"!==Q&&$.toggleContent("filetree"),[4,z.select({path:e,type:td.FileType.File})];case 1:return n.sent(),z.scrollToPath(e),J(null),[2]}})})()};return e(Y.current),Y.subscribe(e)},[Y,J,z,$,Q]),X=(0,B.useCallback)(function(e){return v(e,{command:N({type:td.FileType.Directory,path:"."},z)})},[z,N,v]),{filetree:z,activeModal:r,closeModal:function(){return i(null)},onRootContextMenu:X}),ei=er.filetree,eo=er.activeModal,ea=er.closeModal,eu=er.onRootContextMenu;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(A.View,{clsx:mD.default.header,row:!0,gap:4,align:"center",pl:6,pr:4,children:[(0,g.jsx)(A.View,{grow:!0,shrink:!0,row:!0,gap:4,align:"center",children:(0,g.jsx)(ez.Text,{css:mD.default.title,children:"Files"})}),(0,g.jsxs)(A.View,{row:!0,gap:0,align:"center",children:[(0,g.jsx)(ot.IconButton,{dataCy:"filetree-add-file",alt:"New file",onClick:function(){ei.create(td.FileType.File)},children:(0,g.jsx)(fr.default,{})}),(0,g.jsx)(ot.IconButton,{alt:"New folder",onClick:function(){ei.create(td.FileType.Directory)},children:(0,g.jsx)(mA.default,{})}),(0,g.jsx)(mc.RootActions,{closeFiletree:et,filetree:ei})]})]}),(0,g.jsxs)(A.View,{clsx:mD.default.content,grow:!0,shrink:!0,children:[(0,g.jsx)(mv,{onContextMenu:eu}),(0,g.jsx)(A.View,{grow:!0,shrink:!0,dataCy:"sidebar-filetree-section",children:(0,g.jsx)(md.Filetree,{store:ei.store})})]}),(0,g.jsxs)(eR.Modal,{isOpen:!!eo,onRequestClose:ea,children:[(null==eo?void 0:eo.type)==="conflicts"?(0,g.jsx)(mp.default,{paths:eo.data.conflicts.map(function(e){return e.path}),onCancel:ea,onConfirm:function(){var e=eo.data;"move"===e.type?ei.move({nodes:e.nodes,to:e.to,overwrite:!0}):ei.upload({files:e.files,parentPath:e.to,overwrite:!0}),ea()}}):null,(null==eo?void 0:eo.type)==="deleteNode"?(0,g.jsx)(ox.default,(0,e9._)((0,m._)({},(0,mf.getDeleteText)(eo.data.nodes)),{delete:function(){return eo.data.confirm()},hideModal:ea})):null]})]})}function mO(){var e=(0,v._)(["\n  fragment AgentFeedbackItem on AgentFeedback {\n    id\n    topic\n    feedbackText\n    currentPage\n    status\n    timeCreated\n    user {\n      id\n      username\n      fullName\n      displayName\n      image\n    }\n  }\n"]);return mO=function(){return e},e}function mF(){var e=(0,v._)(["\n  query InboxContentAgentFeedback($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        agentFeedback {\n          ... on ReplAgentFeedback {\n            items {\n              ...AgentFeedbackItem\n            }\n          }\n          ... on Error {\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return mF=function(){return e},e}var mM={},mL=(0,x.gql)(mO()),mU=(0,x.gql)(mF(),mL);function mB(e){var n=(0,m._)({},mM,e);return y.useQuery(mU,n)}var mN=e.i(173703),mG={bug_report:{label:"Bug report",colorway:"red"},feature_request:{label:"Feature request",colorway:"purple"},design:{label:"Design",colorway:"blue"},content:{label:"Content",colorway:"lime"},other:{label:"Other",colorway:"grey"}};function mW(e){var n,t,r,i,o=e.item,a=e.onAddToChat,s=e.onSendToAgent,l=o.topic&&mG[o.topic]?mG[o.topic]:mG.other,u=null!=(n=o.user.displayName)?n:o.user.username,c=function(e,n){if(!n||"other"===n)return e;var t,r=null==(t=mG[n])?void 0:t.label;return r?"[Topic: ".concat(r,"] ").concat(e):e}(o.feedbackText,o.topic),d=(0,B.useCallback)(function(){a(c)},[a,c]),p=(0,B.useCallback)(function(){s(c)},[s,c]);return(0,g.jsxs)(mN.ShadesSurface,{border:"regular",br:8,gap:8,p:8,children:[(0,g.jsxs)(A.View,{row:!0,align:"center",justify:"space-between",children:[(0,g.jsx)(pI.Pill,{text:null!=(t=null==l?void 0:l.label)?t:"Other",colorway:null!=(r=null==l?void 0:l.colorway)?r:"grey",variant:"muted",compact:!0}),(0,g.jsxs)(A.View,{row:!0,gap:4,children:[(0,g.jsx)(ot.IconButton,{alt:"Add to chat",onClick:d,children:(0,g.jsx)(tS.default,{})}),(0,g.jsx)(ot.IconButton,{alt:"Send to agent",onClick:p,children:(0,g.jsx)(rN.default,{size:12})}),(0,g.jsx)(ot.IconButton,{alt:"Dismiss",onClick:function(){},children:(0,g.jsx)(c2.default,{})})]})]}),(0,g.jsxs)(A.View,{row:!0,gap:8,align:"center",children:[(0,g.jsx)(s9.Avatar,{src:o.user.image,username:o.user.username,fullName:null!=(i=o.user.fullName)?i:void 0,size:16}),(0,g.jsxs)(A.View,{row:!0,gap:8,align:"baseline",children:[(0,g.jsx)(ez.Text,{color:"dimmer",children:u}),(0,g.jsx)(ag.Timestamp,{date:o.timeCreated,textColor:"dimmest",textVariant:"small",live:!0})]})]}),(0,g.jsx)(ez.Text,{children:o.feedbackText})]})}var mz=function(){mB({variables:{replId:(0,eN.default)()}})};function mH(){var e,n,t,r,i,o=mB({variables:{replId:(0,eN.default)()}}).data,a=(n=(0,oE.useChatter)(),t=(0,e$.default)().showError,r=(0,rO.useObservable)(n.sessions.agent.current),i=(0,es.useAgentLayout)(),{addToChat:(0,es.useOpenAgentWithPrompt)(),sendToAgent:(0,B.useCallback)(function(e){return(0,ee._)(function(){var o,a,s;return(0,en._)(this,function(l){switch(l.label){case 0:if(l.trys.push([0,4,,5]),o=r)return[3,2];return[4,n.sessions.create({sessionType:oP.SessionType.AGENT_SESSION})];case 1:if(!(a=l.sent()).ok)throw Error("Failed to create Agent session");o=a.payload,l.label=2;case 2:return i.toggle(!0),[4,o.appendEvent({kind:"message",message:e,intent:oP.MessageAction.AGENT})];case 3:return l.sent(),[3,5];case 4:return s=l.sent(),oT.withScope(function(e){e.setTag("agent-inbox-feedback-to-agent",!0),oT.captureException(s)}),t("Error sending feedback to Agent"),[3,5];case 5:return[2]}})})()},[n.sessions,r,i,t])}),s=a.addToChat,l=a.sendToAgent,u=(null==o||null==(e=o.getRepl)?void 0:e.__typename)==="Repl"?o.getRepl.agentFeedback:null,c=(null==u?void 0:u.__typename)==="ReplAgentFeedback"?u.items:[],d=0===c.length;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(A.View,{row:!0,gap:4,align:"center",pl:6,pr:4,children:(0,g.jsx)(A.View,{grow:!0,shrink:!0,row:!0,gap:4,align:"center",children:(0,g.jsx)(ez.Text,{children:"Inbox"})})}),(0,g.jsx)(A.View,{grow:!0,shrink:!0,children:d?(0,g.jsxs)(A.View,{align:"center",pt:64,gap:8,children:[(0,g.jsx)(sV.default,{size:24}),(0,g.jsx)(ez.Text,{color:"dimmer",children:"Inbox is empty"})]}):(0,g.jsx)(A.View,{gap:10,pt:8,children:c.map(function(e){return(0,g.jsx)(mW,{item:e,onAddToChat:s,onSendToAgent:l},e.id)})})})]})}function mq(){var e=(0,es.useSidebar)(),n=(0,es.useAgentLayout)(),t=(0,ix.default)(n.agentFiletreeOrder),r=(0,B.useRef)(null);return(0,g.jsx)(h3,{gutter:n.gutter,side:"agent-filetree"===t?"left":"right",onPointerDown:function(n){(0,uV.measureMouseMove)(n,{start:function(){(0,nr._)(document.activeElement,HTMLElement)&&(r.current=document.activeElement),e.resize.start()},move:function(n){var t=n.delta;e.resize.update(t.x)},end:function(){var n,t;e.resize.end(),null==(t=r.current)||null==(n=t.focus)||n.call(t),r.current=null}})},onDoubleClick:function(){e.closeSidebar()}})}var mK=(0,R.cvarsFrom)("index.module.css",["--width","--height","--transform","--pointer-events","--opacity","--z-index"]),m$=(0,B.memo)(function(){var e=(0,B.useRef)(null),n=(0,es.useSidebar)(),t=n.view,r=(0,ix.default)(n.activeContent);mz(),(0,uI.useStyleSet)(e,uk(t,n.getTransitionEnabled),function(e){var n;return n={},(0,I._)(n,mK.width,e.width+"px"),(0,I._)(n,mK.height,e.height+"px"),(0,I._)(n,mK.transform,"translate(".concat(e.x,"px, ").concat(e.y,"px)")),(0,I._)(n,mK.pointerEvents,e.isOpen?"all":"none"),(0,I._)(n,mK.opacity,e.opacity.toString()),(0,I._)(n,mK.zIndex,ie.zIndexLevels.filetreeDragLayer.toString()),n});var i=(0,B.useCallback)(function(){n.closeSidebar()},[n]);return(0,g.jsxs)(E.Surface,{clsx:mD.default.root,innerRef:e,children:["filetree"===r?(0,g.jsx)(mV,{onClose:i}):null,"inbox"===r?(0,g.jsx)(mH,{}):null,(0,g.jsx)(mq,{})]})}),mQ=e.i(732964),mY=e.i(718632),mJ=e.i(755181);function mX(e){var n,t,r,i,o=e.repl,a=e.currentUser,s=(0,h.useRouter)(),l=(0,Y.useQueryParam)("enterInAgentMode","boolean"),u=(0,Y.useQueryParam)("enterInExpertMode","boolean"),c=(0,Y.useQueryParam)("popupId","string"),d=(0,Q.isInBonsaiWebview)(s),p=(0,Q.doesBonsaiWebviewSupportFeature)(s,"workspace2"),f=(0,h1.useFilePaneFlag)(),v=(0,U._)((0,B.useState)(function(){var e;return(0,ed.createPaneUI)({config:(e=(0,f9.createPaneUIConfig)(),(0,e9._)((0,m._)({},e),{webview:f3,commands:cy,tutorial:fq,extension:cE,extensionStore:py,replAuth:p_,searchReplace:fP,deployments:f7.deploymentsUI,config:c_,integrations:ge.integrationsUI,extensionDevtools:pf,csvPreview:f5.csvPreviewUI,agentChat:cv,agentProgress:gn.unsupportedUI,multiplayer:gn.unsupportedUI})),filePaneFlag:f})}),1)[0],x=(0,z.useHasAssistant)({isSubscribed:a.isSubscribed}),y=null;c?y=mu((0,uj.getPopupState)(c),v.decode,{hasAssistant:x}):o.layoutState&&(y=mu(o.layoutState,v.decode,{hasAssistant:x}));var b=!!o.config.isAgentStack;y||(i=u?"split-with-console":b?"split-with-automations":"split-with-webview");var w=(n=(0,Y.useQueryParam)("deploymentPane","boolean"),t=(0,Y.useQueryParam)("projectPane","boolean"),(0,$.default)(function(){return n?{type:"deployments"}:t?{type:"project"}:void 0},[n,t])),j=(!!(null==(r=o.origin)?void 0:r.id)||u)&&!o.config.isInPlanningPhase,_=(l||!!o.config.isInPlanningPhase)&&!o.config.figmaUrl&&!j;return(0,g.jsx)(us.TrackingHierarchyProvider,{hierarchy:{page:"workspace"},children:(0,g.jsxs)(J.Pid2Provider,{currentUsername:a.username,replId:o.id,children:[(0,g.jsx)(om.SessionProvider,{children:(0,g.jsx)(uw.LayoutStoreProvider,{initialPane:w,savedLayoutState:y,popupId:c,agentCenteredLayout:_,agentLayoutVariation:i,agentPosition:a.workspacePreferences.agentPosition,children:(0,g.jsx)(hS,{tour:null,userId:a.id,children:(0,g.jsx)(mZ,{ui:v,repl:o,currentUser:a,isBonsaiWebview:d,doesBonsaiSupportWorkspace2:p},o.id)})})}),(0,g.jsx)(X.default,{})]})})}function mZ(e){var n,t,r,i,o,a,s,l,u,c,d,p,f,h,m,v,x,y,b=e.repl,w=e.currentUser,j=e.isBonsaiWebview,_=e.doesBonsaiSupportWorkspace2,S=e.ui,C=(n=(0,es.useOpenFile)(),t=(0,es.useOpenMultipleFiles)(),r=(0,es.useOpenMultipleURLs)(),i=(0,gL.useThrowBsod)(),o=(0,K.useFlag)({controlName:"flag-null-diagnostics",logFlagToAnalytics:!1}),s=(a=(0,U._)((0,B.useState)(!1),2))[0],l=a[1],c=(u=(0,U._)((0,B.useState)(!1),2))[0],d=u[1],p=(0,au.useUpdatePresence)(),f=(0,au.useGetColorForUser)(),h=(0,K.useFlag)({controlName:"flag-open-telemetry-tracing"}),m=(0,K.useFlag)({controlName:"flag-multi-lsp-connections"}),v=(0,$.default)(function(){return{onPresenceCommand:p,getColorForUser:f,onUnrecoverableError:(0,hI.default)({origin:"replEnvironmentDesktop: services/unrecoverableError",tags:{environment:"desktop"},onNonBsodUnrecoverableError:function(e){e===H.NonBsodErrorType.NotAllowed?l(!0):e===H.NonBsodErrorType.RequiresRefresh&&d(!0)},throwBsod:i}),openFile:n,openMultipleFiles:t,openMultipleURLs:r,enableUserEvents:o,enableMultipleLSPClientsPerFile:m,openTelemetryTracing:h,enableReplspaceSshTokenPassthrough:!0}},[o,n,t,r,i,p,f,h,m]),x=(0,hC.useCreateServices)(v),(0,$.default)(function(){return{services:x,isPleaseRefresh:c,isNotAllowed:s}},[x,c,s])),k=C.services,I=C.isPleaseRefresh,T=C.isNotAllowed,R=(0,K.useFlag)({controlName:"flag-build-score-survey"}),P=(0,$.default)(function(){return(0,os.initKeybindings)(null==w?void 0:w.keybindings.keybindings)},[w]);if(!k)return(0,g.jsx)(M,{});var E=b.authorizations.useAdvancedChat.isAuthorized;return(0,g.jsx)(W.AiProvider,{replId:b.id,currentUser:w,hasAccessToAdvancedModel:E,orgId:null==(y=b.org)?void 0:y.id,renderEmptyState:function(){return(0,g.jsx)(M,{})},children:(0,g.jsx)(hE.ContextMenuProvider,{children:(0,g.jsxs)(of,{services:k,ui:S,repl:b,userKeybindings:P,children:[(0,g.jsxs)(uQ.default,{origin:"ErrorBoundary: ReplEnvironmentDesktop Top level",bsod:!0,children:[(0,g.jsx)(iG,{}),(0,g.jsx)(r3,{isAdmin:w.isAdmin,isSubscribed:w.isSubscribed}),(0,g.jsx)(hX.default,{repl:b}),j&&!_?(0,g.jsx)(oC,{}):null,(0,g.jsx)(eV,{}),(0,g.jsx)(oh,{}),(0,g.jsx)(hj,{repl:b,currentUser:w}),(0,g.jsx)(oK,{}),(0,g.jsx)(oW,{}),(0,g.jsx)(m1,{repl:b}),(0,g.jsx)(tO,{}),(0,g.jsx)(tP,{}),(0,g.jsx)(hA.default,{}),(0,g.jsx)(hz,{}),(0,g.jsx)(gg,{replId:b.id}),(0,g.jsx)(hY.default,{isOpen:T}),(0,g.jsx)(hJ.default,{isOpen:I}),(0,g.jsx)(mY.GitInShellConfirmModal,{}),(0,g.jsx)(mQ.DefaultBucketAccessConfirmModal,{}),(0,g.jsx)(tk,{}),(0,g.jsx)(oy,{}),(0,g.jsx)(hD.DisconnectedModal,{}),(0,g.jsx)(rf,{}),(0,g.jsx)(hZ.ConvertedToProjectModal,{repl:b}),R?(0,g.jsx)(h0.BuildScoreSurveyTopLevelHook,{}):null]}),(0,g.jsx)(m0,{replId:b.id})]})})})}function m0(e){var n=e.replId,t=(0,U._)((0,gL.useBsod)(),1)[0],r=(0,U._)((0,N.useSaveReplLayoutStateMutation)(),1)[0],i=(0,B.useCallback)(function(){r({variables:{input:{replId:n,state:{}}}})},[r,n]);return(0,B.useEffect)(function(){t&&i()},[t,i]),(0,g.jsx)(hk.default,{})}var m1=(0,B.memo)(function(e){var n,t,r,i,o,a,s,l,u=e.repl,c=(n=(0,es.useUpdateContainer)(),t=(0,es.useGetContainer)(),r=(0,q.default)(),i=(0,oQ.useIsMac)(),o=(0,oQ.useIsWindows)(),a=(i||o)&&r?D.HEADER_HEIGHT:0,s=(0,B.useRef)(null),l=(0,o$.default)(function(e){var r=e.width,i=e.height;if(r&&i&&s.current){var o=s.current.getBoundingClientRect(),l=o.top,u={width:r,height:i,x:o.left,y:l-a};(0,eQ.default)(u,t())||n(u)}}),(0,B.useCallback)(function(e){s.current=e,l(e)},[l])),d=(0,es.useContainerElementIsInitialized)(),p=(0,es.usePaneIds)(),f=(0,es.useHandleIds)(),h=(0,es.useHeaderIds)(),m=(0,B.useRef)(null),v=(0,B.useCallback)(function(e){c(e),m.current=e},[c]),x=(0,q.default)();return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(E.Surface,{innerRef:v,clsx:[mJ.default.contentContainer,(0,I._)({},mJ.default.desktopApp,x)],children:[d?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(uf,{repl:u}),(0,g.jsx)(m$,{}),(0,g.jsxs)("main",{id:"main-content",children:[f.map(function(e){return(0,g.jsx)(gx,{handleId:e},e)}),h.map(function(e){return(0,g.jsx)(cd,{headerId:e},e)}),p.map(function(e){return(0,g.jsx)(uZ,{paneId:e},e)}),0===p.length?(0,g.jsx)(mn,{}):null]}),(0,g.jsx)(ub.DropPreview,{}),(0,g.jsx)(uy.DropPoints,{}),(0,g.jsx)(i0,{}),(0,g.jsx)(u1.ContextMenu,{}),(0,g.jsx)(h7,{})]}):null,(0,g.jsx)(hP,{})]}),d?null:(0,g.jsx)(M,{})]})}),m2=e.i(745844),m4=e.i(734419),m8=e.i(80366),m3=e.i(722313),m6=e.i(507187),m9=e.i(932495),m5=e.i(714260),m7=e.i(788124),ve=e.i(578134),vn=e.i(662792),vt=e.i(838720);e.s(["default",0,function(){var e,n,t,r,i,o,a,s=null,l=(0,h.useRouter)().query;if(!l.replUrl)throw Error("Expected replUrl to be set");if(!l.replId)throw Error("Expected replId to be set");var u=l.replId.toString(),c=(e={variables:{replId:u,environment:(0,m6.useEnvironment)(),platform:(0,m9.usePlatform)()},ssr:!!l.ssr},n=(0,m._)({},_,e),y.useQuery(S,n)),d=c.data,p=c.loading,f=c.error,v=(null==d?void 0:d.currentUser)||void 0,x=(null==d?void 0:d.getRepl)&&("Repl"===d.getRepl.__typename||"ReplRedirect"===d.getRepl.__typename||"ReplSubscriptionExpired"===d.getRepl.__typename)?d.getRepl:null,b=(null==d||null==(t=d.getRepl)?void 0:t.__typename)==="ReplOrgPermissionDeniedError"?d.getRepl:null,w=(null==d||null==(r=d.getRepl)?void 0:r.__typename)==="NotFoundError"?d.getRepl:null,j=(null==d||null==(i=d.getRepl)?void 0:i.__typename)==="UnauthorizedError"||(null==d||null==(o=d.getRepl)?void 0:o.__typename)==="UserError"?d.getRepl:null,I=(null==x?void 0:x.__typename)==="Repl"?x:null,T=null!=(a=null==I?void 0:I.description)?a:void 0,R=null==f?void 0:f.message,P=!!(v&&!v.isVerified);return s=b?(0,g.jsx)(L.ReplOrgPermissionDeniedError,{ownerUsername:b.ownerUsername,ownerImage:b.ownerImage}):P?(0,g.jsx)(A.View,{clsx:vt.default.emailVerificationWrapper,grow:!0,shrink:!0,children:(0,g.jsx)(C.default,{})}):R?(0,g.jsx)(A.View,{align:"center",justify:"center",grow:!0,shrink:!0,children:(0,g.jsx)(ez.Text,{multiline:!1,children:"Something went wrong loading the Repl. Please reload the page and try again."})}):w||j?(0,g.jsx)(vn.default,{}):p?(0,g.jsx)(M,{animation:!0}):I&&v?(0,g.jsx)(m5.default.Provider,{value:I.id,children:(0,g.jsx)(mX,{repl:I,currentUser:v},I.id)}):(0,g.jsx)(M,{animation:!0}),(0,g.jsx)(m7.default,{children:(0,g.jsxs)(ve.default,{dataCy:"workspace-page",title:"".concat((null==I?void 0:I.title)||"Loading..."),description:T,noHeader:!P||!!b,noMain:!P||!!b,noSidebar:!P||!!b,noFooter:!0,hideEmailVerify:!0,children:[I?(0,g.jsx)(m3.OEmbedHead,{replPath:I.url}):null,(0,g.jsx)(k.OpenTelemetryTracer,{}),(0,g.jsxs)(E.Surface,{clsx:vt.default.surface,children:[(0,g.jsx)(m2.HideBodyOverflow,{}),(0,g.jsx)(m4.PreventBodyOverscrollX,{}),s]}),(0,g.jsx)(m8.default,{replId:u})]})})}],453926)},545749,(e,n,t)=>{var r="/replEnvironmentDesktop";(window.__NEXT_P=window.__NEXT_P||[]).push([r,function(){return e.r(453926)}]),n.hot&&n.hot.dispose(function(){window.__NEXT_P.push([r])})}]);

//# debugId=f6881024-6a6c-f77e-431b-942940cecc45
//# sourceMappingURL=3cf8fe0662a0b75c.js.map